/* vtgrape.c */
void *MR3_my_malloc2(size_t n, char *s);
void MR3_my_free2(void **p, char *s);
VG_UNIT *m3_get_unit(void);
void vg_exit(int ret);
VG_UNIT *vg_allocate_unit(void (*function)(void *));
void vg_free_unit(VG_UNIT *unit);
void vg_set_function(VG_UNIT *unit, int function_index, void (*function)(void *));
void vg_set_vectors(VG_UNIT *unit, int nj, void *jvectors);
void vg_set_matrices(VG_UNIT *unit, int nati, int natj, void *matrices);
void vg_set_scalers(VG_UNIT *unit, void *scalers);
void vg_set_pipeline_vectors(VG_UNIT *unit, int ni, void *ivectors);
void vg_calculate(VG_UNIT *unit, int function_index, int nf, void *fvectors, void *pscalers);
void vg_set_vectors_pos_charge_atype(VG_UNIT *unit, int nj, double pos[][3], double charge[], int atype[]);
void vg_set_vectors_pos_charge(VG_UNIT *unit, int nj, double pos[][3], double charge[]);
void vg_set_vectors_pos_atype(VG_UNIT *unit, int nj, double pos[][3], int atype[]);
void vg_set_matrices_gscales_rscales(VG_UNIT *unit, int nati_org, int natj_org, double gscales[], double rscales[]);
void vg_set_pol_sigm_ipotro_pc_pd_zz(VG_UNIT *unit, int nati, int natj, double pol[], double sigm[], double ipotro[], double pc[], double pd[], double zz[]);
void vg_set_scalers_volume_alpha(VG_UNIT *unit, double volume[3], double alpha);
void vg_set_pipeline_vectors_pos_charge_atype(VG_UNIT *unit, int ni, double pos[][3], double charge[], int atype[]);
void vg_set_pipeline_vectors_pos_charge(VG_UNIT *unit, int ni, double pos[][3], double charge[]);
void vg_set_pipeline_vectors_pos_atype(VG_UNIT *unit, int ni, double pos[][3], int atype[]);
void vg_convert_forces(VG_UNIT *unit, int nf, int function_index, double fi[][3]);
void vg_calculate_forces_potentials(VG_UNIT *unit, int function_index, int nf, double fi[][3], double *potc, double *potv);
void vg_get_r1result(int n_org, float r[], float r1[]);
void vg_get_rsqrtresult(int n_org, float r[], float r1[]);
void vg_get_mulresult(int n_org, float r[], float q[], float rq[]);
int vg_write_emufile(int flag);
void vg_initialize_emu(void);
float vg_r1emu(float x);
float vg_rsqrtemu(float x);
void vg_set_scaleq(int n, double q[], double *scaleq, float *scaleq_1);
void m3_set_softening(VG_UNIT *unit, double eps);
void MR3_exit(int ret);
void MR3init(void);
void mr3init_(void);
void mr3init__(void);
void MR3free(void);
void mr3free_(void);
void mr3free__(void);
void MR3calccoulomb(double x[], int n, double q[], double rscale, int tblno, double xmax, int periodicflag, int natchangeflag, double force[]);
void mr3calccoulomb_(double x[], int *n, double q[], double *rscale, int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void mr3calccoulomb__(double x[], int *n, double q[], double *rscale, int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void MR3calccoulomb_ij(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag);
void mr3calccoulomb_ij_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void mr3calccoulomb_ij__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void MR3_sort_with_index_int(int data[], int index[], int left, int right);
void MR3calcvdw_ij_core(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void MR3calcvdw_ij(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void mr3calcvdw_ij_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void mr3calcvdw_ij__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void MR3calcvdw(double x[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int natchangeflag, double force[]);
void mr3calcvdw_(double x[], int *n, int atype[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void mr3calcvdw__(double x[], int *n, int atype[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void MR3calcewald(int *k, int knum_org, double *x, int n, double *chg, double alpha, double epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald__(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void MR3calcnacl(double x[], int n, int atype[], int nat, double pol[], double sigm[], double ipotro[], double pc[], double pd[], double zz[], int tblno, double xmax, int periodicflag, double force[]);
void vtgrape_force(double xj[][3], double mj[], double xi[][3], double eps2, double a[][3], int ni, int nj);
void vg_set_rcut2(VG_UNIT *unit, double rcut2);
void mr3_set_rcut2_(double *rcut2);
int md5sum(unsigned char *buffer, int totallen, unsigned char sum[16]);
int md5sum_file(char *filename, unsigned char sum[16]);
void MR3calccoulomb_ij_host(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag);
void mr3calccoulomb_ij_host_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void mr3calccoulomb_ij_host__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void MR3calcvdw_ij_host(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void mr3calcvdw_ij_host_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void mr3calcvdw_ij_host__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void MR3calccoulomb_nlist_ij_host_notwork(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[], double factorall);
void MR3calccoulomb_nlist_ij_host(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calccoulomb_nlist_host(double xd[], int n, double qd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calcvdw_nlist_ij_host_notwork(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[], double factor);
void MR3calcvdw_nlist_ij_host(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_host2(double x[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[], double factor, double force[]);
void MR3calccoulomb_ij_exlist_host(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void MR3calcvdw_ij_exlist_host(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void MR3calcewald_dft_host(int k[], int knum, double x[], int n, double chg[], double cellsize[3], double bs[], double bc[]);
void MR3calcewald_idft_eng_host(int k[], double bs[], double bc[], int knum, double x[], int n, double cellsize[3], double force[]);
void MR3calcewald_idft_force_host(int k[], double bs[], double bc[], int knum, double x[], int n, double cellsize[3], double force[]);
void MR3calcewald_host(int *k, int knum_org, double *x, int n, double *chg, double alpha, double epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_host__(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_host_(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void MR3SetTable(char *filename, int tblno, int flag);
void mr3settable_nf_(char *fname, int *tblno, int *flag, int *n);
void mr3settable_nf__(char *fname, int *tblno, int *flag, int *n);
void MR3_setup_exlist(int n, int *bckptr);
void mr3_setup_exlist_(int *n, int *bckptr);
void MR3_make_natex2_from_natex(int n, int natex[], int numex[], int **natex_offset, int **natex2, int **numex2, int **natex2_offset, int flag);
void calccoulomb_vdw_ij_exlist_host_sub(int i, int j, double xi[], double xj[], double qj, double gsf, double gsp, double rs, double rscale, double cutoff, double *fc, double *fv, double *pc, double *pv, int tblno, double size[3], int potflag);
void MR3calccoulomb_vdw_ij_exlist_cutoff_host(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double cutoff, double size[3], double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_host(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_host2(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_host_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_host__(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void MR3_get_cputime(double *laptime, double *sprittime);
void MR3_set_ldim(int ldim[3]);
void mr3_set_ldim_(int ldim[3]);
void mr3_set_ldim__(int ldim[3]);
void MR3_set_coulomb_vdw_factor(double cgf);
void mr3_set_coulomb_vdw_factor_(double *cgf);
void mr3_set_coulomb_vdw_factor__(double *cgf);
void MR3calccoulomb_ij_emu(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag);
void MR3calccoulomb_nlist_ij_emu(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calccoulomb_nlist_emu(double xd[], int n, double qd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calcvdw_ij_emu(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void MR3calccoulomb_vdw_nlist_ij_emu(int ni, double xid[], double qid[], int atypei[], double force[], int nj, double xjd[], double qjd[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblno, double volume[], int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_ij_emu(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_emu2(double xd[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calccoulomb_ij_exlist(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void mr3calccoulomb_ij_exlist_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag, int numexorg[], int natexorg[]);
void mr3calccoulomb_ij_exlist__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag, int numexorg[], int natexorg[]);
void MR3calcvdw_ij_exlist(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void mr3calcvdw_ij_exlist_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int numex[], int natex[]);
void mr3calcvdw_ij_exlist__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_core_old(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_core(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_virial_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_exlist(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double volume1, double *potc, double *potv, int *convert_index, int potflag, int flag);
void MR3calccoulomb_vdw_exlist_from_cell(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double volume1, double *potc, double *potv, int *convert_index, int potflag, int flag);
void mr3calccoulomb_vdw_exlist_(int *n, double x[], double q[], int atype[], int *nat, double force[], double *rscale, double gscalesf[], double gscalesp[], double rscales[], int *tblno, int numex[], int natex[], double *volume1, double *potc, double *potv, int *convert_index, int *potflag, int *flag);
void MR3_get_forces_overlap(double force[]);
void mr3_get_forces_overlap_(double force[]);
void MR3_get_potc_and_potv_overlap(double *potc, double *potv);
void mr3_get_potc_and_potv_overlap_(double *potc, double *potv);
void mr3_get_potc_and_potv_overlap__(double *potc, double *potv);
void MR3_get_forces_and_virial_overlap(double force[], double virial[3][3]);
void mr3_get_forces_and_virial_overlap_(double force[], double virial[3][3]);
void MR3calccoulomb_ci_exlist(int n, double x[], double q[], double force[], double rscale, int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], int *convert_index, int flag);
void mr3calccoulomb_ci_exlist_(int *n, double x[], double q[], double force[], double *rscale, int *tblno, int numex[], int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], int *convert_index, int *flag);
void MR3calcvdw_ci(int n, double x[], int atype[], int nat, double force[], double gscales[], double rscales[], int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calcvdw_ci_(int *n, double x[], int atype[], int *nat, double force[], double gscales[], double rscales[], int *tblno, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calcvdw_ci_exlist(int n, double x[], int atype[], int nat, double force[], double gscales[], double rscales[], int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], int *convert_index, int flag);
void mr3calcvdw_ci_exlist_(int *n, double x[], int atype[], int *nat, double force[], double gscales[], double rscales[], int *tblno, int numex[], int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], int *convert_index, int *flag);
void MR3calccoulomb_vdw_ci_exlist(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], double *potc, double *potv, int *convert_index, int potflag, int flag);
void mr3calccoulomb_vdw_ci_exlist_(int *n, double x[], double q[], int atype[], int *nat, double force[], double *rscale, double gscalesf[], double gscalesp[], double rscales[], int *tblno, int *numex, int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], double *potc, double *potv, int *convert_index, int *potflag, int *flag);
void MR3calccoulomb_ci(int n, double x[], double q[], double force[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calccoulomb_ci_(int *n, double x[], double q[], double force[], double *rscale, int *tblno, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_ij_ci(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_ij_ci_old(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calcvdw_ij_ci(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_virial(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut_org, double skinnb, double volume[3], int ldim[3], double virial[3][3], int flag);
void MR3calccoulomb_vdw_ij_ci(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calccoulomb_vdw_ij_ci_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscales[], double rscales[], double *rscale, int *tblnoc, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_old_09(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_old_090121(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_exlist(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3], int numex[], int natex[], int flag);
void mr3calccoulomb_vdw_ij_ci_exlist_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscales[], double rscales[], double *rscale, int *tblnoc, double *rcut, double *skinnb, double volume[3], int ldim[3], int numex[], int natex[], int *flag);
void MR3_get_board_version(int *version, int *freq);
void MR3_rscale_and_pack(int n, double (*x)[3], int *atype, longlong (*rj)[2]);
void MR3_rscale_and_pack_old(int n, double (*x)[3], int *atype, longlong (*rj)[2]);
void MR3SetTable_emu(char *filename, int tblno, int flag);
int MR3_get_total_num_chips(void);
void MR3print_chip_temperature(int flag);
int MR3_get_retry_count(void);
void m3_free_unit(VG_UNIT *unit);
VG_UNIT *m3_allocate_periodic_unit(const char *fname, int mode, double size, int dum);
void m3_set_positions(VG_UNIT *unit, double (*pos)[3], int n);
void m3_set_charges(VG_UNIT *unit, const double *q, int n);
void m3_set_cells(VG_UNIT *unit, M3_CELL *cell, int ncell);
void m3_calculate_forces(VG_UNIT *unit, double (*xi)[3], int ni, double (*force)[3]);
void m3_calculate_potentials(VG_UNIT *unit, double (*xi)[3], int ni, double *eng);
void m3_set_types(VG_UNIT *unit, const int *atype, int n);
void m3_set_pipeline_types(VG_UNIT *unit, const int *atype, int n);
void m3_set_charge_matrix(VG_UNIT *unit, const double *gscale, int nati, int natj);
void m3_set_rscale_matrix(VG_UNIT *unit, const double *rscale, int nati, int natj);
int MR3_close_ch(int s_sock);
int mr3_close_ch_(int *s_sock);
int MR3_open_port(int port_number);
int MR3_sock_read(int sockfd, char *buf, size_t count);
int mr3_sock_read_(int *sockfd, char *buf, int *count);
int mr3_sock_read__(int *sockfd, char *buf, int *count);
int mr3_sock_read_i_(int *sockfd, int *buf);
int mr3_sock_read_i__(int *sockfd, int *buf);
int MR3_sock_read_iv(int sockfd, int *buf, int count);
int mr3_sock_read_iv_(int *sockfd, int *buf, int *count);
int mr3_sock_read_iv__(int *sockfd, int *buf, int *count);
int MR3_sock_read_d(int sockfd, double *buf);
int mr3_sock_read_d__(int *sockfd, double *buf);
int mr3_sock_read_d_(int *sockfd, double *buf);
int MR3_sock_read_dv(int sockfd, double *buf, int count);
int mr3_sock_read_dv__(int *sockfd, double *buf, int *count);
int mr3_sock_read_dv_(int *sockfd, double *buf, int *count);
int MR3_sock_write(int sockfd, char *buf, size_t count);
int MR3_sock_write_c(int sockfd, char *buf);
int mr3_sock_write_c_(int *sockfd, char *buf);
int mr3_sock_write_c__(int *sockfd, char *buf);
int MR3_sock_write_i(int sockfd, int buf);
int mr3_sock_write_i_(int *sockfd, int *buf);
int mr3_sock_write_i__(int *sockfd, int *buf);
int MR3_sock_write_iv(int sockfd, int *buf, int count);
int mr3_sock_write_iv_(int *sockfd, int *buf, int *count);
int mr3_sock_write_iv__(int *sockfd, int *buf, int *count);
int MR3_sock_write_dv(int sockfd, double *buf, int count);
int mr3_sock_write_dv__(int *sockfd, double *buf, int *count);
int mr3_sock_write_dv_(int *sockfd, double *buf, int *count);
int MR3_sock_gets(int sockfd, char *str, size_t count);
int MR3_sock_puts(int sockfd, char *str);
void MR3_sock_init(int *s_sock_org, int port_num, double x[], int igraph[], int natom, int str_len, int lbres[], int ipres[], int nres);
void mr3_sock_init_(int *s_sock, int *port_num, double x[], int igraph[], int *natom, int *str_len, int lbres[], int ipres[], int *nres);
void mr3_sock_init__(int *s_sock, int *port_num, double x[], int igraph[], int *natom, int *str_len, int lbres[], int ipres[], int *nres);
void MR3_sock_1step(int s_sock, double t1, double time, double t2, int recv_buf[], int natom, double x[], double f[], double f_temp[]);
void mr3_sock_1step_(int *s_sock, double *t1, double *time, double *t2, int recv_buf[], int *natom, double x[], double f[], double f_tmp[]);
void mr3_sock_1step__(int *s_sock, double *t1, double *time, double *t2, int recv_buf[], int *natom, double x[], double f[], double f_tmp[]);
void MR3calc_ij_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, char method);
void MR3calc_ij_exlist_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], char method);
void MR3calc_ij_nlist_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], char method);
/* vtgrape.c */
void *MR3_my_malloc2(size_t n, char *s);
void MR3_my_free2(void **p, char *s);
VG_UNIT *m3_get_unit(void);
void vg_exit(int ret);
VG_UNIT *vg_allocate_unit(void (*function)(void *));
void vg_free_unit(VG_UNIT *unit);
void vg_set_function(VG_UNIT *unit, int function_index, void (*function)(void *));
void vg_set_vectors(VG_UNIT *unit, int nj, void *jvectors);
void vg_set_matrices(VG_UNIT *unit, int nati, int natj, void *matrices);
void vg_set_scalers(VG_UNIT *unit, void *scalers);
void vg_set_pipeline_vectors(VG_UNIT *unit, int ni, void *ivectors);
void vg_calculate(VG_UNIT *unit, int function_index, int nf, void *fvectors, void *pscalers);
void vg_set_vectors_pos_charge_atype(VG_UNIT *unit, int nj, double pos[][3], double charge[], int atype[]);
void vg_set_vectors_pos_charge(VG_UNIT *unit, int nj, double pos[][3], double charge[]);
void vg_set_vectors_pos_atype(VG_UNIT *unit, int nj, double pos[][3], int atype[]);
void vg_set_matrices_gscales_rscales(VG_UNIT *unit, int nati_org, int natj_org, double gscales[], double rscales[]);
void vg_set_pol_sigm_ipotro_pc_pd_zz(VG_UNIT *unit, int nati, int natj, double pol[], double sigm[], double ipotro[], double pc[], double pd[], double zz[]);
void vg_set_scalers_volume_alpha(VG_UNIT *unit, double volume[3], double alpha);
void vg_set_pipeline_vectors_pos_charge_atype(VG_UNIT *unit, int ni, double pos[][3], double charge[], int atype[]);
void vg_set_pipeline_vectors_pos_charge(VG_UNIT *unit, int ni, double pos[][3], double charge[]);
void vg_set_pipeline_vectors_pos_atype(VG_UNIT *unit, int ni, double pos[][3], int atype[]);
void vg_convert_forces(VG_UNIT *unit, int nf, int function_index, double fi[][3]);
void vg_calculate_forces_potentials(VG_UNIT *unit, int function_index, int nf, double fi[][3], double *potc, double *potv);
void vg_get_r1result(int n_org, float r[], float r1[]);
void vg_get_rsqrtresult(int n_org, float r[], float r1[]);
void vg_get_mulresult(int n_org, float r[], float q[], float rq[]);
int vg_write_emufile(int flag);
void vg_initialize_emu(void);
float vg_r1emu(float x);
float vg_rsqrtemu(float x);
void vg_set_scaleq(int n, double q[], double *scaleq, float *scaleq_1);
void m3_set_softening(VG_UNIT *unit, double eps);
void MR3_exit(int ret);
void MR3init(void);
void mr3init_(void);
void mr3init__(void);
void MR3free(void);
void mr3free_(void);
void mr3free__(void);
void MR3calccoulomb(double x[], int n, double q[], double rscale, int tblno, double xmax, int periodicflag, int natchangeflag, double force[]);
void mr3calccoulomb_(double x[], int *n, double q[], double *rscale, int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void mr3calccoulomb__(double x[], int *n, double q[], double *rscale, int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void MR3calccoulomb_ij(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag);
void mr3calccoulomb_ij_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void mr3calccoulomb_ij__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void MR3_sort_with_index_int(int data[], int index[], int left, int right);
void MR3calcvdw_ij_core(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void MR3calcvdw_ij(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void mr3calcvdw_ij_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void mr3calcvdw_ij__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void MR3calcvdw(double x[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int natchangeflag, double force[]);
void mr3calcvdw_(double x[], int *n, int atype[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void mr3calcvdw__(double x[], int *n, int atype[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void MR3calcewald(int *k, int knum_org, double *x, int n, double *chg, double alpha, double epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald__(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void MR3calcnacl(double x[], int n, int atype[], int nat, double pol[], double sigm[], double ipotro[], double pc[], double pd[], double zz[], int tblno, double xmax, int periodicflag, double force[]);
void vtgrape_force(double xj[][3], double mj[], double xi[][3], double eps2, double a[][3], int ni, int nj);
void vg_set_rcut2(VG_UNIT *unit, double rcut2);
void mr3_set_rcut2_(double *rcut2);
int md5sum(unsigned char *buffer, int totallen, unsigned char sum[16]);
int md5sum_file(char *filename, unsigned char sum[16]);
void MR3calccoulomb_ij_host(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag);
void mr3calccoulomb_ij_host_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void mr3calccoulomb_ij_host__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void MR3calcvdw_ij_host(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void mr3calcvdw_ij_host_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void mr3calcvdw_ij_host__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void MR3calccoulomb_nlist_ij_host_notwork(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[], double factorall);
void MR3calccoulomb_nlist_ij_host(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calccoulomb_nlist_host(double xd[], int n, double qd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calcvdw_nlist_ij_host_notwork(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[], double factor);
void MR3calcvdw_nlist_ij_host(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_host2(double x[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[], double factor, double force[]);
void MR3calccoulomb_ij_exlist_host(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void MR3calcvdw_ij_exlist_host(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void MR3calcewald_dft_host(int k[], int knum, double x[], int n, double chg[], double cellsize[3], double bs[], double bc[]);
void MR3calcewald_idft_eng_host(int k[], double bs[], double bc[], int knum, double x[], int n, double cellsize[3], double force[]);
void MR3calcewald_idft_force_host(int k[], double bs[], double bc[], int knum, double x[], int n, double cellsize[3], double force[]);
void MR3calcewald_host(int *k, int knum_org, double *x, int n, double *chg, double alpha, double epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_host__(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_host_(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void MR3SetTable(char *filename, int tblno, int flag);
void mr3settable_nf_(char *fname, int *tblno, int *flag, int *n);
void mr3settable_nf__(char *fname, int *tblno, int *flag, int *n);
void MR3_setup_exlist(int n, int *bckptr);
void mr3_setup_exlist_(int *n, int *bckptr);
void MR3_make_natex2_from_natex(int n, int natex[], int numex[], int **natex_offset, int **natex2, int **numex2, int **natex2_offset, int flag);
void calccoulomb_vdw_ij_exlist_host_sub(int i, int j, double xi[], double xj[], double qj, double gsf, double gsp, double rs, double rscale, double cutoff, double *fc, double *fv, double *pc, double *pv, int tblno, double size[3], int potflag);
void MR3calccoulomb_vdw_ij_exlist_cutoff_host(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double cutoff, double size[3], double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_host(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_host2(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_host_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_host__(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void MR3_get_cputime(double *laptime, double *sprittime);
void MR3_set_ldim(int ldim[3]);
void mr3_set_ldim_(int ldim[3]);
void mr3_set_ldim__(int ldim[3]);
void MR3_set_coulomb_vdw_factor(double cgf);
void mr3_set_coulomb_vdw_factor_(double *cgf);
void mr3_set_coulomb_vdw_factor__(double *cgf);
void MR3calccoulomb_ij_emu(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag);
void MR3calccoulomb_nlist_ij_emu(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calccoulomb_nlist_emu(double xd[], int n, double qd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calcvdw_ij_emu(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void MR3calccoulomb_vdw_nlist_ij_emu(int ni, double xid[], double qid[], int atypei[], double force[], int nj, double xjd[], double qjd[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblno, double volume[], int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_ij_emu(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_emu2(double xd[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calccoulomb_ij_exlist(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void mr3calccoulomb_ij_exlist_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag, int numexorg[], int natexorg[]);
void mr3calccoulomb_ij_exlist__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag, int numexorg[], int natexorg[]);
void MR3calcvdw_ij_exlist(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void mr3calcvdw_ij_exlist_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int numex[], int natex[]);
void mr3calcvdw_ij_exlist__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_core_old(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_core(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_virial_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_exlist(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double volume1, double *potc, double *potv, int *convert_index, int potflag, int flag);
void MR3calccoulomb_vdw_exlist_from_cell(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double volume1, double *potc, double *potv, int *convert_index, int potflag, int flag);
void mr3calccoulomb_vdw_exlist_(int *n, double x[], double q[], int atype[], int *nat, double force[], double *rscale, double gscalesf[], double gscalesp[], double rscales[], int *tblno, int numex[], int natex[], double *volume1, double *potc, double *potv, int *convert_index, int *potflag, int *flag);
void MR3_get_forces_overlap(double force[]);
void mr3_get_forces_overlap_(double force[]);
void MR3_get_potc_and_potv_overlap(double *potc, double *potv);
void mr3_get_potc_and_potv_overlap_(double *potc, double *potv);
void mr3_get_potc_and_potv_overlap__(double *potc, double *potv);
void MR3_get_forces_and_virial_overlap(double force[], double virial[3][3]);
void mr3_get_forces_and_virial_overlap_(double force[], double virial[3][3]);
void MR3calccoulomb_ci_exlist(int n, double x[], double q[], double force[], double rscale, int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], int *convert_index, int flag);
void mr3calccoulomb_ci_exlist_(int *n, double x[], double q[], double force[], double *rscale, int *tblno, int numex[], int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], int *convert_index, int *flag);
void MR3calcvdw_ci(int n, double x[], int atype[], int nat, double force[], double gscales[], double rscales[], int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calcvdw_ci_(int *n, double x[], int atype[], int *nat, double force[], double gscales[], double rscales[], int *tblno, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calcvdw_ci_exlist(int n, double x[], int atype[], int nat, double force[], double gscales[], double rscales[], int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], int *convert_index, int flag);
void mr3calcvdw_ci_exlist_(int *n, double x[], int atype[], int *nat, double force[], double gscales[], double rscales[], int *tblno, int numex[], int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], int *convert_index, int *flag);
void MR3calccoulomb_vdw_ci_exlist(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], double *potc, double *potv, int *convert_index, int potflag, int flag);
void mr3calccoulomb_vdw_ci_exlist_(int *n, double x[], double q[], int atype[], int *nat, double force[], double *rscale, double gscalesf[], double gscalesp[], double rscales[], int *tblno, int *numex, int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], double *potc, double *potv, int *convert_index, int *potflag, int *flag);
void MR3calccoulomb_ci(int n, double x[], double q[], double force[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calccoulomb_ci_(int *n, double x[], double q[], double force[], double *rscale, int *tblno, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_ij_ci(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_ij_ci_old(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calcvdw_ij_ci(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_virial(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut_org, double skinnb, double volume[3], int ldim[3], double virial[3][3], int flag);
void MR3calccoulomb_vdw_ij_ci(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calccoulomb_vdw_ij_ci_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscales[], double rscales[], double *rscale, int *tblnoc, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_old_09(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_old_090121(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_exlist(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3], int numex[], int natex[], int flag);
void mr3calccoulomb_vdw_ij_ci_exlist_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscales[], double rscales[], double *rscale, int *tblnoc, double *rcut, double *skinnb, double volume[3], int ldim[3], int numex[], int natex[], int *flag);
void MR3_get_board_version(int *version, int *freq);
void MR3_rscale_and_pack(int n, double (*x)[3], int *atype, longlong (*rj)[2]);
void MR3_rscale_and_pack_old(int n, double (*x)[3], int *atype, longlong (*rj)[2]);
void MR3SetTable_emu(char *filename, int tblno, int flag);
int MR3_get_total_num_chips(void);
void MR3print_chip_temperature(int flag);
int MR3_get_retry_count(void);
void m3_free_unit(VG_UNIT *unit);
VG_UNIT *m3_allocate_periodic_unit(const char *fname, int mode, double size, int dum);
void m3_set_positions(VG_UNIT *unit, double (*pos)[3], int n);
void m3_set_charges(VG_UNIT *unit, const double *q, int n);
void m3_set_cells(VG_UNIT *unit, M3_CELL *cell, int ncell);
void m3_calculate_forces(VG_UNIT *unit, double (*xi)[3], int ni, double (*force)[3]);
void m3_calculate_potentials(VG_UNIT *unit, double (*xi)[3], int ni, double *eng);
void m3_set_types(VG_UNIT *unit, const int *atype, int n);
void m3_set_pipeline_types(VG_UNIT *unit, const int *atype, int n);
void m3_set_charge_matrix(VG_UNIT *unit, const double *gscale, int nati, int natj);
void m3_set_rscale_matrix(VG_UNIT *unit, const double *rscale, int nati, int natj);
int MR3_close_ch(int s_sock);
int mr3_close_ch_(int *s_sock);
int MR3_open_port(int port_number);
int MR3_sock_read(int sockfd, char *buf, size_t count);
int mr3_sock_read_(int *sockfd, char *buf, int *count);
int mr3_sock_read__(int *sockfd, char *buf, int *count);
int mr3_sock_read_i_(int *sockfd, int *buf);
int mr3_sock_read_i__(int *sockfd, int *buf);
int MR3_sock_read_iv(int sockfd, int *buf, int count);
int mr3_sock_read_iv_(int *sockfd, int *buf, int *count);
int mr3_sock_read_iv__(int *sockfd, int *buf, int *count);
int MR3_sock_read_d(int sockfd, double *buf);
int mr3_sock_read_d__(int *sockfd, double *buf);
int mr3_sock_read_d_(int *sockfd, double *buf);
int MR3_sock_read_dv(int sockfd, double *buf, int count);
int mr3_sock_read_dv__(int *sockfd, double *buf, int *count);
int mr3_sock_read_dv_(int *sockfd, double *buf, int *count);
int MR3_sock_write(int sockfd, char *buf, size_t count);
int MR3_sock_write_c(int sockfd, char *buf);
int mr3_sock_write_c_(int *sockfd, char *buf);
int mr3_sock_write_c__(int *sockfd, char *buf);
int MR3_sock_write_i(int sockfd, int buf);
int mr3_sock_write_i_(int *sockfd, int *buf);
int mr3_sock_write_i__(int *sockfd, int *buf);
int MR3_sock_write_iv(int sockfd, int *buf, int count);
int mr3_sock_write_iv_(int *sockfd, int *buf, int *count);
int mr3_sock_write_iv__(int *sockfd, int *buf, int *count);
int MR3_sock_write_dv(int sockfd, double *buf, int count);
int mr3_sock_write_dv__(int *sockfd, double *buf, int *count);
int mr3_sock_write_dv_(int *sockfd, double *buf, int *count);
int MR3_sock_gets(int sockfd, char *str, size_t count);
int MR3_sock_puts(int sockfd, char *str);
void MR3_sock_init(int *s_sock_org, int port_num, double x[], int igraph[], int natom, int str_len, int lbres[], int ipres[], int nres);
void mr3_sock_init_(int *s_sock, int *port_num, double x[], int igraph[], int *natom, int *str_len, int lbres[], int ipres[], int *nres);
void mr3_sock_init__(int *s_sock, int *port_num, double x[], int igraph[], int *natom, int *str_len, int lbres[], int ipres[], int *nres);
void MR3_sock_1step(int s_sock, double t1, double time, double t2, int recv_buf[], int natom, double x[], double f[], double f_temp[]);
void mr3_sock_1step_(int *s_sock, double *t1, double *time, double *t2, int recv_buf[], int *natom, double x[], double f[], double f_tmp[]);
void mr3_sock_1step__(int *s_sock, double *t1, double *time, double *t2, int recv_buf[], int *natom, double x[], double f[], double f_tmp[]);
void MR3calc_ij_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, char method);
void MR3calc_ij_exlist_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], char method);
void MR3calc_ij_nlist_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], char method);
/* vtgrape.c */
void *MR3_my_malloc2(size_t n, char *s);
void MR3_my_free2(void **p, char *s);
VG_UNIT *m3_get_unit(void);
void vg_exit(int ret);
VG_UNIT *vg_allocate_unit(void (*function)(void *));
void vg_free_unit(VG_UNIT *unit);
void vg_set_function(VG_UNIT *unit, int function_index, void (*function)(void *));
void vg_set_vectors(VG_UNIT *unit, int nj, void *jvectors);
void vg_set_matrices(VG_UNIT *unit, int nati, int natj, void *matrices);
void vg_set_scalers(VG_UNIT *unit, void *scalers);
void vg_set_pipeline_vectors(VG_UNIT *unit, int ni, void *ivectors);
void vg_calculate(VG_UNIT *unit, int function_index, int nf, void *fvectors, void *pscalers);
void vg_set_vectors_pos_charge_atype(VG_UNIT *unit, int nj, double pos[][3], double charge[], int atype[]);
void vg_set_vectors_pos_charge(VG_UNIT *unit, int nj, double pos[][3], double charge[]);
void vg_set_vectors_pos_atype(VG_UNIT *unit, int nj, double pos[][3], int atype[]);
void vg_set_matrices_gscales_rscales(VG_UNIT *unit, int nati_org, int natj_org, double gscales[], double rscales[]);
void vg_set_pol_sigm_ipotro_pc_pd_zz(VG_UNIT *unit, int nati, int natj, double pol[], double sigm[], double ipotro[], double pc[], double pd[], double zz[]);
void vg_set_scalers_volume_alpha(VG_UNIT *unit, double volume[3], double alpha);
void vg_set_pipeline_vectors_pos_charge_atype(VG_UNIT *unit, int ni, double pos[][3], double charge[], int atype[]);
void vg_set_pipeline_vectors_pos_charge(VG_UNIT *unit, int ni, double pos[][3], double charge[]);
void vg_set_pipeline_vectors_pos_atype(VG_UNIT *unit, int ni, double pos[][3], int atype[]);
void vg_convert_forces(VG_UNIT *unit, int nf, int function_index, double fi[][3]);
void vg_calculate_forces_potentials(VG_UNIT *unit, int function_index, int nf, double fi[][3], double *potc, double *potv);
void vg_get_r1result(int n_org, float r[], float r1[]);
void vg_get_rsqrtresult(int n_org, float r[], float r1[]);
void vg_get_mulresult(int n_org, float r[], float q[], float rq[]);
int vg_write_emufile(int flag);
void vg_initialize_emu(void);
float vg_r1emu(float x);
float vg_rsqrtemu(float x);
void vg_set_scaleq(int n, double q[], double *scaleq, float *scaleq_1);
void m3_set_softening(VG_UNIT *unit, double eps);
void MR3_exit(int ret);
void MR3init(void);
void mr3init_(void);
void mr3init__(void);
void MR3free(void);
void mr3free_(void);
void mr3free__(void);
void MR3calccoulomb(double x[], int n, double q[], double rscale, int tblno, double xmax, int periodicflag, int natchangeflag, double force[]);
void mr3calccoulomb_(double x[], int *n, double q[], double *rscale, int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void mr3calccoulomb__(double x[], int *n, double q[], double *rscale, int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void MR3calccoulomb_ij(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag);
void mr3calccoulomb_ij_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void mr3calccoulomb_ij__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void MR3_sort_with_index_int(int data[], int index[], int left, int right);
void MR3calcvdw_ij_core(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void MR3calcvdw_ij(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void mr3calcvdw_ij_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void mr3calcvdw_ij__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void MR3calcvdw(double x[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int natchangeflag, double force[]);
void mr3calcvdw_(double x[], int *n, int atype[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void mr3calcvdw__(double x[], int *n, int atype[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void MR3calcewald(int *k, int knum_org, double *x, int n, double *chg, double alpha, double epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald__(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void MR3calcnacl(double x[], int n, int atype[], int nat, double pol[], double sigm[], double ipotro[], double pc[], double pd[], double zz[], int tblno, double xmax, int periodicflag, double force[]);
void vtgrape_force(double xj[][3], double mj[], double xi[][3], double eps2, double a[][3], int ni, int nj);
void vg_set_rcut2(VG_UNIT *unit, double rcut2);
void mr3_set_rcut2_(double *rcut2);
int md5sum(unsigned char *buffer, int totallen, unsigned char sum[16]);
int md5sum_file(char *filename, unsigned char sum[16]);
void MR3calccoulomb_ij_host(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag);
void mr3calccoulomb_ij_host_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void mr3calccoulomb_ij_host__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void MR3calcvdw_ij_host(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void mr3calcvdw_ij_host_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void mr3calcvdw_ij_host__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void MR3calccoulomb_nlist_ij_host_notwork(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[], double factorall);
void MR3calccoulomb_nlist_ij_host(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calccoulomb_nlist_host(double xd[], int n, double qd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calcvdw_nlist_ij_host_notwork(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[], double factor);
void MR3calcvdw_nlist_ij_host(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_host2(double x[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[], double factor, double force[]);
void MR3calccoulomb_ij_exlist_host(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void MR3calcvdw_ij_exlist_host(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void MR3calcewald_dft_host(int k[], int knum, double x[], int n, double chg[], double cellsize[3], double bs[], double bc[]);
void MR3calcewald_idft_eng_host(int k[], double bs[], double bc[], int knum, double x[], int n, double cellsize[3], double force[]);
void MR3calcewald_idft_force_host(int k[], double bs[], double bc[], int knum, double x[], int n, double cellsize[3], double force[]);
void MR3calcewald_host(int *k, int knum_org, double *x, int n, double *chg, double alpha, double epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_host__(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_host_(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void MR3SetTable(char *filename, int tblno, int flag);
void mr3settable_nf_(char *fname, int *tblno, int *flag, int *n);
void mr3settable_nf__(char *fname, int *tblno, int *flag, int *n);
void MR3_setup_exlist(int n, int *bckptr);
void mr3_setup_exlist_(int *n, int *bckptr);
void MR3_make_natex2_from_natex(int n, int natex[], int numex[], int **natex_offset, int **natex2, int **numex2, int **natex2_offset, int flag);
void calccoulomb_vdw_ij_exlist_host_sub(int i, int j, double xi[], double xj[], double qj, double gsf, double gsp, double rs, double rscale, double cutoff, double *fc, double *fv, double *pc, double *pv, int tblno, double size[3], int potflag);
void MR3calccoulomb_vdw_ij_exlist_cutoff_host(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double cutoff, double size[3], double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_host(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_host2(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_host_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_host__(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void MR3_get_cputime(double *laptime, double *sprittime);
void MR3_set_ldim(int ldim[3]);
void mr3_set_ldim_(int ldim[3]);
void mr3_set_ldim__(int ldim[3]);
void MR3_set_coulomb_vdw_factor(double cgf);
void mr3_set_coulomb_vdw_factor_(double *cgf);
void mr3_set_coulomb_vdw_factor__(double *cgf);
void MR3calccoulomb_ij_emu(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag);
void MR3calccoulomb_nlist_ij_emu(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calccoulomb_nlist_emu(double xd[], int n, double qd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calcvdw_ij_emu(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void MR3calccoulomb_vdw_nlist_ij_emu(int ni, double xid[], double qid[], int atypei[], double force[], int nj, double xjd[], double qjd[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblno, double volume[], int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_ij_emu(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_emu2(double xd[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calccoulomb_ij_exlist(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void mr3calccoulomb_ij_exlist_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag, int numexorg[], int natexorg[]);
void mr3calccoulomb_ij_exlist__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag, int numexorg[], int natexorg[]);
void MR3calcvdw_ij_exlist(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void mr3calcvdw_ij_exlist_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int numex[], int natex[]);
void mr3calcvdw_ij_exlist__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_core_old(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_core(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_virial_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_exlist(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double volume1, double *potc, double *potv, int *convert_index, int potflag, int flag);
void MR3calccoulomb_vdw_exlist_from_cell(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double volume1, double *potc, double *potv, int *convert_index, int potflag, int flag);
void mr3calccoulomb_vdw_exlist_(int *n, double x[], double q[], int atype[], int *nat, double force[], double *rscale, double gscalesf[], double gscalesp[], double rscales[], int *tblno, int numex[], int natex[], double *volume1, double *potc, double *potv, int *convert_index, int *potflag, int *flag);
void MR3_get_forces_overlap(double force[]);
void mr3_get_forces_overlap_(double force[]);
void MR3_get_potc_and_potv_overlap(double *potc, double *potv);
void mr3_get_potc_and_potv_overlap_(double *potc, double *potv);
void mr3_get_potc_and_potv_overlap__(double *potc, double *potv);
void MR3_get_forces_and_virial_overlap(double force[], double virial[3][3]);
void mr3_get_forces_and_virial_overlap_(double force[], double virial[3][3]);
void MR3calccoulomb_ci_exlist(int n, double x[], double q[], double force[], double rscale, int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], int *convert_index, int flag);
void mr3calccoulomb_ci_exlist_(int *n, double x[], double q[], double force[], double *rscale, int *tblno, int numex[], int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], int *convert_index, int *flag);
void MR3calcvdw_ci(int n, double x[], int atype[], int nat, double force[], double gscales[], double rscales[], int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calcvdw_ci_(int *n, double x[], int atype[], int *nat, double force[], double gscales[], double rscales[], int *tblno, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calcvdw_ci_exlist(int n, double x[], int atype[], int nat, double force[], double gscales[], double rscales[], int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], int *convert_index, int flag);
void mr3calcvdw_ci_exlist_(int *n, double x[], int atype[], int *nat, double force[], double gscales[], double rscales[], int *tblno, int numex[], int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], int *convert_index, int *flag);
void MR3calccoulomb_vdw_ci_exlist(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], double *potc, double *potv, int *convert_index, int potflag, int flag);
void mr3calccoulomb_vdw_ci_exlist_(int *n, double x[], double q[], int atype[], int *nat, double force[], double *rscale, double gscalesf[], double gscalesp[], double rscales[], int *tblno, int *numex, int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], double *potc, double *potv, int *convert_index, int *potflag, int *flag);
void MR3calccoulomb_ci(int n, double x[], double q[], double force[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calccoulomb_ci_(int *n, double x[], double q[], double force[], double *rscale, int *tblno, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_ij_ci(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_ij_ci_old(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calcvdw_ij_ci(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_virial(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut_org, double skinnb, double volume[3], int ldim[3], double virial[3][3], int flag);
void MR3calccoulomb_vdw_ij_ci(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calccoulomb_vdw_ij_ci_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscales[], double rscales[], double *rscale, int *tblnoc, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_old_09(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_old_090121(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_exlist(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3], int numex[], int natex[], int flag);
void mr3calccoulomb_vdw_ij_ci_exlist_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscales[], double rscales[], double *rscale, int *tblnoc, double *rcut, double *skinnb, double volume[3], int ldim[3], int numex[], int natex[], int *flag);
void MR3_get_board_version(int *version, int *freq);
void MR3_rscale_and_pack(int n, double (*x)[3], int *atype, longlong (*rj)[2]);
void MR3_rscale_and_pack_old(int n, double (*x)[3], int *atype, longlong (*rj)[2]);
void MR3SetTable_emu(char *filename, int tblno, int flag);
int MR3_get_total_num_chips(void);
void MR3print_chip_temperature(int flag);
int MR3_get_retry_count(void);
void m3_free_unit(VG_UNIT *unit);
VG_UNIT *m3_allocate_periodic_unit(const char *fname, int mode, double size, int dum);
void m3_set_positions(VG_UNIT *unit, double (*pos)[3], int n);
void m3_set_charges(VG_UNIT *unit, const double *q, int n);
void m3_set_cells(VG_UNIT *unit, M3_CELL *cell, int ncell);
void m3_calculate_forces(VG_UNIT *unit, double (*xi)[3], int ni, double (*force)[3]);
void m3_calculate_potentials(VG_UNIT *unit, double (*xi)[3], int ni, double *eng);
void m3_set_types(VG_UNIT *unit, const int *atype, int n);
void m3_set_pipeline_types(VG_UNIT *unit, const int *atype, int n);
void m3_set_charge_matrix(VG_UNIT *unit, const double *gscale, int nati, int natj);
void m3_set_rscale_matrix(VG_UNIT *unit, const double *rscale, int nati, int natj);
int MR3_close_ch(int s_sock);
int mr3_close_ch_(int *s_sock);
int MR3_open_port(int port_number);
int MR3_sock_read(int sockfd, char *buf, size_t count);
int mr3_sock_read_(int *sockfd, char *buf, int *count);
int mr3_sock_read__(int *sockfd, char *buf, int *count);
int mr3_sock_read_i_(int *sockfd, int *buf);
int mr3_sock_read_i__(int *sockfd, int *buf);
int MR3_sock_read_iv(int sockfd, int *buf, int count);
int mr3_sock_read_iv_(int *sockfd, int *buf, int *count);
int mr3_sock_read_iv__(int *sockfd, int *buf, int *count);
int MR3_sock_read_d(int sockfd, double *buf);
int mr3_sock_read_d__(int *sockfd, double *buf);
int mr3_sock_read_d_(int *sockfd, double *buf);
int MR3_sock_read_dv(int sockfd, double *buf, int count);
int mr3_sock_read_dv__(int *sockfd, double *buf, int *count);
int mr3_sock_read_dv_(int *sockfd, double *buf, int *count);
int MR3_sock_write(int sockfd, char *buf, size_t count);
int MR3_sock_write_c(int sockfd, char *buf);
int mr3_sock_write_c_(int *sockfd, char *buf);
int mr3_sock_write_c__(int *sockfd, char *buf);
int MR3_sock_write_i(int sockfd, int buf);
int mr3_sock_write_i_(int *sockfd, int *buf);
int mr3_sock_write_i__(int *sockfd, int *buf);
int MR3_sock_write_iv(int sockfd, int *buf, int count);
int mr3_sock_write_iv_(int *sockfd, int *buf, int *count);
int mr3_sock_write_iv__(int *sockfd, int *buf, int *count);
int MR3_sock_write_dv(int sockfd, double *buf, int count);
int mr3_sock_write_dv__(int *sockfd, double *buf, int *count);
int mr3_sock_write_dv_(int *sockfd, double *buf, int *count);
int MR3_sock_gets(int sockfd, char *str, size_t count);
int MR3_sock_puts(int sockfd, char *str);
void MR3_sock_init(int *s_sock_org, int port_num, double x[], int igraph[], int natom, int str_len, int lbres[], int ipres[], int nres);
void mr3_sock_init_(int *s_sock, int *port_num, double x[], int igraph[], int *natom, int *str_len, int lbres[], int ipres[], int *nres);
void mr3_sock_init__(int *s_sock, int *port_num, double x[], int igraph[], int *natom, int *str_len, int lbres[], int ipres[], int *nres);
void MR3_sock_1step(int s_sock, double t1, double time, double t2, int recv_buf[], int natom, double x[], double f[], double f_temp[]);
void mr3_sock_1step_(int *s_sock, double *t1, double *time, double *t2, int recv_buf[], int *natom, double x[], double f[], double f_tmp[]);
void mr3_sock_1step__(int *s_sock, double *t1, double *time, double *t2, int recv_buf[], int *natom, double x[], double f[], double f_tmp[]);
void MR3calc_ij_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, char method);
void MR3calc_ij_exlist_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], char method);
void MR3calc_ij_nlist_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], char method);
/* vtgrape.c */
void *MR3_my_malloc2(size_t n, char *s);
void MR3_my_free2(void **p, char *s);
VG_UNIT *m3_get_unit(void);
void vg_exit(int ret);
VG_UNIT *vg_allocate_unit(void (*function)(void *));
void vg_free_unit(VG_UNIT *unit);
void vg_set_function(VG_UNIT *unit, int function_index, void (*function)(void *));
void vg_set_vectors(VG_UNIT *unit, int nj, void *jvectors);
void vg_set_matrices(VG_UNIT *unit, int nati, int natj, void *matrices);
void vg_set_scalers(VG_UNIT *unit, void *scalers);
void vg_set_pipeline_vectors(VG_UNIT *unit, int ni, void *ivectors);
void vg_calculate(VG_UNIT *unit, int function_index, int nf, void *fvectors, void *pscalers);
void vg_set_vectors_pos_charge_atype(VG_UNIT *unit, int nj, double pos[][3], double charge[], int atype[]);
void vg_set_vectors_pos_charge(VG_UNIT *unit, int nj, double pos[][3], double charge[]);
void vg_set_vectors_pos_atype(VG_UNIT *unit, int nj, double pos[][3], int atype[]);
void vg_set_matrices_gscales_rscales(VG_UNIT *unit, int nati_org, int natj_org, double gscales[], double rscales[]);
void vg_set_pol_sigm_ipotro_pc_pd_zz(VG_UNIT *unit, int nati, int natj, double pol[], double sigm[], double ipotro[], double pc[], double pd[], double zz[]);
void vg_set_scalers_volume_alpha(VG_UNIT *unit, double volume[3], double alpha);
void vg_set_pipeline_vectors_pos_charge_atype(VG_UNIT *unit, int ni, double pos[][3], double charge[], int atype[]);
void vg_set_pipeline_vectors_pos_charge(VG_UNIT *unit, int ni, double pos[][3], double charge[]);
void vg_set_pipeline_vectors_pos_atype(VG_UNIT *unit, int ni, double pos[][3], int atype[]);
void vg_convert_forces(VG_UNIT *unit, int nf, int function_index, double fi[][3]);
void vg_calculate_forces_potentials(VG_UNIT *unit, int function_index, int nf, double fi[][3], double *potc, double *potv);
void vg_get_r1result(int n_org, float r[], float r1[]);
void vg_get_rsqrtresult(int n_org, float r[], float r1[]);
void vg_get_mulresult(int n_org, float r[], float q[], float rq[]);
int vg_write_emufile(int flag);
void vg_initialize_emu(void);
float vg_r1emu(float x);
float vg_rsqrtemu(float x);
void vg_set_scaleq(int n, double q[], double *scaleq, float *scaleq_1);
void m3_set_softening(VG_UNIT *unit, double eps);
void MR3_exit(int ret);
void MR3init(void);
void mr3init_(void);
void mr3init__(void);
void MR3free(void);
void mr3free_(void);
void mr3free__(void);
void MR3calccoulomb(double x[], int n, double q[], double rscale, int tblno, double xmax, int periodicflag, int natchangeflag, double force[]);
void mr3calccoulomb_(double x[], int *n, double q[], double *rscale, int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void mr3calccoulomb__(double x[], int *n, double q[], double *rscale, int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void MR3calccoulomb_ij(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag);
void mr3calccoulomb_ij_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void mr3calccoulomb_ij__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void MR3_sort_with_index_int(int data[], int index[], int left, int right);
void MR3calcvdw_ij_core(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void MR3calcvdw_ij(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void mr3calcvdw_ij_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void mr3calcvdw_ij__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void MR3calcvdw(double x[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int natchangeflag, double force[]);
void mr3calcvdw_(double x[], int *n, int atype[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void mr3calcvdw__(double x[], int *n, int atype[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void MR3calcewald(int *k, int knum_org, double *x, int n, double *chg, double alpha, double epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald__(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void MR3calcnacl(double x[], int n, int atype[], int nat, double pol[], double sigm[], double ipotro[], double pc[], double pd[], double zz[], int tblno, double xmax, int periodicflag, double force[]);
void vtgrape_force(double xj[][3], double mj[], double xi[][3], double eps2, double a[][3], int ni, int nj);
void vg_set_rcut2(VG_UNIT *unit, double rcut2);
void mr3_set_rcut2_(double *rcut2);
int md5sum(unsigned char *buffer, int totallen, unsigned char sum[16]);
int md5sum_file(char *filename, unsigned char sum[16]);
void MR3calccoulomb_ij_host(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag);
void mr3calccoulomb_ij_host_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void mr3calccoulomb_ij_host__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void MR3calcvdw_ij_host(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void mr3calcvdw_ij_host_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void mr3calcvdw_ij_host__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void MR3calccoulomb_nlist_ij_host_notwork(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[], double factorall);
void MR3calccoulomb_nlist_ij_host(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calccoulomb_nlist_host(double xd[], int n, double qd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calcvdw_nlist_ij_host_notwork(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[], double factor);
void MR3calcvdw_nlist_ij_host(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_host2(double x[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[], double factor, double force[]);
void MR3calccoulomb_ij_exlist_host(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void MR3calcvdw_ij_exlist_host(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void MR3calcewald_dft_host(int k[], int knum, double x[], int n, double chg[], double cellsize[3], double bs[], double bc[]);
void MR3calcewald_idft_eng_host(int k[], double bs[], double bc[], int knum, double x[], int n, double cellsize[3], double force[]);
void MR3calcewald_idft_force_host(int k[], double bs[], double bc[], int knum, double x[], int n, double cellsize[3], double force[]);
void MR3calcewald_host(int *k, int knum_org, double *x, int n, double *chg, double alpha, double epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_host__(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_host_(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void MR3SetTable(char *filename, int tblno, int flag);
void mr3settable_nf_(char *fname, int *tblno, int *flag, int *n);
void mr3settable_nf__(char *fname, int *tblno, int *flag, int *n);
void MR3_setup_exlist(int n, int *bckptr);
void mr3_setup_exlist_(int *n, int *bckptr);
void MR3_make_natex2_from_natex(int n, int natex[], int numex[], int **natex_offset, int **natex2, int **numex2, int **natex2_offset, int flag);
void calccoulomb_vdw_ij_exlist_host_sub(int i, int j, double xi[], double xj[], double qj, double gsf, double gsp, double rs, double rscale, double cutoff, double *fc, double *fv, double *pc, double *pv, int tblno, double size[3], int potflag);
void MR3calccoulomb_vdw_ij_exlist_cutoff_host(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double cutoff, double size[3], double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_host(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_host2(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_host_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_host__(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void MR3_get_cputime(double *laptime, double *sprittime);
void MR3_set_ldim(int ldim[3]);
void mr3_set_ldim_(int ldim[3]);
void mr3_set_ldim__(int ldim[3]);
void MR3_set_coulomb_vdw_factor(double cgf);
void mr3_set_coulomb_vdw_factor_(double *cgf);
void mr3_set_coulomb_vdw_factor__(double *cgf);
void MR3calccoulomb_ij_emu(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag);
void MR3calccoulomb_nlist_ij_emu(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calccoulomb_nlist_emu(double xd[], int n, double qd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calcvdw_ij_emu(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void MR3calccoulomb_vdw_nlist_ij_emu(int ni, double xid[], double qid[], int atypei[], double force[], int nj, double xjd[], double qjd[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblno, double volume[], int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_ij_emu(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_emu2(double xd[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calccoulomb_ij_exlist(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void mr3calccoulomb_ij_exlist_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag, int numexorg[], int natexorg[]);
void mr3calccoulomb_ij_exlist__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag, int numexorg[], int natexorg[]);
void MR3calcvdw_ij_exlist(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void mr3calcvdw_ij_exlist_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int numex[], int natex[]);
void mr3calcvdw_ij_exlist__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_core_old(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_core(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_virial_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_exlist(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double volume1, double *potc, double *potv, int *convert_index, int potflag, int flag);
void MR3calccoulomb_vdw_exlist_from_cell(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double volume1, double *potc, double *potv, int *convert_index, int potflag, int flag);
void mr3calccoulomb_vdw_exlist_(int *n, double x[], double q[], int atype[], int *nat, double force[], double *rscale, double gscalesf[], double gscalesp[], double rscales[], int *tblno, int numex[], int natex[], double *volume1, double *potc, double *potv, int *convert_index, int *potflag, int *flag);
void MR3_get_forces_overlap(double force[]);
void mr3_get_forces_overlap_(double force[]);
void MR3_get_potc_and_potv_overlap(double *potc, double *potv);
void mr3_get_potc_and_potv_overlap_(double *potc, double *potv);
void mr3_get_potc_and_potv_overlap__(double *potc, double *potv);
void MR3_get_forces_and_virial_overlap(double force[], double virial[3][3]);
void mr3_get_forces_and_virial_overlap_(double force[], double virial[3][3]);
void MR3calccoulomb_ci_exlist(int n, double x[], double q[], double force[], double rscale, int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], int *convert_index, int flag);
void mr3calccoulomb_ci_exlist_(int *n, double x[], double q[], double force[], double *rscale, int *tblno, int numex[], int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], int *convert_index, int *flag);
void MR3calcvdw_ci(int n, double x[], int atype[], int nat, double force[], double gscales[], double rscales[], int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calcvdw_ci_(int *n, double x[], int atype[], int *nat, double force[], double gscales[], double rscales[], int *tblno, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calcvdw_ci_exlist(int n, double x[], int atype[], int nat, double force[], double gscales[], double rscales[], int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], int *convert_index, int flag);
void mr3calcvdw_ci_exlist_(int *n, double x[], int atype[], int *nat, double force[], double gscales[], double rscales[], int *tblno, int numex[], int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], int *convert_index, int *flag);
void MR3calccoulomb_vdw_ci_exlist(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], double *potc, double *potv, int *convert_index, int potflag, int flag);
void mr3calccoulomb_vdw_ci_exlist_(int *n, double x[], double q[], int atype[], int *nat, double force[], double *rscale, double gscalesf[], double gscalesp[], double rscales[], int *tblno, int *numex, int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], double *potc, double *potv, int *convert_index, int *potflag, int *flag);
void MR3calccoulomb_ci(int n, double x[], double q[], double force[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calccoulomb_ci_(int *n, double x[], double q[], double force[], double *rscale, int *tblno, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_ij_ci(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_ij_ci_old(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calcvdw_ij_ci(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_virial(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut_org, double skinnb, double volume[3], int ldim[3], double virial[3][3], int flag);
void MR3calccoulomb_vdw_ij_ci(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calccoulomb_vdw_ij_ci_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscales[], double rscales[], double *rscale, int *tblnoc, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_old_09(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_old_090121(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_exlist(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3], int numex[], int natex[], int flag);
void mr3calccoulomb_vdw_ij_ci_exlist_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscales[], double rscales[], double *rscale, int *tblnoc, double *rcut, double *skinnb, double volume[3], int ldim[3], int numex[], int natex[], int *flag);
void MR3_get_board_version(int *version, int *freq);
void MR3_rscale_and_pack(int n, double (*x)[3], int *atype, longlong (*rj)[2]);
void MR3_rscale_and_pack_old(int n, double (*x)[3], int *atype, longlong (*rj)[2]);
void MR3SetTable_emu(char *filename, int tblno, int flag);
int MR3_get_total_num_chips(void);
void MR3print_chip_temperature(int flag);
int MR3_get_retry_count(void);
void m3_free_unit(VG_UNIT *unit);
VG_UNIT *m3_allocate_periodic_unit(const char *fname, int mode, double size, int dum);
void m3_set_positions(VG_UNIT *unit, double (*pos)[3], int n);
void m3_set_charges(VG_UNIT *unit, const double *q, int n);
void m3_set_cells(VG_UNIT *unit, M3_CELL *cell, int ncell);
void m3_calculate_forces(VG_UNIT *unit, double (*xi)[3], int ni, double (*force)[3]);
void m3_calculate_potentials(VG_UNIT *unit, double (*xi)[3], int ni, double *eng);
void m3_set_types(VG_UNIT *unit, const int *atype, int n);
void m3_set_pipeline_types(VG_UNIT *unit, const int *atype, int n);
void m3_set_charge_matrix(VG_UNIT *unit, const double *gscale, int nati, int natj);
void m3_set_rscale_matrix(VG_UNIT *unit, const double *rscale, int nati, int natj);
int MR3_close_ch(int s_sock);
int mr3_close_ch_(int *s_sock);
int MR3_open_port(int port_number);
int MR3_sock_read(int sockfd, char *buf, size_t count);
int mr3_sock_read_(int *sockfd, char *buf, int *count);
int mr3_sock_read__(int *sockfd, char *buf, int *count);
int mr3_sock_read_i_(int *sockfd, int *buf);
int mr3_sock_read_i__(int *sockfd, int *buf);
int MR3_sock_read_iv(int sockfd, int *buf, int count);
int mr3_sock_read_iv_(int *sockfd, int *buf, int *count);
int mr3_sock_read_iv__(int *sockfd, int *buf, int *count);
int MR3_sock_read_d(int sockfd, double *buf);
int mr3_sock_read_d__(int *sockfd, double *buf);
int mr3_sock_read_d_(int *sockfd, double *buf);
int MR3_sock_read_dv(int sockfd, double *buf, int count);
int mr3_sock_read_dv__(int *sockfd, double *buf, int *count);
int mr3_sock_read_dv_(int *sockfd, double *buf, int *count);
int MR3_sock_write(int sockfd, char *buf, size_t count);
int MR3_sock_write_c(int sockfd, char *buf);
int mr3_sock_write_c_(int *sockfd, char *buf);
int mr3_sock_write_c__(int *sockfd, char *buf);
int MR3_sock_write_i(int sockfd, int buf);
int mr3_sock_write_i_(int *sockfd, int *buf);
int mr3_sock_write_i__(int *sockfd, int *buf);
int MR3_sock_write_iv(int sockfd, int *buf, int count);
int mr3_sock_write_iv_(int *sockfd, int *buf, int *count);
int mr3_sock_write_iv__(int *sockfd, int *buf, int *count);
int MR3_sock_write_dv(int sockfd, double *buf, int count);
int mr3_sock_write_dv__(int *sockfd, double *buf, int *count);
int mr3_sock_write_dv_(int *sockfd, double *buf, int *count);
int MR3_sock_gets(int sockfd, char *str, size_t count);
int MR3_sock_puts(int sockfd, char *str);
void MR3_sock_init(int *s_sock_org, int port_num, double x[], int igraph[], int natom, int str_len, int lbres[], int ipres[], int nres);
void mr3_sock_init_(int *s_sock, int *port_num, double x[], int igraph[], int *natom, int *str_len, int lbres[], int ipres[], int *nres);
void mr3_sock_init__(int *s_sock, int *port_num, double x[], int igraph[], int *natom, int *str_len, int lbres[], int ipres[], int *nres);
void MR3_sock_1step(int s_sock, double t1, double time, double t2, int recv_buf[], int natom, double x[], double f[], double f_temp[]);
void mr3_sock_1step_(int *s_sock, double *t1, double *time, double *t2, int recv_buf[], int *natom, double x[], double f[], double f_tmp[]);
void mr3_sock_1step__(int *s_sock, double *t1, double *time, double *t2, int recv_buf[], int *natom, double x[], double f[], double f_tmp[]);
void MR3calc_ij_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, char method);
void MR3calc_ij_exlist_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], char method);
void MR3calc_ij_nlist_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], char method);
/* vtgrape.c */
void *MR3_my_malloc2(size_t n, char *s);
void MR3_my_free2(void **p, char *s);
VG_UNIT *m3_get_unit(void);
void vg_exit(int ret);
VG_UNIT *vg_allocate_unit(void (*function)(void *));
void vg_free_unit(VG_UNIT *unit);
void vg_set_function(VG_UNIT *unit, int function_index, void (*function)(void *));
void vg_set_vectors(VG_UNIT *unit, int nj, void *jvectors);
void vg_set_matrices(VG_UNIT *unit, int nati, int natj, void *matrices);
void vg_set_scalers(VG_UNIT *unit, void *scalers);
void vg_set_pipeline_vectors(VG_UNIT *unit, int ni, void *ivectors);
void vg_calculate(VG_UNIT *unit, int function_index, int nf, void *fvectors, void *pscalers);
void vg_set_vectors_pos_charge_atype(VG_UNIT *unit, int nj, double pos[][3], double charge[], int atype[]);
void vg_set_vectors_pos_charge(VG_UNIT *unit, int nj, double pos[][3], double charge[]);
void vg_set_vectors_pos_atype(VG_UNIT *unit, int nj, double pos[][3], int atype[]);
void vg_set_matrices_gscales_rscales(VG_UNIT *unit, int nati_org, int natj_org, double gscales[], double rscales[]);
void vg_set_pol_sigm_ipotro_pc_pd_zz(VG_UNIT *unit, int nati, int natj, double pol[], double sigm[], double ipotro[], double pc[], double pd[], double zz[]);
void vg_set_scalers_volume_alpha(VG_UNIT *unit, double volume[3], double alpha);
void vg_set_pipeline_vectors_pos_charge_atype(VG_UNIT *unit, int ni, double pos[][3], double charge[], int atype[]);
void vg_set_pipeline_vectors_pos_charge(VG_UNIT *unit, int ni, double pos[][3], double charge[]);
void vg_set_pipeline_vectors_pos_atype(VG_UNIT *unit, int ni, double pos[][3], int atype[]);
void vg_convert_forces(VG_UNIT *unit, int nf, int function_index, double fi[][3]);
void vg_calculate_forces_potentials(VG_UNIT *unit, int function_index, int nf, double fi[][3], double *potc, double *potv);
void vg_get_r1result(int n_org, float r[], float r1[]);
void vg_get_rsqrtresult(int n_org, float r[], float r1[]);
void vg_get_mulresult(int n_org, float r[], float q[], float rq[]);
int vg_write_emufile(int flag);
void vg_initialize_emu(void);
float vg_r1emu(float x);
float vg_rsqrtemu(float x);
void vg_set_scaleq(int n, double q[], double *scaleq, float *scaleq_1);
void m3_set_softening(VG_UNIT *unit, double eps);
void MR3_exit(int ret);
void MR3init(void);
void mr3init_(void);
void mr3init__(void);
void MR3free(void);
void mr3free_(void);
void mr3free__(void);
void MR3calccoulomb(double x[], int n, double q[], double rscale, int tblno, double xmax, int periodicflag, int natchangeflag, double force[]);
void mr3calccoulomb_(double x[], int *n, double q[], double *rscale, int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void mr3calccoulomb__(double x[], int *n, double q[], double *rscale, int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void MR3calccoulomb_ij(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag);
void mr3calccoulomb_ij_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void mr3calccoulomb_ij__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void MR3_sort_with_index_int(int data[], int index[], int left, int right);
void MR3calcvdw_ij_core(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void MR3calcvdw_ij(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void mr3calcvdw_ij_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void mr3calcvdw_ij__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void MR3calcvdw(double x[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int natchangeflag, double force[]);
void mr3calcvdw_(double x[], int *n, int atype[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void mr3calcvdw__(double x[], int *n, int atype[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void MR3calcewald(int *k, int knum_org, double *x, int n, double *chg, double alpha, double epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald__(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void MR3calcnacl(double x[], int n, int atype[], int nat, double pol[], double sigm[], double ipotro[], double pc[], double pd[], double zz[], int tblno, double xmax, int periodicflag, double force[]);
void vtgrape_force(double xj[][3], double mj[], double xi[][3], double eps2, double a[][3], int ni, int nj);
void vg_set_rcut2(VG_UNIT *unit, double rcut2);
void mr3_set_rcut2_(double *rcut2);
int md5sum(unsigned char *buffer, int totallen, unsigned char sum[16]);
int md5sum_file(char *filename, unsigned char sum[16]);
void MR3calccoulomb_ij_host(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag);
void mr3calccoulomb_ij_host_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void mr3calccoulomb_ij_host__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void MR3calcvdw_ij_host(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void mr3calcvdw_ij_host_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void mr3calcvdw_ij_host__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void MR3calccoulomb_nlist_ij_host_notwork(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[], double factorall);
void MR3calccoulomb_nlist_ij_host(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calccoulomb_nlist_host(double xd[], int n, double qd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calcvdw_nlist_ij_host_notwork(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[], double factor);
void MR3calcvdw_nlist_ij_host(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_host2(double x[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[], double factor, double force[]);
void MR3calccoulomb_ij_exlist_host(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void MR3calcvdw_ij_exlist_host(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void MR3calcewald_dft_host(int k[], int knum, double x[], int n, double chg[], double cellsize[3], double bs[], double bc[]);
void MR3calcewald_idft_eng_host(int k[], double bs[], double bc[], int knum, double x[], int n, double cellsize[3], double force[]);
void MR3calcewald_idft_force_host(int k[], double bs[], double bc[], int knum, double x[], int n, double cellsize[3], double force[]);
void MR3calcewald_host(int *k, int knum_org, double *x, int n, double *chg, double alpha, double epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_host__(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_host_(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void MR3SetTable(char *filename, int tblno, int flag);
void mr3settable_nf_(char *fname, int *tblno, int *flag, int *n);
void mr3settable_nf__(char *fname, int *tblno, int *flag, int *n);
void MR3_setup_exlist(int n, int *bckptr);
void mr3_setup_exlist_(int *n, int *bckptr);
void MR3_make_natex2_from_natex(int n, int natex[], int numex[], int **natex_offset, int **natex2, int **numex2, int **natex2_offset, int flag);
void calccoulomb_vdw_ij_exlist_host_sub(int i, int j, double xi[], double xj[], double qj, double gsf, double gsp, double rs, double rscale, double cutoff, double *fc, double *fv, double *pc, double *pv, int tblno, double size[3], int potflag);
void MR3calccoulomb_vdw_ij_exlist_cutoff_host(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double cutoff, double size[3], double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_host(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_host2(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_host_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_host__(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void MR3_get_cputime(double *laptime, double *sprittime);
void MR3_set_ldim(int ldim[3]);
void mr3_set_ldim_(int ldim[3]);
void mr3_set_ldim__(int ldim[3]);
void MR3_set_coulomb_vdw_factor(double cgf);
void mr3_set_coulomb_vdw_factor_(double *cgf);
void mr3_set_coulomb_vdw_factor__(double *cgf);
void MR3calccoulomb_ij_emu(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag);
void MR3calccoulomb_nlist_ij_emu(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calccoulomb_nlist_emu(double xd[], int n, double qd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calcvdw_ij_emu(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void MR3calccoulomb_vdw_nlist_ij_emu(int ni, double xid[], double qid[], int atypei[], double force[], int nj, double xjd[], double qjd[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblno, double volume[], int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_ij_emu(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_emu2(double xd[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calccoulomb_ij_exlist(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void mr3calccoulomb_ij_exlist_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag, int numexorg[], int natexorg[]);
void mr3calccoulomb_ij_exlist__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag, int numexorg[], int natexorg[]);
void MR3calcvdw_ij_exlist(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void mr3calcvdw_ij_exlist_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int numex[], int natex[]);
void mr3calcvdw_ij_exlist__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_core_old(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_core(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_virial_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_exlist(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double volume1, double *potc, double *potv, int *convert_index, int potflag, int flag);
void MR3calccoulomb_vdw_exlist_from_cell(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double volume1, double *potc, double *potv, int *convert_index, int potflag, int flag);
void mr3calccoulomb_vdw_exlist_(int *n, double x[], double q[], int atype[], int *nat, double force[], double *rscale, double gscalesf[], double gscalesp[], double rscales[], int *tblno, int numex[], int natex[], double *volume1, double *potc, double *potv, int *convert_index, int *potflag, int *flag);
void MR3_get_forces_overlap(double force[]);
void mr3_get_forces_overlap_(double force[]);
void MR3_get_potc_and_potv_overlap(double *potc, double *potv);
void mr3_get_potc_and_potv_overlap_(double *potc, double *potv);
void mr3_get_potc_and_potv_overlap__(double *potc, double *potv);
void MR3_get_forces_and_virial_overlap(double force[], double virial[3][3]);
void mr3_get_forces_and_virial_overlap_(double force[], double virial[3][3]);
void MR3calccoulomb_ci_exlist(int n, double x[], double q[], double force[], double rscale, int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], int *convert_index, int flag);
void mr3calccoulomb_ci_exlist_(int *n, double x[], double q[], double force[], double *rscale, int *tblno, int numex[], int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], int *convert_index, int *flag);
void MR3calcvdw_ci(int n, double x[], int atype[], int nat, double force[], double gscales[], double rscales[], int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calcvdw_ci_(int *n, double x[], int atype[], int *nat, double force[], double gscales[], double rscales[], int *tblno, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calcvdw_ci_exlist(int n, double x[], int atype[], int nat, double force[], double gscales[], double rscales[], int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], int *convert_index, int flag);
void mr3calcvdw_ci_exlist_(int *n, double x[], int atype[], int *nat, double force[], double gscales[], double rscales[], int *tblno, int numex[], int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], int *convert_index, int *flag);
void MR3calccoulomb_vdw_ci_exlist(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], double *potc, double *potv, int *convert_index, int potflag, int flag);
void mr3calccoulomb_vdw_ci_exlist_(int *n, double x[], double q[], int atype[], int *nat, double force[], double *rscale, double gscalesf[], double gscalesp[], double rscales[], int *tblno, int *numex, int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], double *potc, double *potv, int *convert_index, int *potflag, int *flag);
void MR3calccoulomb_ci(int n, double x[], double q[], double force[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calccoulomb_ci_(int *n, double x[], double q[], double force[], double *rscale, int *tblno, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_ij_ci(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_ij_ci_old(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calcvdw_ij_ci(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_virial(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut_org, double skinnb, double volume[3], int ldim[3], double virial[3][3], int flag);
void MR3calccoulomb_vdw_ij_ci(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calccoulomb_vdw_ij_ci_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscales[], double rscales[], double *rscale, int *tblnoc, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_old_09(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_old_090121(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_exlist(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3], int numex[], int natex[], int flag);
void mr3calccoulomb_vdw_ij_ci_exlist_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscales[], double rscales[], double *rscale, int *tblnoc, double *rcut, double *skinnb, double volume[3], int ldim[3], int numex[], int natex[], int *flag);
void MR3_get_board_version(int *version, int *freq);
void MR3_rscale_and_pack(int n, double (*x)[3], int *atype, longlong (*rj)[2]);
void MR3_rscale_and_pack_old(int n, double (*x)[3], int *atype, longlong (*rj)[2]);
void MR3SetTable_emu(char *filename, int tblno, int flag);
int MR3_get_total_num_chips(void);
void MR3print_chip_temperature(int flag);
int MR3_get_retry_count(void);
void m3_free_unit(VG_UNIT *unit);
VG_UNIT *m3_allocate_periodic_unit(const char *fname, int mode, double size, int dum);
void m3_set_positions(VG_UNIT *unit, double (*pos)[3], int n);
void m3_set_charges(VG_UNIT *unit, const double *q, int n);
void m3_set_cells(VG_UNIT *unit, M3_CELL *cell, int ncell);
void m3_calculate_forces(VG_UNIT *unit, double (*xi)[3], int ni, double (*force)[3]);
void m3_calculate_potentials(VG_UNIT *unit, double (*xi)[3], int ni, double *eng);
void m3_set_types(VG_UNIT *unit, const int *atype, int n);
void m3_set_pipeline_types(VG_UNIT *unit, const int *atype, int n);
void m3_set_charge_matrix(VG_UNIT *unit, const double *gscale, int nati, int natj);
void m3_set_rscale_matrix(VG_UNIT *unit, const double *rscale, int nati, int natj);
int MR3_close_ch(int s_sock);
int mr3_close_ch_(int *s_sock);
int MR3_open_port(int port_number);
int MR3_sock_read(int sockfd, char *buf, size_t count);
int mr3_sock_read_(int *sockfd, char *buf, int *count);
int mr3_sock_read__(int *sockfd, char *buf, int *count);
int mr3_sock_read_i_(int *sockfd, int *buf);
int mr3_sock_read_i__(int *sockfd, int *buf);
int MR3_sock_read_iv(int sockfd, int *buf, int count);
int mr3_sock_read_iv_(int *sockfd, int *buf, int *count);
int mr3_sock_read_iv__(int *sockfd, int *buf, int *count);
int MR3_sock_read_d(int sockfd, double *buf);
int mr3_sock_read_d__(int *sockfd, double *buf);
int mr3_sock_read_d_(int *sockfd, double *buf);
int MR3_sock_read_dv(int sockfd, double *buf, int count);
int mr3_sock_read_dv__(int *sockfd, double *buf, int *count);
int mr3_sock_read_dv_(int *sockfd, double *buf, int *count);
int MR3_sock_write(int sockfd, char *buf, size_t count);
int MR3_sock_write_c(int sockfd, char *buf);
int mr3_sock_write_c_(int *sockfd, char *buf);
int mr3_sock_write_c__(int *sockfd, char *buf);
int MR3_sock_write_i(int sockfd, int buf);
int mr3_sock_write_i_(int *sockfd, int *buf);
int mr3_sock_write_i__(int *sockfd, int *buf);
int MR3_sock_write_iv(int sockfd, int *buf, int count);
int mr3_sock_write_iv_(int *sockfd, int *buf, int *count);
int mr3_sock_write_iv__(int *sockfd, int *buf, int *count);
int MR3_sock_write_dv(int sockfd, double *buf, int count);
int mr3_sock_write_dv__(int *sockfd, double *buf, int *count);
int mr3_sock_write_dv_(int *sockfd, double *buf, int *count);
int MR3_sock_gets(int sockfd, char *str, size_t count);
int MR3_sock_puts(int sockfd, char *str);
void MR3_sock_init(int *s_sock_org, int port_num, double x[], int igraph[], int natom, int str_len, int lbres[], int ipres[], int nres);
void mr3_sock_init_(int *s_sock, int *port_num, double x[], int igraph[], int *natom, int *str_len, int lbres[], int ipres[], int *nres);
void mr3_sock_init__(int *s_sock, int *port_num, double x[], int igraph[], int *natom, int *str_len, int lbres[], int ipres[], int *nres);
void MR3_sock_1step(int s_sock, double t1, double time, double t2, int recv_buf[], int natom, double x[], double f[], double f_temp[]);
void mr3_sock_1step_(int *s_sock, double *t1, double *time, double *t2, int recv_buf[], int *natom, double x[], double f[], double f_tmp[]);
void mr3_sock_1step__(int *s_sock, double *t1, double *time, double *t2, int recv_buf[], int *natom, double x[], double f[], double f_tmp[]);
void MR3calc_ij_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, char method);
void MR3calc_ij_exlist_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], char method);
void MR3calc_ij_nlist_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], char method);
/* vtgrape.c */
void *MR3_my_malloc2(size_t n, char *s);
void MR3_my_free2(void **p, char *s);
VG_UNIT *m3_get_unit(void);
void vg_exit(int ret);
VG_UNIT *vg_allocate_unit(void (*function)(void *));
void vg_free_unit(VG_UNIT *unit);
void vg_set_function(VG_UNIT *unit, int function_index, void (*function)(void *));
void vg_set_vectors(VG_UNIT *unit, int nj, void *jvectors);
void vg_set_matrices(VG_UNIT *unit, int nati, int natj, void *matrices);
void vg_set_scalers(VG_UNIT *unit, void *scalers);
void vg_set_pipeline_vectors(VG_UNIT *unit, int ni, void *ivectors);
void vg_calculate(VG_UNIT *unit, int function_index, int nf, void *fvectors, void *pscalers);
void vg_set_vectors_pos_charge_atype(VG_UNIT *unit, int nj, double pos[][3], double charge[], int atype[]);
void vg_set_vectors_pos_charge(VG_UNIT *unit, int nj, double pos[][3], double charge[]);
void vg_set_vectors_pos_atype(VG_UNIT *unit, int nj, double pos[][3], int atype[]);
void vg_set_matrices_gscales_rscales(VG_UNIT *unit, int nati_org, int natj_org, double gscales[], double rscales[]);
void vg_set_pol_sigm_ipotro_pc_pd_zz(VG_UNIT *unit, int nati, int natj, double pol[], double sigm[], double ipotro[], double pc[], double pd[], double zz[]);
void vg_set_scalers_volume_alpha(VG_UNIT *unit, double volume[3], double alpha);
void vg_set_pipeline_vectors_pos_charge_atype(VG_UNIT *unit, int ni, double pos[][3], double charge[], int atype[]);
void vg_set_pipeline_vectors_pos_charge(VG_UNIT *unit, int ni, double pos[][3], double charge[]);
void vg_set_pipeline_vectors_pos_atype(VG_UNIT *unit, int ni, double pos[][3], int atype[]);
void vg_convert_forces(VG_UNIT *unit, int nf, int function_index, double fi[][3]);
void vg_calculate_forces_potentials(VG_UNIT *unit, int function_index, int nf, double fi[][3], double *potc, double *potv);
void vg_get_r1result(int n_org, float r[], float r1[]);
void vg_get_rsqrtresult(int n_org, float r[], float r1[]);
void vg_get_mulresult(int n_org, float r[], float q[], float rq[]);
int vg_write_emufile(int flag);
void vg_initialize_emu(void);
float vg_r1emu(float x);
float vg_rsqrtemu(float x);
void vg_set_scaleq(int n, double q[], double *scaleq, float *scaleq_1);
void m3_set_softening(VG_UNIT *unit, double eps);
void MR3_exit(int ret);
void MR3init(void);
void mr3init_(void);
void mr3init__(void);
void MR3free(void);
void mr3free_(void);
void mr3free__(void);
void MR3calccoulomb(double x[], int n, double q[], double rscale, int tblno, double xmax, int periodicflag, int natchangeflag, double force[]);
void mr3calccoulomb_(double x[], int *n, double q[], double *rscale, int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void mr3calccoulomb__(double x[], int *n, double q[], double *rscale, int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void MR3calccoulomb_ij(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag);
void mr3calccoulomb_ij_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void mr3calccoulomb_ij__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void MR3_sort_with_index_int(int data[], int index[], int left, int right);
void MR3calcvdw_ij_core(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void MR3calcvdw_ij(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void mr3calcvdw_ij_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void mr3calcvdw_ij__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void MR3calcvdw(double x[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int natchangeflag, double force[]);
void mr3calcvdw_(double x[], int *n, int atype[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void mr3calcvdw__(double x[], int *n, int atype[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void MR3calcewald(int *k, int knum_org, double *x, int n, double *chg, double alpha, double epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald__(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void MR3calcnacl(double x[], int n, int atype[], int nat, double pol[], double sigm[], double ipotro[], double pc[], double pd[], double zz[], int tblno, double xmax, int periodicflag, double force[]);
void vtgrape_force(double xj[][3], double mj[], double xi[][3], double eps2, double a[][3], int ni, int nj);
void vg_set_rcut2(VG_UNIT *unit, double rcut2);
void mr3_set_rcut2_(double *rcut2);
int md5sum(unsigned char *buffer, int totallen, unsigned char sum[16]);
int md5sum_file(char *filename, unsigned char sum[16]);
void MR3calccoulomb_ij_host(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag);
void mr3calccoulomb_ij_host_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void mr3calccoulomb_ij_host__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void MR3calcvdw_ij_host(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void mr3calcvdw_ij_host_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void mr3calcvdw_ij_host__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void MR3calccoulomb_nlist_ij_host_notwork(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[], double factorall);
void MR3calccoulomb_nlist_ij_host(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calccoulomb_nlist_host(double xd[], int n, double qd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calcvdw_nlist_ij_host_notwork(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[], double factor);
void MR3calcvdw_nlist_ij_host(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_host2(double x[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[], double factor, double force[]);
void MR3calccoulomb_ij_exlist_host(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void MR3calcvdw_ij_exlist_host(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void MR3calcewald_dft_host(int k[], int knum, double x[], int n, double chg[], double cellsize[3], double bs[], double bc[]);
void MR3calcewald_idft_eng_host(int k[], double bs[], double bc[], int knum, double x[], int n, double cellsize[3], double force[]);
void MR3calcewald_idft_force_host(int k[], double bs[], double bc[], int knum, double x[], int n, double cellsize[3], double force[]);
void MR3calcewald_host(int *k, int knum_org, double *x, int n, double *chg, double alpha, double epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_host__(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_host_(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void MR3SetTable(char *filename, int tblno, int flag);
void mr3settable_nf_(char *fname, int *tblno, int *flag, int *n);
void mr3settable_nf__(char *fname, int *tblno, int *flag, int *n);
void MR3_setup_exlist(int n, int *bckptr);
void mr3_setup_exlist_(int *n, int *bckptr);
void MR3_make_natex2_from_natex(int n, int natex[], int numex[], int **natex_offset, int **natex2, int **numex2, int **natex2_offset, int flag);
void calccoulomb_vdw_ij_exlist_host_sub(int i, int j, double xi[], double xj[], double qj, double gsf, double gsp, double rs, double rscale, double cutoff, double *fc, double *fv, double *pc, double *pv, int tblno, double size[3], int potflag);
void MR3calccoulomb_vdw_ij_exlist_cutoff_host(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double cutoff, double size[3], double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_host(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_host2(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_host_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_host__(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void MR3_get_cputime(double *laptime, double *sprittime);
void MR3_set_ldim(int ldim[3]);
void mr3_set_ldim_(int ldim[3]);
void mr3_set_ldim__(int ldim[3]);
void MR3_set_coulomb_vdw_factor(double cgf);
void mr3_set_coulomb_vdw_factor_(double *cgf);
void mr3_set_coulomb_vdw_factor__(double *cgf);
void MR3calccoulomb_ij_emu(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag);
void MR3calccoulomb_nlist_ij_emu(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calccoulomb_nlist_emu(double xd[], int n, double qd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calcvdw_ij_emu(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void MR3calccoulomb_vdw_nlist_ij_emu(int ni, double xid[], double qid[], int atypei[], double force[], int nj, double xjd[], double qjd[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblno, double volume[], int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_ij_emu(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_emu2(double xd[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calccoulomb_ij_exlist(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void mr3calccoulomb_ij_exlist_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag, int numexorg[], int natexorg[]);
void mr3calccoulomb_ij_exlist__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag, int numexorg[], int natexorg[]);
void MR3calcvdw_ij_exlist(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void mr3calcvdw_ij_exlist_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int numex[], int natex[]);
void mr3calcvdw_ij_exlist__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_core_old(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_core(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_virial_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_exlist(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double volume1, double *potc, double *potv, int *convert_index, int potflag, int flag);
void MR3calccoulomb_vdw_exlist_from_cell(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double volume1, double *potc, double *potv, int *convert_index, int potflag, int flag);
void mr3calccoulomb_vdw_exlist_(int *n, double x[], double q[], int atype[], int *nat, double force[], double *rscale, double gscalesf[], double gscalesp[], double rscales[], int *tblno, int numex[], int natex[], double *volume1, double *potc, double *potv, int *convert_index, int *potflag, int *flag);
void MR3_get_forces_overlap(double force[]);
void mr3_get_forces_overlap_(double force[]);
void MR3_get_potc_and_potv_overlap(double *potc, double *potv);
void mr3_get_potc_and_potv_overlap_(double *potc, double *potv);
void mr3_get_potc_and_potv_overlap__(double *potc, double *potv);
void MR3_get_forces_and_virial_overlap(double force[], double virial[3][3]);
void mr3_get_forces_and_virial_overlap_(double force[], double virial[3][3]);
void MR3calccoulomb_ci_exlist(int n, double x[], double q[], double force[], double rscale, int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], int *convert_index, int flag);
void mr3calccoulomb_ci_exlist_(int *n, double x[], double q[], double force[], double *rscale, int *tblno, int numex[], int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], int *convert_index, int *flag);
void MR3calcvdw_ci(int n, double x[], int atype[], int nat, double force[], double gscales[], double rscales[], int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calcvdw_ci_(int *n, double x[], int atype[], int *nat, double force[], double gscales[], double rscales[], int *tblno, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calcvdw_ci_exlist(int n, double x[], int atype[], int nat, double force[], double gscales[], double rscales[], int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], int *convert_index, int flag);
void mr3calcvdw_ci_exlist_(int *n, double x[], int atype[], int *nat, double force[], double gscales[], double rscales[], int *tblno, int numex[], int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], int *convert_index, int *flag);
void MR3calccoulomb_vdw_ci_exlist(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], double *potc, double *potv, int *convert_index, int potflag, int flag);
void mr3calccoulomb_vdw_ci_exlist_(int *n, double x[], double q[], int atype[], int *nat, double force[], double *rscale, double gscalesf[], double gscalesp[], double rscales[], int *tblno, int *numex, int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], double *potc, double *potv, int *convert_index, int *potflag, int *flag);
void MR3calccoulomb_ci(int n, double x[], double q[], double force[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calccoulomb_ci_(int *n, double x[], double q[], double force[], double *rscale, int *tblno, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_ij_ci(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_ij_ci_old(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calcvdw_ij_ci(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_virial(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut_org, double skinnb, double volume[3], int ldim[3], double virial[3][3], int flag);
void MR3calccoulomb_vdw_ij_ci(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calccoulomb_vdw_ij_ci_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscales[], double rscales[], double *rscale, int *tblnoc, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_old_09(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_old_090121(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_exlist(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3], int numex[], int natex[], int flag);
void mr3calccoulomb_vdw_ij_ci_exlist_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscales[], double rscales[], double *rscale, int *tblnoc, double *rcut, double *skinnb, double volume[3], int ldim[3], int numex[], int natex[], int *flag);
void MR3_get_board_version(int *version, int *freq);
void MR3_rscale_and_pack(int n, double (*x)[3], int *atype, longlong (*rj)[2]);
void MR3_rscale_and_pack_old(int n, double (*x)[3], int *atype, longlong (*rj)[2]);
void MR3SetTable_emu(char *filename, int tblno, int flag);
int MR3_get_total_num_chips(void);
void MR3print_chip_temperature(int flag);
int MR3_get_retry_count(void);
void m3_free_unit(VG_UNIT *unit);
VG_UNIT *m3_allocate_periodic_unit(const char *fname, int mode, double size, int dum);
void m3_set_positions(VG_UNIT *unit, double (*pos)[3], int n);
void m3_set_charges(VG_UNIT *unit, const double *q, int n);
void m3_set_cells(VG_UNIT *unit, M3_CELL *cell, int ncell);
void m3_calculate_forces(VG_UNIT *unit, double (*xi)[3], int ni, double (*force)[3]);
void m3_calculate_potentials(VG_UNIT *unit, double (*xi)[3], int ni, double *eng);
void m3_set_types(VG_UNIT *unit, const int *atype, int n);
void m3_set_pipeline_types(VG_UNIT *unit, const int *atype, int n);
void m3_set_charge_matrix(VG_UNIT *unit, const double *gscale, int nati, int natj);
void m3_set_rscale_matrix(VG_UNIT *unit, const double *rscale, int nati, int natj);
int MR3_close_ch(int s_sock);
int mr3_close_ch_(int *s_sock);
int MR3_open_port(int port_number);
int MR3_sock_read(int sockfd, char *buf, size_t count);
int mr3_sock_read_(int *sockfd, char *buf, int *count);
int mr3_sock_read__(int *sockfd, char *buf, int *count);
int mr3_sock_read_i_(int *sockfd, int *buf);
int mr3_sock_read_i__(int *sockfd, int *buf);
int MR3_sock_read_iv(int sockfd, int *buf, int count);
int mr3_sock_read_iv_(int *sockfd, int *buf, int *count);
int mr3_sock_read_iv__(int *sockfd, int *buf, int *count);
int MR3_sock_read_d(int sockfd, double *buf);
int mr3_sock_read_d__(int *sockfd, double *buf);
int mr3_sock_read_d_(int *sockfd, double *buf);
int MR3_sock_read_dv(int sockfd, double *buf, int count);
int mr3_sock_read_dv__(int *sockfd, double *buf, int *count);
int mr3_sock_read_dv_(int *sockfd, double *buf, int *count);
int MR3_sock_write(int sockfd, char *buf, size_t count);
int MR3_sock_write_c(int sockfd, char *buf);
int mr3_sock_write_c_(int *sockfd, char *buf);
int mr3_sock_write_c__(int *sockfd, char *buf);
int MR3_sock_write_i(int sockfd, int buf);
int mr3_sock_write_i_(int *sockfd, int *buf);
int mr3_sock_write_i__(int *sockfd, int *buf);
int MR3_sock_write_iv(int sockfd, int *buf, int count);
int mr3_sock_write_iv_(int *sockfd, int *buf, int *count);
int mr3_sock_write_iv__(int *sockfd, int *buf, int *count);
int MR3_sock_write_dv(int sockfd, double *buf, int count);
int mr3_sock_write_dv__(int *sockfd, double *buf, int *count);
int mr3_sock_write_dv_(int *sockfd, double *buf, int *count);
int MR3_sock_gets(int sockfd, char *str, size_t count);
int MR3_sock_puts(int sockfd, char *str);
void MR3_sock_init(int *s_sock_org, int port_num, double x[], int igraph[], int natom, int str_len, int lbres[], int ipres[], int nres);
void mr3_sock_init_(int *s_sock, int *port_num, double x[], int igraph[], int *natom, int *str_len, int lbres[], int ipres[], int *nres);
void mr3_sock_init__(int *s_sock, int *port_num, double x[], int igraph[], int *natom, int *str_len, int lbres[], int ipres[], int *nres);
void MR3_sock_1step(int s_sock, double t1, double time, double t2, int recv_buf[], int natom, double x[], double f[], double f_temp[]);
void mr3_sock_1step_(int *s_sock, double *t1, double *time, double *t2, int recv_buf[], int *natom, double x[], double f[], double f_tmp[]);
void mr3_sock_1step__(int *s_sock, double *t1, double *time, double *t2, int recv_buf[], int *natom, double x[], double f[], double f_tmp[]);
void MR3calc_ij_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, char method);
void MR3calc_ij_exlist_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], char method);
void MR3calc_ij_nlist_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], char method);
/* vtgrape.c */
void *MR3_my_malloc2(size_t n, char *s);
void MR3_my_free2(void **p, char *s);
VG_UNIT *m3_get_unit(void);
void vg_exit(int ret);
VG_UNIT *vg_allocate_unit(void (*function)(void *));
void vg_free_unit(VG_UNIT *unit);
void vg_set_function(VG_UNIT *unit, int function_index, void (*function)(void *));
void vg_set_vectors(VG_UNIT *unit, int nj, void *jvectors);
void vg_set_matrices(VG_UNIT *unit, int nati, int natj, void *matrices);
void vg_set_scalers(VG_UNIT *unit, void *scalers);
void vg_set_pipeline_vectors(VG_UNIT *unit, int ni, void *ivectors);
void vg_calculate(VG_UNIT *unit, int function_index, int nf, void *fvectors, void *pscalers);
void vg_set_vectors_pos_charge_atype(VG_UNIT *unit, int nj, double pos[][3], double charge[], int atype[]);
void vg_set_vectors_pos_charge(VG_UNIT *unit, int nj, double pos[][3], double charge[]);
void vg_set_vectors_pos_atype(VG_UNIT *unit, int nj, double pos[][3], int atype[]);
void vg_set_matrices_gscales_rscales(VG_UNIT *unit, int nati_org, int natj_org, double gscales[], double rscales[]);
void vg_set_pol_sigm_ipotro_pc_pd_zz(VG_UNIT *unit, int nati, int natj, double pol[], double sigm[], double ipotro[], double pc[], double pd[], double zz[]);
void vg_set_scalers_volume_alpha(VG_UNIT *unit, double volume[3], double alpha);
void vg_set_pipeline_vectors_pos_charge_atype(VG_UNIT *unit, int ni, double pos[][3], double charge[], int atype[]);
void vg_set_pipeline_vectors_pos_charge(VG_UNIT *unit, int ni, double pos[][3], double charge[]);
void vg_set_pipeline_vectors_pos_atype(VG_UNIT *unit, int ni, double pos[][3], int atype[]);
void vg_convert_forces(VG_UNIT *unit, int nf, int function_index, double fi[][3]);
void vg_calculate_forces_potentials(VG_UNIT *unit, int function_index, int nf, double fi[][3], double *potc, double *potv);
void vg_get_r1result(int n_org, float r[], float r1[]);
void vg_get_rsqrtresult(int n_org, float r[], float r1[]);
void vg_get_mulresult(int n_org, float r[], float q[], float rq[]);
int vg_write_emufile(int flag);
void vg_initialize_emu(void);
float vg_r1emu(float x);
float vg_rsqrtemu(float x);
void vg_set_scaleq(int n, double q[], double *scaleq, float *scaleq_1);
void m3_set_softening(VG_UNIT *unit, double eps);
void MR3_exit(int ret);
void MR3init(void);
void mr3init_(void);
void mr3init__(void);
void MR3free(void);
void mr3free_(void);
void mr3free__(void);
void MR3calccoulomb(double x[], int n, double q[], double rscale, int tblno, double xmax, int periodicflag, int natchangeflag, double force[]);
void mr3calccoulomb_(double x[], int *n, double q[], double *rscale, int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void mr3calccoulomb__(double x[], int *n, double q[], double *rscale, int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void MR3calccoulomb_ij(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag);
void mr3calccoulomb_ij_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void mr3calccoulomb_ij__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void MR3_sort_with_index_int(int data[], int index[], int left, int right);
void MR3calcvdw_ij_core(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void MR3calcvdw_ij(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void mr3calcvdw_ij_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void mr3calcvdw_ij__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void MR3calcvdw(double x[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int natchangeflag, double force[]);
void mr3calcvdw_(double x[], int *n, int atype[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void mr3calcvdw__(double x[], int *n, int atype[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void MR3calcewald(int *k, int knum_org, double *x, int n, double *chg, double alpha, double epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald__(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void MR3calcnacl(double x[], int n, int atype[], int nat, double pol[], double sigm[], double ipotro[], double pc[], double pd[], double zz[], int tblno, double xmax, int periodicflag, double force[]);
void vtgrape_force(double xj[][3], double mj[], double xi[][3], double eps2, double a[][3], int ni, int nj);
void vg_set_rcut2(VG_UNIT *unit, double rcut2);
void mr3_set_rcut2_(double *rcut2);
int md5sum(unsigned char *buffer, int totallen, unsigned char sum[16]);
int md5sum_file(char *filename, unsigned char sum[16]);
void MR3calccoulomb_ij_host(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag);
void mr3calccoulomb_ij_host_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void mr3calccoulomb_ij_host__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void MR3calcvdw_ij_host(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void mr3calcvdw_ij_host_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void mr3calcvdw_ij_host__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void MR3calccoulomb_nlist_ij_host_notwork(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[], double factorall);
void MR3calccoulomb_nlist_ij_host(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calccoulomb_nlist_host(double xd[], int n, double qd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calcvdw_nlist_ij_host_notwork(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[], double factor);
void MR3calcvdw_nlist_ij_host(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_host2(double x[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[], double factor, double force[]);
void MR3calccoulomb_ij_exlist_host(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void MR3calcvdw_ij_exlist_host(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void MR3calcewald_dft_host(int k[], int knum, double x[], int n, double chg[], double cellsize[3], double bs[], double bc[]);
void MR3calcewald_idft_eng_host(int k[], double bs[], double bc[], int knum, double x[], int n, double cellsize[3], double force[]);
void MR3calcewald_idft_force_host(int k[], double bs[], double bc[], int knum, double x[], int n, double cellsize[3], double force[]);
void MR3calcewald_host(int *k, int knum_org, double *x, int n, double *chg, double alpha, double epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_host__(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_host_(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void MR3SetTable(char *filename, int tblno, int flag);
void mr3settable_nf_(char *fname, int *tblno, int *flag, int *n);
void mr3settable_nf__(char *fname, int *tblno, int *flag, int *n);
void MR3_setup_exlist(int n, int *bckptr);
void mr3_setup_exlist_(int *n, int *bckptr);
void MR3_make_natex2_from_natex(int n, int natex[], int numex[], int **natex_offset, int **natex2, int **numex2, int **natex2_offset, int flag);
void calccoulomb_vdw_ij_exlist_host_sub(int i, int j, double xi[], double xj[], double qj, double gsf, double gsp, double rs, double rscale, double cutoff, double *fc, double *fv, double *pc, double *pv, int tblno, double size[3], int potflag);
void MR3calccoulomb_vdw_ij_exlist_cutoff_host(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double cutoff, double size[3], double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_host(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_host2(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_host_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_host__(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void MR3_get_cputime(double *laptime, double *sprittime);
void MR3_set_ldim(int ldim[3]);
void mr3_set_ldim_(int ldim[3]);
void mr3_set_ldim__(int ldim[3]);
void MR3_set_coulomb_vdw_factor(double cgf);
void mr3_set_coulomb_vdw_factor_(double *cgf);
void mr3_set_coulomb_vdw_factor__(double *cgf);
void MR3calccoulomb_ij_emu(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag);
void MR3calccoulomb_nlist_ij_emu(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calccoulomb_nlist_emu(double xd[], int n, double qd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calcvdw_ij_emu(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void MR3calccoulomb_vdw_nlist_ij_emu(int ni, double xid[], double qid[], int atypei[], double force[], int nj, double xjd[], double qjd[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblno, double volume[], int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_ij_emu(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_emu2(double xd[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calccoulomb_ij_exlist(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void mr3calccoulomb_ij_exlist_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag, int numexorg[], int natexorg[]);
void mr3calccoulomb_ij_exlist__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag, int numexorg[], int natexorg[]);
void MR3calcvdw_ij_exlist(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void mr3calcvdw_ij_exlist_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int numex[], int natex[]);
void mr3calcvdw_ij_exlist__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_core_old(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_core(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_virial_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_exlist(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double volume1, double *potc, double *potv, int *convert_index, int potflag, int flag);
void MR3calccoulomb_vdw_exlist_from_cell(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double volume1, double *potc, double *potv, int *convert_index, int potflag, int flag);
void mr3calccoulomb_vdw_exlist_(int *n, double x[], double q[], int atype[], int *nat, double force[], double *rscale, double gscalesf[], double gscalesp[], double rscales[], int *tblno, int numex[], int natex[], double *volume1, double *potc, double *potv, int *convert_index, int *potflag, int *flag);
void MR3_get_forces_overlap(double force[]);
void mr3_get_forces_overlap_(double force[]);
void MR3_get_potc_and_potv_overlap(double *potc, double *potv);
void mr3_get_potc_and_potv_overlap_(double *potc, double *potv);
void mr3_get_potc_and_potv_overlap__(double *potc, double *potv);
void MR3_get_forces_and_virial_overlap(double force[], double virial[3][3]);
void mr3_get_forces_and_virial_overlap_(double force[], double virial[3][3]);
void MR3calccoulomb_ci_exlist(int n, double x[], double q[], double force[], double rscale, int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], int *convert_index, int flag);
void mr3calccoulomb_ci_exlist_(int *n, double x[], double q[], double force[], double *rscale, int *tblno, int numex[], int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], int *convert_index, int *flag);
void MR3calcvdw_ci(int n, double x[], int atype[], int nat, double force[], double gscales[], double rscales[], int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calcvdw_ci_(int *n, double x[], int atype[], int *nat, double force[], double gscales[], double rscales[], int *tblno, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calcvdw_ci_exlist(int n, double x[], int atype[], int nat, double force[], double gscales[], double rscales[], int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], int *convert_index, int flag);
void mr3calcvdw_ci_exlist_(int *n, double x[], int atype[], int *nat, double force[], double gscales[], double rscales[], int *tblno, int numex[], int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], int *convert_index, int *flag);
void MR3calccoulomb_vdw_ci_exlist(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], double *potc, double *potv, int *convert_index, int potflag, int flag);
void mr3calccoulomb_vdw_ci_exlist_(int *n, double x[], double q[], int atype[], int *nat, double force[], double *rscale, double gscalesf[], double gscalesp[], double rscales[], int *tblno, int *numex, int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], double *potc, double *potv, int *convert_index, int *potflag, int *flag);
void MR3calccoulomb_ci(int n, double x[], double q[], double force[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calccoulomb_ci_(int *n, double x[], double q[], double force[], double *rscale, int *tblno, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_ij_ci(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_ij_ci_old(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calcvdw_ij_ci(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_virial(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut_org, double skinnb, double volume[3], int ldim[3], double virial[3][3], int flag);
void MR3calccoulomb_vdw_ij_ci(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calccoulomb_vdw_ij_ci_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscales[], double rscales[], double *rscale, int *tblnoc, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_old_09(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_old_090121(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_exlist(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3], int numex[], int natex[], int flag);
void mr3calccoulomb_vdw_ij_ci_exlist_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscales[], double rscales[], double *rscale, int *tblnoc, double *rcut, double *skinnb, double volume[3], int ldim[3], int numex[], int natex[], int *flag);
void MR3_get_board_version(int *version, int *freq);
void MR3_rscale_and_pack(int n, double (*x)[3], int *atype, longlong (*rj)[2]);
void MR3_rscale_and_pack_old(int n, double (*x)[3], int *atype, longlong (*rj)[2]);
void MR3SetTable_emu(char *filename, int tblno, int flag);
int MR3_get_total_num_chips(void);
void MR3print_chip_temperature(int flag);
int MR3_get_retry_count(void);
void m3_free_unit(VG_UNIT *unit);
VG_UNIT *m3_allocate_periodic_unit(const char *fname, int mode, double size, int dum);
void m3_set_positions(VG_UNIT *unit, double (*pos)[3], int n);
void m3_set_charges(VG_UNIT *unit, const double *q, int n);
void m3_set_cells(VG_UNIT *unit, M3_CELL *cell, int ncell);
void m3_calculate_forces(VG_UNIT *unit, double (*xi)[3], int ni, double (*force)[3]);
void m3_calculate_potentials(VG_UNIT *unit, double (*xi)[3], int ni, double *eng);
void m3_set_types(VG_UNIT *unit, const int *atype, int n);
void m3_set_pipeline_types(VG_UNIT *unit, const int *atype, int n);
void m3_set_charge_matrix(VG_UNIT *unit, const double *gscale, int nati, int natj);
void m3_set_rscale_matrix(VG_UNIT *unit, const double *rscale, int nati, int natj);
int MR3_close_ch(int s_sock);
int mr3_close_ch_(int *s_sock);
int MR3_open_port(int port_number);
int MR3_sock_read(int sockfd, char *buf, size_t count);
int mr3_sock_read_(int *sockfd, char *buf, int *count);
int mr3_sock_read__(int *sockfd, char *buf, int *count);
int mr3_sock_read_i_(int *sockfd, int *buf);
int mr3_sock_read_i__(int *sockfd, int *buf);
int MR3_sock_read_iv(int sockfd, int *buf, int count);
int mr3_sock_read_iv_(int *sockfd, int *buf, int *count);
int mr3_sock_read_iv__(int *sockfd, int *buf, int *count);
int MR3_sock_read_d(int sockfd, double *buf);
int mr3_sock_read_d__(int *sockfd, double *buf);
int mr3_sock_read_d_(int *sockfd, double *buf);
int MR3_sock_read_dv(int sockfd, double *buf, int count);
int mr3_sock_read_dv__(int *sockfd, double *buf, int *count);
int mr3_sock_read_dv_(int *sockfd, double *buf, int *count);
int MR3_sock_write(int sockfd, char *buf, size_t count);
int MR3_sock_write_c(int sockfd, char *buf);
int mr3_sock_write_c_(int *sockfd, char *buf);
int mr3_sock_write_c__(int *sockfd, char *buf);
int MR3_sock_write_i(int sockfd, int buf);
int mr3_sock_write_i_(int *sockfd, int *buf);
int mr3_sock_write_i__(int *sockfd, int *buf);
int MR3_sock_write_iv(int sockfd, int *buf, int count);
int mr3_sock_write_iv_(int *sockfd, int *buf, int *count);
int mr3_sock_write_iv__(int *sockfd, int *buf, int *count);
int MR3_sock_write_dv(int sockfd, double *buf, int count);
int mr3_sock_write_dv__(int *sockfd, double *buf, int *count);
int mr3_sock_write_dv_(int *sockfd, double *buf, int *count);
int MR3_sock_gets(int sockfd, char *str, size_t count);
int MR3_sock_puts(int sockfd, char *str);
void MR3_sock_init(int *s_sock_org, int port_num, double x[], int igraph[], int natom, int str_len, int lbres[], int ipres[], int nres);
void mr3_sock_init_(int *s_sock, int *port_num, double x[], int igraph[], int *natom, int *str_len, int lbres[], int ipres[], int *nres);
void mr3_sock_init__(int *s_sock, int *port_num, double x[], int igraph[], int *natom, int *str_len, int lbres[], int ipres[], int *nres);
void MR3_sock_1step(int s_sock, double t1, double time, double t2, int recv_buf[], int natom, double x[], double f[], double f_temp[]);
void mr3_sock_1step_(int *s_sock, double *t1, double *time, double *t2, int recv_buf[], int *natom, double x[], double f[], double f_tmp[]);
void mr3_sock_1step__(int *s_sock, double *t1, double *time, double *t2, int recv_buf[], int *natom, double x[], double f[], double f_tmp[]);
void MR3calc_ij_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, char method);
void MR3calc_ij_exlist_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], char method);
void MR3calc_ij_nlist_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], char method);
/* vtgrape.c */
void *MR3_my_malloc2(size_t n, char *s);
void MR3_my_free2(void **p, char *s);
VG_UNIT *m3_get_unit(void);
void vg_exit(int ret);
VG_UNIT *vg_allocate_unit(void (*function)(void *));
void vg_free_unit(VG_UNIT *unit);
void vg_set_function(VG_UNIT *unit, int function_index, void (*function)(void *));
void vg_set_vectors(VG_UNIT *unit, int nj, void *jvectors);
void vg_set_matrices(VG_UNIT *unit, int nati, int natj, void *matrices);
void vg_set_scalers(VG_UNIT *unit, void *scalers);
void vg_set_pipeline_vectors(VG_UNIT *unit, int ni, void *ivectors);
void vg_calculate(VG_UNIT *unit, int function_index, int nf, void *fvectors, void *pscalers);
void vg_set_vectors_pos_charge_atype(VG_UNIT *unit, int nj, double pos[][3], double charge[], int atype[]);
void vg_set_vectors_pos_charge(VG_UNIT *unit, int nj, double pos[][3], double charge[]);
void vg_set_vectors_pos_atype(VG_UNIT *unit, int nj, double pos[][3], int atype[]);
void vg_set_matrices_gscales_rscales(VG_UNIT *unit, int nati_org, int natj_org, double gscales[], double rscales[]);
void vg_set_pol_sigm_ipotro_pc_pd_zz(VG_UNIT *unit, int nati, int natj, double pol[], double sigm[], double ipotro[], double pc[], double pd[], double zz[]);
void vg_set_scalers_volume_alpha(VG_UNIT *unit, double volume[3], double alpha);
void vg_set_pipeline_vectors_pos_charge_atype(VG_UNIT *unit, int ni, double pos[][3], double charge[], int atype[]);
void vg_set_pipeline_vectors_pos_charge(VG_UNIT *unit, int ni, double pos[][3], double charge[]);
void vg_set_pipeline_vectors_pos_atype(VG_UNIT *unit, int ni, double pos[][3], int atype[]);
void vg_convert_forces(VG_UNIT *unit, int nf, int function_index, double fi[][3]);
void vg_calculate_forces_potentials(VG_UNIT *unit, int function_index, int nf, double fi[][3], double *potc, double *potv);
void vg_get_r1result(int n_org, float r[], float r1[]);
void vg_get_rsqrtresult(int n_org, float r[], float r1[]);
void vg_get_mulresult(int n_org, float r[], float q[], float rq[]);
int vg_write_emufile(int flag);
void vg_initialize_emu(void);
float vg_r1emu(float x);
float vg_rsqrtemu(float x);
void vg_set_scaleq(int n, double q[], double *scaleq, float *scaleq_1);
void m3_set_softening(VG_UNIT *unit, double eps);
void MR3_exit(int ret);
void MR3init(void);
void mr3init_(void);
void mr3init__(void);
void MR3free(void);
void mr3free_(void);
void mr3free__(void);
void MR3calccoulomb(double x[], int n, double q[], double rscale, int tblno, double xmax, int periodicflag, int natchangeflag, double force[]);
void mr3calccoulomb_(double x[], int *n, double q[], double *rscale, int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void mr3calccoulomb__(double x[], int *n, double q[], double *rscale, int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void MR3calccoulomb_ij(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag);
void mr3calccoulomb_ij_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void mr3calccoulomb_ij__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void MR3_sort_with_index_int(int data[], int index[], int left, int right);
void MR3calcvdw_ij_core(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void MR3calcvdw_ij(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void mr3calcvdw_ij_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void mr3calcvdw_ij__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void MR3calcvdw(double x[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int natchangeflag, double force[]);
void mr3calcvdw_(double x[], int *n, int atype[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void mr3calcvdw__(double x[], int *n, int atype[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void MR3calcewald(int *k, int knum_org, double *x, int n, double *chg, double alpha, double epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald__(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void MR3calcnacl(double x[], int n, int atype[], int nat, double pol[], double sigm[], double ipotro[], double pc[], double pd[], double zz[], int tblno, double xmax, int periodicflag, double force[]);
void vtgrape_force(double xj[][3], double mj[], double xi[][3], double eps2, double a[][3], int ni, int nj);
void vg_set_rcut2(VG_UNIT *unit, double rcut2);
void mr3_set_rcut2_(double *rcut2);
int md5sum(unsigned char *buffer, int totallen, unsigned char sum[16]);
int md5sum_file(char *filename, unsigned char sum[16]);
void MR3calccoulomb_ij_host(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag);
void mr3calccoulomb_ij_host_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void mr3calccoulomb_ij_host__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void MR3calcvdw_ij_host(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void mr3calcvdw_ij_host_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void mr3calcvdw_ij_host__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void MR3calccoulomb_nlist_ij_host_notwork(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[], double factorall);
void MR3calccoulomb_nlist_ij_host(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calccoulomb_nlist_host(double xd[], int n, double qd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calcvdw_nlist_ij_host_notwork(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[], double factor);
void MR3calcvdw_nlist_ij_host(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_host2(double x[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[], double factor, double force[]);
void MR3calccoulomb_ij_exlist_host(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void MR3calcvdw_ij_exlist_host(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void MR3calcewald_dft_host(int k[], int knum, double x[], int n, double chg[], double cellsize[3], double bs[], double bc[]);
void MR3calcewald_idft_eng_host(int k[], double bs[], double bc[], int knum, double x[], int n, double cellsize[3], double force[]);
void MR3calcewald_idft_force_host(int k[], double bs[], double bc[], int knum, double x[], int n, double cellsize[3], double force[]);
void MR3calcewald_host(int *k, int knum_org, double *x, int n, double *chg, double alpha, double epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_host__(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_host_(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void MR3SetTable(char *filename, int tblno, int flag);
void mr3settable_nf_(char *fname, int *tblno, int *flag, int *n);
void mr3settable_nf__(char *fname, int *tblno, int *flag, int *n);
void MR3_setup_exlist(int n, int *bckptr);
void mr3_setup_exlist_(int *n, int *bckptr);
void MR3_make_natex2_from_natex(int n, int natex[], int numex[], int **natex_offset, int **natex2, int **numex2, int **natex2_offset, int flag);
void calccoulomb_vdw_ij_exlist_host_sub(int i, int j, double xi[], double xj[], double qj, double gsf, double gsp, double rs, double rscale, double cutoff, double *fc, double *fv, double *pc, double *pv, int tblno, double size[3], int potflag);
void MR3calccoulomb_vdw_ij_exlist_cutoff_host(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double cutoff, double size[3], double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_host(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_host2(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_host_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_host__(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void MR3_get_cputime(double *laptime, double *sprittime);
void MR3_set_ldim(int ldim[3]);
void mr3_set_ldim_(int ldim[3]);
void mr3_set_ldim__(int ldim[3]);
void MR3_set_coulomb_vdw_factor(double cgf);
void mr3_set_coulomb_vdw_factor_(double *cgf);
void mr3_set_coulomb_vdw_factor__(double *cgf);
void MR3calccoulomb_ij_emu(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag);
void MR3calccoulomb_nlist_ij_emu(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calccoulomb_nlist_emu(double xd[], int n, double qd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calcvdw_ij_emu(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void MR3calccoulomb_vdw_nlist_ij_emu(int ni, double xid[], double qid[], int atypei[], double force[], int nj, double xjd[], double qjd[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblno, double volume[], int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_ij_emu(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_emu2(double xd[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calccoulomb_ij_exlist(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void mr3calccoulomb_ij_exlist_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag, int numexorg[], int natexorg[]);
void mr3calccoulomb_ij_exlist__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag, int numexorg[], int natexorg[]);
void MR3calcvdw_ij_exlist(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void mr3calcvdw_ij_exlist_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int numex[], int natex[]);
void mr3calcvdw_ij_exlist__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_core_old(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_core(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_virial_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_exlist(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double volume1, double *potc, double *potv, int *convert_index, int potflag, int flag);
void MR3calccoulomb_vdw_exlist_from_cell(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double volume1, double *potc, double *potv, int *convert_index, int potflag, int flag);
void mr3calccoulomb_vdw_exlist_(int *n, double x[], double q[], int atype[], int *nat, double force[], double *rscale, double gscalesf[], double gscalesp[], double rscales[], int *tblno, int numex[], int natex[], double *volume1, double *potc, double *potv, int *convert_index, int *potflag, int *flag);
void MR3_get_forces_overlap(double force[]);
void mr3_get_forces_overlap_(double force[]);
void MR3_get_potc_and_potv_overlap(double *potc, double *potv);
void mr3_get_potc_and_potv_overlap_(double *potc, double *potv);
void mr3_get_potc_and_potv_overlap__(double *potc, double *potv);
void MR3_get_forces_and_virial_overlap(double force[], double virial[3][3]);
void mr3_get_forces_and_virial_overlap_(double force[], double virial[3][3]);
void MR3calccoulomb_ci_exlist(int n, double x[], double q[], double force[], double rscale, int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], int *convert_index, int flag);
void mr3calccoulomb_ci_exlist_(int *n, double x[], double q[], double force[], double *rscale, int *tblno, int numex[], int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], int *convert_index, int *flag);
void MR3calcvdw_ci(int n, double x[], int atype[], int nat, double force[], double gscales[], double rscales[], int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calcvdw_ci_(int *n, double x[], int atype[], int *nat, double force[], double gscales[], double rscales[], int *tblno, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calcvdw_ci_exlist(int n, double x[], int atype[], int nat, double force[], double gscales[], double rscales[], int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], int *convert_index, int flag);
void mr3calcvdw_ci_exlist_(int *n, double x[], int atype[], int *nat, double force[], double gscales[], double rscales[], int *tblno, int numex[], int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], int *convert_index, int *flag);
void MR3calccoulomb_vdw_ci_exlist(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], double *potc, double *potv, int *convert_index, int potflag, int flag);
void mr3calccoulomb_vdw_ci_exlist_(int *n, double x[], double q[], int atype[], int *nat, double force[], double *rscale, double gscalesf[], double gscalesp[], double rscales[], int *tblno, int *numex, int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], double *potc, double *potv, int *convert_index, int *potflag, int *flag);
void MR3calccoulomb_ci(int n, double x[], double q[], double force[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calccoulomb_ci_(int *n, double x[], double q[], double force[], double *rscale, int *tblno, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_ij_ci(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_ij_ci_old(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calcvdw_ij_ci(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_virial(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut_org, double skinnb, double volume[3], int ldim[3], double virial[3][3], int flag);
void MR3calccoulomb_vdw_ij_ci(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calccoulomb_vdw_ij_ci_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscales[], double rscales[], double *rscale, int *tblnoc, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_old_09(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_old_090121(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_exlist(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3], int numex[], int natex[], int flag);
void mr3calccoulomb_vdw_ij_ci_exlist_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscales[], double rscales[], double *rscale, int *tblnoc, double *rcut, double *skinnb, double volume[3], int ldim[3], int numex[], int natex[], int *flag);
void MR3_get_board_version(int *version, int *freq);
void MR3_rscale_and_pack(int n, double (*x)[3], int *atype, longlong (*rj)[2]);
void MR3_rscale_and_pack_old(int n, double (*x)[3], int *atype, longlong (*rj)[2]);
void MR3SetTable_emu(char *filename, int tblno, int flag);
int MR3_get_total_num_chips(void);
void MR3print_chip_temperature(int flag);
int MR3_get_retry_count(void);
void m3_free_unit(VG_UNIT *unit);
VG_UNIT *m3_allocate_periodic_unit(const char *fname, int mode, double size, int dum);
void m3_set_positions(VG_UNIT *unit, double (*pos)[3], int n);
void m3_set_charges(VG_UNIT *unit, const double *q, int n);
void m3_set_cells(VG_UNIT *unit, M3_CELL *cell, int ncell);
void m3_calculate_forces(VG_UNIT *unit, double (*xi)[3], int ni, double (*force)[3]);
void m3_calculate_potentials(VG_UNIT *unit, double (*xi)[3], int ni, double *eng);
void m3_set_types(VG_UNIT *unit, const int *atype, int n);
void m3_set_pipeline_types(VG_UNIT *unit, const int *atype, int n);
void m3_set_charge_matrix(VG_UNIT *unit, const double *gscale, int nati, int natj);
void m3_set_rscale_matrix(VG_UNIT *unit, const double *rscale, int nati, int natj);
int MR3_close_ch(int s_sock);
int mr3_close_ch_(int *s_sock);
int MR3_open_port(int port_number);
int MR3_sock_read(int sockfd, char *buf, size_t count);
int mr3_sock_read_(int *sockfd, char *buf, int *count);
int mr3_sock_read__(int *sockfd, char *buf, int *count);
int mr3_sock_read_i_(int *sockfd, int *buf);
int mr3_sock_read_i__(int *sockfd, int *buf);
int MR3_sock_read_iv(int sockfd, int *buf, int count);
int mr3_sock_read_iv_(int *sockfd, int *buf, int *count);
int mr3_sock_read_iv__(int *sockfd, int *buf, int *count);
int MR3_sock_read_d(int sockfd, double *buf);
int mr3_sock_read_d__(int *sockfd, double *buf);
int mr3_sock_read_d_(int *sockfd, double *buf);
int MR3_sock_read_dv(int sockfd, double *buf, int count);
int mr3_sock_read_dv__(int *sockfd, double *buf, int *count);
int mr3_sock_read_dv_(int *sockfd, double *buf, int *count);
int MR3_sock_write(int sockfd, char *buf, size_t count);
int MR3_sock_write_c(int sockfd, char *buf);
int mr3_sock_write_c_(int *sockfd, char *buf);
int mr3_sock_write_c__(int *sockfd, char *buf);
int MR3_sock_write_i(int sockfd, int buf);
int mr3_sock_write_i_(int *sockfd, int *buf);
int mr3_sock_write_i__(int *sockfd, int *buf);
int MR3_sock_write_iv(int sockfd, int *buf, int count);
int mr3_sock_write_iv_(int *sockfd, int *buf, int *count);
int mr3_sock_write_iv__(int *sockfd, int *buf, int *count);
int MR3_sock_write_dv(int sockfd, double *buf, int count);
int mr3_sock_write_dv__(int *sockfd, double *buf, int *count);
int mr3_sock_write_dv_(int *sockfd, double *buf, int *count);
int MR3_sock_gets(int sockfd, char *str, size_t count);
int MR3_sock_puts(int sockfd, char *str);
void MR3_sock_init(int *s_sock_org, int port_num, double x[], int igraph[], int natom, int str_len, int lbres[], int ipres[], int nres);
void mr3_sock_init_(int *s_sock, int *port_num, double x[], int igraph[], int *natom, int *str_len, int lbres[], int ipres[], int *nres);
void mr3_sock_init__(int *s_sock, int *port_num, double x[], int igraph[], int *natom, int *str_len, int lbres[], int ipres[], int *nres);
void MR3_sock_1step(int s_sock, double t1, double time, double t2, int recv_buf[], int natom, double x[], double f[], double f_temp[]);
void mr3_sock_1step_(int *s_sock, double *t1, double *time, double *t2, int recv_buf[], int *natom, double x[], double f[], double f_tmp[]);
void mr3_sock_1step__(int *s_sock, double *t1, double *time, double *t2, int recv_buf[], int *natom, double x[], double f[], double f_tmp[]);
void MR3calc_ij_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, char method);
void MR3calc_ij_exlist_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], char method);
void MR3calc_ij_nlist_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], char method);
/* vtgrape.c */
void *MR3_my_malloc2(size_t n, char *s);
void MR3_my_free2(void **p, char *s);
VG_UNIT *m3_get_unit(void);
void vg_exit(int ret);
VG_UNIT *vg_allocate_unit(void (*function)(void *));
void vg_free_unit(VG_UNIT *unit);
void vg_set_function(VG_UNIT *unit, int function_index, void (*function)(void *));
void vg_set_vectors(VG_UNIT *unit, int nj, void *jvectors);
void vg_set_matrices(VG_UNIT *unit, int nati, int natj, void *matrices);
void vg_set_scalers(VG_UNIT *unit, void *scalers);
void vg_set_pipeline_vectors(VG_UNIT *unit, int ni, void *ivectors);
void vg_calculate(VG_UNIT *unit, int function_index, int nf, void *fvectors, void *pscalers);
void vg_set_vectors_pos_charge_atype(VG_UNIT *unit, int nj, double pos[][3], double charge[], int atype[]);
void vg_set_vectors_pos_charge(VG_UNIT *unit, int nj, double pos[][3], double charge[]);
void vg_set_vectors_pos_atype(VG_UNIT *unit, int nj, double pos[][3], int atype[]);
void vg_set_matrices_gscales_rscales(VG_UNIT *unit, int nati_org, int natj_org, double gscales[], double rscales[]);
void vg_set_pol_sigm_ipotro_pc_pd_zz(VG_UNIT *unit, int nati, int natj, double pol[], double sigm[], double ipotro[], double pc[], double pd[], double zz[]);
void vg_set_scalers_volume_alpha(VG_UNIT *unit, double volume[3], double alpha);
void vg_set_pipeline_vectors_pos_charge_atype(VG_UNIT *unit, int ni, double pos[][3], double charge[], int atype[]);
void vg_set_pipeline_vectors_pos_charge(VG_UNIT *unit, int ni, double pos[][3], double charge[]);
void vg_set_pipeline_vectors_pos_atype(VG_UNIT *unit, int ni, double pos[][3], int atype[]);
void vg_convert_forces(VG_UNIT *unit, int nf, int function_index, double fi[][3]);
void vg_calculate_forces_potentials(VG_UNIT *unit, int function_index, int nf, double fi[][3], double *potc, double *potv);
void vg_get_r1result(int n_org, float r[], float r1[]);
void vg_get_rsqrtresult(int n_org, float r[], float r1[]);
void vg_get_mulresult(int n_org, float r[], float q[], float rq[]);
int vg_write_emufile(int flag);
void vg_initialize_emu(void);
float vg_r1emu(float x);
float vg_rsqrtemu(float x);
void vg_set_scaleq(int n, double q[], double *scaleq, float *scaleq_1);
void m3_set_softening(VG_UNIT *unit, double eps);
void MR3_exit(int ret);
void MR3init(void);
void mr3init_(void);
void mr3init__(void);
void MR3free(void);
void mr3free_(void);
void mr3free__(void);
void MR3calccoulomb(double x[], int n, double q[], double rscale, int tblno, double xmax, int periodicflag, int natchangeflag, double force[]);
void mr3calccoulomb_(double x[], int *n, double q[], double *rscale, int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void mr3calccoulomb__(double x[], int *n, double q[], double *rscale, int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void MR3calccoulomb_ij(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag);
void mr3calccoulomb_ij_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void mr3calccoulomb_ij__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void MR3_sort_with_index_int(int data[], int index[], int left, int right);
void MR3calcvdw_ij_core(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void MR3calcvdw_ij(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void mr3calcvdw_ij_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void mr3calcvdw_ij__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void MR3calcvdw(double x[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int natchangeflag, double force[]);
void mr3calcvdw_(double x[], int *n, int atype[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void mr3calcvdw__(double x[], int *n, int atype[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void MR3calcewald(int *k, int knum_org, double *x, int n, double *chg, double alpha, double epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald__(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void MR3calcnacl(double x[], int n, int atype[], int nat, double pol[], double sigm[], double ipotro[], double pc[], double pd[], double zz[], int tblno, double xmax, int periodicflag, double force[]);
void vtgrape_force(double xj[][3], double mj[], double xi[][3], double eps2, double a[][3], int ni, int nj);
void vg_set_rcut2(VG_UNIT *unit, double rcut2);
void mr3_set_rcut2_(double *rcut2);
int md5sum(unsigned char *buffer, int totallen, unsigned char sum[16]);
int md5sum_file(char *filename, unsigned char sum[16]);
void MR3calccoulomb_ij_host(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag);
void mr3calccoulomb_ij_host_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void mr3calccoulomb_ij_host__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void MR3calcvdw_ij_host(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void mr3calcvdw_ij_host_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void mr3calcvdw_ij_host__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void MR3calccoulomb_nlist_ij_host_notwork(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[], double factorall);
void MR3calccoulomb_nlist_ij_host(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calccoulomb_nlist_host(double xd[], int n, double qd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calcvdw_nlist_ij_host_notwork(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[], double factor);
void MR3calcvdw_nlist_ij_host(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_host2(double x[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[], double factor, double force[]);
void MR3calccoulomb_ij_exlist_host(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void MR3calcvdw_ij_exlist_host(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void MR3calcewald_dft_host(int k[], int knum, double x[], int n, double chg[], double cellsize[3], double bs[], double bc[]);
void MR3calcewald_idft_eng_host(int k[], double bs[], double bc[], int knum, double x[], int n, double cellsize[3], double force[]);
void MR3calcewald_idft_force_host(int k[], double bs[], double bc[], int knum, double x[], int n, double cellsize[3], double force[]);
void MR3calcewald_host(int *k, int knum_org, double *x, int n, double *chg, double alpha, double epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_host__(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_host_(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void MR3SetTable(char *filename, int tblno, int flag);
void mr3settable_nf_(char *fname, int *tblno, int *flag, int *n);
void mr3settable_nf__(char *fname, int *tblno, int *flag, int *n);
void MR3_setup_exlist(int n, int *bckptr);
void mr3_setup_exlist_(int *n, int *bckptr);
void MR3_make_natex2_from_natex(int n, int natex[], int numex[], int **natex_offset, int **natex2, int **numex2, int **natex2_offset, int flag);
void calccoulomb_vdw_ij_exlist_host_sub(int i, int j, double xi[], double xj[], double qj, double gsf, double gsp, double rs, double rscale, double cutoff, double *fc, double *fv, double *pc, double *pv, int tblno, double size[3], int potflag);
void MR3calccoulomb_vdw_ij_exlist_cutoff_host(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double cutoff, double size[3], double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_host(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_host2(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_host_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_host__(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void MR3_get_cputime(double *laptime, double *sprittime);
void MR3_set_ldim(int ldim[3]);
void mr3_set_ldim_(int ldim[3]);
void mr3_set_ldim__(int ldim[3]);
void MR3_set_coulomb_vdw_factor(double cgf);
void mr3_set_coulomb_vdw_factor_(double *cgf);
void mr3_set_coulomb_vdw_factor__(double *cgf);
void MR3calccoulomb_ij_emu(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag);
void MR3calccoulomb_nlist_ij_emu(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calccoulomb_nlist_emu(double xd[], int n, double qd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calcvdw_ij_emu(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void MR3calccoulomb_vdw_nlist_ij_emu(int ni, double xid[], double qid[], int atypei[], double force[], int nj, double xjd[], double qjd[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblno, double volume[], int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_ij_emu(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_emu2(double xd[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calccoulomb_ij_exlist(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void mr3calccoulomb_ij_exlist_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag, int numexorg[], int natexorg[]);
void mr3calccoulomb_ij_exlist__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag, int numexorg[], int natexorg[]);
void MR3calcvdw_ij_exlist(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void mr3calcvdw_ij_exlist_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int numex[], int natex[]);
void mr3calcvdw_ij_exlist__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_core_old(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_core(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_virial_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_exlist(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double volume1, double *potc, double *potv, int *convert_index, int potflag, int flag);
void MR3calccoulomb_vdw_exlist_from_cell(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double volume1, double *potc, double *potv, int *convert_index, int potflag, int flag);
void mr3calccoulomb_vdw_exlist_(int *n, double x[], double q[], int atype[], int *nat, double force[], double *rscale, double gscalesf[], double gscalesp[], double rscales[], int *tblno, int numex[], int natex[], double *volume1, double *potc, double *potv, int *convert_index, int *potflag, int *flag);
void MR3_get_forces_overlap(double force[]);
void mr3_get_forces_overlap_(double force[]);
void MR3_get_potc_and_potv_overlap(double *potc, double *potv);
void mr3_get_potc_and_potv_overlap_(double *potc, double *potv);
void mr3_get_potc_and_potv_overlap__(double *potc, double *potv);
void MR3_get_forces_and_virial_overlap(double force[], double virial[3][3]);
void mr3_get_forces_and_virial_overlap_(double force[], double virial[3][3]);
void MR3calccoulomb_ci_exlist(int n, double x[], double q[], double force[], double rscale, int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], int *convert_index, int flag);
void mr3calccoulomb_ci_exlist_(int *n, double x[], double q[], double force[], double *rscale, int *tblno, int numex[], int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], int *convert_index, int *flag);
void MR3calcvdw_ci(int n, double x[], int atype[], int nat, double force[], double gscales[], double rscales[], int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calcvdw_ci_(int *n, double x[], int atype[], int *nat, double force[], double gscales[], double rscales[], int *tblno, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calcvdw_ci_exlist(int n, double x[], int atype[], int nat, double force[], double gscales[], double rscales[], int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], int *convert_index, int flag);
void mr3calcvdw_ci_exlist_(int *n, double x[], int atype[], int *nat, double force[], double gscales[], double rscales[], int *tblno, int numex[], int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], int *convert_index, int *flag);
void MR3calccoulomb_vdw_ci_exlist(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], double *potc, double *potv, int *convert_index, int potflag, int flag);
void mr3calccoulomb_vdw_ci_exlist_(int *n, double x[], double q[], int atype[], int *nat, double force[], double *rscale, double gscalesf[], double gscalesp[], double rscales[], int *tblno, int *numex, int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], double *potc, double *potv, int *convert_index, int *potflag, int *flag);
void MR3calccoulomb_ci(int n, double x[], double q[], double force[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calccoulomb_ci_(int *n, double x[], double q[], double force[], double *rscale, int *tblno, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_ij_ci(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_ij_ci_old(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calcvdw_ij_ci(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_virial(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut_org, double skinnb, double volume[3], int ldim[3], double virial[3][3], int flag);
void MR3calccoulomb_vdw_ij_ci(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calccoulomb_vdw_ij_ci_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscales[], double rscales[], double *rscale, int *tblnoc, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_old_09(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_old_090121(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_exlist(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3], int numex[], int natex[], int flag);
void mr3calccoulomb_vdw_ij_ci_exlist_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscales[], double rscales[], double *rscale, int *tblnoc, double *rcut, double *skinnb, double volume[3], int ldim[3], int numex[], int natex[], int *flag);
void MR3_get_board_version(int *version, int *freq);
void MR3_rscale_and_pack(int n, double (*x)[3], int *atype, longlong (*rj)[2]);
void MR3_rscale_and_pack_old(int n, double (*x)[3], int *atype, longlong (*rj)[2]);
void MR3SetTable_emu(char *filename, int tblno, int flag);
int MR3_get_total_num_chips(void);
void MR3print_chip_temperature(int flag);
int MR3_get_retry_count(void);
void m3_free_unit(VG_UNIT *unit);
VG_UNIT *m3_allocate_periodic_unit(const char *fname, int mode, double size, int dum);
void m3_set_positions(VG_UNIT *unit, double (*pos)[3], int n);
void m3_set_charges(VG_UNIT *unit, const double *q, int n);
void m3_set_cells(VG_UNIT *unit, M3_CELL *cell, int ncell);
void m3_calculate_forces(VG_UNIT *unit, double (*xi)[3], int ni, double (*force)[3]);
void m3_calculate_potentials(VG_UNIT *unit, double (*xi)[3], int ni, double *eng);
void m3_set_types(VG_UNIT *unit, const int *atype, int n);
void m3_set_pipeline_types(VG_UNIT *unit, const int *atype, int n);
void m3_set_charge_matrix(VG_UNIT *unit, const double *gscale, int nati, int natj);
void m3_set_rscale_matrix(VG_UNIT *unit, const double *rscale, int nati, int natj);
int MR3_close_ch(int s_sock);
int mr3_close_ch_(int *s_sock);
int MR3_open_port(int port_number);
int MR3_sock_read(int sockfd, char *buf, size_t count);
int mr3_sock_read_(int *sockfd, char *buf, int *count);
int mr3_sock_read__(int *sockfd, char *buf, int *count);
int mr3_sock_read_i_(int *sockfd, int *buf);
int mr3_sock_read_i__(int *sockfd, int *buf);
int MR3_sock_read_iv(int sockfd, int *buf, int count);
int mr3_sock_read_iv_(int *sockfd, int *buf, int *count);
int mr3_sock_read_iv__(int *sockfd, int *buf, int *count);
int MR3_sock_read_d(int sockfd, double *buf);
int mr3_sock_read_d__(int *sockfd, double *buf);
int mr3_sock_read_d_(int *sockfd, double *buf);
int MR3_sock_read_dv(int sockfd, double *buf, int count);
int mr3_sock_read_dv__(int *sockfd, double *buf, int *count);
int mr3_sock_read_dv_(int *sockfd, double *buf, int *count);
int MR3_sock_write(int sockfd, char *buf, size_t count);
int MR3_sock_write_c(int sockfd, char *buf);
int mr3_sock_write_c_(int *sockfd, char *buf);
int mr3_sock_write_c__(int *sockfd, char *buf);
int MR3_sock_write_i(int sockfd, int buf);
int mr3_sock_write_i_(int *sockfd, int *buf);
int mr3_sock_write_i__(int *sockfd, int *buf);
int MR3_sock_write_iv(int sockfd, int *buf, int count);
int mr3_sock_write_iv_(int *sockfd, int *buf, int *count);
int mr3_sock_write_iv__(int *sockfd, int *buf, int *count);
int MR3_sock_write_dv(int sockfd, double *buf, int count);
int mr3_sock_write_dv__(int *sockfd, double *buf, int *count);
int mr3_sock_write_dv_(int *sockfd, double *buf, int *count);
int MR3_sock_gets(int sockfd, char *str, size_t count);
int MR3_sock_puts(int sockfd, char *str);
void MR3_sock_init(int *s_sock_org, int port_num, double x[], int igraph[], int natom, int str_len, int lbres[], int ipres[], int nres);
void mr3_sock_init_(int *s_sock, int *port_num, double x[], int igraph[], int *natom, int *str_len, int lbres[], int ipres[], int *nres);
void mr3_sock_init__(int *s_sock, int *port_num, double x[], int igraph[], int *natom, int *str_len, int lbres[], int ipres[], int *nres);
void MR3_sock_1step(int s_sock, double t1, double time, double t2, int recv_buf[], int natom, double x[], double f[], double f_temp[]);
void mr3_sock_1step_(int *s_sock, double *t1, double *time, double *t2, int recv_buf[], int *natom, double x[], double f[], double f_tmp[]);
void mr3_sock_1step__(int *s_sock, double *t1, double *time, double *t2, int recv_buf[], int *natom, double x[], double f[], double f_tmp[]);
void MR3calc_ij_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, char method);
void MR3calc_ij_exlist_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], char method);
void MR3calc_ij_nlist_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], char method);
/* vtgrape.c */
void *MR3_my_malloc2(size_t n, char *s);
void MR3_my_free2(void **p, char *s);
VG_UNIT *m3_get_unit(void);
void vg_exit(int ret);
VG_UNIT *vg_allocate_unit(void (*function)(void *));
void vg_free_unit(VG_UNIT *unit);
void vg_set_function(VG_UNIT *unit, int function_index, void (*function)(void *));
void vg_set_vectors(VG_UNIT *unit, int nj, void *jvectors);
void vg_set_matrices(VG_UNIT *unit, int nati, int natj, void *matrices);
void vg_set_scalers(VG_UNIT *unit, void *scalers);
void vg_set_pipeline_vectors(VG_UNIT *unit, int ni, void *ivectors);
void vg_calculate(VG_UNIT *unit, int function_index, int nf, void *fvectors, void *pscalers);
void vg_set_vectors_pos_charge_atype(VG_UNIT *unit, int nj, double pos[][3], double charge[], int atype[]);
void vg_set_vectors_pos_charge(VG_UNIT *unit, int nj, double pos[][3], double charge[]);
void vg_set_vectors_pos_atype(VG_UNIT *unit, int nj, double pos[][3], int atype[]);
void vg_set_matrices_gscales_rscales(VG_UNIT *unit, int nati_org, int natj_org, double gscales[], double rscales[]);
void vg_set_pol_sigm_ipotro_pc_pd_zz(VG_UNIT *unit, int nati, int natj, double pol[], double sigm[], double ipotro[], double pc[], double pd[], double zz[]);
void vg_set_scalers_volume_alpha(VG_UNIT *unit, double volume[3], double alpha);
void vg_set_pipeline_vectors_pos_charge_atype(VG_UNIT *unit, int ni, double pos[][3], double charge[], int atype[]);
void vg_set_pipeline_vectors_pos_charge(VG_UNIT *unit, int ni, double pos[][3], double charge[]);
void vg_set_pipeline_vectors_pos_atype(VG_UNIT *unit, int ni, double pos[][3], int atype[]);
void vg_convert_forces(VG_UNIT *unit, int nf, int function_index, double fi[][3]);
void vg_calculate_forces_potentials(VG_UNIT *unit, int function_index, int nf, double fi[][3], double *potc, double *potv);
void vg_get_r1result(int n_org, float r[], float r1[]);
void vg_get_rsqrtresult(int n_org, float r[], float r1[]);
void vg_get_mulresult(int n_org, float r[], float q[], float rq[]);
int vg_write_emufile(int flag);
void vg_initialize_emu(void);
float vg_r1emu(float x);
float vg_rsqrtemu(float x);
void vg_set_scaleq(int n, double q[], double *scaleq, float *scaleq_1);
void m3_set_softening(VG_UNIT *unit, double eps);
void MR3_exit(int ret);
void MR3init(void);
void mr3init_(void);
void mr3init__(void);
void MR3free(void);
void mr3free_(void);
void mr3free__(void);
void MR3calccoulomb(double x[], int n, double q[], double rscale, int tblno, double xmax, int periodicflag, int natchangeflag, double force[]);
void mr3calccoulomb_(double x[], int *n, double q[], double *rscale, int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void mr3calccoulomb__(double x[], int *n, double q[], double *rscale, int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void MR3calccoulomb_ij(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag);
void mr3calccoulomb_ij_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void mr3calccoulomb_ij__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void MR3_sort_with_index_int(int data[], int index[], int left, int right);
void MR3calcvdw_ij_core(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void MR3calcvdw_ij(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void mr3calcvdw_ij_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void mr3calcvdw_ij__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void MR3calcvdw(double x[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int natchangeflag, double force[]);
void mr3calcvdw_(double x[], int *n, int atype[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void mr3calcvdw__(double x[], int *n, int atype[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void MR3calcewald(int *k, int knum_org, double *x, int n, double *chg, double alpha, double epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald__(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void MR3calcnacl(double x[], int n, int atype[], int nat, double pol[], double sigm[], double ipotro[], double pc[], double pd[], double zz[], int tblno, double xmax, int periodicflag, double force[]);
void vtgrape_force(double xj[][3], double mj[], double xi[][3], double eps2, double a[][3], int ni, int nj);
void vg_set_rcut2(VG_UNIT *unit, double rcut2);
void mr3_set_rcut2_(double *rcut2);
int md5sum(unsigned char *buffer, int totallen, unsigned char sum[16]);
int md5sum_file(char *filename, unsigned char sum[16]);
void MR3calccoulomb_ij_host(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag);
void mr3calccoulomb_ij_host_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void mr3calccoulomb_ij_host__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void MR3calcvdw_ij_host(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void mr3calcvdw_ij_host_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void mr3calcvdw_ij_host__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void MR3calccoulomb_nlist_ij_host_notwork(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[], double factorall);
void MR3calccoulomb_nlist_ij_host(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calccoulomb_nlist_host(double xd[], int n, double qd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calcvdw_nlist_ij_host_notwork(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[], double factor);
void MR3calcvdw_nlist_ij_host(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_host2(double x[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[], double factor, double force[]);
void MR3calccoulomb_ij_exlist_host(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void MR3calcvdw_ij_exlist_host(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void MR3calcewald_dft_host(int k[], int knum, double x[], int n, double chg[], double cellsize[3], double bs[], double bc[]);
void MR3calcewald_idft_eng_host(int k[], double bs[], double bc[], int knum, double x[], int n, double cellsize[3], double force[]);
void MR3calcewald_idft_force_host(int k[], double bs[], double bc[], int knum, double x[], int n, double cellsize[3], double force[]);
void MR3calcewald_host(int *k, int knum_org, double *x, int n, double *chg, double alpha, double epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_host__(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_host_(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void MR3SetTable(char *filename, int tblno, int flag);
void mr3settable_nf_(char *fname, int *tblno, int *flag, int *n);
void mr3settable_nf__(char *fname, int *tblno, int *flag, int *n);
void MR3_setup_exlist(int n, int *bckptr);
void mr3_setup_exlist_(int *n, int *bckptr);
void MR3_make_natex2_from_natex(int n, int natex[], int numex[], int **natex_offset, int **natex2, int **numex2, int **natex2_offset, int flag);
void calccoulomb_vdw_ij_exlist_host_sub(int i, int j, double xi[], double xj[], double qj, double gsf, double gsp, double rs, double rscale, double cutoff, double *fc, double *fv, double *pc, double *pv, int tblno, double size[3], int potflag);
void MR3calccoulomb_vdw_ij_exlist_cutoff_host(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double cutoff, double size[3], double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_host(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_host2(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_host_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_host__(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void MR3_get_cputime(double *laptime, double *sprittime);
void MR3_set_ldim(int ldim[3]);
void mr3_set_ldim_(int ldim[3]);
void mr3_set_ldim__(int ldim[3]);
void MR3_set_coulomb_vdw_factor(double cgf);
void mr3_set_coulomb_vdw_factor_(double *cgf);
void mr3_set_coulomb_vdw_factor__(double *cgf);
void MR3calccoulomb_ij_emu(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag);
void MR3calccoulomb_nlist_ij_emu(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calccoulomb_nlist_emu(double xd[], int n, double qd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calcvdw_ij_emu(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void MR3calccoulomb_vdw_nlist_ij_emu(int ni, double xid[], double qid[], int atypei[], double force[], int nj, double xjd[], double qjd[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblno, double volume[], int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_ij_emu(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_emu2(double xd[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calccoulomb_ij_exlist(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void mr3calccoulomb_ij_exlist_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag, int numexorg[], int natexorg[]);
void mr3calccoulomb_ij_exlist__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag, int numexorg[], int natexorg[]);
void MR3calcvdw_ij_exlist(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void mr3calcvdw_ij_exlist_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int numex[], int natex[]);
void mr3calcvdw_ij_exlist__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_core_old(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_core(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_virial_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_exlist(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double volume1, double *potc, double *potv, int *convert_index, int potflag, int flag);
void MR3calccoulomb_vdw_exlist_from_cell(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double volume1, double *potc, double *potv, int *convert_index, int potflag, int flag);
void mr3calccoulomb_vdw_exlist_(int *n, double x[], double q[], int atype[], int *nat, double force[], double *rscale, double gscalesf[], double gscalesp[], double rscales[], int *tblno, int numex[], int natex[], double *volume1, double *potc, double *potv, int *convert_index, int *potflag, int *flag);
void MR3_get_forces_overlap(double force[]);
void mr3_get_forces_overlap_(double force[]);
void MR3_get_potc_and_potv_overlap(double *potc, double *potv);
void mr3_get_potc_and_potv_overlap_(double *potc, double *potv);
void mr3_get_potc_and_potv_overlap__(double *potc, double *potv);
void MR3_get_forces_and_virial_overlap(double force[], double virial[3][3]);
void mr3_get_forces_and_virial_overlap_(double force[], double virial[3][3]);
void MR3calccoulomb_ci_exlist(int n, double x[], double q[], double force[], double rscale, int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], int *convert_index, int flag);
void mr3calccoulomb_ci_exlist_(int *n, double x[], double q[], double force[], double *rscale, int *tblno, int numex[], int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], int *convert_index, int *flag);
void MR3calcvdw_ci(int n, double x[], int atype[], int nat, double force[], double gscales[], double rscales[], int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calcvdw_ci_(int *n, double x[], int atype[], int *nat, double force[], double gscales[], double rscales[], int *tblno, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calcvdw_ci_exlist(int n, double x[], int atype[], int nat, double force[], double gscales[], double rscales[], int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], int *convert_index, int flag);
void mr3calcvdw_ci_exlist_(int *n, double x[], int atype[], int *nat, double force[], double gscales[], double rscales[], int *tblno, int numex[], int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], int *convert_index, int *flag);
void MR3calccoulomb_vdw_ci_exlist(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], double *potc, double *potv, int *convert_index, int potflag, int flag);
void mr3calccoulomb_vdw_ci_exlist_(int *n, double x[], double q[], int atype[], int *nat, double force[], double *rscale, double gscalesf[], double gscalesp[], double rscales[], int *tblno, int *numex, int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], double *potc, double *potv, int *convert_index, int *potflag, int *flag);
void MR3calccoulomb_ci(int n, double x[], double q[], double force[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calccoulomb_ci_(int *n, double x[], double q[], double force[], double *rscale, int *tblno, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_ij_ci(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_ij_ci_old(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calcvdw_ij_ci(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_virial(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut_org, double skinnb, double volume[3], int ldim[3], double virial[3][3], int flag);
void MR3calccoulomb_vdw_ij_ci(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calccoulomb_vdw_ij_ci_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscales[], double rscales[], double *rscale, int *tblnoc, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_old_09(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_old_090121(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_exlist(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3], int numex[], int natex[], int flag);
void mr3calccoulomb_vdw_ij_ci_exlist_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscales[], double rscales[], double *rscale, int *tblnoc, double *rcut, double *skinnb, double volume[3], int ldim[3], int numex[], int natex[], int *flag);
void MR3_get_board_version(int *version, int *freq);
void MR3_rscale_and_pack(int n, double (*x)[3], int *atype, longlong (*rj)[2]);
void MR3_rscale_and_pack_old(int n, double (*x)[3], int *atype, longlong (*rj)[2]);
void MR3SetTable_emu(char *filename, int tblno, int flag);
int MR3_get_total_num_chips(void);
void MR3print_chip_temperature(int flag);
int MR3_get_retry_count(void);
void m3_free_unit(VG_UNIT *unit);
VG_UNIT *m3_allocate_periodic_unit(const char *fname, int mode, double size, int dum);
void m3_set_positions(VG_UNIT *unit, double (*pos)[3], int n);
void m3_set_charges(VG_UNIT *unit, const double *q, int n);
void m3_set_cells(VG_UNIT *unit, M3_CELL *cell, int ncell);
void m3_calculate_forces(VG_UNIT *unit, double (*xi)[3], int ni, double (*force)[3]);
void m3_calculate_potentials(VG_UNIT *unit, double (*xi)[3], int ni, double *eng);
void m3_set_types(VG_UNIT *unit, const int *atype, int n);
void m3_set_pipeline_types(VG_UNIT *unit, const int *atype, int n);
void m3_set_charge_matrix(VG_UNIT *unit, const double *gscale, int nati, int natj);
void m3_set_rscale_matrix(VG_UNIT *unit, const double *rscale, int nati, int natj);
int MR3_close_ch(int s_sock);
int mr3_close_ch_(int *s_sock);
int MR3_open_port(int port_number);
int MR3_sock_read(int sockfd, char *buf, size_t count);
int mr3_sock_read_(int *sockfd, char *buf, int *count);
int mr3_sock_read__(int *sockfd, char *buf, int *count);
int mr3_sock_read_i_(int *sockfd, int *buf);
int mr3_sock_read_i__(int *sockfd, int *buf);
int MR3_sock_read_iv(int sockfd, int *buf, int count);
int mr3_sock_read_iv_(int *sockfd, int *buf, int *count);
int mr3_sock_read_iv__(int *sockfd, int *buf, int *count);
int MR3_sock_read_d(int sockfd, double *buf);
int mr3_sock_read_d__(int *sockfd, double *buf);
int mr3_sock_read_d_(int *sockfd, double *buf);
int MR3_sock_read_dv(int sockfd, double *buf, int count);
int mr3_sock_read_dv__(int *sockfd, double *buf, int *count);
int mr3_sock_read_dv_(int *sockfd, double *buf, int *count);
int MR3_sock_write(int sockfd, char *buf, size_t count);
int MR3_sock_write_c(int sockfd, char *buf);
int mr3_sock_write_c_(int *sockfd, char *buf);
int mr3_sock_write_c__(int *sockfd, char *buf);
int MR3_sock_write_i(int sockfd, int buf);
int mr3_sock_write_i_(int *sockfd, int *buf);
int mr3_sock_write_i__(int *sockfd, int *buf);
int MR3_sock_write_iv(int sockfd, int *buf, int count);
int mr3_sock_write_iv_(int *sockfd, int *buf, int *count);
int mr3_sock_write_iv__(int *sockfd, int *buf, int *count);
int MR3_sock_write_dv(int sockfd, double *buf, int count);
int mr3_sock_write_dv__(int *sockfd, double *buf, int *count);
int mr3_sock_write_dv_(int *sockfd, double *buf, int *count);
int MR3_sock_gets(int sockfd, char *str, size_t count);
int MR3_sock_puts(int sockfd, char *str);
void MR3_sock_init(int *s_sock_org, int port_num, double x[], int igraph[], int natom, int str_len, int lbres[], int ipres[], int nres);
void mr3_sock_init_(int *s_sock, int *port_num, double x[], int igraph[], int *natom, int *str_len, int lbres[], int ipres[], int *nres);
void mr3_sock_init__(int *s_sock, int *port_num, double x[], int igraph[], int *natom, int *str_len, int lbres[], int ipres[], int *nres);
void MR3_sock_1step(int s_sock, double t1, double time, double t2, int recv_buf[], int natom, double x[], double f[], double f_temp[]);
void mr3_sock_1step_(int *s_sock, double *t1, double *time, double *t2, int recv_buf[], int *natom, double x[], double f[], double f_tmp[]);
void mr3_sock_1step__(int *s_sock, double *t1, double *time, double *t2, int recv_buf[], int *natom, double x[], double f[], double f_tmp[]);
void MR3calc_ij_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, char method);
void MR3calc_ij_exlist_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], char method);
void MR3calc_ij_nlist_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], char method);
/* vtgrape.c */
void *MR3_my_malloc2(size_t n, char *s);
void MR3_my_free2(void **p, char *s);
VG_UNIT *m3_get_unit(void);
void vg_exit(int ret);
VG_UNIT *vg_allocate_unit(void (*function)(void *));
void vg_free_unit(VG_UNIT *unit);
void vg_set_function(VG_UNIT *unit, int function_index, void (*function)(void *));
void vg_set_vectors(VG_UNIT *unit, int nj, void *jvectors);
void vg_set_matrices(VG_UNIT *unit, int nati, int natj, void *matrices);
void vg_set_scalers(VG_UNIT *unit, void *scalers);
void vg_set_pipeline_vectors(VG_UNIT *unit, int ni, void *ivectors);
void vg_calculate(VG_UNIT *unit, int function_index, int nf, void *fvectors, void *pscalers);
void vg_set_vectors_pos_charge_atype(VG_UNIT *unit, int nj, double pos[][3], double charge[], int atype[]);
void vg_set_vectors_pos_charge(VG_UNIT *unit, int nj, double pos[][3], double charge[]);
void vg_set_vectors_pos_atype(VG_UNIT *unit, int nj, double pos[][3], int atype[]);
void vg_set_matrices_gscales_rscales(VG_UNIT *unit, int nati_org, int natj_org, double gscales[], double rscales[]);
void vg_set_pol_sigm_ipotro_pc_pd_zz(VG_UNIT *unit, int nati, int natj, double pol[], double sigm[], double ipotro[], double pc[], double pd[], double zz[]);
void vg_set_scalers_volume_alpha(VG_UNIT *unit, double volume[3], double alpha);
void vg_set_pipeline_vectors_pos_charge_atype(VG_UNIT *unit, int ni, double pos[][3], double charge[], int atype[]);
void vg_set_pipeline_vectors_pos_charge(VG_UNIT *unit, int ni, double pos[][3], double charge[]);
void vg_set_pipeline_vectors_pos_atype(VG_UNIT *unit, int ni, double pos[][3], int atype[]);
void vg_convert_forces(VG_UNIT *unit, int nf, int function_index, double fi[][3]);
void vg_calculate_forces_potentials(VG_UNIT *unit, int function_index, int nf, double fi[][3], double *potc, double *potv);
void vg_get_r1result(int n_org, float r[], float r1[]);
void vg_get_rsqrtresult(int n_org, float r[], float r1[]);
void vg_get_mulresult(int n_org, float r[], float q[], float rq[]);
int vg_write_emufile(int flag);
void vg_initialize_emu(void);
float vg_r1emu(float x);
float vg_rsqrtemu(float x);
void vg_set_scaleq(int n, double q[], double *scaleq, float *scaleq_1);
void m3_set_softening(VG_UNIT *unit, double eps);
void MR3_exit(int ret);
void MR3init(void);
void mr3init_(void);
void mr3init__(void);
void MR3free(void);
void mr3free_(void);
void mr3free__(void);
void MR3calccoulomb(double x[], int n, double q[], double rscale, int tblno, double xmax, int periodicflag, int natchangeflag, double force[]);
void mr3calccoulomb_(double x[], int *n, double q[], double *rscale, int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void mr3calccoulomb__(double x[], int *n, double q[], double *rscale, int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void MR3calccoulomb_ij(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag);
void mr3calccoulomb_ij_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void mr3calccoulomb_ij__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void MR3_sort_with_index_int(int data[], int index[], int left, int right);
void MR3calcvdw_ij_core(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void MR3calcvdw_ij(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void mr3calcvdw_ij_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void mr3calcvdw_ij__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void MR3calcvdw(double x[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int natchangeflag, double force[]);
void mr3calcvdw_(double x[], int *n, int atype[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void mr3calcvdw__(double x[], int *n, int atype[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void MR3calcewald(int *k, int knum_org, double *x, int n, double *chg, double alpha, double epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald__(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void MR3calcnacl(double x[], int n, int atype[], int nat, double pol[], double sigm[], double ipotro[], double pc[], double pd[], double zz[], int tblno, double xmax, int periodicflag, double force[]);
void vtgrape_force(double xj[][3], double mj[], double xi[][3], double eps2, double a[][3], int ni, int nj);
void vg_set_rcut2(VG_UNIT *unit, double rcut2);
void mr3_set_rcut2_(double *rcut2);
int md5sum(unsigned char *buffer, int totallen, unsigned char sum[16]);
int md5sum_file(char *filename, unsigned char sum[16]);
void MR3calccoulomb_ij_host(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag);
void mr3calccoulomb_ij_host_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void mr3calccoulomb_ij_host__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void MR3calcvdw_ij_host(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void mr3calcvdw_ij_host_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void mr3calcvdw_ij_host__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void MR3calccoulomb_nlist_ij_host_notwork(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[], double factorall);
void MR3calccoulomb_nlist_ij_host(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calccoulomb_nlist_host(double xd[], int n, double qd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calcvdw_nlist_ij_host_notwork(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[], double factor);
void MR3calcvdw_nlist_ij_host(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_host2(double x[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[], double factor, double force[]);
void MR3calccoulomb_ij_exlist_host(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void MR3calcvdw_ij_exlist_host(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void MR3calcewald_dft_host(int k[], int knum, double x[], int n, double chg[], double cellsize[3], double bs[], double bc[]);
void MR3calcewald_idft_eng_host(int k[], double bs[], double bc[], int knum, double x[], int n, double cellsize[3], double force[]);
void MR3calcewald_idft_force_host(int k[], double bs[], double bc[], int knum, double x[], int n, double cellsize[3], double force[]);
void MR3calcewald_host(int *k, int knum_org, double *x, int n, double *chg, double alpha, double epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_host__(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_host_(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void MR3SetTable(char *filename, int tblno, int flag);
void mr3settable_nf_(char *fname, int *tblno, int *flag, int *n);
void mr3settable_nf__(char *fname, int *tblno, int *flag, int *n);
void MR3_setup_exlist(int n, int *bckptr);
void mr3_setup_exlist_(int *n, int *bckptr);
void MR3_make_natex2_from_natex(int n, int natex[], int numex[], int **natex_offset, int **natex2, int **numex2, int **natex2_offset, int flag);
void calccoulomb_vdw_ij_exlist_host_sub(int i, int j, double xi[], double xj[], double qj, double gsf, double gsp, double rs, double rscale, double cutoff, double *fc, double *fv, double *pc, double *pv, int tblno, double size[3], int potflag);
void MR3calccoulomb_vdw_ij_exlist_cutoff_host(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double cutoff, double size[3], double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_host(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_host2(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_host_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_host__(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void MR3_get_cputime(double *laptime, double *sprittime);
void MR3_set_ldim(int ldim[3]);
void mr3_set_ldim_(int ldim[3]);
void mr3_set_ldim__(int ldim[3]);
void MR3_set_coulomb_vdw_factor(double cgf);
void mr3_set_coulomb_vdw_factor_(double *cgf);
void mr3_set_coulomb_vdw_factor__(double *cgf);
void MR3calccoulomb_ij_emu(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag);
void MR3calccoulomb_nlist_ij_emu(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calccoulomb_nlist_emu(double xd[], int n, double qd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calcvdw_ij_emu(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void MR3calccoulomb_vdw_nlist_ij_emu(int ni, double xid[], double qid[], int atypei[], double force[], int nj, double xjd[], double qjd[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblno, double volume[], int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_ij_emu(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_emu2(double xd[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calccoulomb_ij_exlist(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void mr3calccoulomb_ij_exlist_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag, int numexorg[], int natexorg[]);
void mr3calccoulomb_ij_exlist__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag, int numexorg[], int natexorg[]);
void MR3calcvdw_ij_exlist(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void mr3calcvdw_ij_exlist_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int numex[], int natex[]);
void mr3calcvdw_ij_exlist__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_core_old(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_core(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_virial_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_exlist(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double volume1, double *potc, double *potv, int *convert_index, int potflag, int flag);
void MR3calccoulomb_vdw_exlist_from_cell(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double volume1, double *potc, double *potv, int *convert_index, int potflag, int flag);
void mr3calccoulomb_vdw_exlist_(int *n, double x[], double q[], int atype[], int *nat, double force[], double *rscale, double gscalesf[], double gscalesp[], double rscales[], int *tblno, int numex[], int natex[], double *volume1, double *potc, double *potv, int *convert_index, int *potflag, int *flag);
void MR3_get_forces_overlap(double force[]);
void mr3_get_forces_overlap_(double force[]);
void MR3_get_potc_and_potv_overlap(double *potc, double *potv);
void mr3_get_potc_and_potv_overlap_(double *potc, double *potv);
void mr3_get_potc_and_potv_overlap__(double *potc, double *potv);
void MR3_get_forces_and_virial_overlap(double force[], double virial[3][3]);
void mr3_get_forces_and_virial_overlap_(double force[], double virial[3][3]);
void MR3calccoulomb_ci_exlist(int n, double x[], double q[], double force[], double rscale, int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], int *convert_index, int flag);
void mr3calccoulomb_ci_exlist_(int *n, double x[], double q[], double force[], double *rscale, int *tblno, int numex[], int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], int *convert_index, int *flag);
void MR3calcvdw_ci(int n, double x[], int atype[], int nat, double force[], double gscales[], double rscales[], int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calcvdw_ci_(int *n, double x[], int atype[], int *nat, double force[], double gscales[], double rscales[], int *tblno, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calcvdw_ci_exlist(int n, double x[], int atype[], int nat, double force[], double gscales[], double rscales[], int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], int *convert_index, int flag);
void mr3calcvdw_ci_exlist_(int *n, double x[], int atype[], int *nat, double force[], double gscales[], double rscales[], int *tblno, int numex[], int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], int *convert_index, int *flag);
void MR3calccoulomb_vdw_ci_exlist(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], double *potc, double *potv, int *convert_index, int potflag, int flag);
void mr3calccoulomb_vdw_ci_exlist_(int *n, double x[], double q[], int atype[], int *nat, double force[], double *rscale, double gscalesf[], double gscalesp[], double rscales[], int *tblno, int *numex, int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], double *potc, double *potv, int *convert_index, int *potflag, int *flag);
void MR3calccoulomb_ci(int n, double x[], double q[], double force[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calccoulomb_ci_(int *n, double x[], double q[], double force[], double *rscale, int *tblno, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_ij_ci(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_ij_ci_old(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calcvdw_ij_ci(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_virial(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut_org, double skinnb, double volume[3], int ldim[3], double virial[3][3], int flag);
void MR3calccoulomb_vdw_ij_ci(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calccoulomb_vdw_ij_ci_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscales[], double rscales[], double *rscale, int *tblnoc, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_old_09(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_old_090121(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_exlist(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3], int numex[], int natex[], int flag);
void mr3calccoulomb_vdw_ij_ci_exlist_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscales[], double rscales[], double *rscale, int *tblnoc, double *rcut, double *skinnb, double volume[3], int ldim[3], int numex[], int natex[], int *flag);
void MR3_get_board_version(int *version, int *freq);
void MR3_rscale_and_pack(int n, double (*x)[3], int *atype, longlong (*rj)[2]);
void MR3_rscale_and_pack_old(int n, double (*x)[3], int *atype, longlong (*rj)[2]);
void MR3SetTable_emu(char *filename, int tblno, int flag);
int MR3_get_total_num_chips(void);
void MR3print_chip_temperature(int flag);
int MR3_get_retry_count(void);
void m3_free_unit(VG_UNIT *unit);
VG_UNIT *m3_allocate_periodic_unit(const char *fname, int mode, double size, int dum);
void m3_set_positions(VG_UNIT *unit, double (*pos)[3], int n);
void m3_set_charges(VG_UNIT *unit, const double *q, int n);
void m3_set_cells(VG_UNIT *unit, M3_CELL *cell, int ncell);
void m3_calculate_forces(VG_UNIT *unit, double (*xi)[3], int ni, double (*force)[3]);
void m3_calculate_potentials(VG_UNIT *unit, double (*xi)[3], int ni, double *eng);
void m3_set_types(VG_UNIT *unit, const int *atype, int n);
void m3_set_pipeline_types(VG_UNIT *unit, const int *atype, int n);
void m3_set_charge_matrix(VG_UNIT *unit, const double *gscale, int nati, int natj);
void m3_set_rscale_matrix(VG_UNIT *unit, const double *rscale, int nati, int natj);
int MR3_close_ch(int s_sock);
int mr3_close_ch_(int *s_sock);
int MR3_open_port(int port_number);
int MR3_sock_read(int sockfd, char *buf, size_t count);
int mr3_sock_read_(int *sockfd, char *buf, int *count);
int mr3_sock_read__(int *sockfd, char *buf, int *count);
int mr3_sock_read_i_(int *sockfd, int *buf);
int mr3_sock_read_i__(int *sockfd, int *buf);
int MR3_sock_read_iv(int sockfd, int *buf, int count);
int mr3_sock_read_iv_(int *sockfd, int *buf, int *count);
int mr3_sock_read_iv__(int *sockfd, int *buf, int *count);
int MR3_sock_read_d(int sockfd, double *buf);
int mr3_sock_read_d__(int *sockfd, double *buf);
int mr3_sock_read_d_(int *sockfd, double *buf);
int MR3_sock_read_dv(int sockfd, double *buf, int count);
int mr3_sock_read_dv__(int *sockfd, double *buf, int *count);
int mr3_sock_read_dv_(int *sockfd, double *buf, int *count);
int MR3_sock_write(int sockfd, char *buf, size_t count);
int MR3_sock_write_c(int sockfd, char *buf);
int mr3_sock_write_c_(int *sockfd, char *buf);
int mr3_sock_write_c__(int *sockfd, char *buf);
int MR3_sock_write_i(int sockfd, int buf);
int mr3_sock_write_i_(int *sockfd, int *buf);
int mr3_sock_write_i__(int *sockfd, int *buf);
int MR3_sock_write_iv(int sockfd, int *buf, int count);
int mr3_sock_write_iv_(int *sockfd, int *buf, int *count);
int mr3_sock_write_iv__(int *sockfd, int *buf, int *count);
int MR3_sock_write_dv(int sockfd, double *buf, int count);
int mr3_sock_write_dv__(int *sockfd, double *buf, int *count);
int mr3_sock_write_dv_(int *sockfd, double *buf, int *count);
int MR3_sock_gets(int sockfd, char *str, size_t count);
int MR3_sock_puts(int sockfd, char *str);
void MR3_sock_init(int *s_sock_org, int port_num, double x[], int igraph[], int natom, int str_len, int lbres[], int ipres[], int nres);
void mr3_sock_init_(int *s_sock, int *port_num, double x[], int igraph[], int *natom, int *str_len, int lbres[], int ipres[], int *nres);
void mr3_sock_init__(int *s_sock, int *port_num, double x[], int igraph[], int *natom, int *str_len, int lbres[], int ipres[], int *nres);
void MR3_sock_1step(int s_sock, double t1, double time, double t2, int recv_buf[], int natom, double x[], double f[], double f_temp[]);
void mr3_sock_1step_(int *s_sock, double *t1, double *time, double *t2, int recv_buf[], int *natom, double x[], double f[], double f_tmp[]);
void mr3_sock_1step__(int *s_sock, double *t1, double *time, double *t2, int recv_buf[], int *natom, double x[], double f[], double f_tmp[]);
void MR3calc_ij_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, char method);
void MR3calc_ij_exlist_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], char method);
void MR3calc_ij_nlist_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], char method);
/* vtgrape.c */
void *MR3_my_malloc2(size_t n, char *s);
void MR3_my_free2(void **p, char *s);
VG_UNIT *m3_get_unit(void);
void vg_exit(int ret);
VG_UNIT *vg_allocate_unit(void (*function)(void *));
void vg_free_unit(VG_UNIT *unit);
void vg_set_function(VG_UNIT *unit, int function_index, void (*function)(void *));
void vg_set_vectors(VG_UNIT *unit, int nj, void *jvectors);
void vg_set_matrices(VG_UNIT *unit, int nati, int natj, void *matrices);
void vg_set_scalers(VG_UNIT *unit, void *scalers);
void vg_set_pipeline_vectors(VG_UNIT *unit, int ni, void *ivectors);
void vg_calculate(VG_UNIT *unit, int function_index, int nf, void *fvectors, void *pscalers);
void vg_set_vectors_pos_charge_atype(VG_UNIT *unit, int nj, double pos[][3], double charge[], int atype[]);
void vg_set_vectors_pos_charge(VG_UNIT *unit, int nj, double pos[][3], double charge[]);
void vg_set_vectors_pos_atype(VG_UNIT *unit, int nj, double pos[][3], int atype[]);
void vg_set_matrices_gscales_rscales(VG_UNIT *unit, int nati_org, int natj_org, double gscales[], double rscales[]);
void vg_set_pol_sigm_ipotro_pc_pd_zz(VG_UNIT *unit, int nati, int natj, double pol[], double sigm[], double ipotro[], double pc[], double pd[], double zz[]);
void vg_set_scalers_volume_alpha(VG_UNIT *unit, double volume[3], double alpha);
void vg_set_pipeline_vectors_pos_charge_atype(VG_UNIT *unit, int ni, double pos[][3], double charge[], int atype[]);
void vg_set_pipeline_vectors_pos_charge(VG_UNIT *unit, int ni, double pos[][3], double charge[]);
void vg_set_pipeline_vectors_pos_atype(VG_UNIT *unit, int ni, double pos[][3], int atype[]);
void vg_convert_forces(VG_UNIT *unit, int nf, int function_index, double fi[][3]);
void vg_calculate_forces_potentials(VG_UNIT *unit, int function_index, int nf, double fi[][3], double *potc, double *potv);
void vg_get_r1result(int n_org, float r[], float r1[]);
void vg_get_rsqrtresult(int n_org, float r[], float r1[]);
void vg_get_mulresult(int n_org, float r[], float q[], float rq[]);
int vg_write_emufile(int flag);
void vg_initialize_emu(void);
float vg_r1emu(float x);
float vg_rsqrtemu(float x);
void vg_set_scaleq(int n, double q[], double *scaleq, float *scaleq_1);
void m3_set_softening(VG_UNIT *unit, double eps);
void MR3_exit(int ret);
void MR3init(void);
void mr3init_(void);
void mr3init__(void);
void MR3free(void);
void mr3free_(void);
void mr3free__(void);
void MR3calccoulomb(double x[], int n, double q[], double rscale, int tblno, double xmax, int periodicflag, int natchangeflag, double force[]);
void mr3calccoulomb_(double x[], int *n, double q[], double *rscale, int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void mr3calccoulomb__(double x[], int *n, double q[], double *rscale, int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void MR3calccoulomb_ij(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag);
void mr3calccoulomb_ij_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void mr3calccoulomb_ij__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void MR3_sort_with_index_int(int data[], int index[], int left, int right);
void MR3calcvdw_ij_core(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void MR3calcvdw_ij(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void mr3calcvdw_ij_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void mr3calcvdw_ij__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void MR3calcvdw(double x[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int natchangeflag, double force[]);
void mr3calcvdw_(double x[], int *n, int atype[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void mr3calcvdw__(double x[], int *n, int atype[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void MR3calcewald(int *k, int knum_org, double *x, int n, double *chg, double alpha, double epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald__(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void MR3calcnacl(double x[], int n, int atype[], int nat, double pol[], double sigm[], double ipotro[], double pc[], double pd[], double zz[], int tblno, double xmax, int periodicflag, double force[]);
void vtgrape_force(double xj[][3], double mj[], double xi[][3], double eps2, double a[][3], int ni, int nj);
void vg_set_rcut2(VG_UNIT *unit, double rcut2);
void mr3_set_rcut2_(double *rcut2);
int md5sum(unsigned char *buffer, int totallen, unsigned char sum[16]);
int md5sum_file(char *filename, unsigned char sum[16]);
void MR3calccoulomb_ij_host(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag);
void mr3calccoulomb_ij_host_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void mr3calccoulomb_ij_host__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void MR3calcvdw_ij_host(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void mr3calcvdw_ij_host_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void mr3calcvdw_ij_host__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void MR3calccoulomb_nlist_ij_host_notwork(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[], double factorall);
void MR3calccoulomb_nlist_ij_host(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calccoulomb_nlist_host(double xd[], int n, double qd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calcvdw_nlist_ij_host_notwork(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[], double factor);
void MR3calcvdw_nlist_ij_host(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_host2(double x[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[], double factor, double force[]);
void MR3calccoulomb_ij_exlist_host(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void MR3calcvdw_ij_exlist_host(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void MR3calcewald_dft_host(int k[], int knum, double x[], int n, double chg[], double cellsize[3], double bs[], double bc[]);
void MR3calcewald_idft_eng_host(int k[], double bs[], double bc[], int knum, double x[], int n, double cellsize[3], double force[]);
void MR3calcewald_idft_force_host(int k[], double bs[], double bc[], int knum, double x[], int n, double cellsize[3], double force[]);
void MR3calcewald_host(int *k, int knum_org, double *x, int n, double *chg, double alpha, double epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_host__(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_host_(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void MR3SetTable(char *filename, int tblno, int flag);
void mr3settable_nf_(char *fname, int *tblno, int *flag, int *n);
void mr3settable_nf__(char *fname, int *tblno, int *flag, int *n);
void MR3_setup_exlist(int n, int *bckptr);
void mr3_setup_exlist_(int *n, int *bckptr);
void MR3_make_natex2_from_natex(int n, int natex[], int numex[], int **natex_offset, int **natex2, int **numex2, int **natex2_offset, int flag);
void calccoulomb_vdw_ij_exlist_host_sub(int i, int j, double xi[], double xj[], double qj, double gsf, double gsp, double rs, double rscale, double cutoff, double *fc, double *fv, double *pc, double *pv, int tblno, double size[3], int potflag);
void MR3calccoulomb_vdw_ij_exlist_cutoff_host(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double cutoff, double size[3], double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_host(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_host2(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_host_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_host__(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void MR3_get_cputime(double *laptime, double *sprittime);
void MR3_set_ldim(int ldim[3]);
void mr3_set_ldim_(int ldim[3]);
void mr3_set_ldim__(int ldim[3]);
void MR3_set_coulomb_vdw_factor(double cgf);
void mr3_set_coulomb_vdw_factor_(double *cgf);
void mr3_set_coulomb_vdw_factor__(double *cgf);
void MR3calccoulomb_ij_emu(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag);
void MR3calccoulomb_nlist_ij_emu(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calccoulomb_nlist_emu(double xd[], int n, double qd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calcvdw_ij_emu(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void MR3calccoulomb_vdw_nlist_ij_emu(int ni, double xid[], double qid[], int atypei[], double force[], int nj, double xjd[], double qjd[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblno, double volume[], int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_ij_emu(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_emu2(double xd[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calccoulomb_ij_exlist(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void mr3calccoulomb_ij_exlist_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag, int numexorg[], int natexorg[]);
void mr3calccoulomb_ij_exlist__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag, int numexorg[], int natexorg[]);
void MR3calcvdw_ij_exlist(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void mr3calcvdw_ij_exlist_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int numex[], int natex[]);
void mr3calcvdw_ij_exlist__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_core_old(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_core(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_virial_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_exlist(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double volume1, double *potc, double *potv, int *convert_index, int potflag, int flag);
void MR3calccoulomb_vdw_exlist_from_cell(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double volume1, double *potc, double *potv, int *convert_index, int potflag, int flag);
void mr3calccoulomb_vdw_exlist_(int *n, double x[], double q[], int atype[], int *nat, double force[], double *rscale, double gscalesf[], double gscalesp[], double rscales[], int *tblno, int numex[], int natex[], double *volume1, double *potc, double *potv, int *convert_index, int *potflag, int *flag);
void MR3_get_forces_overlap(double force[]);
void mr3_get_forces_overlap_(double force[]);
void MR3_get_potc_and_potv_overlap(double *potc, double *potv);
void mr3_get_potc_and_potv_overlap_(double *potc, double *potv);
void mr3_get_potc_and_potv_overlap__(double *potc, double *potv);
void MR3_get_forces_and_virial_overlap(double force[], double virial[3][3]);
void mr3_get_forces_and_virial_overlap_(double force[], double virial[3][3]);
void MR3calccoulomb_ci_exlist(int n, double x[], double q[], double force[], double rscale, int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], int *convert_index, int flag);
void mr3calccoulomb_ci_exlist_(int *n, double x[], double q[], double force[], double *rscale, int *tblno, int numex[], int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], int *convert_index, int *flag);
void MR3calcvdw_ci(int n, double x[], int atype[], int nat, double force[], double gscales[], double rscales[], int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calcvdw_ci_(int *n, double x[], int atype[], int *nat, double force[], double gscales[], double rscales[], int *tblno, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calcvdw_ci_exlist(int n, double x[], int atype[], int nat, double force[], double gscales[], double rscales[], int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], int *convert_index, int flag);
void mr3calcvdw_ci_exlist_(int *n, double x[], int atype[], int *nat, double force[], double gscales[], double rscales[], int *tblno, int numex[], int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], int *convert_index, int *flag);
void MR3calccoulomb_vdw_ci_exlist(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], double *potc, double *potv, int *convert_index, int potflag, int flag);
void mr3calccoulomb_vdw_ci_exlist_(int *n, double x[], double q[], int atype[], int *nat, double force[], double *rscale, double gscalesf[], double gscalesp[], double rscales[], int *tblno, int *numex, int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], double *potc, double *potv, int *convert_index, int *potflag, int *flag);
void MR3calccoulomb_ci(int n, double x[], double q[], double force[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calccoulomb_ci_(int *n, double x[], double q[], double force[], double *rscale, int *tblno, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_ij_ci(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_ij_ci_old(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calcvdw_ij_ci(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_virial(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut_org, double skinnb, double volume[3], int ldim[3], double virial[3][3], int flag);
void MR3calccoulomb_vdw_ij_ci(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calccoulomb_vdw_ij_ci_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscales[], double rscales[], double *rscale, int *tblnoc, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_old_09(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_old_090121(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_exlist(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3], int numex[], int natex[], int flag);
void mr3calccoulomb_vdw_ij_ci_exlist_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscales[], double rscales[], double *rscale, int *tblnoc, double *rcut, double *skinnb, double volume[3], int ldim[3], int numex[], int natex[], int *flag);
void MR3_get_board_version(int *version, int *freq);
void MR3_rscale_and_pack(int n, double (*x)[3], int *atype, longlong (*rj)[2]);
void MR3_rscale_and_pack_old(int n, double (*x)[3], int *atype, longlong (*rj)[2]);
void MR3SetTable_emu(char *filename, int tblno, int flag);
int MR3_get_total_num_chips(void);
void MR3print_chip_temperature(int flag);
int MR3_get_retry_count(void);
void m3_free_unit(VG_UNIT *unit);
VG_UNIT *m3_allocate_periodic_unit(const char *fname, int mode, double size, int dum);
void m3_set_positions(VG_UNIT *unit, double (*pos)[3], int n);
void m3_set_charges(VG_UNIT *unit, const double *q, int n);
void m3_set_cells(VG_UNIT *unit, M3_CELL *cell, int ncell);
void m3_calculate_forces(VG_UNIT *unit, double (*xi)[3], int ni, double (*force)[3]);
void m3_calculate_potentials(VG_UNIT *unit, double (*xi)[3], int ni, double *eng);
void m3_set_types(VG_UNIT *unit, const int *atype, int n);
void m3_set_pipeline_types(VG_UNIT *unit, const int *atype, int n);
void m3_set_charge_matrix(VG_UNIT *unit, const double *gscale, int nati, int natj);
void m3_set_rscale_matrix(VG_UNIT *unit, const double *rscale, int nati, int natj);
int MR3_close_ch(int s_sock);
int mr3_close_ch_(int *s_sock);
int MR3_open_port(int port_number);
int MR3_sock_read(int sockfd, char *buf, size_t count);
int mr3_sock_read_(int *sockfd, char *buf, int *count);
int mr3_sock_read__(int *sockfd, char *buf, int *count);
int mr3_sock_read_i_(int *sockfd, int *buf);
int mr3_sock_read_i__(int *sockfd, int *buf);
int MR3_sock_read_iv(int sockfd, int *buf, int count);
int mr3_sock_read_iv_(int *sockfd, int *buf, int *count);
int mr3_sock_read_iv__(int *sockfd, int *buf, int *count);
int MR3_sock_read_d(int sockfd, double *buf);
int mr3_sock_read_d__(int *sockfd, double *buf);
int mr3_sock_read_d_(int *sockfd, double *buf);
int MR3_sock_read_dv(int sockfd, double *buf, int count);
int mr3_sock_read_dv__(int *sockfd, double *buf, int *count);
int mr3_sock_read_dv_(int *sockfd, double *buf, int *count);
int MR3_sock_write(int sockfd, char *buf, size_t count);
int MR3_sock_write_c(int sockfd, char *buf);
int mr3_sock_write_c_(int *sockfd, char *buf);
int mr3_sock_write_c__(int *sockfd, char *buf);
int MR3_sock_write_i(int sockfd, int buf);
int mr3_sock_write_i_(int *sockfd, int *buf);
int mr3_sock_write_i__(int *sockfd, int *buf);
int MR3_sock_write_iv(int sockfd, int *buf, int count);
int mr3_sock_write_iv_(int *sockfd, int *buf, int *count);
int mr3_sock_write_iv__(int *sockfd, int *buf, int *count);
int MR3_sock_write_dv(int sockfd, double *buf, int count);
int mr3_sock_write_dv__(int *sockfd, double *buf, int *count);
int mr3_sock_write_dv_(int *sockfd, double *buf, int *count);
int MR3_sock_gets(int sockfd, char *str, size_t count);
int MR3_sock_puts(int sockfd, char *str);
void MR3_sock_init(int *s_sock_org, int port_num, double x[], int igraph[], int natom, int str_len, int lbres[], int ipres[], int nres);
void mr3_sock_init_(int *s_sock, int *port_num, double x[], int igraph[], int *natom, int *str_len, int lbres[], int ipres[], int *nres);
void mr3_sock_init__(int *s_sock, int *port_num, double x[], int igraph[], int *natom, int *str_len, int lbres[], int ipres[], int *nres);
void MR3_sock_1step(int s_sock, double t1, double time, double t2, int recv_buf[], int natom, double x[], double f[], double f_temp[]);
void mr3_sock_1step_(int *s_sock, double *t1, double *time, double *t2, int recv_buf[], int *natom, double x[], double f[], double f_tmp[]);
void mr3_sock_1step__(int *s_sock, double *t1, double *time, double *t2, int recv_buf[], int *natom, double x[], double f[], double f_tmp[]);
void MR3calc_ij_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, char method);
void MR3calc_ij_exlist_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], char method);
void MR3calc_ij_nlist_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], char method);
/* vtgrape.c */
void *MR3_my_malloc2(size_t n, char *s);
void MR3_my_free2(void **p, char *s);
VG_UNIT *m3_get_unit(void);
void vg_exit(int ret);
VG_UNIT *vg_allocate_unit(void (*function)(void *));
void vg_free_unit(VG_UNIT *unit);
void vg_set_function(VG_UNIT *unit, int function_index, void (*function)(void *));
void vg_set_vectors(VG_UNIT *unit, int nj, void *jvectors);
void vg_set_matrices(VG_UNIT *unit, int nati, int natj, void *matrices);
void vg_set_scalers(VG_UNIT *unit, void *scalers);
void vg_set_pipeline_vectors(VG_UNIT *unit, int ni, void *ivectors);
void vg_calculate(VG_UNIT *unit, int function_index, int nf, void *fvectors, void *pscalers);
void vg_set_vectors_pos_charge_atype(VG_UNIT *unit, int nj, double pos[][3], double charge[], int atype[]);
void vg_set_vectors_pos_charge(VG_UNIT *unit, int nj, double pos[][3], double charge[]);
void vg_set_vectors_pos_atype(VG_UNIT *unit, int nj, double pos[][3], int atype[]);
void vg_set_matrices_gscales_rscales(VG_UNIT *unit, int nati_org, int natj_org, double gscales[], double rscales[]);
void vg_set_pol_sigm_ipotro_pc_pd_zz(VG_UNIT *unit, int nati, int natj, double pol[], double sigm[], double ipotro[], double pc[], double pd[], double zz[]);
void vg_set_scalers_volume_alpha(VG_UNIT *unit, double volume[3], double alpha);
void vg_set_pipeline_vectors_pos_charge_atype(VG_UNIT *unit, int ni, double pos[][3], double charge[], int atype[]);
void vg_set_pipeline_vectors_pos_charge(VG_UNIT *unit, int ni, double pos[][3], double charge[]);
void vg_set_pipeline_vectors_pos_atype(VG_UNIT *unit, int ni, double pos[][3], int atype[]);
void vg_convert_forces(VG_UNIT *unit, int nf, int function_index, double fi[][3]);
void vg_calculate_forces_potentials(VG_UNIT *unit, int function_index, int nf, double fi[][3], double *potc, double *potv);
void vg_get_r1result(int n_org, float r[], float r1[]);
void vg_get_rsqrtresult(int n_org, float r[], float r1[]);
void vg_get_mulresult(int n_org, float r[], float q[], float rq[]);
int vg_write_emufile(int flag);
void vg_initialize_emu(void);
float vg_r1emu(float x);
float vg_rsqrtemu(float x);
void vg_set_scaleq(int n, double q[], double *scaleq, float *scaleq_1);
void m3_set_softening(VG_UNIT *unit, double eps);
void MR3_exit(int ret);
void MR3init(void);
void mr3init_(void);
void mr3init__(void);
void MR3free(void);
void mr3free_(void);
void mr3free__(void);
void MR3calccoulomb(double x[], int n, double q[], double rscale, int tblno, double xmax, int periodicflag, int natchangeflag, double force[]);
void mr3calccoulomb_(double x[], int *n, double q[], double *rscale, int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void mr3calccoulomb__(double x[], int *n, double q[], double *rscale, int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void MR3calccoulomb_ij(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag);
void mr3calccoulomb_ij_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void mr3calccoulomb_ij__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void MR3_sort_with_index_int(int data[], int index[], int left, int right);
void MR3calcvdw_ij_core(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void MR3calcvdw_ij(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void mr3calcvdw_ij_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void mr3calcvdw_ij__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void MR3calcvdw(double x[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int natchangeflag, double force[]);
void mr3calcvdw_(double x[], int *n, int atype[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void mr3calcvdw__(double x[], int *n, int atype[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void MR3calcewald(int *k, int knum_org, double *x, int n, double *chg, double alpha, double epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald__(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void MR3calcnacl(double x[], int n, int atype[], int nat, double pol[], double sigm[], double ipotro[], double pc[], double pd[], double zz[], int tblno, double xmax, int periodicflag, double force[]);
void vtgrape_force(double xj[][3], double mj[], double xi[][3], double eps2, double a[][3], int ni, int nj);
void vg_set_rcut2(VG_UNIT *unit, double rcut2);
void mr3_set_rcut2_(double *rcut2);
int md5sum(unsigned char *buffer, int totallen, unsigned char sum[16]);
int md5sum_file(char *filename, unsigned char sum[16]);
void MR3calccoulomb_ij_host(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag);
void mr3calccoulomb_ij_host_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void mr3calccoulomb_ij_host__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void MR3calcvdw_ij_host(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void mr3calcvdw_ij_host_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void mr3calcvdw_ij_host__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void MR3calccoulomb_nlist_ij_host_notwork(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[], double factorall);
void MR3calccoulomb_nlist_ij_host(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calccoulomb_nlist_host(double xd[], int n, double qd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calcvdw_nlist_ij_host_notwork(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[], double factor);
void MR3calcvdw_nlist_ij_host(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_host2(double x[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[], double factor, double force[]);
void MR3calccoulomb_ij_exlist_host(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void MR3calcvdw_ij_exlist_host(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void MR3calcewald_dft_host(int k[], int knum, double x[], int n, double chg[], double cellsize[3], double bs[], double bc[]);
void MR3calcewald_idft_eng_host(int k[], double bs[], double bc[], int knum, double x[], int n, double cellsize[3], double force[]);
void MR3calcewald_idft_force_host(int k[], double bs[], double bc[], int knum, double x[], int n, double cellsize[3], double force[]);
void MR3calcewald_host(int *k, int knum_org, double *x, int n, double *chg, double alpha, double epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_host__(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_host_(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void MR3SetTable(char *filename, int tblno, int flag);
void mr3settable_nf_(char *fname, int *tblno, int *flag, int *n);
void mr3settable_nf__(char *fname, int *tblno, int *flag, int *n);
void MR3_setup_exlist(int n, int *bckptr);
void mr3_setup_exlist_(int *n, int *bckptr);
void MR3_make_natex2_from_natex(int n, int natex[], int numex[], int **natex_offset, int **natex2, int **numex2, int **natex2_offset, int flag);
void calccoulomb_vdw_ij_exlist_host_sub(int i, int j, double xi[], double xj[], double qj, double gsf, double gsp, double rs, double rscale, double cutoff, double *fc, double *fv, double *pc, double *pv, int tblno, double size[3], int potflag);
void MR3calccoulomb_vdw_ij_exlist_cutoff_host(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double cutoff, double size[3], double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_host(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_host2(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_host_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_host__(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void MR3_get_cputime(double *laptime, double *sprittime);
void MR3_set_ldim(int ldim[3]);
void mr3_set_ldim_(int ldim[3]);
void mr3_set_ldim__(int ldim[3]);
void MR3_set_coulomb_vdw_factor(double cgf);
void mr3_set_coulomb_vdw_factor_(double *cgf);
void mr3_set_coulomb_vdw_factor__(double *cgf);
void MR3calccoulomb_ij_emu(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag);
void MR3calccoulomb_nlist_ij_emu(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calccoulomb_nlist_emu(double xd[], int n, double qd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calcvdw_ij_emu(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void MR3calccoulomb_vdw_nlist_ij_emu(int ni, double xid[], double qid[], int atypei[], double force[], int nj, double xjd[], double qjd[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblno, double volume[], int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_ij_emu(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_emu2(double xd[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calccoulomb_ij_exlist(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void mr3calccoulomb_ij_exlist_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag, int numexorg[], int natexorg[]);
void mr3calccoulomb_ij_exlist__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag, int numexorg[], int natexorg[]);
void MR3calcvdw_ij_exlist(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void mr3calcvdw_ij_exlist_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int numex[], int natex[]);
void mr3calcvdw_ij_exlist__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_core_old(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_core(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_virial_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_exlist(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double volume1, double *potc, double *potv, int *convert_index, int potflag, int flag);
void MR3calccoulomb_vdw_exlist_from_cell(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double volume1, double *potc, double *potv, int *convert_index, int potflag, int flag);
void mr3calccoulomb_vdw_exlist_(int *n, double x[], double q[], int atype[], int *nat, double force[], double *rscale, double gscalesf[], double gscalesp[], double rscales[], int *tblno, int numex[], int natex[], double *volume1, double *potc, double *potv, int *convert_index, int *potflag, int *flag);
void MR3_get_forces_overlap(double force[]);
void mr3_get_forces_overlap_(double force[]);
void MR3_get_potc_and_potv_overlap(double *potc, double *potv);
void mr3_get_potc_and_potv_overlap_(double *potc, double *potv);
void mr3_get_potc_and_potv_overlap__(double *potc, double *potv);
void MR3_get_forces_and_virial_overlap(double force[], double virial[3][3]);
void mr3_get_forces_and_virial_overlap_(double force[], double virial[3][3]);
void MR3calccoulomb_ci_exlist(int n, double x[], double q[], double force[], double rscale, int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], int *convert_index, int flag);
void mr3calccoulomb_ci_exlist_(int *n, double x[], double q[], double force[], double *rscale, int *tblno, int numex[], int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], int *convert_index, int *flag);
void MR3calcvdw_ci(int n, double x[], int atype[], int nat, double force[], double gscales[], double rscales[], int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calcvdw_ci_(int *n, double x[], int atype[], int *nat, double force[], double gscales[], double rscales[], int *tblno, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calcvdw_ci_exlist(int n, double x[], int atype[], int nat, double force[], double gscales[], double rscales[], int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], int *convert_index, int flag);
void mr3calcvdw_ci_exlist_(int *n, double x[], int atype[], int *nat, double force[], double gscales[], double rscales[], int *tblno, int numex[], int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], int *convert_index, int *flag);
void MR3calccoulomb_vdw_ci_exlist(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], double *potc, double *potv, int *convert_index, int potflag, int flag);
void mr3calccoulomb_vdw_ci_exlist_(int *n, double x[], double q[], int atype[], int *nat, double force[], double *rscale, double gscalesf[], double gscalesp[], double rscales[], int *tblno, int *numex, int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], double *potc, double *potv, int *convert_index, int *potflag, int *flag);
void MR3calccoulomb_ci(int n, double x[], double q[], double force[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calccoulomb_ci_(int *n, double x[], double q[], double force[], double *rscale, int *tblno, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_ij_ci(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_ij_ci_old(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calcvdw_ij_ci(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_virial(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut_org, double skinnb, double volume[3], int ldim[3], double virial[3][3], int flag);
void MR3calccoulomb_vdw_ij_ci(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calccoulomb_vdw_ij_ci_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscales[], double rscales[], double *rscale, int *tblnoc, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_old_09(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_old_090121(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_exlist(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3], int numex[], int natex[], int flag);
void mr3calccoulomb_vdw_ij_ci_exlist_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscales[], double rscales[], double *rscale, int *tblnoc, double *rcut, double *skinnb, double volume[3], int ldim[3], int numex[], int natex[], int *flag);
void MR3_get_board_version(int *version, int *freq);
void MR3_rscale_and_pack(int n, double (*x)[3], int *atype, longlong (*rj)[2]);
void MR3_rscale_and_pack_old(int n, double (*x)[3], int *atype, longlong (*rj)[2]);
void MR3SetTable_emu(char *filename, int tblno, int flag);
int MR3_get_total_num_chips(void);
void MR3print_chip_temperature(int flag);
int MR3_get_retry_count(void);
void m3_free_unit(VG_UNIT *unit);
VG_UNIT *m3_allocate_periodic_unit(const char *fname, int mode, double size, int dum);
void m3_set_positions(VG_UNIT *unit, double (*pos)[3], int n);
void m3_set_charges(VG_UNIT *unit, const double *q, int n);
void m3_set_cells(VG_UNIT *unit, M3_CELL *cell, int ncell);
void m3_calculate_forces(VG_UNIT *unit, double (*xi)[3], int ni, double (*force)[3]);
void m3_calculate_potentials(VG_UNIT *unit, double (*xi)[3], int ni, double *eng);
void m3_set_types(VG_UNIT *unit, const int *atype, int n);
void m3_set_pipeline_types(VG_UNIT *unit, const int *atype, int n);
void m3_set_charge_matrix(VG_UNIT *unit, const double *gscale, int nati, int natj);
void m3_set_rscale_matrix(VG_UNIT *unit, const double *rscale, int nati, int natj);
int MR3_close_ch(int s_sock);
int mr3_close_ch_(int *s_sock);
int MR3_open_port(int port_number);
int MR3_sock_read(int sockfd, char *buf, size_t count);
int mr3_sock_read_(int *sockfd, char *buf, int *count);
int mr3_sock_read__(int *sockfd, char *buf, int *count);
int mr3_sock_read_i_(int *sockfd, int *buf);
int mr3_sock_read_i__(int *sockfd, int *buf);
int MR3_sock_read_iv(int sockfd, int *buf, int count);
int mr3_sock_read_iv_(int *sockfd, int *buf, int *count);
int mr3_sock_read_iv__(int *sockfd, int *buf, int *count);
int MR3_sock_read_d(int sockfd, double *buf);
int mr3_sock_read_d__(int *sockfd, double *buf);
int mr3_sock_read_d_(int *sockfd, double *buf);
int MR3_sock_read_dv(int sockfd, double *buf, int count);
int mr3_sock_read_dv__(int *sockfd, double *buf, int *count);
int mr3_sock_read_dv_(int *sockfd, double *buf, int *count);
int MR3_sock_write(int sockfd, char *buf, size_t count);
int MR3_sock_write_c(int sockfd, char *buf);
int mr3_sock_write_c_(int *sockfd, char *buf);
int mr3_sock_write_c__(int *sockfd, char *buf);
int MR3_sock_write_i(int sockfd, int buf);
int mr3_sock_write_i_(int *sockfd, int *buf);
int mr3_sock_write_i__(int *sockfd, int *buf);
int MR3_sock_write_iv(int sockfd, int *buf, int count);
int mr3_sock_write_iv_(int *sockfd, int *buf, int *count);
int mr3_sock_write_iv__(int *sockfd, int *buf, int *count);
int MR3_sock_write_dv(int sockfd, double *buf, int count);
int mr3_sock_write_dv__(int *sockfd, double *buf, int *count);
int mr3_sock_write_dv_(int *sockfd, double *buf, int *count);
int MR3_sock_gets(int sockfd, char *str, size_t count);
int MR3_sock_puts(int sockfd, char *str);
void MR3_sock_init(int *s_sock_org, int port_num, double x[], int igraph[], int natom, int str_len, int lbres[], int ipres[], int nres);
void mr3_sock_init_(int *s_sock, int *port_num, double x[], int igraph[], int *natom, int *str_len, int lbres[], int ipres[], int *nres);
void mr3_sock_init__(int *s_sock, int *port_num, double x[], int igraph[], int *natom, int *str_len, int lbres[], int ipres[], int *nres);
void MR3_sock_1step(int s_sock, double t1, double time, double t2, int recv_buf[], int natom, double x[], double f[], double f_temp[]);
void mr3_sock_1step_(int *s_sock, double *t1, double *time, double *t2, int recv_buf[], int *natom, double x[], double f[], double f_tmp[]);
void mr3_sock_1step__(int *s_sock, double *t1, double *time, double *t2, int recv_buf[], int *natom, double x[], double f[], double f_tmp[]);
void MR3calc_ij_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, char method);
void MR3calc_ij_exlist_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], char method);
void MR3calc_ij_nlist_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], char method);
/* vtgrape.c */
void *MR3_my_malloc2(size_t n, char *s);
void MR3_my_free2(void **p, char *s);
VG_UNIT *m3_get_unit(void);
void vg_exit(int ret);
VG_UNIT *vg_allocate_unit(void (*function)(void *));
void vg_free_unit(VG_UNIT *unit);
void vg_set_function(VG_UNIT *unit, int function_index, void (*function)(void *));
void vg_set_vectors(VG_UNIT *unit, int nj, void *jvectors);
void vg_set_matrices(VG_UNIT *unit, int nati, int natj, void *matrices);
void vg_set_scalers(VG_UNIT *unit, void *scalers);
void vg_set_pipeline_vectors(VG_UNIT *unit, int ni, void *ivectors);
void vg_calculate(VG_UNIT *unit, int function_index, int nf, void *fvectors, void *pscalers);
void vg_set_vectors_pos_charge_atype(VG_UNIT *unit, int nj, double pos[][3], double charge[], int atype[]);
void vg_set_vectors_pos_charge(VG_UNIT *unit, int nj, double pos[][3], double charge[]);
void vg_set_vectors_pos_atype(VG_UNIT *unit, int nj, double pos[][3], int atype[]);
void vg_set_matrices_gscales_rscales(VG_UNIT *unit, int nati_org, int natj_org, double gscales[], double rscales[]);
void vg_set_pol_sigm_ipotro_pc_pd_zz(VG_UNIT *unit, int nati, int natj, double pol[], double sigm[], double ipotro[], double pc[], double pd[], double zz[]);
void vg_set_scalers_volume_alpha(VG_UNIT *unit, double volume[3], double alpha);
void vg_set_pipeline_vectors_pos_charge_atype(VG_UNIT *unit, int ni, double pos[][3], double charge[], int atype[]);
void vg_set_pipeline_vectors_pos_charge(VG_UNIT *unit, int ni, double pos[][3], double charge[]);
void vg_set_pipeline_vectors_pos_atype(VG_UNIT *unit, int ni, double pos[][3], int atype[]);
void vg_convert_forces(VG_UNIT *unit, int nf, int function_index, double fi[][3]);
void vg_calculate_forces_potentials(VG_UNIT *unit, int function_index, int nf, double fi[][3], double *potc, double *potv);
void vg_get_r1result(int n_org, float r[], float r1[]);
void vg_get_rsqrtresult(int n_org, float r[], float r1[]);
void vg_get_mulresult(int n_org, float r[], float q[], float rq[]);
int vg_write_emufile(int flag);
void vg_initialize_emu(void);
float vg_r1emu(float x);
float vg_rsqrtemu(float x);
void vg_set_scaleq(int n, double q[], double *scaleq, float *scaleq_1);
void m3_set_softening(VG_UNIT *unit, double eps);
void MR3_exit(int ret);
void MR3init(void);
void mr3init_(void);
void mr3init__(void);
void MR3free(void);
void mr3free_(void);
void mr3free__(void);
void MR3calccoulomb(double x[], int n, double q[], double rscale, int tblno, double xmax, int periodicflag, int natchangeflag, double force[]);
void mr3calccoulomb_(double x[], int *n, double q[], double *rscale, int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void mr3calccoulomb__(double x[], int *n, double q[], double *rscale, int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void MR3calccoulomb_ij(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag);
void mr3calccoulomb_ij_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void mr3calccoulomb_ij__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void MR3_sort_with_index_int(int data[], int index[], int left, int right);
void MR3calcvdw_ij_core(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void MR3calcvdw_ij(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void mr3calcvdw_ij_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void mr3calcvdw_ij__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void MR3calcvdw(double x[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int natchangeflag, double force[]);
void mr3calcvdw_(double x[], int *n, int atype[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void mr3calcvdw__(double x[], int *n, int atype[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void MR3calcewald(int *k, int knum_org, double *x, int n, double *chg, double alpha, double epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald__(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void MR3calcnacl(double x[], int n, int atype[], int nat, double pol[], double sigm[], double ipotro[], double pc[], double pd[], double zz[], int tblno, double xmax, int periodicflag, double force[]);
void vtgrape_force(double xj[][3], double mj[], double xi[][3], double eps2, double a[][3], int ni, int nj);
void vg_set_rcut2(VG_UNIT *unit, double rcut2);
void mr3_set_rcut2_(double *rcut2);
int md5sum(unsigned char *buffer, int totallen, unsigned char sum[16]);
int md5sum_file(char *filename, unsigned char sum[16]);
void MR3calccoulomb_ij_host(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag);
void mr3calccoulomb_ij_host_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void mr3calccoulomb_ij_host__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void MR3calcvdw_ij_host(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void mr3calcvdw_ij_host_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void mr3calcvdw_ij_host__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void MR3calccoulomb_nlist_ij_host_notwork(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[], double factorall);
void MR3calccoulomb_nlist_ij_host(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calccoulomb_nlist_host(double xd[], int n, double qd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calcvdw_nlist_ij_host_notwork(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[], double factor);
void MR3calcvdw_nlist_ij_host(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_host2(double x[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[], double factor, double force[]);
void MR3calccoulomb_ij_exlist_host(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void MR3calcvdw_ij_exlist_host(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void MR3calcewald_dft_host(int k[], int knum, double x[], int n, double chg[], double cellsize[3], double bs[], double bc[]);
void MR3calcewald_idft_eng_host(int k[], double bs[], double bc[], int knum, double x[], int n, double cellsize[3], double force[]);
void MR3calcewald_idft_force_host(int k[], double bs[], double bc[], int knum, double x[], int n, double cellsize[3], double force[]);
void MR3calcewald_host(int *k, int knum_org, double *x, int n, double *chg, double alpha, double epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_host__(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_host_(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void MR3SetTable(char *filename, int tblno, int flag);
void mr3settable_nf_(char *fname, int *tblno, int *flag, int *n);
void mr3settable_nf__(char *fname, int *tblno, int *flag, int *n);
void MR3_setup_exlist(int n, int *bckptr);
void mr3_setup_exlist_(int *n, int *bckptr);
void MR3_make_natex2_from_natex(int n, int natex[], int numex[], int **natex_offset, int **natex2, int **numex2, int **natex2_offset, int flag);
void calccoulomb_vdw_ij_exlist_host_sub(int i, int j, double xi[], double xj[], double qj, double gsf, double gsp, double rs, double rscale, double cutoff, double *fc, double *fv, double *pc, double *pv, int tblno, double size[3], int potflag);
void MR3calccoulomb_vdw_ij_exlist_cutoff_host(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double cutoff, double size[3], double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_host(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_host2(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_host_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_host__(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void MR3_get_cputime(double *laptime, double *sprittime);
void MR3_set_ldim(int ldim[3]);
void mr3_set_ldim_(int ldim[3]);
void mr3_set_ldim__(int ldim[3]);
void MR3_set_coulomb_vdw_factor(double cgf);
void mr3_set_coulomb_vdw_factor_(double *cgf);
void mr3_set_coulomb_vdw_factor__(double *cgf);
void MR3calccoulomb_ij_emu(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag);
void MR3calccoulomb_nlist_ij_emu(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calccoulomb_nlist_emu(double xd[], int n, double qd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calcvdw_ij_emu(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void MR3calccoulomb_vdw_nlist_ij_emu(int ni, double xid[], double qid[], int atypei[], double force[], int nj, double xjd[], double qjd[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblno, double volume[], int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_ij_emu(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_emu2(double xd[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calccoulomb_ij_exlist(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void mr3calccoulomb_ij_exlist_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag, int numexorg[], int natexorg[]);
void mr3calccoulomb_ij_exlist__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag, int numexorg[], int natexorg[]);
void MR3calcvdw_ij_exlist(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void mr3calcvdw_ij_exlist_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int numex[], int natex[]);
void mr3calcvdw_ij_exlist__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_core_old(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_core(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_virial_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_exlist(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double volume1, double *potc, double *potv, int *convert_index, int potflag, int flag);
void MR3calccoulomb_vdw_exlist_from_cell(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double volume1, double *potc, double *potv, int *convert_index, int potflag, int flag);
void mr3calccoulomb_vdw_exlist_(int *n, double x[], double q[], int atype[], int *nat, double force[], double *rscale, double gscalesf[], double gscalesp[], double rscales[], int *tblno, int numex[], int natex[], double *volume1, double *potc, double *potv, int *convert_index, int *potflag, int *flag);
void MR3_get_forces_overlap(double force[]);
void mr3_get_forces_overlap_(double force[]);
void MR3_get_potc_and_potv_overlap(double *potc, double *potv);
void mr3_get_potc_and_potv_overlap_(double *potc, double *potv);
void mr3_get_potc_and_potv_overlap__(double *potc, double *potv);
void MR3_get_forces_and_virial_overlap(double force[], double virial[3][3]);
void mr3_get_forces_and_virial_overlap_(double force[], double virial[3][3]);
void MR3calccoulomb_ci_exlist(int n, double x[], double q[], double force[], double rscale, int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], int *convert_index, int flag);
void mr3calccoulomb_ci_exlist_(int *n, double x[], double q[], double force[], double *rscale, int *tblno, int numex[], int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], int *convert_index, int *flag);
void MR3calcvdw_ci(int n, double x[], int atype[], int nat, double force[], double gscales[], double rscales[], int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calcvdw_ci_(int *n, double x[], int atype[], int *nat, double force[], double gscales[], double rscales[], int *tblno, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calcvdw_ci_exlist(int n, double x[], int atype[], int nat, double force[], double gscales[], double rscales[], int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], int *convert_index, int flag);
void mr3calcvdw_ci_exlist_(int *n, double x[], int atype[], int *nat, double force[], double gscales[], double rscales[], int *tblno, int numex[], int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], int *convert_index, int *flag);
void MR3calccoulomb_vdw_ci_exlist(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], double *potc, double *potv, int *convert_index, int potflag, int flag);
void mr3calccoulomb_vdw_ci_exlist_(int *n, double x[], double q[], int atype[], int *nat, double force[], double *rscale, double gscalesf[], double gscalesp[], double rscales[], int *tblno, int *numex, int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], double *potc, double *potv, int *convert_index, int *potflag, int *flag);
void MR3calccoulomb_ci(int n, double x[], double q[], double force[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calccoulomb_ci_(int *n, double x[], double q[], double force[], double *rscale, int *tblno, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_ij_ci(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_ij_ci_old(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calcvdw_ij_ci(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_virial(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut_org, double skinnb, double volume[3], int ldim[3], double virial[3][3], int flag);
void MR3calccoulomb_vdw_ij_ci(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calccoulomb_vdw_ij_ci_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscales[], double rscales[], double *rscale, int *tblnoc, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_old_09(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_old_090121(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_exlist(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3], int numex[], int natex[], int flag);
void mr3calccoulomb_vdw_ij_ci_exlist_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscales[], double rscales[], double *rscale, int *tblnoc, double *rcut, double *skinnb, double volume[3], int ldim[3], int numex[], int natex[], int *flag);
void MR3_get_board_version(int *version, int *freq);
void MR3_rscale_and_pack(int n, double (*x)[3], int *atype, longlong (*rj)[2]);
void MR3_rscale_and_pack_old(int n, double (*x)[3], int *atype, longlong (*rj)[2]);
void MR3SetTable_emu(char *filename, int tblno, int flag);
int MR3_get_total_num_chips(void);
void MR3print_chip_temperature(int flag);
int MR3_get_retry_count(void);
void m3_free_unit(VG_UNIT *unit);
VG_UNIT *m3_allocate_periodic_unit(const char *fname, int mode, double size, int dum);
void m3_set_positions(VG_UNIT *unit, double (*pos)[3], int n);
void m3_set_charges(VG_UNIT *unit, const double *q, int n);
void m3_set_cells(VG_UNIT *unit, M3_CELL *cell, int ncell);
void m3_calculate_forces(VG_UNIT *unit, double (*xi)[3], int ni, double (*force)[3]);
void m3_calculate_potentials(VG_UNIT *unit, double (*xi)[3], int ni, double *eng);
void m3_set_types(VG_UNIT *unit, const int *atype, int n);
void m3_set_pipeline_types(VG_UNIT *unit, const int *atype, int n);
void m3_set_charge_matrix(VG_UNIT *unit, const double *gscale, int nati, int natj);
void m3_set_rscale_matrix(VG_UNIT *unit, const double *rscale, int nati, int natj);
int MR3_close_ch(int s_sock);
int mr3_close_ch_(int *s_sock);
int MR3_open_port(int port_number);
int MR3_sock_read(int sockfd, char *buf, size_t count);
int mr3_sock_read_(int *sockfd, char *buf, int *count);
int mr3_sock_read__(int *sockfd, char *buf, int *count);
int mr3_sock_read_i_(int *sockfd, int *buf);
int mr3_sock_read_i__(int *sockfd, int *buf);
int MR3_sock_read_iv(int sockfd, int *buf, int count);
int mr3_sock_read_iv_(int *sockfd, int *buf, int *count);
int mr3_sock_read_iv__(int *sockfd, int *buf, int *count);
int MR3_sock_read_d(int sockfd, double *buf);
int mr3_sock_read_d__(int *sockfd, double *buf);
int mr3_sock_read_d_(int *sockfd, double *buf);
int MR3_sock_read_dv(int sockfd, double *buf, int count);
int mr3_sock_read_dv__(int *sockfd, double *buf, int *count);
int mr3_sock_read_dv_(int *sockfd, double *buf, int *count);
int MR3_sock_write(int sockfd, char *buf, size_t count);
int MR3_sock_write_c(int sockfd, char *buf);
int mr3_sock_write_c_(int *sockfd, char *buf);
int mr3_sock_write_c__(int *sockfd, char *buf);
int MR3_sock_write_i(int sockfd, int buf);
int mr3_sock_write_i_(int *sockfd, int *buf);
int mr3_sock_write_i__(int *sockfd, int *buf);
int MR3_sock_write_iv(int sockfd, int *buf, int count);
int mr3_sock_write_iv_(int *sockfd, int *buf, int *count);
int mr3_sock_write_iv__(int *sockfd, int *buf, int *count);
int MR3_sock_write_dv(int sockfd, double *buf, int count);
int mr3_sock_write_dv__(int *sockfd, double *buf, int *count);
int mr3_sock_write_dv_(int *sockfd, double *buf, int *count);
int MR3_sock_gets(int sockfd, char *str, size_t count);
int MR3_sock_puts(int sockfd, char *str);
void MR3_sock_init(int *s_sock_org, int port_num, double x[], int igraph[], int natom, int str_len, int lbres[], int ipres[], int nres);
void mr3_sock_init_(int *s_sock, int *port_num, double x[], int igraph[], int *natom, int *str_len, int lbres[], int ipres[], int *nres);
void mr3_sock_init__(int *s_sock, int *port_num, double x[], int igraph[], int *natom, int *str_len, int lbres[], int ipres[], int *nres);
void MR3_sock_1step(int s_sock, double t1, double time, double t2, int recv_buf[], int natom, double x[], double f[], double f_temp[]);
void mr3_sock_1step_(int *s_sock, double *t1, double *time, double *t2, int recv_buf[], int *natom, double x[], double f[], double f_tmp[]);
void mr3_sock_1step__(int *s_sock, double *t1, double *time, double *t2, int recv_buf[], int *natom, double x[], double f[], double f_tmp[]);
void MR3calc_ij_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, char method);
void MR3calc_ij_exlist_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], char method);
void MR3calc_ij_nlist_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], char method);
/* vtgrape.c */
void *MR3_my_malloc2(size_t n, char *s);
void MR3_my_free2(void **p, char *s);
VG_UNIT *m3_get_unit(void);
void vg_exit(int ret);
VG_UNIT *vg_allocate_unit(void (*function)(void *));
void vg_free_unit(VG_UNIT *unit);
void vg_set_function(VG_UNIT *unit, int function_index, void (*function)(void *));
void vg_set_vectors(VG_UNIT *unit, int nj, void *jvectors);
void vg_set_matrices(VG_UNIT *unit, int nati, int natj, void *matrices);
void vg_set_scalers(VG_UNIT *unit, void *scalers);
void vg_set_pipeline_vectors(VG_UNIT *unit, int ni, void *ivectors);
void vg_calculate(VG_UNIT *unit, int function_index, int nf, void *fvectors, void *pscalers);
void vg_set_vectors_pos_charge_atype(VG_UNIT *unit, int nj, double pos[][3], double charge[], int atype[]);
void vg_set_vectors_pos_charge(VG_UNIT *unit, int nj, double pos[][3], double charge[]);
void vg_set_vectors_pos_atype(VG_UNIT *unit, int nj, double pos[][3], int atype[]);
void vg_set_matrices_gscales_rscales(VG_UNIT *unit, int nati_org, int natj_org, double gscales[], double rscales[]);
void vg_set_pol_sigm_ipotro_pc_pd_zz(VG_UNIT *unit, int nati, int natj, double pol[], double sigm[], double ipotro[], double pc[], double pd[], double zz[]);
void vg_set_scalers_volume_alpha(VG_UNIT *unit, double volume[3], double alpha);
void vg_set_pipeline_vectors_pos_charge_atype(VG_UNIT *unit, int ni, double pos[][3], double charge[], int atype[]);
void vg_set_pipeline_vectors_pos_charge(VG_UNIT *unit, int ni, double pos[][3], double charge[]);
void vg_set_pipeline_vectors_pos_atype(VG_UNIT *unit, int ni, double pos[][3], int atype[]);
void vg_convert_forces(VG_UNIT *unit, int nf, int function_index, double fi[][3]);
void vg_calculate_forces_potentials(VG_UNIT *unit, int function_index, int nf, double fi[][3], double *potc, double *potv);
void vg_get_r1result(int n_org, float r[], float r1[]);
void vg_get_rsqrtresult(int n_org, float r[], float r1[]);
void vg_get_mulresult(int n_org, float r[], float q[], float rq[]);
int vg_write_emufile(int flag);
void vg_initialize_emu(void);
float vg_r1emu(float x);
float vg_rsqrtemu(float x);
void vg_set_scaleq(int n, double q[], double *scaleq, float *scaleq_1);
void m3_set_softening(VG_UNIT *unit, double eps);
void MR3_exit(int ret);
void MR3init(void);
void mr3init_(void);
void mr3init__(void);
void MR3free(void);
void mr3free_(void);
void mr3free__(void);
void MR3calccoulomb(double x[], int n, double q[], double rscale, int tblno, double xmax, int periodicflag, int natchangeflag, double force[]);
void mr3calccoulomb_(double x[], int *n, double q[], double *rscale, int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void mr3calccoulomb__(double x[], int *n, double q[], double *rscale, int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void MR3calccoulomb_ij(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag);
void mr3calccoulomb_ij_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void mr3calccoulomb_ij__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void MR3_sort_with_index_int(int data[], int index[], int left, int right);
void MR3calcvdw_ij_core(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void MR3calcvdw_ij(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void mr3calcvdw_ij_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void mr3calcvdw_ij__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void MR3calcvdw(double x[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int natchangeflag, double force[]);
void mr3calcvdw_(double x[], int *n, int atype[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void mr3calcvdw__(double x[], int *n, int atype[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void MR3calcewald(int *k, int knum_org, double *x, int n, double *chg, double alpha, double epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald__(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void MR3calcnacl(double x[], int n, int atype[], int nat, double pol[], double sigm[], double ipotro[], double pc[], double pd[], double zz[], int tblno, double xmax, int periodicflag, double force[]);
void vtgrape_force(double xj[][3], double mj[], double xi[][3], double eps2, double a[][3], int ni, int nj);
void vg_set_rcut2(VG_UNIT *unit, double rcut2);
void mr3_set_rcut2_(double *rcut2);
int md5sum(unsigned char *buffer, int totallen, unsigned char sum[16]);
int md5sum_file(char *filename, unsigned char sum[16]);
void MR3calccoulomb_ij_host(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag);
void mr3calccoulomb_ij_host_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void mr3calccoulomb_ij_host__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void MR3calcvdw_ij_host(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void mr3calcvdw_ij_host_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void mr3calcvdw_ij_host__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void MR3calccoulomb_nlist_ij_host_notwork(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[], double factorall);
void MR3calccoulomb_nlist_ij_host(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calccoulomb_nlist_host(double xd[], int n, double qd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calcvdw_nlist_ij_host_notwork(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[], double factor);
void MR3calcvdw_nlist_ij_host(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_host2(double x[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[], double factor, double force[]);
void MR3calccoulomb_ij_exlist_host(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void MR3calcvdw_ij_exlist_host(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void MR3calcewald_dft_host(int k[], int knum, double x[], int n, double chg[], double cellsize[3], double bs[], double bc[]);
void MR3calcewald_idft_eng_host(int k[], double bs[], double bc[], int knum, double x[], int n, double cellsize[3], double force[]);
void MR3calcewald_idft_force_host(int k[], double bs[], double bc[], int knum, double x[], int n, double cellsize[3], double force[]);
void MR3calcewald_host(int *k, int knum_org, double *x, int n, double *chg, double alpha, double epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_host__(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_host_(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void MR3SetTable(char *filename, int tblno, int flag);
void mr3settable_nf_(char *fname, int *tblno, int *flag, int *n);
void mr3settable_nf__(char *fname, int *tblno, int *flag, int *n);
void MR3_setup_exlist(int n, int *bckptr);
void mr3_setup_exlist_(int *n, int *bckptr);
void MR3_make_natex2_from_natex(int n, int natex[], int numex[], int **natex_offset, int **natex2, int **numex2, int **natex2_offset, int flag);
void calccoulomb_vdw_ij_exlist_host_sub(int i, int j, double xi[], double xj[], double qj, double gsf, double gsp, double rs, double rscale, double cutoff, double *fc, double *fv, double *pc, double *pv, int tblno, double size[3], int potflag);
void MR3calccoulomb_vdw_ij_exlist_cutoff_host(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double cutoff, double size[3], double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_host(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_host2(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_host_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_host__(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void MR3_get_cputime(double *laptime, double *sprittime);
void MR3_set_ldim(int ldim[3]);
void mr3_set_ldim_(int ldim[3]);
void mr3_set_ldim__(int ldim[3]);
void MR3_set_coulomb_vdw_factor(double cgf);
void mr3_set_coulomb_vdw_factor_(double *cgf);
void mr3_set_coulomb_vdw_factor__(double *cgf);
void MR3calccoulomb_ij_emu(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag);
void MR3calccoulomb_nlist_ij_emu(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calccoulomb_nlist_emu(double xd[], int n, double qd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calcvdw_ij_emu(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void MR3calccoulomb_vdw_nlist_ij_emu(int ni, double xid[], double qid[], int atypei[], double force[], int nj, double xjd[], double qjd[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblno, double volume[], int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_ij_emu(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_emu2(double xd[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calccoulomb_ij_exlist(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void mr3calccoulomb_ij_exlist_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag, int numexorg[], int natexorg[]);
void mr3calccoulomb_ij_exlist__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag, int numexorg[], int natexorg[]);
void MR3calcvdw_ij_exlist(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void mr3calcvdw_ij_exlist_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int numex[], int natex[]);
void mr3calcvdw_ij_exlist__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_core_old(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_core(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_virial_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_exlist(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double volume1, double *potc, double *potv, int *convert_index, int potflag, int flag);
void MR3calccoulomb_vdw_exlist_from_cell(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double volume1, double *potc, double *potv, int *convert_index, int potflag, int flag);
void mr3calccoulomb_vdw_exlist_(int *n, double x[], double q[], int atype[], int *nat, double force[], double *rscale, double gscalesf[], double gscalesp[], double rscales[], int *tblno, int numex[], int natex[], double *volume1, double *potc, double *potv, int *convert_index, int *potflag, int *flag);
void MR3_get_forces_overlap(double force[]);
void mr3_get_forces_overlap_(double force[]);
void MR3_get_potc_and_potv_overlap(double *potc, double *potv);
void mr3_get_potc_and_potv_overlap_(double *potc, double *potv);
void mr3_get_potc_and_potv_overlap__(double *potc, double *potv);
void MR3_get_forces_and_virial_overlap(double force[], double virial[3][3]);
void mr3_get_forces_and_virial_overlap_(double force[], double virial[3][3]);
void MR3calccoulomb_ci_exlist(int n, double x[], double q[], double force[], double rscale, int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], int *convert_index, int flag);
void mr3calccoulomb_ci_exlist_(int *n, double x[], double q[], double force[], double *rscale, int *tblno, int numex[], int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], int *convert_index, int *flag);
void MR3calcvdw_ci(int n, double x[], int atype[], int nat, double force[], double gscales[], double rscales[], int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calcvdw_ci_(int *n, double x[], int atype[], int *nat, double force[], double gscales[], double rscales[], int *tblno, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calcvdw_ci_exlist(int n, double x[], int atype[], int nat, double force[], double gscales[], double rscales[], int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], int *convert_index, int flag);
void mr3calcvdw_ci_exlist_(int *n, double x[], int atype[], int *nat, double force[], double gscales[], double rscales[], int *tblno, int numex[], int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], int *convert_index, int *flag);
void MR3calccoulomb_vdw_ci_exlist(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], double *potc, double *potv, int *convert_index, int potflag, int flag);
void mr3calccoulomb_vdw_ci_exlist_(int *n, double x[], double q[], int atype[], int *nat, double force[], double *rscale, double gscalesf[], double gscalesp[], double rscales[], int *tblno, int *numex, int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], double *potc, double *potv, int *convert_index, int *potflag, int *flag);
void MR3calccoulomb_ci(int n, double x[], double q[], double force[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calccoulomb_ci_(int *n, double x[], double q[], double force[], double *rscale, int *tblno, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_ij_ci(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_ij_ci_old(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calcvdw_ij_ci(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_virial(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut_org, double skinnb, double volume[3], int ldim[3], double virial[3][3], int flag);
void MR3calccoulomb_vdw_ij_ci(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calccoulomb_vdw_ij_ci_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscales[], double rscales[], double *rscale, int *tblnoc, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_old_09(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_old_090121(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_exlist(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3], int numex[], int natex[], int flag);
void mr3calccoulomb_vdw_ij_ci_exlist_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscales[], double rscales[], double *rscale, int *tblnoc, double *rcut, double *skinnb, double volume[3], int ldim[3], int numex[], int natex[], int *flag);
void MR3_get_board_version(int *version, int *freq);
void MR3_rscale_and_pack(int n, double (*x)[3], int *atype, longlong (*rj)[2]);
void MR3_rscale_and_pack_old(int n, double (*x)[3], int *atype, longlong (*rj)[2]);
void MR3SetTable_emu(char *filename, int tblno, int flag);
int MR3_get_total_num_chips(void);
void MR3print_chip_temperature(int flag);
int MR3_get_retry_count(void);
void m3_free_unit(VG_UNIT *unit);
VG_UNIT *m3_allocate_periodic_unit(const char *fname, int mode, double size, int dum);
void m3_set_positions(VG_UNIT *unit, double (*pos)[3], int n);
void m3_set_charges(VG_UNIT *unit, const double *q, int n);
void m3_set_cells(VG_UNIT *unit, M3_CELL *cell, int ncell);
void m3_calculate_forces(VG_UNIT *unit, double (*xi)[3], int ni, double (*force)[3]);
void m3_calculate_potentials(VG_UNIT *unit, double (*xi)[3], int ni, double *eng);
void m3_set_types(VG_UNIT *unit, const int *atype, int n);
void m3_set_pipeline_types(VG_UNIT *unit, const int *atype, int n);
void m3_set_charge_matrix(VG_UNIT *unit, const double *gscale, int nati, int natj);
void m3_set_rscale_matrix(VG_UNIT *unit, const double *rscale, int nati, int natj);
int MR3_close_ch(int s_sock);
int mr3_close_ch_(int *s_sock);
int MR3_open_port(int port_number);
int MR3_sock_read(int sockfd, char *buf, size_t count);
int mr3_sock_read_(int *sockfd, char *buf, int *count);
int mr3_sock_read__(int *sockfd, char *buf, int *count);
int mr3_sock_read_i_(int *sockfd, int *buf);
int mr3_sock_read_i__(int *sockfd, int *buf);
int MR3_sock_read_iv(int sockfd, int *buf, int count);
int mr3_sock_read_iv_(int *sockfd, int *buf, int *count);
int mr3_sock_read_iv__(int *sockfd, int *buf, int *count);
int MR3_sock_read_d(int sockfd, double *buf);
int mr3_sock_read_d__(int *sockfd, double *buf);
int mr3_sock_read_d_(int *sockfd, double *buf);
int MR3_sock_read_dv(int sockfd, double *buf, int count);
int mr3_sock_read_dv__(int *sockfd, double *buf, int *count);
int mr3_sock_read_dv_(int *sockfd, double *buf, int *count);
int MR3_sock_write(int sockfd, char *buf, size_t count);
int MR3_sock_write_c(int sockfd, char *buf);
int mr3_sock_write_c_(int *sockfd, char *buf);
int mr3_sock_write_c__(int *sockfd, char *buf);
int MR3_sock_write_i(int sockfd, int buf);
int mr3_sock_write_i_(int *sockfd, int *buf);
int mr3_sock_write_i__(int *sockfd, int *buf);
int MR3_sock_write_iv(int sockfd, int *buf, int count);
int mr3_sock_write_iv_(int *sockfd, int *buf, int *count);
int mr3_sock_write_iv__(int *sockfd, int *buf, int *count);
int MR3_sock_write_dv(int sockfd, double *buf, int count);
int mr3_sock_write_dv__(int *sockfd, double *buf, int *count);
int mr3_sock_write_dv_(int *sockfd, double *buf, int *count);
int MR3_sock_gets(int sockfd, char *str, size_t count);
int MR3_sock_puts(int sockfd, char *str);
void MR3_sock_init(int *s_sock_org, int port_num, double x[], int igraph[], int natom, int str_len, int lbres[], int ipres[], int nres);
void mr3_sock_init_(int *s_sock, int *port_num, double x[], int igraph[], int *natom, int *str_len, int lbres[], int ipres[], int *nres);
void mr3_sock_init__(int *s_sock, int *port_num, double x[], int igraph[], int *natom, int *str_len, int lbres[], int ipres[], int *nres);
void MR3_sock_1step(int s_sock, double t1, double time, double t2, int recv_buf[], int natom, double x[], double f[], double f_temp[]);
void mr3_sock_1step_(int *s_sock, double *t1, double *time, double *t2, int recv_buf[], int *natom, double x[], double f[], double f_tmp[]);
void mr3_sock_1step__(int *s_sock, double *t1, double *time, double *t2, int recv_buf[], int *natom, double x[], double f[], double f_tmp[]);
void MR3calc_ij_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, char method);
void MR3calc_ij_exlist_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], char method);
void MR3calc_ij_nlist_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], char method);
/* vtgrape.c */
void *MR3_my_malloc2(size_t n, char *s);
void MR3_my_free2(void **p, char *s);
VG_UNIT *m3_get_unit(void);
void vg_exit(int ret);
VG_UNIT *vg_allocate_unit(void (*function)(void *));
void vg_free_unit(VG_UNIT *unit);
void vg_set_function(VG_UNIT *unit, int function_index, void (*function)(void *));
void vg_set_vectors(VG_UNIT *unit, int nj, void *jvectors);
void vg_set_matrices(VG_UNIT *unit, int nati, int natj, void *matrices);
void vg_set_scalers(VG_UNIT *unit, void *scalers);
void vg_set_pipeline_vectors(VG_UNIT *unit, int ni, void *ivectors);
void vg_calculate(VG_UNIT *unit, int function_index, int nf, void *fvectors, void *pscalers);
void vg_set_vectors_pos_charge_atype(VG_UNIT *unit, int nj, double pos[][3], double charge[], int atype[]);
void vg_set_vectors_pos_charge(VG_UNIT *unit, int nj, double pos[][3], double charge[]);
void vg_set_vectors_pos_atype(VG_UNIT *unit, int nj, double pos[][3], int atype[]);
void vg_set_matrices_gscales_rscales(VG_UNIT *unit, int nati_org, int natj_org, double gscales[], double rscales[]);
void vg_set_pol_sigm_ipotro_pc_pd_zz(VG_UNIT *unit, int nati, int natj, double pol[], double sigm[], double ipotro[], double pc[], double pd[], double zz[]);
void vg_set_scalers_volume_alpha(VG_UNIT *unit, double volume[3], double alpha);
void vg_set_pipeline_vectors_pos_charge_atype(VG_UNIT *unit, int ni, double pos[][3], double charge[], int atype[]);
void vg_set_pipeline_vectors_pos_charge(VG_UNIT *unit, int ni, double pos[][3], double charge[]);
void vg_set_pipeline_vectors_pos_atype(VG_UNIT *unit, int ni, double pos[][3], int atype[]);
void vg_convert_forces(VG_UNIT *unit, int nf, int function_index, double fi[][3]);
void vg_calculate_forces_potentials(VG_UNIT *unit, int function_index, int nf, double fi[][3], double *potc, double *potv);
void vg_get_r1result(int n_org, float r[], float r1[]);
void vg_get_rsqrtresult(int n_org, float r[], float r1[]);
void vg_get_mulresult(int n_org, float r[], float q[], float rq[]);
int vg_write_emufile(int flag);
void vg_initialize_emu(void);
float vg_r1emu(float x);
float vg_rsqrtemu(float x);
void vg_set_scaleq(int n, double q[], double *scaleq, float *scaleq_1);
void m3_set_softening(VG_UNIT *unit, double eps);
void MR3_exit(int ret);
void MR3init(void);
void mr3init_(void);
void mr3init__(void);
void MR3free(void);
void mr3free_(void);
void mr3free__(void);
void MR3calccoulomb(double x[], int n, double q[], double rscale, int tblno, double xmax, int periodicflag, int natchangeflag, double force[]);
void mr3calccoulomb_(double x[], int *n, double q[], double *rscale, int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void mr3calccoulomb__(double x[], int *n, double q[], double *rscale, int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void MR3calccoulomb_ij(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag);
void mr3calccoulomb_ij_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void mr3calccoulomb_ij__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void MR3_sort_with_index_int(int data[], int index[], int left, int right);
void MR3calcvdw_ij_core(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void MR3calcvdw_ij(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void mr3calcvdw_ij_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void mr3calcvdw_ij__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void MR3calcvdw(double x[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int natchangeflag, double force[]);
void mr3calcvdw_(double x[], int *n, int atype[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void mr3calcvdw__(double x[], int *n, int atype[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void MR3calcewald(int *k, int knum_org, double *x, int n, double *chg, double alpha, double epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald__(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void MR3calcnacl(double x[], int n, int atype[], int nat, double pol[], double sigm[], double ipotro[], double pc[], double pd[], double zz[], int tblno, double xmax, int periodicflag, double force[]);
void vtgrape_force(double xj[][3], double mj[], double xi[][3], double eps2, double a[][3], int ni, int nj);
void vg_set_rcut2(VG_UNIT *unit, double rcut2);
void mr3_set_rcut2_(double *rcut2);
int md5sum(unsigned char *buffer, int totallen, unsigned char sum[16]);
int md5sum_file(char *filename, unsigned char sum[16]);
void MR3calccoulomb_ij_host(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag);
void mr3calccoulomb_ij_host_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void mr3calccoulomb_ij_host__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void MR3calcvdw_ij_host(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void mr3calcvdw_ij_host_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void mr3calcvdw_ij_host__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void MR3calccoulomb_nlist_ij_host_notwork(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[], double factorall);
void MR3calccoulomb_nlist_ij_host(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calccoulomb_nlist_host(double xd[], int n, double qd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calcvdw_nlist_ij_host_notwork(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[], double factor);
void MR3calcvdw_nlist_ij_host(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_host2(double x[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[], double factor, double force[]);
void MR3calccoulomb_ij_exlist_host(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void MR3calcvdw_ij_exlist_host(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void MR3calcewald_dft_host(int k[], int knum, double x[], int n, double chg[], double cellsize[3], double bs[], double bc[]);
void MR3calcewald_idft_eng_host(int k[], double bs[], double bc[], int knum, double x[], int n, double cellsize[3], double force[]);
void MR3calcewald_idft_force_host(int k[], double bs[], double bc[], int knum, double x[], int n, double cellsize[3], double force[]);
void MR3calcewald_host(int *k, int knum_org, double *x, int n, double *chg, double alpha, double epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_host__(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_host_(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void MR3SetTable(char *filename, int tblno, int flag);
void mr3settable_nf_(char *fname, int *tblno, int *flag, int *n);
void mr3settable_nf__(char *fname, int *tblno, int *flag, int *n);
void MR3_setup_exlist(int n, int *bckptr);
void mr3_setup_exlist_(int *n, int *bckptr);
void MR3_make_natex2_from_natex(int n, int natex[], int numex[], int **natex_offset, int **natex2, int **numex2, int **natex2_offset, int flag);
void calccoulomb_vdw_ij_exlist_host_sub(int i, int j, double xi[], double xj[], double qj, double gsf, double gsp, double rs, double rscale, double cutoff, double *fc, double *fv, double *pc, double *pv, int tblno, double size[3], int potflag);
void MR3calccoulomb_vdw_ij_exlist_cutoff_host(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double cutoff, double size[3], double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_host(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_host2(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_host_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_host__(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void MR3_get_cputime(double *laptime, double *sprittime);
void MR3_set_ldim(int ldim[3]);
void mr3_set_ldim_(int ldim[3]);
void mr3_set_ldim__(int ldim[3]);
void MR3_set_coulomb_vdw_factor(double cgf);
void mr3_set_coulomb_vdw_factor_(double *cgf);
void mr3_set_coulomb_vdw_factor__(double *cgf);
void MR3calccoulomb_ij_emu(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag);
void MR3calccoulomb_nlist_ij_emu(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calccoulomb_nlist_emu(double xd[], int n, double qd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calcvdw_ij_emu(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void MR3calccoulomb_vdw_nlist_ij_emu(int ni, double xid[], double qid[], int atypei[], double force[], int nj, double xjd[], double qjd[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblno, double volume[], int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_ij_emu(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_emu2(double xd[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calccoulomb_ij_exlist(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void mr3calccoulomb_ij_exlist_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag, int numexorg[], int natexorg[]);
void mr3calccoulomb_ij_exlist__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag, int numexorg[], int natexorg[]);
void MR3calcvdw_ij_exlist(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void mr3calcvdw_ij_exlist_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int numex[], int natex[]);
void mr3calcvdw_ij_exlist__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_core_old(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_core(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_virial_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_exlist(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double volume1, double *potc, double *potv, int *convert_index, int potflag, int flag);
void MR3calccoulomb_vdw_exlist_from_cell(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double volume1, double *potc, double *potv, int *convert_index, int potflag, int flag);
void mr3calccoulomb_vdw_exlist_(int *n, double x[], double q[], int atype[], int *nat, double force[], double *rscale, double gscalesf[], double gscalesp[], double rscales[], int *tblno, int numex[], int natex[], double *volume1, double *potc, double *potv, int *convert_index, int *potflag, int *flag);
void MR3_get_forces_overlap(double force[]);
void mr3_get_forces_overlap_(double force[]);
void MR3_get_potc_and_potv_overlap(double *potc, double *potv);
void mr3_get_potc_and_potv_overlap_(double *potc, double *potv);
void mr3_get_potc_and_potv_overlap__(double *potc, double *potv);
void MR3_get_forces_and_virial_overlap(double force[], double virial[3][3]);
void mr3_get_forces_and_virial_overlap_(double force[], double virial[3][3]);
void MR3calccoulomb_ci_exlist(int n, double x[], double q[], double force[], double rscale, int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], int *convert_index, int flag);
void mr3calccoulomb_ci_exlist_(int *n, double x[], double q[], double force[], double *rscale, int *tblno, int numex[], int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], int *convert_index, int *flag);
void MR3calcvdw_ci(int n, double x[], int atype[], int nat, double force[], double gscales[], double rscales[], int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calcvdw_ci_(int *n, double x[], int atype[], int *nat, double force[], double gscales[], double rscales[], int *tblno, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calcvdw_ci_exlist(int n, double x[], int atype[], int nat, double force[], double gscales[], double rscales[], int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], int *convert_index, int flag);
void mr3calcvdw_ci_exlist_(int *n, double x[], int atype[], int *nat, double force[], double gscales[], double rscales[], int *tblno, int numex[], int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], int *convert_index, int *flag);
void MR3calccoulomb_vdw_ci_exlist(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], double *potc, double *potv, int *convert_index, int potflag, int flag);
void mr3calccoulomb_vdw_ci_exlist_(int *n, double x[], double q[], int atype[], int *nat, double force[], double *rscale, double gscalesf[], double gscalesp[], double rscales[], int *tblno, int *numex, int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], double *potc, double *potv, int *convert_index, int *potflag, int *flag);
void MR3calccoulomb_ci(int n, double x[], double q[], double force[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calccoulomb_ci_(int *n, double x[], double q[], double force[], double *rscale, int *tblno, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_ij_ci(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_ij_ci_old(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calcvdw_ij_ci(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_virial(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut_org, double skinnb, double volume[3], int ldim[3], double virial[3][3], int flag);
void MR3calccoulomb_vdw_ij_ci(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calccoulomb_vdw_ij_ci_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscales[], double rscales[], double *rscale, int *tblnoc, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_old_09(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_old_090121(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_exlist(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3], int numex[], int natex[], int flag);
void mr3calccoulomb_vdw_ij_ci_exlist_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscales[], double rscales[], double *rscale, int *tblnoc, double *rcut, double *skinnb, double volume[3], int ldim[3], int numex[], int natex[], int *flag);
void MR3_get_board_version(int *version, int *freq);
void MR3_rscale_and_pack(int n, double (*x)[3], int *atype, longlong (*rj)[2]);
void MR3_rscale_and_pack_old(int n, double (*x)[3], int *atype, longlong (*rj)[2]);
void MR3SetTable_emu(char *filename, int tblno, int flag);
int MR3_get_total_num_chips(void);
void MR3print_chip_temperature(int flag);
int MR3_get_retry_count(void);
void m3_free_unit(VG_UNIT *unit);
VG_UNIT *m3_allocate_periodic_unit(const char *fname, int mode, double size, int dum);
void m3_set_positions(VG_UNIT *unit, double (*pos)[3], int n);
void m3_set_charges(VG_UNIT *unit, const double *q, int n);
void m3_set_cells(VG_UNIT *unit, M3_CELL *cell, int ncell);
void m3_calculate_forces(VG_UNIT *unit, double (*xi)[3], int ni, double (*force)[3]);
void m3_calculate_potentials(VG_UNIT *unit, double (*xi)[3], int ni, double *eng);
void m3_set_types(VG_UNIT *unit, const int *atype, int n);
void m3_set_pipeline_types(VG_UNIT *unit, const int *atype, int n);
void m3_set_charge_matrix(VG_UNIT *unit, const double *gscale, int nati, int natj);
void m3_set_rscale_matrix(VG_UNIT *unit, const double *rscale, int nati, int natj);
int MR3_close_ch(int s_sock);
int mr3_close_ch_(int *s_sock);
int MR3_open_port(int port_number);
int MR3_sock_read(int sockfd, char *buf, size_t count);
int mr3_sock_read_(int *sockfd, char *buf, int *count);
int mr3_sock_read__(int *sockfd, char *buf, int *count);
int mr3_sock_read_i_(int *sockfd, int *buf);
int mr3_sock_read_i__(int *sockfd, int *buf);
int MR3_sock_read_iv(int sockfd, int *buf, int count);
int mr3_sock_read_iv_(int *sockfd, int *buf, int *count);
int mr3_sock_read_iv__(int *sockfd, int *buf, int *count);
int MR3_sock_read_d(int sockfd, double *buf);
int mr3_sock_read_d__(int *sockfd, double *buf);
int mr3_sock_read_d_(int *sockfd, double *buf);
int MR3_sock_read_dv(int sockfd, double *buf, int count);
int mr3_sock_read_dv__(int *sockfd, double *buf, int *count);
int mr3_sock_read_dv_(int *sockfd, double *buf, int *count);
int MR3_sock_write(int sockfd, char *buf, size_t count);
int MR3_sock_write_c(int sockfd, char *buf);
int mr3_sock_write_c_(int *sockfd, char *buf);
int mr3_sock_write_c__(int *sockfd, char *buf);
int MR3_sock_write_i(int sockfd, int buf);
int mr3_sock_write_i_(int *sockfd, int *buf);
int mr3_sock_write_i__(int *sockfd, int *buf);
int MR3_sock_write_iv(int sockfd, int *buf, int count);
int mr3_sock_write_iv_(int *sockfd, int *buf, int *count);
int mr3_sock_write_iv__(int *sockfd, int *buf, int *count);
int MR3_sock_write_dv(int sockfd, double *buf, int count);
int mr3_sock_write_dv__(int *sockfd, double *buf, int *count);
int mr3_sock_write_dv_(int *sockfd, double *buf, int *count);
int MR3_sock_gets(int sockfd, char *str, size_t count);
int MR3_sock_puts(int sockfd, char *str);
void MR3_sock_init(int *s_sock_org, int port_num, double x[], int igraph[], int natom, int str_len, int lbres[], int ipres[], int nres);
void mr3_sock_init_(int *s_sock, int *port_num, double x[], int igraph[], int *natom, int *str_len, int lbres[], int ipres[], int *nres);
void mr3_sock_init__(int *s_sock, int *port_num, double x[], int igraph[], int *natom, int *str_len, int lbres[], int ipres[], int *nres);
void MR3_sock_1step(int s_sock, double t1, double time, double t2, int recv_buf[], int natom, double x[], double f[], double f_temp[]);
void mr3_sock_1step_(int *s_sock, double *t1, double *time, double *t2, int recv_buf[], int *natom, double x[], double f[], double f_tmp[]);
void mr3_sock_1step__(int *s_sock, double *t1, double *time, double *t2, int recv_buf[], int *natom, double x[], double f[], double f_tmp[]);
void MR3calc_ij_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, char method);
void MR3calc_ij_exlist_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], char method);
void MR3calc_ij_nlist_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], char method);
/* vtgrape.c */
void *MR3_my_malloc2(size_t n, char *s);
void MR3_my_free2(void **p, char *s);
VG_UNIT *m3_get_unit(void);
void vg_exit(int ret);
VG_UNIT *vg_allocate_unit(void (*function)(void *));
void vg_free_unit(VG_UNIT *unit);
void vg_set_function(VG_UNIT *unit, int function_index, void (*function)(void *));
void vg_set_vectors(VG_UNIT *unit, int nj, void *jvectors);
void vg_set_matrices(VG_UNIT *unit, int nati, int natj, void *matrices);
void vg_set_scalers(VG_UNIT *unit, void *scalers);
void vg_set_pipeline_vectors(VG_UNIT *unit, int ni, void *ivectors);
void vg_calculate(VG_UNIT *unit, int function_index, int nf, void *fvectors, void *pscalers);
void vg_set_vectors_pos_charge_atype(VG_UNIT *unit, int nj, double pos[][3], double charge[], int atype[]);
void vg_set_vectors_pos_charge(VG_UNIT *unit, int nj, double pos[][3], double charge[]);
void vg_set_vectors_pos_atype(VG_UNIT *unit, int nj, double pos[][3], int atype[]);
void vg_set_matrices_gscales_rscales(VG_UNIT *unit, int nati_org, int natj_org, double gscales[], double rscales[]);
void vg_set_pol_sigm_ipotro_pc_pd_zz(VG_UNIT *unit, int nati, int natj, double pol[], double sigm[], double ipotro[], double pc[], double pd[], double zz[]);
void vg_set_scalers_volume_alpha(VG_UNIT *unit, double volume[3], double alpha);
void vg_set_pipeline_vectors_pos_charge_atype(VG_UNIT *unit, int ni, double pos[][3], double charge[], int atype[]);
void vg_set_pipeline_vectors_pos_charge(VG_UNIT *unit, int ni, double pos[][3], double charge[]);
void vg_set_pipeline_vectors_pos_atype(VG_UNIT *unit, int ni, double pos[][3], int atype[]);
void vg_convert_forces(VG_UNIT *unit, int nf, int function_index, double fi[][3]);
void vg_calculate_forces_potentials(VG_UNIT *unit, int function_index, int nf, double fi[][3], double *potc, double *potv);
void vg_get_r1result(int n_org, float r[], float r1[]);
void vg_get_rsqrtresult(int n_org, float r[], float r1[]);
void vg_get_mulresult(int n_org, float r[], float q[], float rq[]);
int vg_write_emufile(int flag);
void vg_initialize_emu(void);
float vg_r1emu(float x);
float vg_rsqrtemu(float x);
void vg_set_scaleq(int n, double q[], double *scaleq, float *scaleq_1);
void m3_set_softening(VG_UNIT *unit, double eps);
void MR3_exit(int ret);
void MR3init(void);
void mr3init_(void);
void mr3init__(void);
void MR3free(void);
void mr3free_(void);
void mr3free__(void);
void MR3calccoulomb(double x[], int n, double q[], double rscale, int tblno, double xmax, int periodicflag, int natchangeflag, double force[]);
void mr3calccoulomb_(double x[], int *n, double q[], double *rscale, int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void mr3calccoulomb__(double x[], int *n, double q[], double *rscale, int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void MR3calccoulomb_ij(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag);
void mr3calccoulomb_ij_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void mr3calccoulomb_ij__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void MR3_sort_with_index_int(int data[], int index[], int left, int right);
void MR3calcvdw_ij_core(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void MR3calcvdw_ij(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void mr3calcvdw_ij_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void mr3calcvdw_ij__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void MR3calcvdw(double x[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int natchangeflag, double force[]);
void mr3calcvdw_(double x[], int *n, int atype[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void mr3calcvdw__(double x[], int *n, int atype[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void MR3calcewald(int *k, int knum_org, double *x, int n, double *chg, double alpha, double epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald__(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void MR3calcnacl(double x[], int n, int atype[], int nat, double pol[], double sigm[], double ipotro[], double pc[], double pd[], double zz[], int tblno, double xmax, int periodicflag, double force[]);
void vtgrape_force(double xj[][3], double mj[], double xi[][3], double eps2, double a[][3], int ni, int nj);
void vg_set_rcut2(VG_UNIT *unit, double rcut2);
void mr3_set_rcut2_(double *rcut2);
int md5sum(unsigned char *buffer, int totallen, unsigned char sum[16]);
int md5sum_file(char *filename, unsigned char sum[16]);
void MR3calccoulomb_ij_host(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag);
void mr3calccoulomb_ij_host_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void mr3calccoulomb_ij_host__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void MR3calcvdw_ij_host(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void mr3calcvdw_ij_host_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void mr3calcvdw_ij_host__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void MR3calccoulomb_nlist_ij_host_notwork(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[], double factorall);
void MR3calccoulomb_nlist_ij_host(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calccoulomb_nlist_host(double xd[], int n, double qd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calcvdw_nlist_ij_host_notwork(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[], double factor);
void MR3calcvdw_nlist_ij_host(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_host2(double x[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[], double factor, double force[]);
void MR3calccoulomb_ij_exlist_host(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void MR3calcvdw_ij_exlist_host(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void MR3calcewald_dft_host(int k[], int knum, double x[], int n, double chg[], double cellsize[3], double bs[], double bc[]);
void MR3calcewald_idft_eng_host(int k[], double bs[], double bc[], int knum, double x[], int n, double cellsize[3], double force[]);
void MR3calcewald_idft_force_host(int k[], double bs[], double bc[], int knum, double x[], int n, double cellsize[3], double force[]);
void MR3calcewald_host(int *k, int knum_org, double *x, int n, double *chg, double alpha, double epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_host__(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_host_(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void MR3SetTable(char *filename, int tblno, int flag);
void mr3settable_nf_(char *fname, int *tblno, int *flag, int *n);
void mr3settable_nf__(char *fname, int *tblno, int *flag, int *n);
void MR3_setup_exlist(int n, int *bckptr);
void mr3_setup_exlist_(int *n, int *bckptr);
void MR3_make_natex2_from_natex(int n, int natex[], int numex[], int **natex_offset, int **natex2, int **numex2, int **natex2_offset, int flag);
void calccoulomb_vdw_ij_exlist_host_sub(int i, int j, double xi[], double xj[], double qj, double gsf, double gsp, double rs, double rscale, double cutoff, double *fc, double *fv, double *pc, double *pv, int tblno, double size[3], int potflag);
void MR3calccoulomb_vdw_ij_exlist_cutoff_host(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double cutoff, double size[3], double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_host(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_host2(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_host_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_host__(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void MR3_get_cputime(double *laptime, double *sprittime);
void MR3_set_ldim(int ldim[3]);
void mr3_set_ldim_(int ldim[3]);
void mr3_set_ldim__(int ldim[3]);
void MR3_set_coulomb_vdw_factor(double cgf);
void mr3_set_coulomb_vdw_factor_(double *cgf);
void mr3_set_coulomb_vdw_factor__(double *cgf);
void MR3calccoulomb_ij_emu(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag);
void MR3calccoulomb_nlist_ij_emu(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calccoulomb_nlist_emu(double xd[], int n, double qd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calcvdw_ij_emu(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void MR3calccoulomb_vdw_nlist_ij_emu(int ni, double xid[], double qid[], int atypei[], double force[], int nj, double xjd[], double qjd[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblno, double volume[], int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_ij_emu(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_emu2(double xd[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calccoulomb_ij_exlist(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void mr3calccoulomb_ij_exlist_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag, int numexorg[], int natexorg[]);
void mr3calccoulomb_ij_exlist__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag, int numexorg[], int natexorg[]);
void MR3calcvdw_ij_exlist(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void mr3calcvdw_ij_exlist_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int numex[], int natex[]);
void mr3calcvdw_ij_exlist__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_core_old(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_core(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_virial_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_exlist(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double volume1, double *potc, double *potv, int *convert_index, int potflag, int flag);
void MR3calccoulomb_vdw_exlist_from_cell(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double volume1, double *potc, double *potv, int *convert_index, int potflag, int flag);
void mr3calccoulomb_vdw_exlist_(int *n, double x[], double q[], int atype[], int *nat, double force[], double *rscale, double gscalesf[], double gscalesp[], double rscales[], int *tblno, int numex[], int natex[], double *volume1, double *potc, double *potv, int *convert_index, int *potflag, int *flag);
void MR3_get_forces_overlap(double force[]);
void mr3_get_forces_overlap_(double force[]);
void MR3_get_potc_and_potv_overlap(double *potc, double *potv);
void mr3_get_potc_and_potv_overlap_(double *potc, double *potv);
void mr3_get_potc_and_potv_overlap__(double *potc, double *potv);
void MR3_get_forces_and_virial_overlap(double force[], double virial[3][3]);
void mr3_get_forces_and_virial_overlap_(double force[], double virial[3][3]);
void MR3calccoulomb_ci_exlist(int n, double x[], double q[], double force[], double rscale, int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], int *convert_index, int flag);
void mr3calccoulomb_ci_exlist_(int *n, double x[], double q[], double force[], double *rscale, int *tblno, int numex[], int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], int *convert_index, int *flag);
void MR3calcvdw_ci(int n, double x[], int atype[], int nat, double force[], double gscales[], double rscales[], int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calcvdw_ci_(int *n, double x[], int atype[], int *nat, double force[], double gscales[], double rscales[], int *tblno, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calcvdw_ci_exlist(int n, double x[], int atype[], int nat, double force[], double gscales[], double rscales[], int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], int *convert_index, int flag);
void mr3calcvdw_ci_exlist_(int *n, double x[], int atype[], int *nat, double force[], double gscales[], double rscales[], int *tblno, int numex[], int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], int *convert_index, int *flag);
void MR3calccoulomb_vdw_ci_exlist(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], double *potc, double *potv, int *convert_index, int potflag, int flag);
void mr3calccoulomb_vdw_ci_exlist_(int *n, double x[], double q[], int atype[], int *nat, double force[], double *rscale, double gscalesf[], double gscalesp[], double rscales[], int *tblno, int *numex, int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], double *potc, double *potv, int *convert_index, int *potflag, int *flag);
void MR3calccoulomb_ci(int n, double x[], double q[], double force[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calccoulomb_ci_(int *n, double x[], double q[], double force[], double *rscale, int *tblno, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_ij_ci(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_ij_ci_old(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calcvdw_ij_ci(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_virial(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut_org, double skinnb, double volume[3], int ldim[3], double virial[3][3], int flag);
void MR3calccoulomb_vdw_ij_ci(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calccoulomb_vdw_ij_ci_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscales[], double rscales[], double *rscale, int *tblnoc, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_old_09(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_old_090121(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_exlist(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3], int numex[], int natex[], int flag);
void mr3calccoulomb_vdw_ij_ci_exlist_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscales[], double rscales[], double *rscale, int *tblnoc, double *rcut, double *skinnb, double volume[3], int ldim[3], int numex[], int natex[], int *flag);
void MR3_get_board_version(int *version, int *freq);
void MR3_rscale_and_pack(int n, double (*x)[3], int *atype, longlong (*rj)[2]);
void MR3_rscale_and_pack_old(int n, double (*x)[3], int *atype, longlong (*rj)[2]);
void MR3SetTable_emu(char *filename, int tblno, int flag);
int MR3_get_total_num_chips(void);
void MR3print_chip_temperature(int flag);
int MR3_get_retry_count(void);
void m3_free_unit(VG_UNIT *unit);
VG_UNIT *m3_allocate_periodic_unit(const char *fname, int mode, double size, int dum);
void m3_set_positions(VG_UNIT *unit, double (*pos)[3], int n);
void m3_set_charges(VG_UNIT *unit, const double *q, int n);
void m3_set_cells(VG_UNIT *unit, M3_CELL *cell, int ncell);
void m3_calculate_forces(VG_UNIT *unit, double (*xi)[3], int ni, double (*force)[3]);
void m3_calculate_potentials(VG_UNIT *unit, double (*xi)[3], int ni, double *eng);
void m3_set_types(VG_UNIT *unit, const int *atype, int n);
void m3_set_pipeline_types(VG_UNIT *unit, const int *atype, int n);
void m3_set_charge_matrix(VG_UNIT *unit, const double *gscale, int nati, int natj);
void m3_set_rscale_matrix(VG_UNIT *unit, const double *rscale, int nati, int natj);
int MR3_close_ch(int s_sock);
int mr3_close_ch_(int *s_sock);
int MR3_open_port(int port_number);
int MR3_sock_read(int sockfd, char *buf, size_t count);
int mr3_sock_read_(int *sockfd, char *buf, int *count);
int mr3_sock_read__(int *sockfd, char *buf, int *count);
int mr3_sock_read_i_(int *sockfd, int *buf);
int mr3_sock_read_i__(int *sockfd, int *buf);
int MR3_sock_read_iv(int sockfd, int *buf, int count);
int mr3_sock_read_iv_(int *sockfd, int *buf, int *count);
int mr3_sock_read_iv__(int *sockfd, int *buf, int *count);
int MR3_sock_read_d(int sockfd, double *buf);
int mr3_sock_read_d__(int *sockfd, double *buf);
int mr3_sock_read_d_(int *sockfd, double *buf);
int MR3_sock_read_dv(int sockfd, double *buf, int count);
int mr3_sock_read_dv__(int *sockfd, double *buf, int *count);
int mr3_sock_read_dv_(int *sockfd, double *buf, int *count);
int MR3_sock_write(int sockfd, char *buf, size_t count);
int MR3_sock_write_c(int sockfd, char *buf);
int mr3_sock_write_c_(int *sockfd, char *buf);
int mr3_sock_write_c__(int *sockfd, char *buf);
int MR3_sock_write_i(int sockfd, int buf);
int mr3_sock_write_i_(int *sockfd, int *buf);
int mr3_sock_write_i__(int *sockfd, int *buf);
int MR3_sock_write_iv(int sockfd, int *buf, int count);
int mr3_sock_write_iv_(int *sockfd, int *buf, int *count);
int mr3_sock_write_iv__(int *sockfd, int *buf, int *count);
int MR3_sock_write_dv(int sockfd, double *buf, int count);
int mr3_sock_write_dv__(int *sockfd, double *buf, int *count);
int mr3_sock_write_dv_(int *sockfd, double *buf, int *count);
int MR3_sock_gets(int sockfd, char *str, size_t count);
int MR3_sock_puts(int sockfd, char *str);
void MR3_sock_init(int *s_sock_org, int port_num, double x[], int igraph[], int natom, int str_len, int lbres[], int ipres[], int nres);
void mr3_sock_init_(int *s_sock, int *port_num, double x[], int igraph[], int *natom, int *str_len, int lbres[], int ipres[], int *nres);
void mr3_sock_init__(int *s_sock, int *port_num, double x[], int igraph[], int *natom, int *str_len, int lbres[], int ipres[], int *nres);
void MR3_sock_1step(int s_sock, double t1, double time, double t2, int recv_buf[], int natom, double x[], double f[], double f_temp[]);
void mr3_sock_1step_(int *s_sock, double *t1, double *time, double *t2, int recv_buf[], int *natom, double x[], double f[], double f_tmp[]);
void mr3_sock_1step__(int *s_sock, double *t1, double *time, double *t2, int recv_buf[], int *natom, double x[], double f[], double f_tmp[]);
void MR3calc_ij_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, char method);
void MR3calc_ij_exlist_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], char method);
void MR3calc_ij_nlist_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], char method);
/* vtgrape.c */
void *MR3_my_malloc2(size_t n, char *s);
void MR3_my_free2(void **p, char *s);
VG_UNIT *m3_get_unit(void);
void vg_exit(int ret);
VG_UNIT *vg_allocate_unit(void (*function)(void *));
void vg_free_unit(VG_UNIT *unit);
void vg_set_function(VG_UNIT *unit, int function_index, void (*function)(void *));
void vg_set_vectors(VG_UNIT *unit, int nj, void *jvectors);
void vg_set_matrices(VG_UNIT *unit, int nati, int natj, void *matrices);
void vg_set_scalers(VG_UNIT *unit, void *scalers);
void vg_set_pipeline_vectors(VG_UNIT *unit, int ni, void *ivectors);
void vg_calculate(VG_UNIT *unit, int function_index, int nf, void *fvectors, void *pscalers);
void vg_set_vectors_pos_charge_atype(VG_UNIT *unit, int nj, double pos[][3], double charge[], int atype[]);
void vg_set_vectors_pos_charge(VG_UNIT *unit, int nj, double pos[][3], double charge[]);
void vg_set_vectors_pos_atype(VG_UNIT *unit, int nj, double pos[][3], int atype[]);
void vg_set_matrices_gscales_rscales(VG_UNIT *unit, int nati_org, int natj_org, double gscales[], double rscales[]);
void vg_set_pol_sigm_ipotro_pc_pd_zz(VG_UNIT *unit, int nati, int natj, double pol[], double sigm[], double ipotro[], double pc[], double pd[], double zz[]);
void vg_set_scalers_volume_alpha(VG_UNIT *unit, double volume[3], double alpha);
void vg_set_pipeline_vectors_pos_charge_atype(VG_UNIT *unit, int ni, double pos[][3], double charge[], int atype[]);
void vg_set_pipeline_vectors_pos_charge(VG_UNIT *unit, int ni, double pos[][3], double charge[]);
void vg_set_pipeline_vectors_pos_atype(VG_UNIT *unit, int ni, double pos[][3], int atype[]);
void vg_convert_forces(VG_UNIT *unit, int nf, int function_index, double fi[][3]);
void vg_calculate_forces_potentials(VG_UNIT *unit, int function_index, int nf, double fi[][3], double *potc, double *potv);
void vg_get_r1result(int n_org, float r[], float r1[]);
void vg_get_rsqrtresult(int n_org, float r[], float r1[]);
void vg_get_mulresult(int n_org, float r[], float q[], float rq[]);
int vg_write_emufile(int flag);
void vg_initialize_emu(void);
float vg_r1emu(float x);
float vg_rsqrtemu(float x);
void vg_set_scaleq(int n, double q[], double *scaleq, float *scaleq_1);
void m3_set_softening(VG_UNIT *unit, double eps);
void MR3_exit(int ret);
void MR3init(void);
void mr3init_(void);
void mr3init__(void);
void MR3free(void);
void mr3free_(void);
void mr3free__(void);
void MR3calccoulomb(double x[], int n, double q[], double rscale, int tblno, double xmax, int periodicflag, int natchangeflag, double force[]);
void mr3calccoulomb_(double x[], int *n, double q[], double *rscale, int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void mr3calccoulomb__(double x[], int *n, double q[], double *rscale, int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void MR3calccoulomb_ij(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag);
void mr3calccoulomb_ij_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void mr3calccoulomb_ij__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void MR3_sort_with_index_int(int data[], int index[], int left, int right);
void MR3calcvdw_ij_core(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void MR3calcvdw_ij(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void mr3calcvdw_ij_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void mr3calcvdw_ij__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void MR3calcvdw(double x[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int natchangeflag, double force[]);
void mr3calcvdw_(double x[], int *n, int atype[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void mr3calcvdw__(double x[], int *n, int atype[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void MR3calcewald(int *k, int knum_org, double *x, int n, double *chg, double alpha, double epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald__(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void MR3calcnacl(double x[], int n, int atype[], int nat, double pol[], double sigm[], double ipotro[], double pc[], double pd[], double zz[], int tblno, double xmax, int periodicflag, double force[]);
void vtgrape_force(double xj[][3], double mj[], double xi[][3], double eps2, double a[][3], int ni, int nj);
void vg_set_rcut2(VG_UNIT *unit, double rcut2);
void mr3_set_rcut2_(double *rcut2);
int md5sum(unsigned char *buffer, int totallen, unsigned char sum[16]);
int md5sum_file(char *filename, unsigned char sum[16]);
void MR3calccoulomb_ij_host(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag);
void mr3calccoulomb_ij_host_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void mr3calccoulomb_ij_host__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void MR3calcvdw_ij_host(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void mr3calcvdw_ij_host_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void mr3calcvdw_ij_host__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void MR3calccoulomb_nlist_ij_host_notwork(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[], double factorall);
void MR3calccoulomb_nlist_ij_host(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calccoulomb_nlist_host(double xd[], int n, double qd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calcvdw_nlist_ij_host_notwork(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[], double factor);
void MR3calcvdw_nlist_ij_host(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_host2(double x[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[], double factor, double force[]);
void MR3calccoulomb_ij_exlist_host(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void MR3calcvdw_ij_exlist_host(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void MR3calcewald_dft_host(int k[], int knum, double x[], int n, double chg[], double cellsize[3], double bs[], double bc[]);
void MR3calcewald_idft_eng_host(int k[], double bs[], double bc[], int knum, double x[], int n, double cellsize[3], double force[]);
void MR3calcewald_idft_force_host(int k[], double bs[], double bc[], int knum, double x[], int n, double cellsize[3], double force[]);
void MR3calcewald_host(int *k, int knum_org, double *x, int n, double *chg, double alpha, double epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_host__(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_host_(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void MR3SetTable(char *filename, int tblno, int flag);
void mr3settable_nf_(char *fname, int *tblno, int *flag, int *n);
void mr3settable_nf__(char *fname, int *tblno, int *flag, int *n);
void MR3_setup_exlist(int n, int *bckptr);
void mr3_setup_exlist_(int *n, int *bckptr);
void MR3_make_natex2_from_natex(int n, int natex[], int numex[], int **natex_offset, int **natex2, int **numex2, int **natex2_offset, int flag);
void calccoulomb_vdw_ij_exlist_host_sub(int i, int j, double xi[], double xj[], double qj, double gsf, double gsp, double rs, double rscale, double cutoff, double *fc, double *fv, double *pc, double *pv, int tblno, double size[3], int potflag);
void MR3calccoulomb_vdw_ij_exlist_cutoff_host(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double cutoff, double size[3], double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_host(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_host2(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_host_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_host__(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void MR3_get_cputime(double *laptime, double *sprittime);
void MR3_set_ldim(int ldim[3]);
void mr3_set_ldim_(int ldim[3]);
void mr3_set_ldim__(int ldim[3]);
void MR3_set_coulomb_vdw_factor(double cgf);
void mr3_set_coulomb_vdw_factor_(double *cgf);
void mr3_set_coulomb_vdw_factor__(double *cgf);
void MR3calccoulomb_ij_emu(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag);
void MR3calccoulomb_nlist_ij_emu(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calccoulomb_nlist_emu(double xd[], int n, double qd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calcvdw_ij_emu(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void MR3calccoulomb_vdw_nlist_ij_emu(int ni, double xid[], double qid[], int atypei[], double force[], int nj, double xjd[], double qjd[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblno, double volume[], int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_ij_emu(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_emu2(double xd[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calccoulomb_ij_exlist(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void mr3calccoulomb_ij_exlist_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag, int numexorg[], int natexorg[]);
void mr3calccoulomb_ij_exlist__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag, int numexorg[], int natexorg[]);
void MR3calcvdw_ij_exlist(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void mr3calcvdw_ij_exlist_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int numex[], int natex[]);
void mr3calcvdw_ij_exlist__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_core_old(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_core(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_virial_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_exlist(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double volume1, double *potc, double *potv, int *convert_index, int potflag, int flag);
void MR3calccoulomb_vdw_exlist_from_cell(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double volume1, double *potc, double *potv, int *convert_index, int potflag, int flag);
void mr3calccoulomb_vdw_exlist_(int *n, double x[], double q[], int atype[], int *nat, double force[], double *rscale, double gscalesf[], double gscalesp[], double rscales[], int *tblno, int numex[], int natex[], double *volume1, double *potc, double *potv, int *convert_index, int *potflag, int *flag);
void MR3_get_forces_overlap(double force[]);
void mr3_get_forces_overlap_(double force[]);
void MR3_get_potc_and_potv_overlap(double *potc, double *potv);
void mr3_get_potc_and_potv_overlap_(double *potc, double *potv);
void mr3_get_potc_and_potv_overlap__(double *potc, double *potv);
void MR3_get_forces_and_virial_overlap(double force[], double virial[3][3]);
void mr3_get_forces_and_virial_overlap_(double force[], double virial[3][3]);
void MR3calccoulomb_ci_exlist(int n, double x[], double q[], double force[], double rscale, int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], int *convert_index, int flag);
void mr3calccoulomb_ci_exlist_(int *n, double x[], double q[], double force[], double *rscale, int *tblno, int numex[], int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], int *convert_index, int *flag);
void MR3calcvdw_ci(int n, double x[], int atype[], int nat, double force[], double gscales[], double rscales[], int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calcvdw_ci_(int *n, double x[], int atype[], int *nat, double force[], double gscales[], double rscales[], int *tblno, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calcvdw_ci_exlist(int n, double x[], int atype[], int nat, double force[], double gscales[], double rscales[], int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], int *convert_index, int flag);
void mr3calcvdw_ci_exlist_(int *n, double x[], int atype[], int *nat, double force[], double gscales[], double rscales[], int *tblno, int numex[], int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], int *convert_index, int *flag);
void MR3calccoulomb_vdw_ci_exlist(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], double *potc, double *potv, int *convert_index, int potflag, int flag);
void mr3calccoulomb_vdw_ci_exlist_(int *n, double x[], double q[], int atype[], int *nat, double force[], double *rscale, double gscalesf[], double gscalesp[], double rscales[], int *tblno, int *numex, int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], double *potc, double *potv, int *convert_index, int *potflag, int *flag);
void MR3calccoulomb_ci(int n, double x[], double q[], double force[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calccoulomb_ci_(int *n, double x[], double q[], double force[], double *rscale, int *tblno, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_ij_ci(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_ij_ci_old(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calcvdw_ij_ci(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_virial(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut_org, double skinnb, double volume[3], int ldim[3], double virial[3][3], int flag);
void MR3calccoulomb_vdw_ij_ci(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calccoulomb_vdw_ij_ci_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscales[], double rscales[], double *rscale, int *tblnoc, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_old_09(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_old_090121(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_exlist(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3], int numex[], int natex[], int flag);
void mr3calccoulomb_vdw_ij_ci_exlist_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscales[], double rscales[], double *rscale, int *tblnoc, double *rcut, double *skinnb, double volume[3], int ldim[3], int numex[], int natex[], int *flag);
void MR3_get_board_version(int *version, int *freq);
void MR3_rscale_and_pack(int n, double (*x)[3], int *atype, longlong (*rj)[2]);
void MR3_rscale_and_pack_old(int n, double (*x)[3], int *atype, longlong (*rj)[2]);
void MR3SetTable_emu(char *filename, int tblno, int flag);
int MR3_get_total_num_chips(void);
void MR3print_chip_temperature(int flag);
int MR3_get_retry_count(void);
void m3_free_unit(VG_UNIT *unit);
VG_UNIT *m3_allocate_periodic_unit(const char *fname, int mode, double size, int dum);
void m3_set_positions(VG_UNIT *unit, double (*pos)[3], int n);
void m3_set_charges(VG_UNIT *unit, const double *q, int n);
void m3_set_cells(VG_UNIT *unit, M3_CELL *cell, int ncell);
void m3_calculate_forces(VG_UNIT *unit, double (*xi)[3], int ni, double (*force)[3]);
void m3_calculate_potentials(VG_UNIT *unit, double (*xi)[3], int ni, double *eng);
void m3_set_types(VG_UNIT *unit, const int *atype, int n);
void m3_set_pipeline_types(VG_UNIT *unit, const int *atype, int n);
void m3_set_charge_matrix(VG_UNIT *unit, const double *gscale, int nati, int natj);
void m3_set_rscale_matrix(VG_UNIT *unit, const double *rscale, int nati, int natj);
int MR3_close_ch(int s_sock);
int mr3_close_ch_(int *s_sock);
int MR3_open_port(int port_number);
int MR3_sock_read(int sockfd, char *buf, size_t count);
int mr3_sock_read_(int *sockfd, char *buf, int *count);
int mr3_sock_read__(int *sockfd, char *buf, int *count);
int mr3_sock_read_i_(int *sockfd, int *buf);
int mr3_sock_read_i__(int *sockfd, int *buf);
int MR3_sock_read_iv(int sockfd, int *buf, int count);
int mr3_sock_read_iv_(int *sockfd, int *buf, int *count);
int mr3_sock_read_iv__(int *sockfd, int *buf, int *count);
int MR3_sock_read_d(int sockfd, double *buf);
int mr3_sock_read_d__(int *sockfd, double *buf);
int mr3_sock_read_d_(int *sockfd, double *buf);
int MR3_sock_read_dv(int sockfd, double *buf, int count);
int mr3_sock_read_dv__(int *sockfd, double *buf, int *count);
int mr3_sock_read_dv_(int *sockfd, double *buf, int *count);
int MR3_sock_write(int sockfd, char *buf, size_t count);
int MR3_sock_write_c(int sockfd, char *buf);
int mr3_sock_write_c_(int *sockfd, char *buf);
int mr3_sock_write_c__(int *sockfd, char *buf);
int MR3_sock_write_i(int sockfd, int buf);
int mr3_sock_write_i_(int *sockfd, int *buf);
int mr3_sock_write_i__(int *sockfd, int *buf);
int MR3_sock_write_iv(int sockfd, int *buf, int count);
int mr3_sock_write_iv_(int *sockfd, int *buf, int *count);
int mr3_sock_write_iv__(int *sockfd, int *buf, int *count);
int MR3_sock_write_dv(int sockfd, double *buf, int count);
int mr3_sock_write_dv__(int *sockfd, double *buf, int *count);
int mr3_sock_write_dv_(int *sockfd, double *buf, int *count);
int MR3_sock_gets(int sockfd, char *str, size_t count);
int MR3_sock_puts(int sockfd, char *str);
void MR3_sock_init(int *s_sock_org, int port_num, double x[], int igraph[], int natom, int str_len, int lbres[], int ipres[], int nres);
void mr3_sock_init_(int *s_sock, int *port_num, double x[], int igraph[], int *natom, int *str_len, int lbres[], int ipres[], int *nres);
void mr3_sock_init__(int *s_sock, int *port_num, double x[], int igraph[], int *natom, int *str_len, int lbres[], int ipres[], int *nres);
void MR3_sock_1step(int s_sock, double t1, double time, double t2, int recv_buf[], int natom, double x[], double f[], double f_temp[]);
void mr3_sock_1step_(int *s_sock, double *t1, double *time, double *t2, int recv_buf[], int *natom, double x[], double f[], double f_tmp[]);
void mr3_sock_1step__(int *s_sock, double *t1, double *time, double *t2, int recv_buf[], int *natom, double x[], double f[], double f_tmp[]);
void MR3calc_ij_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, char method);
void MR3calc_ij_exlist_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], char method);
void MR3calc_ij_nlist_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], char method);
/* vtgrape.c */
void *MR3_my_malloc2(size_t n, char *s);
void MR3_my_free2(void **p, char *s);
VG_UNIT *m3_get_unit(void);
void vg_exit(int ret);
VG_UNIT *vg_allocate_unit(void (*function)(void *));
void vg_free_unit(VG_UNIT *unit);
void vg_set_function(VG_UNIT *unit, int function_index, void (*function)(void *));
void vg_set_vectors(VG_UNIT *unit, int nj, void *jvectors);
void vg_set_matrices(VG_UNIT *unit, int nati, int natj, void *matrices);
void vg_set_scalers(VG_UNIT *unit, void *scalers);
void vg_set_pipeline_vectors(VG_UNIT *unit, int ni, void *ivectors);
void vg_calculate(VG_UNIT *unit, int function_index, int nf, void *fvectors, void *pscalers);
void vg_set_vectors_pos_charge_atype(VG_UNIT *unit, int nj, double pos[][3], double charge[], int atype[]);
void vg_set_vectors_pos_charge(VG_UNIT *unit, int nj, double pos[][3], double charge[]);
void vg_set_vectors_pos_atype(VG_UNIT *unit, int nj, double pos[][3], int atype[]);
void vg_set_matrices_gscales_rscales(VG_UNIT *unit, int nati_org, int natj_org, double gscales[], double rscales[]);
void vg_set_pol_sigm_ipotro_pc_pd_zz(VG_UNIT *unit, int nati, int natj, double pol[], double sigm[], double ipotro[], double pc[], double pd[], double zz[]);
void vg_set_scalers_volume_alpha(VG_UNIT *unit, double volume[3], double alpha);
void vg_set_pipeline_vectors_pos_charge_atype(VG_UNIT *unit, int ni, double pos[][3], double charge[], int atype[]);
void vg_set_pipeline_vectors_pos_charge(VG_UNIT *unit, int ni, double pos[][3], double charge[]);
void vg_set_pipeline_vectors_pos_atype(VG_UNIT *unit, int ni, double pos[][3], int atype[]);
void vg_convert_forces(VG_UNIT *unit, int nf, int function_index, double fi[][3]);
void vg_calculate_forces_potentials(VG_UNIT *unit, int function_index, int nf, double fi[][3], double *potc, double *potv);
void vg_get_r1result(int n_org, float r[], float r1[]);
void vg_get_rsqrtresult(int n_org, float r[], float r1[]);
void vg_get_mulresult(int n_org, float r[], float q[], float rq[]);
int vg_write_emufile(int flag);
void vg_initialize_emu(void);
float vg_r1emu(float x);
float vg_rsqrtemu(float x);
void vg_set_scaleq(int n, double q[], double *scaleq, float *scaleq_1);
void m3_set_softening(VG_UNIT *unit, double eps);
void MR3_exit(int ret);
void MR3init(void);
void mr3init_(void);
void mr3init__(void);
void MR3free(void);
void mr3free_(void);
void mr3free__(void);
void MR3calccoulomb(double x[], int n, double q[], double rscale, int tblno, double xmax, int periodicflag, int natchangeflag, double force[]);
void mr3calccoulomb_(double x[], int *n, double q[], double *rscale, int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void mr3calccoulomb__(double x[], int *n, double q[], double *rscale, int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void MR3calccoulomb_ij(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag);
void mr3calccoulomb_ij_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void mr3calccoulomb_ij__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void MR3_sort_with_index_int(int data[], int index[], int left, int right);
void MR3calcvdw_ij_core(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void MR3calcvdw_ij(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void mr3calcvdw_ij_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void mr3calcvdw_ij__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void MR3calcvdw(double x[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int natchangeflag, double force[]);
void mr3calcvdw_(double x[], int *n, int atype[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void mr3calcvdw__(double x[], int *n, int atype[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void MR3calcewald(int *k, int knum_org, double *x, int n, double *chg, double alpha, double epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald__(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void MR3calcnacl(double x[], int n, int atype[], int nat, double pol[], double sigm[], double ipotro[], double pc[], double pd[], double zz[], int tblno, double xmax, int periodicflag, double force[]);
void vtgrape_force(double xj[][3], double mj[], double xi[][3], double eps2, double a[][3], int ni, int nj);
void vg_set_rcut2(VG_UNIT *unit, double rcut2);
void mr3_set_rcut2_(double *rcut2);
int md5sum(unsigned char *buffer, int totallen, unsigned char sum[16]);
int md5sum_file(char *filename, unsigned char sum[16]);
void MR3calccoulomb_ij_host(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag);
void mr3calccoulomb_ij_host_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void mr3calccoulomb_ij_host__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void MR3calcvdw_ij_host(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void mr3calcvdw_ij_host_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void mr3calcvdw_ij_host__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void MR3calccoulomb_nlist_ij_host_notwork(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[], double factorall);
void MR3calccoulomb_nlist_ij_host(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calccoulomb_nlist_host(double xd[], int n, double qd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calcvdw_nlist_ij_host_notwork(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[], double factor);
void MR3calcvdw_nlist_ij_host(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_host2(double x[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[], double factor, double force[]);
void MR3calccoulomb_ij_exlist_host(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void MR3calcvdw_ij_exlist_host(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void MR3calcewald_dft_host(int k[], int knum, double x[], int n, double chg[], double cellsize[3], double bs[], double bc[]);
void MR3calcewald_idft_eng_host(int k[], double bs[], double bc[], int knum, double x[], int n, double cellsize[3], double force[]);
void MR3calcewald_idft_force_host(int k[], double bs[], double bc[], int knum, double x[], int n, double cellsize[3], double force[]);
void MR3calcewald_host(int *k, int knum_org, double *x, int n, double *chg, double alpha, double epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_host__(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_host_(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void MR3SetTable(char *filename, int tblno, int flag);
void mr3settable_nf_(char *fname, int *tblno, int *flag, int *n);
void mr3settable_nf__(char *fname, int *tblno, int *flag, int *n);
void MR3_setup_exlist(int n, int *bckptr);
void mr3_setup_exlist_(int *n, int *bckptr);
void MR3_make_natex2_from_natex(int n, int natex[], int numex[], int **natex_offset, int **natex2, int **numex2, int **natex2_offset, int flag);
void calccoulomb_vdw_ij_exlist_host_sub(int i, int j, double xi[], double xj[], double qj, double gsf, double gsp, double rs, double rscale, double cutoff, double *fc, double *fv, double *pc, double *pv, int tblno, double size[3], int potflag);
void MR3calccoulomb_vdw_ij_exlist_cutoff_host(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double cutoff, double size[3], double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_host(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_host2(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_host_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_host__(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void MR3_get_cputime(double *laptime, double *sprittime);
void MR3_set_ldim(int ldim[3]);
void mr3_set_ldim_(int ldim[3]);
void mr3_set_ldim__(int ldim[3]);
void MR3_set_coulomb_vdw_factor(double cgf);
void mr3_set_coulomb_vdw_factor_(double *cgf);
void mr3_set_coulomb_vdw_factor__(double *cgf);
void MR3calccoulomb_ij_emu(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag);
void MR3calccoulomb_nlist_ij_emu(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calccoulomb_nlist_emu(double xd[], int n, double qd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calcvdw_ij_emu(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void MR3calccoulomb_vdw_nlist_ij_emu(int ni, double xid[], double qid[], int atypei[], double force[], int nj, double xjd[], double qjd[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblno, double volume[], int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_ij_emu(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_emu2(double xd[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calccoulomb_ij_exlist(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void mr3calccoulomb_ij_exlist_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag, int numexorg[], int natexorg[]);
void mr3calccoulomb_ij_exlist__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag, int numexorg[], int natexorg[]);
void MR3calcvdw_ij_exlist(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void mr3calcvdw_ij_exlist_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int numex[], int natex[]);
void mr3calcvdw_ij_exlist__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_core_old(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_core(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_virial_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_exlist(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double volume1, double *potc, double *potv, int *convert_index, int potflag, int flag);
void MR3calccoulomb_vdw_exlist_from_cell(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double volume1, double *potc, double *potv, int *convert_index, int potflag, int flag);
void mr3calccoulomb_vdw_exlist_(int *n, double x[], double q[], int atype[], int *nat, double force[], double *rscale, double gscalesf[], double gscalesp[], double rscales[], int *tblno, int numex[], int natex[], double *volume1, double *potc, double *potv, int *convert_index, int *potflag, int *flag);
void MR3_get_forces_overlap(double force[]);
void mr3_get_forces_overlap_(double force[]);
void MR3_get_potc_and_potv_overlap(double *potc, double *potv);
void mr3_get_potc_and_potv_overlap_(double *potc, double *potv);
void mr3_get_potc_and_potv_overlap__(double *potc, double *potv);
void MR3_get_forces_and_virial_overlap(double force[], double virial[3][3]);
void mr3_get_forces_and_virial_overlap_(double force[], double virial[3][3]);
void MR3calccoulomb_ci_exlist(int n, double x[], double q[], double force[], double rscale, int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], int *convert_index, int flag);
void mr3calccoulomb_ci_exlist_(int *n, double x[], double q[], double force[], double *rscale, int *tblno, int numex[], int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], int *convert_index, int *flag);
void MR3calcvdw_ci(int n, double x[], int atype[], int nat, double force[], double gscales[], double rscales[], int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calcvdw_ci_(int *n, double x[], int atype[], int *nat, double force[], double gscales[], double rscales[], int *tblno, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calcvdw_ci_exlist(int n, double x[], int atype[], int nat, double force[], double gscales[], double rscales[], int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], int *convert_index, int flag);
void mr3calcvdw_ci_exlist_(int *n, double x[], int atype[], int *nat, double force[], double gscales[], double rscales[], int *tblno, int numex[], int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], int *convert_index, int *flag);
void MR3calccoulomb_vdw_ci_exlist(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], double *potc, double *potv, int *convert_index, int potflag, int flag);
void mr3calccoulomb_vdw_ci_exlist_(int *n, double x[], double q[], int atype[], int *nat, double force[], double *rscale, double gscalesf[], double gscalesp[], double rscales[], int *tblno, int *numex, int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], double *potc, double *potv, int *convert_index, int *potflag, int *flag);
void MR3calccoulomb_ci(int n, double x[], double q[], double force[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calccoulomb_ci_(int *n, double x[], double q[], double force[], double *rscale, int *tblno, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_ij_ci(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_ij_ci_old(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calcvdw_ij_ci(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_virial(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut_org, double skinnb, double volume[3], int ldim[3], double virial[3][3], int flag);
void MR3calccoulomb_vdw_ij_ci(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calccoulomb_vdw_ij_ci_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscales[], double rscales[], double *rscale, int *tblnoc, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_old_09(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_old_090121(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_exlist(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3], int numex[], int natex[], int flag);
void mr3calccoulomb_vdw_ij_ci_exlist_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscales[], double rscales[], double *rscale, int *tblnoc, double *rcut, double *skinnb, double volume[3], int ldim[3], int numex[], int natex[], int *flag);
void MR3_get_board_version(int *version, int *freq);
void MR3_rscale_and_pack(int n, double (*x)[3], int *atype, longlong (*rj)[2]);
void MR3_rscale_and_pack_old(int n, double (*x)[3], int *atype, longlong (*rj)[2]);
void MR3SetTable_emu(char *filename, int tblno, int flag);
int MR3_get_total_num_chips(void);
void MR3print_chip_temperature(int flag);
int MR3_get_retry_count(void);
void m3_free_unit(VG_UNIT *unit);
VG_UNIT *m3_allocate_periodic_unit(const char *fname, int mode, double size, int dum);
void m3_set_positions(VG_UNIT *unit, double (*pos)[3], int n);
void m3_set_charges(VG_UNIT *unit, const double *q, int n);
void m3_set_cells(VG_UNIT *unit, M3_CELL *cell, int ncell);
void m3_calculate_forces(VG_UNIT *unit, double (*xi)[3], int ni, double (*force)[3]);
void m3_calculate_potentials(VG_UNIT *unit, double (*xi)[3], int ni, double *eng);
void m3_set_types(VG_UNIT *unit, const int *atype, int n);
void m3_set_pipeline_types(VG_UNIT *unit, const int *atype, int n);
void m3_set_charge_matrix(VG_UNIT *unit, const double *gscale, int nati, int natj);
void m3_set_rscale_matrix(VG_UNIT *unit, const double *rscale, int nati, int natj);
int MR3_close_ch(int s_sock);
int mr3_close_ch_(int *s_sock);
int MR3_open_port(int port_number);
int MR3_sock_read(int sockfd, char *buf, size_t count);
int mr3_sock_read_(int *sockfd, char *buf, int *count);
int mr3_sock_read__(int *sockfd, char *buf, int *count);
int mr3_sock_read_i_(int *sockfd, int *buf);
int mr3_sock_read_i__(int *sockfd, int *buf);
int MR3_sock_read_iv(int sockfd, int *buf, int count);
int mr3_sock_read_iv_(int *sockfd, int *buf, int *count);
int mr3_sock_read_iv__(int *sockfd, int *buf, int *count);
int MR3_sock_read_d(int sockfd, double *buf);
int mr3_sock_read_d__(int *sockfd, double *buf);
int mr3_sock_read_d_(int *sockfd, double *buf);
int MR3_sock_read_dv(int sockfd, double *buf, int count);
int mr3_sock_read_dv__(int *sockfd, double *buf, int *count);
int mr3_sock_read_dv_(int *sockfd, double *buf, int *count);
int MR3_sock_write(int sockfd, char *buf, size_t count);
int MR3_sock_write_c(int sockfd, char *buf);
int mr3_sock_write_c_(int *sockfd, char *buf);
int mr3_sock_write_c__(int *sockfd, char *buf);
int MR3_sock_write_i(int sockfd, int buf);
int mr3_sock_write_i_(int *sockfd, int *buf);
int mr3_sock_write_i__(int *sockfd, int *buf);
int MR3_sock_write_iv(int sockfd, int *buf, int count);
int mr3_sock_write_iv_(int *sockfd, int *buf, int *count);
int mr3_sock_write_iv__(int *sockfd, int *buf, int *count);
int MR3_sock_write_dv(int sockfd, double *buf, int count);
int mr3_sock_write_dv__(int *sockfd, double *buf, int *count);
int mr3_sock_write_dv_(int *sockfd, double *buf, int *count);
int MR3_sock_gets(int sockfd, char *str, size_t count);
int MR3_sock_puts(int sockfd, char *str);
void MR3_sock_init(int *s_sock_org, int port_num, double x[], int igraph[], int natom, int str_len, int lbres[], int ipres[], int nres);
void mr3_sock_init_(int *s_sock, int *port_num, double x[], int igraph[], int *natom, int *str_len, int lbres[], int ipres[], int *nres);
void mr3_sock_init__(int *s_sock, int *port_num, double x[], int igraph[], int *natom, int *str_len, int lbres[], int ipres[], int *nres);
void MR3_sock_1step(int s_sock, double t1, double time, double t2, int recv_buf[], int natom, double x[], double f[], double f_temp[]);
void mr3_sock_1step_(int *s_sock, double *t1, double *time, double *t2, int recv_buf[], int *natom, double x[], double f[], double f_tmp[]);
void mr3_sock_1step__(int *s_sock, double *t1, double *time, double *t2, int recv_buf[], int *natom, double x[], double f[], double f_tmp[]);
void MR3calc_ij_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, char method);
void MR3calc_ij_exlist_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], char method);
void MR3calc_ij_nlist_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], char method);
/* vtgrape.c */
void *MR3_my_malloc2(size_t n, char *s);
void MR3_my_free2(void **p, char *s);
VG_UNIT *m3_get_unit(void);
void vg_exit(int ret);
VG_UNIT *vg_allocate_unit(void (*function)(void *));
void vg_free_unit(VG_UNIT *unit);
void vg_set_function(VG_UNIT *unit, int function_index, void (*function)(void *));
void vg_set_vectors(VG_UNIT *unit, int nj, void *jvectors);
void vg_set_matrices(VG_UNIT *unit, int nati, int natj, void *matrices);
void vg_set_scalers(VG_UNIT *unit, void *scalers);
void vg_set_pipeline_vectors(VG_UNIT *unit, int ni, void *ivectors);
void vg_calculate(VG_UNIT *unit, int function_index, int nf, void *fvectors, void *pscalers);
void vg_set_vectors_pos_charge_atype(VG_UNIT *unit, int nj, double pos[][3], double charge[], int atype[]);
void vg_set_vectors_pos_charge(VG_UNIT *unit, int nj, double pos[][3], double charge[]);
void vg_set_vectors_pos_atype(VG_UNIT *unit, int nj, double pos[][3], int atype[]);
void vg_set_matrices_gscales_rscales(VG_UNIT *unit, int nati_org, int natj_org, double gscales[], double rscales[]);
void vg_set_pol_sigm_ipotro_pc_pd_zz(VG_UNIT *unit, int nati, int natj, double pol[], double sigm[], double ipotro[], double pc[], double pd[], double zz[]);
void vg_set_scalers_volume_alpha(VG_UNIT *unit, double volume[3], double alpha);
void vg_set_pipeline_vectors_pos_charge_atype(VG_UNIT *unit, int ni, double pos[][3], double charge[], int atype[]);
void vg_set_pipeline_vectors_pos_charge(VG_UNIT *unit, int ni, double pos[][3], double charge[]);
void vg_set_pipeline_vectors_pos_atype(VG_UNIT *unit, int ni, double pos[][3], int atype[]);
void vg_convert_forces(VG_UNIT *unit, int nf, int function_index, double fi[][3]);
void vg_calculate_forces_potentials(VG_UNIT *unit, int function_index, int nf, double fi[][3], double *potc, double *potv);
void vg_get_r1result(int n_org, float r[], float r1[]);
void vg_get_rsqrtresult(int n_org, float r[], float r1[]);
void vg_get_mulresult(int n_org, float r[], float q[], float rq[]);
int vg_write_emufile(int flag);
void vg_initialize_emu(void);
float vg_r1emu(float x);
float vg_rsqrtemu(float x);
void vg_set_scaleq(int n, double q[], double *scaleq, float *scaleq_1);
void m3_set_softening(VG_UNIT *unit, double eps);
void MR3_exit(int ret);
void MR3init(void);
void mr3init_(void);
void mr3init__(void);
void MR3free(void);
void mr3free_(void);
void mr3free__(void);
void MR3calccoulomb(double x[], int n, double q[], double rscale, int tblno, double xmax, int periodicflag, int natchangeflag, double force[]);
void mr3calccoulomb_(double x[], int *n, double q[], double *rscale, int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void mr3calccoulomb__(double x[], int *n, double q[], double *rscale, int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void MR3calccoulomb_ij(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag);
void mr3calccoulomb_ij_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void mr3calccoulomb_ij__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void MR3_sort_with_index_int(int data[], int index[], int left, int right);
void MR3calcvdw_ij_core(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void MR3calcvdw_ij(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void mr3calcvdw_ij_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void mr3calcvdw_ij__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void MR3calcvdw(double x[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int natchangeflag, double force[]);
void mr3calcvdw_(double x[], int *n, int atype[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void mr3calcvdw__(double x[], int *n, int atype[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void MR3calcewald(int *k, int knum_org, double *x, int n, double *chg, double alpha, double epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald__(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void MR3calcnacl(double x[], int n, int atype[], int nat, double pol[], double sigm[], double ipotro[], double pc[], double pd[], double zz[], int tblno, double xmax, int periodicflag, double force[]);
void vtgrape_force(double xj[][3], double mj[], double xi[][3], double eps2, double a[][3], int ni, int nj);
void vg_set_rcut2(VG_UNIT *unit, double rcut2);
void mr3_set_rcut2_(double *rcut2);
int md5sum(unsigned char *buffer, int totallen, unsigned char sum[16]);
int md5sum_file(char *filename, unsigned char sum[16]);
void MR3calccoulomb_ij_host(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag);
void mr3calccoulomb_ij_host_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void mr3calccoulomb_ij_host__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void MR3calcvdw_ij_host(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void mr3calcvdw_ij_host_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void mr3calcvdw_ij_host__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void MR3calccoulomb_nlist_ij_host_notwork(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[], double factorall);
void MR3calccoulomb_nlist_ij_host(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calccoulomb_nlist_host(double xd[], int n, double qd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calcvdw_nlist_ij_host_notwork(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[], double factor);
void MR3calcvdw_nlist_ij_host(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_host2(double x[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[], double factor, double force[]);
void MR3calccoulomb_ij_exlist_host(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void MR3calcvdw_ij_exlist_host(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void MR3calcewald_dft_host(int k[], int knum, double x[], int n, double chg[], double cellsize[3], double bs[], double bc[]);
void MR3calcewald_idft_eng_host(int k[], double bs[], double bc[], int knum, double x[], int n, double cellsize[3], double force[]);
void MR3calcewald_idft_force_host(int k[], double bs[], double bc[], int knum, double x[], int n, double cellsize[3], double force[]);
void MR3calcewald_host(int *k, int knum_org, double *x, int n, double *chg, double alpha, double epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_host__(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_host_(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void MR3SetTable(char *filename, int tblno, int flag);
void mr3settable_nf_(char *fname, int *tblno, int *flag, int *n);
void mr3settable_nf__(char *fname, int *tblno, int *flag, int *n);
void MR3_setup_exlist(int n, int *bckptr);
void mr3_setup_exlist_(int *n, int *bckptr);
void MR3_make_natex2_from_natex(int n, int natex[], int numex[], int **natex_offset, int **natex2, int **numex2, int **natex2_offset, int flag);
void calccoulomb_vdw_ij_exlist_host_sub(int i, int j, double xi[], double xj[], double qj, double gsf, double gsp, double rs, double rscale, double cutoff, double *fc, double *fv, double *pc, double *pv, int tblno, double size[3], int potflag);
void MR3calccoulomb_vdw_ij_exlist_cutoff_host(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double cutoff, double size[3], double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_host(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_host2(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_host_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_host__(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void MR3_get_cputime(double *laptime, double *sprittime);
void MR3_set_ldim(int ldim[3]);
void mr3_set_ldim_(int ldim[3]);
void mr3_set_ldim__(int ldim[3]);
void MR3_set_coulomb_vdw_factor(double cgf);
void mr3_set_coulomb_vdw_factor_(double *cgf);
void mr3_set_coulomb_vdw_factor__(double *cgf);
void MR3calccoulomb_ij_emu(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag);
void MR3calccoulomb_nlist_ij_emu(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calccoulomb_nlist_emu(double xd[], int n, double qd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calcvdw_ij_emu(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void MR3calccoulomb_vdw_nlist_ij_emu(int ni, double xid[], double qid[], int atypei[], double force[], int nj, double xjd[], double qjd[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblno, double volume[], int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_ij_emu(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_emu2(double xd[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calccoulomb_ij_exlist(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void mr3calccoulomb_ij_exlist_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag, int numexorg[], int natexorg[]);
void mr3calccoulomb_ij_exlist__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag, int numexorg[], int natexorg[]);
void MR3calcvdw_ij_exlist(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void mr3calcvdw_ij_exlist_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int numex[], int natex[]);
void mr3calcvdw_ij_exlist__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_core_old(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_core(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_virial_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_exlist(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double volume1, double *potc, double *potv, int *convert_index, int potflag, int flag);
void MR3calccoulomb_vdw_exlist_from_cell(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double volume1, double *potc, double *potv, int *convert_index, int potflag, int flag);
void mr3calccoulomb_vdw_exlist_(int *n, double x[], double q[], int atype[], int *nat, double force[], double *rscale, double gscalesf[], double gscalesp[], double rscales[], int *tblno, int numex[], int natex[], double *volume1, double *potc, double *potv, int *convert_index, int *potflag, int *flag);
void MR3_get_forces_overlap(double force[]);
void mr3_get_forces_overlap_(double force[]);
void MR3_get_potc_and_potv_overlap(double *potc, double *potv);
void mr3_get_potc_and_potv_overlap_(double *potc, double *potv);
void mr3_get_potc_and_potv_overlap__(double *potc, double *potv);
void MR3_get_forces_and_virial_overlap(double force[], double virial[3][3]);
void mr3_get_forces_and_virial_overlap_(double force[], double virial[3][3]);
void MR3calccoulomb_ci_exlist(int n, double x[], double q[], double force[], double rscale, int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], int *convert_index, int flag);
void mr3calccoulomb_ci_exlist_(int *n, double x[], double q[], double force[], double *rscale, int *tblno, int numex[], int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], int *convert_index, int *flag);
void MR3calcvdw_ci(int n, double x[], int atype[], int nat, double force[], double gscales[], double rscales[], int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calcvdw_ci_(int *n, double x[], int atype[], int *nat, double force[], double gscales[], double rscales[], int *tblno, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calcvdw_ci_exlist(int n, double x[], int atype[], int nat, double force[], double gscales[], double rscales[], int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], int *convert_index, int flag);
void mr3calcvdw_ci_exlist_(int *n, double x[], int atype[], int *nat, double force[], double gscales[], double rscales[], int *tblno, int numex[], int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], int *convert_index, int *flag);
void MR3calccoulomb_vdw_ci_exlist(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], double *potc, double *potv, int *convert_index, int potflag, int flag);
void mr3calccoulomb_vdw_ci_exlist_(int *n, double x[], double q[], int atype[], int *nat, double force[], double *rscale, double gscalesf[], double gscalesp[], double rscales[], int *tblno, int *numex, int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], double *potc, double *potv, int *convert_index, int *potflag, int *flag);
void MR3calccoulomb_ci(int n, double x[], double q[], double force[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calccoulomb_ci_(int *n, double x[], double q[], double force[], double *rscale, int *tblno, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_ij_ci(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_ij_ci_old(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calcvdw_ij_ci(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_virial(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut_org, double skinnb, double volume[3], int ldim[3], double virial[3][3], int flag);
void MR3calccoulomb_vdw_ij_ci(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calccoulomb_vdw_ij_ci_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscales[], double rscales[], double *rscale, int *tblnoc, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_old_09(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_old_090121(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_exlist(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3], int numex[], int natex[], int flag);
void mr3calccoulomb_vdw_ij_ci_exlist_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscales[], double rscales[], double *rscale, int *tblnoc, double *rcut, double *skinnb, double volume[3], int ldim[3], int numex[], int natex[], int *flag);
void MR3_get_board_version(int *version, int *freq);
void MR3_rscale_and_pack(int n, double (*x)[3], int *atype, longlong (*rj)[2]);
void MR3_rscale_and_pack_old(int n, double (*x)[3], int *atype, longlong (*rj)[2]);
void MR3SetTable_emu(char *filename, int tblno, int flag);
int MR3_get_total_num_chips(void);
void MR3print_chip_temperature(int flag);
int MR3_get_retry_count(void);
void m3_free_unit(VG_UNIT *unit);
VG_UNIT *m3_allocate_periodic_unit(const char *fname, int mode, double size, int dum);
void m3_set_positions(VG_UNIT *unit, double (*pos)[3], int n);
void m3_set_charges(VG_UNIT *unit, const double *q, int n);
void m3_set_cells(VG_UNIT *unit, M3_CELL *cell, int ncell);
void m3_calculate_forces(VG_UNIT *unit, double (*xi)[3], int ni, double (*force)[3]);
void m3_calculate_potentials(VG_UNIT *unit, double (*xi)[3], int ni, double *eng);
void m3_set_types(VG_UNIT *unit, const int *atype, int n);
void m3_set_pipeline_types(VG_UNIT *unit, const int *atype, int n);
void m3_set_charge_matrix(VG_UNIT *unit, const double *gscale, int nati, int natj);
void m3_set_rscale_matrix(VG_UNIT *unit, const double *rscale, int nati, int natj);
int MR3_close_ch(int s_sock);
int mr3_close_ch_(int *s_sock);
int MR3_open_port(int port_number);
int MR3_sock_read(int sockfd, char *buf, size_t count);
int mr3_sock_read_(int *sockfd, char *buf, int *count);
int mr3_sock_read__(int *sockfd, char *buf, int *count);
int mr3_sock_read_i_(int *sockfd, int *buf);
int mr3_sock_read_i__(int *sockfd, int *buf);
int MR3_sock_read_iv(int sockfd, int *buf, int count);
int mr3_sock_read_iv_(int *sockfd, int *buf, int *count);
int mr3_sock_read_iv__(int *sockfd, int *buf, int *count);
int MR3_sock_read_d(int sockfd, double *buf);
int mr3_sock_read_d__(int *sockfd, double *buf);
int mr3_sock_read_d_(int *sockfd, double *buf);
int MR3_sock_read_dv(int sockfd, double *buf, int count);
int mr3_sock_read_dv__(int *sockfd, double *buf, int *count);
int mr3_sock_read_dv_(int *sockfd, double *buf, int *count);
int MR3_sock_write(int sockfd, char *buf, size_t count);
int MR3_sock_write_c(int sockfd, char *buf);
int mr3_sock_write_c_(int *sockfd, char *buf);
int mr3_sock_write_c__(int *sockfd, char *buf);
int MR3_sock_write_i(int sockfd, int buf);
int mr3_sock_write_i_(int *sockfd, int *buf);
int mr3_sock_write_i__(int *sockfd, int *buf);
int MR3_sock_write_iv(int sockfd, int *buf, int count);
int mr3_sock_write_iv_(int *sockfd, int *buf, int *count);
int mr3_sock_write_iv__(int *sockfd, int *buf, int *count);
int MR3_sock_write_dv(int sockfd, double *buf, int count);
int mr3_sock_write_dv__(int *sockfd, double *buf, int *count);
int mr3_sock_write_dv_(int *sockfd, double *buf, int *count);
int MR3_sock_gets(int sockfd, char *str, size_t count);
int MR3_sock_puts(int sockfd, char *str);
void MR3_sock_init(int *s_sock_org, int port_num, double x[], int igraph[], int natom, int str_len, int lbres[], int ipres[], int nres);
void mr3_sock_init_(int *s_sock, int *port_num, double x[], int igraph[], int *natom, int *str_len, int lbres[], int ipres[], int *nres);
void mr3_sock_init__(int *s_sock, int *port_num, double x[], int igraph[], int *natom, int *str_len, int lbres[], int ipres[], int *nres);
void MR3_sock_1step(int s_sock, double t1, double time, double t2, int recv_buf[], int natom, double x[], double f[], double f_temp[]);
void mr3_sock_1step_(int *s_sock, double *t1, double *time, double *t2, int recv_buf[], int *natom, double x[], double f[], double f_tmp[]);
void mr3_sock_1step__(int *s_sock, double *t1, double *time, double *t2, int recv_buf[], int *natom, double x[], double f[], double f_tmp[]);
void MR3calc_ij_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, char method);
void MR3calc_ij_exlist_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], char method);
void MR3calc_ij_nlist_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], char method);
/* vtgrape.c */
void *MR3_my_malloc2(size_t n, char *s);
void MR3_my_free2(void **p, char *s);
VG_UNIT *m3_get_unit(void);
void vg_exit(int ret);
VG_UNIT *vg_allocate_unit(void (*function)(void *));
void vg_free_unit(VG_UNIT *unit);
void vg_set_function(VG_UNIT *unit, int function_index, void (*function)(void *));
void vg_set_vectors(VG_UNIT *unit, int nj, void *jvectors);
void vg_set_matrices(VG_UNIT *unit, int nati, int natj, void *matrices);
void vg_set_scalers(VG_UNIT *unit, void *scalers);
void vg_set_pipeline_vectors(VG_UNIT *unit, int ni, void *ivectors);
void vg_calculate(VG_UNIT *unit, int function_index, int nf, void *fvectors, void *pscalers);
void vg_set_vectors_pos_charge_atype(VG_UNIT *unit, int nj, double pos[][3], double charge[], int atype[]);
void vg_set_vectors_pos_charge(VG_UNIT *unit, int nj, double pos[][3], double charge[]);
void vg_set_vectors_pos_atype(VG_UNIT *unit, int nj, double pos[][3], int atype[]);
void vg_set_matrices_gscales_rscales(VG_UNIT *unit, int nati_org, int natj_org, double gscales[], double rscales[]);
void vg_set_pol_sigm_ipotro_pc_pd_zz(VG_UNIT *unit, int nati, int natj, double pol[], double sigm[], double ipotro[], double pc[], double pd[], double zz[]);
void vg_set_scalers_volume_alpha(VG_UNIT *unit, double volume[3], double alpha);
void vg_set_pipeline_vectors_pos_charge_atype(VG_UNIT *unit, int ni, double pos[][3], double charge[], int atype[]);
void vg_set_pipeline_vectors_pos_charge(VG_UNIT *unit, int ni, double pos[][3], double charge[]);
void vg_set_pipeline_vectors_pos_atype(VG_UNIT *unit, int ni, double pos[][3], int atype[]);
void vg_convert_forces(VG_UNIT *unit, int nf, int function_index, double fi[][3]);
void vg_calculate_forces_potentials(VG_UNIT *unit, int function_index, int nf, double fi[][3], double *potc, double *potv);
void vg_get_r1result(int n_org, float r[], float r1[]);
void vg_get_rsqrtresult(int n_org, float r[], float r1[]);
void vg_get_mulresult(int n_org, float r[], float q[], float rq[]);
int vg_write_emufile(int flag);
void vg_initialize_emu(void);
float vg_r1emu(float x);
float vg_rsqrtemu(float x);
void vg_set_scaleq(int n, double q[], double *scaleq, float *scaleq_1);
void m3_set_softening(VG_UNIT *unit, double eps);
void MR3_exit(int ret);
void MR3init(void);
void mr3init_(void);
void mr3init__(void);
void MR3free(void);
void mr3free_(void);
void mr3free__(void);
void MR3calccoulomb(double x[], int n, double q[], double rscale, int tblno, double xmax, int periodicflag, int natchangeflag, double force[]);
void mr3calccoulomb_(double x[], int *n, double q[], double *rscale, int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void mr3calccoulomb__(double x[], int *n, double q[], double *rscale, int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void MR3calccoulomb_ij(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag);
void mr3calccoulomb_ij_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void mr3calccoulomb_ij__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void MR3_sort_with_index_int(int data[], int index[], int left, int right);
void MR3calcvdw_ij_core(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void MR3calcvdw_ij(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void mr3calcvdw_ij_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void mr3calcvdw_ij__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void MR3calcvdw(double x[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int natchangeflag, double force[]);
void mr3calcvdw_(double x[], int *n, int atype[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void mr3calcvdw__(double x[], int *n, int atype[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void MR3calcewald(int *k, int knum_org, double *x, int n, double *chg, double alpha, double epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald__(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void MR3calcnacl(double x[], int n, int atype[], int nat, double pol[], double sigm[], double ipotro[], double pc[], double pd[], double zz[], int tblno, double xmax, int periodicflag, double force[]);
void vtgrape_force(double xj[][3], double mj[], double xi[][3], double eps2, double a[][3], int ni, int nj);
void vg_set_rcut2(VG_UNIT *unit, double rcut2);
void mr3_set_rcut2_(double *rcut2);
int md5sum(unsigned char *buffer, int totallen, unsigned char sum[16]);
int md5sum_file(char *filename, unsigned char sum[16]);
void MR3calccoulomb_ij_host(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag);
void mr3calccoulomb_ij_host_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void mr3calccoulomb_ij_host__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void MR3calcvdw_ij_host(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void mr3calcvdw_ij_host_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void mr3calcvdw_ij_host__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void MR3calccoulomb_nlist_ij_host_notwork(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[], double factorall);
void MR3calccoulomb_nlist_ij_host(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calccoulomb_nlist_host(double xd[], int n, double qd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calcvdw_nlist_ij_host_notwork(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[], double factor);
void MR3calcvdw_nlist_ij_host(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_host2(double x[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[], double factor, double force[]);
void MR3calccoulomb_ij_exlist_host(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void MR3calcvdw_ij_exlist_host(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void MR3calcewald_dft_host(int k[], int knum, double x[], int n, double chg[], double cellsize[3], double bs[], double bc[]);
void MR3calcewald_idft_eng_host(int k[], double bs[], double bc[], int knum, double x[], int n, double cellsize[3], double force[]);
void MR3calcewald_idft_force_host(int k[], double bs[], double bc[], int knum, double x[], int n, double cellsize[3], double force[]);
void MR3calcewald_host(int *k, int knum_org, double *x, int n, double *chg, double alpha, double epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_host__(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_host_(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void MR3SetTable(char *filename, int tblno, int flag);
void mr3settable_nf_(char *fname, int *tblno, int *flag, int *n);
void mr3settable_nf__(char *fname, int *tblno, int *flag, int *n);
void MR3_setup_exlist(int n, int *bckptr);
void mr3_setup_exlist_(int *n, int *bckptr);
void MR3_make_natex2_from_natex(int n, int natex[], int numex[], int **natex_offset, int **natex2, int **numex2, int **natex2_offset, int flag);
void calccoulomb_vdw_ij_exlist_host_sub(int i, int j, double xi[], double xj[], double qj, double gsf, double gsp, double rs, double rscale, double cutoff, double *fc, double *fv, double *pc, double *pv, int tblno, double size[3], int potflag);
void MR3calccoulomb_vdw_ij_exlist_cutoff_host(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double cutoff, double size[3], double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_host(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_host2(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_host_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_host__(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void MR3_get_cputime(double *laptime, double *sprittime);
void MR3_set_ldim(int ldim[3]);
void mr3_set_ldim_(int ldim[3]);
void mr3_set_ldim__(int ldim[3]);
void MR3_set_coulomb_vdw_factor(double cgf);
void mr3_set_coulomb_vdw_factor_(double *cgf);
void mr3_set_coulomb_vdw_factor__(double *cgf);
void MR3calccoulomb_ij_emu(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag);
void MR3calccoulomb_nlist_ij_emu(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calccoulomb_nlist_emu(double xd[], int n, double qd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calcvdw_ij_emu(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void MR3calccoulomb_vdw_nlist_ij_emu(int ni, double xid[], double qid[], int atypei[], double force[], int nj, double xjd[], double qjd[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblno, double volume[], int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_ij_emu(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_emu2(double xd[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calccoulomb_ij_exlist(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void mr3calccoulomb_ij_exlist_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag, int numexorg[], int natexorg[]);
void mr3calccoulomb_ij_exlist__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag, int numexorg[], int natexorg[]);
void MR3calcvdw_ij_exlist(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void mr3calcvdw_ij_exlist_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int numex[], int natex[]);
void mr3calcvdw_ij_exlist__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_core_old(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_core(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_virial_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_exlist(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double volume1, double *potc, double *potv, int *convert_index, int potflag, int flag);
void MR3calccoulomb_vdw_exlist_from_cell(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double volume1, double *potc, double *potv, int *convert_index, int potflag, int flag);
void mr3calccoulomb_vdw_exlist_(int *n, double x[], double q[], int atype[], int *nat, double force[], double *rscale, double gscalesf[], double gscalesp[], double rscales[], int *tblno, int numex[], int natex[], double *volume1, double *potc, double *potv, int *convert_index, int *potflag, int *flag);
void MR3_get_forces_overlap(double force[]);
void mr3_get_forces_overlap_(double force[]);
void MR3_get_potc_and_potv_overlap(double *potc, double *potv);
void mr3_get_potc_and_potv_overlap_(double *potc, double *potv);
void mr3_get_potc_and_potv_overlap__(double *potc, double *potv);
void MR3_get_forces_and_virial_overlap(double force[], double virial[3][3]);
void mr3_get_forces_and_virial_overlap_(double force[], double virial[3][3]);
void MR3calccoulomb_ci_exlist(int n, double x[], double q[], double force[], double rscale, int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], int *convert_index, int flag);
void mr3calccoulomb_ci_exlist_(int *n, double x[], double q[], double force[], double *rscale, int *tblno, int numex[], int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], int *convert_index, int *flag);
void MR3calcvdw_ci(int n, double x[], int atype[], int nat, double force[], double gscales[], double rscales[], int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calcvdw_ci_(int *n, double x[], int atype[], int *nat, double force[], double gscales[], double rscales[], int *tblno, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calcvdw_ci_exlist(int n, double x[], int atype[], int nat, double force[], double gscales[], double rscales[], int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], int *convert_index, int flag);
void mr3calcvdw_ci_exlist_(int *n, double x[], int atype[], int *nat, double force[], double gscales[], double rscales[], int *tblno, int numex[], int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], int *convert_index, int *flag);
void MR3calccoulomb_vdw_ci_exlist(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], double *potc, double *potv, int *convert_index, int potflag, int flag);
void mr3calccoulomb_vdw_ci_exlist_(int *n, double x[], double q[], int atype[], int *nat, double force[], double *rscale, double gscalesf[], double gscalesp[], double rscales[], int *tblno, int *numex, int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], double *potc, double *potv, int *convert_index, int *potflag, int *flag);
void MR3calccoulomb_ci(int n, double x[], double q[], double force[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calccoulomb_ci_(int *n, double x[], double q[], double force[], double *rscale, int *tblno, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_ij_ci(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_ij_ci_old(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calcvdw_ij_ci(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_virial(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut_org, double skinnb, double volume[3], int ldim[3], double virial[3][3], int flag);
void MR3calccoulomb_vdw_ij_ci(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calccoulomb_vdw_ij_ci_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscales[], double rscales[], double *rscale, int *tblnoc, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_old_09(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_old_090121(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_exlist(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3], int numex[], int natex[], int flag);
void mr3calccoulomb_vdw_ij_ci_exlist_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscales[], double rscales[], double *rscale, int *tblnoc, double *rcut, double *skinnb, double volume[3], int ldim[3], int numex[], int natex[], int *flag);
void MR3_get_board_version(int *version, int *freq);
void MR3_rscale_and_pack(int n, double (*x)[3], int *atype, longlong (*rj)[2]);
void MR3_rscale_and_pack_old(int n, double (*x)[3], int *atype, longlong (*rj)[2]);
void MR3SetTable_emu(char *filename, int tblno, int flag);
int MR3_get_total_num_chips(void);
void MR3print_chip_temperature(int flag);
int MR3_get_retry_count(void);
void m3_free_unit(VG_UNIT *unit);
VG_UNIT *m3_allocate_periodic_unit(const char *fname, int mode, double size, int dum);
void m3_set_positions(VG_UNIT *unit, double (*pos)[3], int n);
void m3_set_charges(VG_UNIT *unit, const double *q, int n);
void m3_set_cells(VG_UNIT *unit, M3_CELL *cell, int ncell);
void m3_calculate_forces(VG_UNIT *unit, double (*xi)[3], int ni, double (*force)[3]);
void m3_calculate_potentials(VG_UNIT *unit, double (*xi)[3], int ni, double *eng);
void m3_set_types(VG_UNIT *unit, const int *atype, int n);
void m3_set_pipeline_types(VG_UNIT *unit, const int *atype, int n);
void m3_set_charge_matrix(VG_UNIT *unit, const double *gscale, int nati, int natj);
void m3_set_rscale_matrix(VG_UNIT *unit, const double *rscale, int nati, int natj);
int MR3_close_ch(int s_sock);
int mr3_close_ch_(int *s_sock);
int MR3_open_port(int port_number);
int MR3_sock_read(int sockfd, char *buf, size_t count);
int mr3_sock_read_(int *sockfd, char *buf, int *count);
int mr3_sock_read__(int *sockfd, char *buf, int *count);
int mr3_sock_read_i_(int *sockfd, int *buf);
int mr3_sock_read_i__(int *sockfd, int *buf);
int MR3_sock_read_iv(int sockfd, int *buf, int count);
int mr3_sock_read_iv_(int *sockfd, int *buf, int *count);
int mr3_sock_read_iv__(int *sockfd, int *buf, int *count);
int MR3_sock_read_d(int sockfd, double *buf);
int mr3_sock_read_d__(int *sockfd, double *buf);
int mr3_sock_read_d_(int *sockfd, double *buf);
int MR3_sock_read_dv(int sockfd, double *buf, int count);
int mr3_sock_read_dv__(int *sockfd, double *buf, int *count);
int mr3_sock_read_dv_(int *sockfd, double *buf, int *count);
int MR3_sock_write(int sockfd, char *buf, size_t count);
int MR3_sock_write_c(int sockfd, char *buf);
int mr3_sock_write_c_(int *sockfd, char *buf);
int mr3_sock_write_c__(int *sockfd, char *buf);
int MR3_sock_write_i(int sockfd, int buf);
int mr3_sock_write_i_(int *sockfd, int *buf);
int mr3_sock_write_i__(int *sockfd, int *buf);
int MR3_sock_write_iv(int sockfd, int *buf, int count);
int mr3_sock_write_iv_(int *sockfd, int *buf, int *count);
int mr3_sock_write_iv__(int *sockfd, int *buf, int *count);
int MR3_sock_write_dv(int sockfd, double *buf, int count);
int mr3_sock_write_dv__(int *sockfd, double *buf, int *count);
int mr3_sock_write_dv_(int *sockfd, double *buf, int *count);
int MR3_sock_gets(int sockfd, char *str, size_t count);
int MR3_sock_puts(int sockfd, char *str);
void MR3_sock_init(int *s_sock_org, int port_num, double x[], int igraph[], int natom, int str_len, int lbres[], int ipres[], int nres);
void mr3_sock_init_(int *s_sock, int *port_num, double x[], int igraph[], int *natom, int *str_len, int lbres[], int ipres[], int *nres);
void mr3_sock_init__(int *s_sock, int *port_num, double x[], int igraph[], int *natom, int *str_len, int lbres[], int ipres[], int *nres);
void MR3_sock_1step(int s_sock, double t1, double time, double t2, int recv_buf[], int natom, double x[], double f[], double f_temp[]);
void mr3_sock_1step_(int *s_sock, double *t1, double *time, double *t2, int recv_buf[], int *natom, double x[], double f[], double f_tmp[]);
void mr3_sock_1step__(int *s_sock, double *t1, double *time, double *t2, int recv_buf[], int *natom, double x[], double f[], double f_tmp[]);
void MR3calc_ij_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, char method);
void MR3calc_ij_exlist_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], char method);
void MR3calc_ij_nlist_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], char method);
/* vtgrape.c */
void *MR3_my_malloc2(size_t n, char *s);
void MR3_my_free2(void **p, char *s);
VG_UNIT *m3_get_unit(void);
void vg_exit(int ret);
VG_UNIT *vg_allocate_unit(void (*function)(void *));
void vg_free_unit(VG_UNIT *unit);
void vg_set_function(VG_UNIT *unit, int function_index, void (*function)(void *));
void vg_set_vectors(VG_UNIT *unit, int nj, void *jvectors);
void vg_set_matrices(VG_UNIT *unit, int nati, int natj, void *matrices);
void vg_set_scalers(VG_UNIT *unit, void *scalers);
void vg_set_pipeline_vectors(VG_UNIT *unit, int ni, void *ivectors);
void vg_calculate(VG_UNIT *unit, int function_index, int nf, void *fvectors, void *pscalers);
void vg_set_vectors_pos_charge_atype(VG_UNIT *unit, int nj, double pos[][3], double charge[], int atype[]);
void vg_set_vectors_pos_charge(VG_UNIT *unit, int nj, double pos[][3], double charge[]);
void vg_set_vectors_pos_atype(VG_UNIT *unit, int nj, double pos[][3], int atype[]);
void vg_set_matrices_gscales_rscales(VG_UNIT *unit, int nati_org, int natj_org, double gscales[], double rscales[]);
void vg_set_pol_sigm_ipotro_pc_pd_zz(VG_UNIT *unit, int nati, int natj, double pol[], double sigm[], double ipotro[], double pc[], double pd[], double zz[]);
void vg_set_scalers_volume_alpha(VG_UNIT *unit, double volume[3], double alpha);
void vg_set_pipeline_vectors_pos_charge_atype(VG_UNIT *unit, int ni, double pos[][3], double charge[], int atype[]);
void vg_set_pipeline_vectors_pos_charge(VG_UNIT *unit, int ni, double pos[][3], double charge[]);
void vg_set_pipeline_vectors_pos_atype(VG_UNIT *unit, int ni, double pos[][3], int atype[]);
void vg_convert_forces(VG_UNIT *unit, int nf, int function_index, double fi[][3]);
void vg_calculate_forces_potentials(VG_UNIT *unit, int function_index, int nf, double fi[][3], double *potc, double *potv);
void vg_get_r1result(int n_org, float r[], float r1[]);
void vg_get_rsqrtresult(int n_org, float r[], float r1[]);
void vg_get_mulresult(int n_org, float r[], float q[], float rq[]);
int vg_write_emufile(int flag);
void vg_initialize_emu(void);
float vg_r1emu(float x);
float vg_rsqrtemu(float x);
void vg_set_scaleq(int n, double q[], double *scaleq, float *scaleq_1);
void m3_set_softening(VG_UNIT *unit, double eps);
void MR3_exit(int ret);
void MR3init(void);
void mr3init_(void);
void mr3init__(void);
void MR3free(void);
void mr3free_(void);
void mr3free__(void);
void MR3calccoulomb(double x[], int n, double q[], double rscale, int tblno, double xmax, int periodicflag, int natchangeflag, double force[]);
void mr3calccoulomb_(double x[], int *n, double q[], double *rscale, int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void mr3calccoulomb__(double x[], int *n, double q[], double *rscale, int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void MR3calccoulomb_ij(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag);
void mr3calccoulomb_ij_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void mr3calccoulomb_ij__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void MR3_sort_with_index_int(int data[], int index[], int left, int right);
void MR3calcvdw_ij_core(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void MR3calcvdw_ij(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void mr3calcvdw_ij_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void mr3calcvdw_ij__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void MR3calcvdw(double x[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int natchangeflag, double force[]);
void mr3calcvdw_(double x[], int *n, int atype[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void mr3calcvdw__(double x[], int *n, int atype[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void MR3calcewald(int *k, int knum_org, double *x, int n, double *chg, double alpha, double epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald__(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void MR3calcnacl(double x[], int n, int atype[], int nat, double pol[], double sigm[], double ipotro[], double pc[], double pd[], double zz[], int tblno, double xmax, int periodicflag, double force[]);
void vtgrape_force(double xj[][3], double mj[], double xi[][3], double eps2, double a[][3], int ni, int nj);
void vg_set_rcut2(VG_UNIT *unit, double rcut2);
void mr3_set_rcut2_(double *rcut2);
int md5sum(unsigned char *buffer, int totallen, unsigned char sum[16]);
int md5sum_file(char *filename, unsigned char sum[16]);
void MR3calccoulomb_ij_host(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag);
void mr3calccoulomb_ij_host_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void mr3calccoulomb_ij_host__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void MR3calcvdw_ij_host(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void mr3calcvdw_ij_host_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void mr3calcvdw_ij_host__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void MR3calccoulomb_nlist_ij_host_notwork(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[], double factorall);
void MR3calccoulomb_nlist_ij_host(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calccoulomb_nlist_host(double xd[], int n, double qd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calcvdw_nlist_ij_host_notwork(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[], double factor);
void MR3calcvdw_nlist_ij_host(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_host2(double x[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[], double factor, double force[]);
void MR3calccoulomb_ij_exlist_host(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void MR3calcvdw_ij_exlist_host(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void MR3calcewald_dft_host(int k[], int knum, double x[], int n, double chg[], double cellsize[3], double bs[], double bc[]);
void MR3calcewald_idft_eng_host(int k[], double bs[], double bc[], int knum, double x[], int n, double cellsize[3], double force[]);
void MR3calcewald_idft_force_host(int k[], double bs[], double bc[], int knum, double x[], int n, double cellsize[3], double force[]);
void MR3calcewald_host(int *k, int knum_org, double *x, int n, double *chg, double alpha, double epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_host__(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_host_(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void MR3SetTable(char *filename, int tblno, int flag);
void mr3settable_nf_(char *fname, int *tblno, int *flag, int *n);
void mr3settable_nf__(char *fname, int *tblno, int *flag, int *n);
void MR3_setup_exlist(int n, int *bckptr);
void mr3_setup_exlist_(int *n, int *bckptr);
void MR3_make_natex2_from_natex(int n, int natex[], int numex[], int **natex_offset, int **natex2, int **numex2, int **natex2_offset, int flag);
void calccoulomb_vdw_ij_exlist_host_sub(int i, int j, double xi[], double xj[], double qj, double gsf, double gsp, double rs, double rscale, double cutoff, double *fc, double *fv, double *pc, double *pv, int tblno, double size[3], int potflag);
void MR3calccoulomb_vdw_ij_exlist_cutoff_host(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double cutoff, double size[3], double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_host(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_host2(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_host_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_host__(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void MR3_get_cputime(double *laptime, double *sprittime);
void MR3_set_ldim(int ldim[3]);
void mr3_set_ldim_(int ldim[3]);
void mr3_set_ldim__(int ldim[3]);
void MR3_set_coulomb_vdw_factor(double cgf);
void mr3_set_coulomb_vdw_factor_(double *cgf);
void mr3_set_coulomb_vdw_factor__(double *cgf);
void MR3calccoulomb_ij_emu(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag);
void MR3calccoulomb_nlist_ij_emu(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calccoulomb_nlist_emu(double xd[], int n, double qd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calcvdw_ij_emu(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void MR3calccoulomb_vdw_nlist_ij_emu(int ni, double xid[], double qid[], int atypei[], double force[], int nj, double xjd[], double qjd[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblno, double volume[], int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_ij_emu(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_emu2(double xd[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calccoulomb_ij_exlist(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void mr3calccoulomb_ij_exlist_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag, int numexorg[], int natexorg[]);
void mr3calccoulomb_ij_exlist__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag, int numexorg[], int natexorg[]);
void MR3calcvdw_ij_exlist(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void mr3calcvdw_ij_exlist_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int numex[], int natex[]);
void mr3calcvdw_ij_exlist__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_core_old(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_core(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_virial_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_exlist(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double volume1, double *potc, double *potv, int *convert_index, int potflag, int flag);
void MR3calccoulomb_vdw_exlist_from_cell(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double volume1, double *potc, double *potv, int *convert_index, int potflag, int flag);
void mr3calccoulomb_vdw_exlist_(int *n, double x[], double q[], int atype[], int *nat, double force[], double *rscale, double gscalesf[], double gscalesp[], double rscales[], int *tblno, int numex[], int natex[], double *volume1, double *potc, double *potv, int *convert_index, int *potflag, int *flag);
void MR3_get_forces_overlap(double force[]);
void mr3_get_forces_overlap_(double force[]);
void MR3_get_potc_and_potv_overlap(double *potc, double *potv);
void mr3_get_potc_and_potv_overlap_(double *potc, double *potv);
void mr3_get_potc_and_potv_overlap__(double *potc, double *potv);
void MR3_get_forces_and_virial_overlap(double force[], double virial[3][3]);
void mr3_get_forces_and_virial_overlap_(double force[], double virial[3][3]);
void MR3calccoulomb_ci_exlist(int n, double x[], double q[], double force[], double rscale, int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], int *convert_index, int flag);
void mr3calccoulomb_ci_exlist_(int *n, double x[], double q[], double force[], double *rscale, int *tblno, int numex[], int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], int *convert_index, int *flag);
void MR3calcvdw_ci(int n, double x[], int atype[], int nat, double force[], double gscales[], double rscales[], int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calcvdw_ci_(int *n, double x[], int atype[], int *nat, double force[], double gscales[], double rscales[], int *tblno, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calcvdw_ci_exlist(int n, double x[], int atype[], int nat, double force[], double gscales[], double rscales[], int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], int *convert_index, int flag);
void mr3calcvdw_ci_exlist_(int *n, double x[], int atype[], int *nat, double force[], double gscales[], double rscales[], int *tblno, int numex[], int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], int *convert_index, int *flag);
void MR3calccoulomb_vdw_ci_exlist(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], double *potc, double *potv, int *convert_index, int potflag, int flag);
void mr3calccoulomb_vdw_ci_exlist_(int *n, double x[], double q[], int atype[], int *nat, double force[], double *rscale, double gscalesf[], double gscalesp[], double rscales[], int *tblno, int *numex, int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], double *potc, double *potv, int *convert_index, int *potflag, int *flag);
void MR3calccoulomb_ci(int n, double x[], double q[], double force[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calccoulomb_ci_(int *n, double x[], double q[], double force[], double *rscale, int *tblno, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_ij_ci(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_ij_ci_old(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calcvdw_ij_ci(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_virial(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut_org, double skinnb, double volume[3], int ldim[3], double virial[3][3], int flag);
void MR3calccoulomb_vdw_ij_ci(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calccoulomb_vdw_ij_ci_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscales[], double rscales[], double *rscale, int *tblnoc, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_old_09(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_old_090121(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_exlist(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3], int numex[], int natex[], int flag);
void mr3calccoulomb_vdw_ij_ci_exlist_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscales[], double rscales[], double *rscale, int *tblnoc, double *rcut, double *skinnb, double volume[3], int ldim[3], int numex[], int natex[], int *flag);
void MR3_get_board_version(int *version, int *freq);
void MR3_rscale_and_pack(int n, double (*x)[3], int *atype, longlong (*rj)[2]);
void MR3_rscale_and_pack_old(int n, double (*x)[3], int *atype, longlong (*rj)[2]);
void MR3SetTable_emu(char *filename, int tblno, int flag);
int MR3_get_total_num_chips(void);
void MR3print_chip_temperature(int flag);
int MR3_get_retry_count(void);
void m3_free_unit(VG_UNIT *unit);
VG_UNIT *m3_allocate_periodic_unit(const char *fname, int mode, double size, int dum);
void m3_set_positions(VG_UNIT *unit, double (*pos)[3], int n);
void m3_set_charges(VG_UNIT *unit, const double *q, int n);
void m3_set_cells(VG_UNIT *unit, M3_CELL *cell, int ncell);
void m3_calculate_forces(VG_UNIT *unit, double (*xi)[3], int ni, double (*force)[3]);
void m3_calculate_potentials(VG_UNIT *unit, double (*xi)[3], int ni, double *eng);
void m3_set_types(VG_UNIT *unit, const int *atype, int n);
void m3_set_pipeline_types(VG_UNIT *unit, const int *atype, int n);
void m3_set_charge_matrix(VG_UNIT *unit, const double *gscale, int nati, int natj);
void m3_set_rscale_matrix(VG_UNIT *unit, const double *rscale, int nati, int natj);
int MR3_close_ch(int s_sock);
int mr3_close_ch_(int *s_sock);
int MR3_open_port(int port_number);
int MR3_sock_read(int sockfd, char *buf, size_t count);
int mr3_sock_read_(int *sockfd, char *buf, int *count);
int mr3_sock_read__(int *sockfd, char *buf, int *count);
int mr3_sock_read_i_(int *sockfd, int *buf);
int mr3_sock_read_i__(int *sockfd, int *buf);
int MR3_sock_read_iv(int sockfd, int *buf, int count);
int mr3_sock_read_iv_(int *sockfd, int *buf, int *count);
int mr3_sock_read_iv__(int *sockfd, int *buf, int *count);
int MR3_sock_read_d(int sockfd, double *buf);
int mr3_sock_read_d__(int *sockfd, double *buf);
int mr3_sock_read_d_(int *sockfd, double *buf);
int MR3_sock_read_dv(int sockfd, double *buf, int count);
int mr3_sock_read_dv__(int *sockfd, double *buf, int *count);
int mr3_sock_read_dv_(int *sockfd, double *buf, int *count);
int MR3_sock_write(int sockfd, char *buf, size_t count);
int MR3_sock_write_c(int sockfd, char *buf);
int mr3_sock_write_c_(int *sockfd, char *buf);
int mr3_sock_write_c__(int *sockfd, char *buf);
int MR3_sock_write_i(int sockfd, int buf);
int mr3_sock_write_i_(int *sockfd, int *buf);
int mr3_sock_write_i__(int *sockfd, int *buf);
int MR3_sock_write_iv(int sockfd, int *buf, int count);
int mr3_sock_write_iv_(int *sockfd, int *buf, int *count);
int mr3_sock_write_iv__(int *sockfd, int *buf, int *count);
int MR3_sock_write_dv(int sockfd, double *buf, int count);
int mr3_sock_write_dv__(int *sockfd, double *buf, int *count);
int mr3_sock_write_dv_(int *sockfd, double *buf, int *count);
int MR3_sock_gets(int sockfd, char *str, size_t count);
int MR3_sock_puts(int sockfd, char *str);
void MR3_sock_init(int *s_sock_org, int port_num, double x[], int igraph[], int natom, int str_len, int lbres[], int ipres[], int nres);
void mr3_sock_init_(int *s_sock, int *port_num, double x[], int igraph[], int *natom, int *str_len, int lbres[], int ipres[], int *nres);
void mr3_sock_init__(int *s_sock, int *port_num, double x[], int igraph[], int *natom, int *str_len, int lbres[], int ipres[], int *nres);
void MR3_sock_1step(int s_sock, double t1, double time, double t2, int recv_buf[], int natom, double x[], double f[], double f_temp[]);
void mr3_sock_1step_(int *s_sock, double *t1, double *time, double *t2, int recv_buf[], int *natom, double x[], double f[], double f_tmp[]);
void mr3_sock_1step__(int *s_sock, double *t1, double *time, double *t2, int recv_buf[], int *natom, double x[], double f[], double f_tmp[]);
void MR3calc_ij_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, char method);
void MR3calc_ij_exlist_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], char method);
void MR3calc_ij_nlist_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], char method);
/* vtgrape.c */
void *MR3_my_malloc2(size_t n, char *s);
void MR3_my_free2(void **p, char *s);
VG_UNIT *m3_get_unit(void);
void vg_exit(int ret);
VG_UNIT *vg_allocate_unit(void (*function)(void *));
void vg_free_unit(VG_UNIT *unit);
void vg_set_function(VG_UNIT *unit, int function_index, void (*function)(void *));
void vg_set_vectors(VG_UNIT *unit, int nj, void *jvectors);
void vg_set_matrices(VG_UNIT *unit, int nati, int natj, void *matrices);
void vg_set_scalers(VG_UNIT *unit, void *scalers);
void vg_set_pipeline_vectors(VG_UNIT *unit, int ni, void *ivectors);
void vg_calculate(VG_UNIT *unit, int function_index, int nf, void *fvectors, void *pscalers);
void vg_set_vectors_pos_charge_atype(VG_UNIT *unit, int nj, double pos[][3], double charge[], int atype[]);
void vg_set_vectors_pos_charge(VG_UNIT *unit, int nj, double pos[][3], double charge[]);
void vg_set_vectors_pos_atype(VG_UNIT *unit, int nj, double pos[][3], int atype[]);
void vg_set_matrices_gscales_rscales(VG_UNIT *unit, int nati_org, int natj_org, double gscales[], double rscales[]);
void vg_set_pol_sigm_ipotro_pc_pd_zz(VG_UNIT *unit, int nati, int natj, double pol[], double sigm[], double ipotro[], double pc[], double pd[], double zz[]);
void vg_set_scalers_volume_alpha(VG_UNIT *unit, double volume[3], double alpha);
void vg_set_pipeline_vectors_pos_charge_atype(VG_UNIT *unit, int ni, double pos[][3], double charge[], int atype[]);
void vg_set_pipeline_vectors_pos_charge(VG_UNIT *unit, int ni, double pos[][3], double charge[]);
void vg_set_pipeline_vectors_pos_atype(VG_UNIT *unit, int ni, double pos[][3], int atype[]);
void vg_convert_forces(VG_UNIT *unit, int nf, int function_index, double fi[][3]);
void vg_calculate_forces_potentials(VG_UNIT *unit, int function_index, int nf, double fi[][3], double *potc, double *potv);
void vg_get_r1result(int n_org, float r[], float r1[]);
void vg_get_rsqrtresult(int n_org, float r[], float r1[]);
void vg_get_mulresult(int n_org, float r[], float q[], float rq[]);
int vg_write_emufile(int flag);
void vg_initialize_emu(void);
float vg_r1emu(float x);
float vg_rsqrtemu(float x);
void vg_set_scaleq(int n, double q[], double *scaleq, float *scaleq_1);
void m3_set_softening(VG_UNIT *unit, double eps);
void MR3_exit(int ret);
void MR3init(void);
void mr3init_(void);
void mr3init__(void);
void MR3free(void);
void mr3free_(void);
void mr3free__(void);
void MR3calccoulomb(double x[], int n, double q[], double rscale, int tblno, double xmax, int periodicflag, int natchangeflag, double force[]);
void mr3calccoulomb_(double x[], int *n, double q[], double *rscale, int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void mr3calccoulomb__(double x[], int *n, double q[], double *rscale, int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void MR3calccoulomb_ij(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag);
void mr3calccoulomb_ij_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void mr3calccoulomb_ij__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void MR3_sort_with_index_int(int data[], int index[], int left, int right);
void MR3calcvdw_ij_core(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void MR3calcvdw_ij(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void mr3calcvdw_ij_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void mr3calcvdw_ij__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void MR3calcvdw(double x[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int natchangeflag, double force[]);
void mr3calcvdw_(double x[], int *n, int atype[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void mr3calcvdw__(double x[], int *n, int atype[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void MR3calcewald(int *k, int knum_org, double *x, int n, double *chg, double alpha, double epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald__(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void MR3calcnacl(double x[], int n, int atype[], int nat, double pol[], double sigm[], double ipotro[], double pc[], double pd[], double zz[], int tblno, double xmax, int periodicflag, double force[]);
void vtgrape_force(double xj[][3], double mj[], double xi[][3], double eps2, double a[][3], int ni, int nj);
void vg_set_rcut2(VG_UNIT *unit, double rcut2);
void mr3_set_rcut2_(double *rcut2);
int md5sum(unsigned char *buffer, int totallen, unsigned char sum[16]);
int md5sum_file(char *filename, unsigned char sum[16]);
void MR3calccoulomb_ij_host(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag);
void mr3calccoulomb_ij_host_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void mr3calccoulomb_ij_host__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void MR3calcvdw_ij_host(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void mr3calcvdw_ij_host_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void mr3calcvdw_ij_host__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void MR3calccoulomb_nlist_ij_host_notwork(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[], double factorall);
void MR3calccoulomb_nlist_ij_host(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calccoulomb_nlist_host(double xd[], int n, double qd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calcvdw_nlist_ij_host_notwork(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[], double factor);
void MR3calcvdw_nlist_ij_host(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_host2(double x[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[], double factor, double force[]);
void MR3calccoulomb_ij_exlist_host(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void MR3calcvdw_ij_exlist_host(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void MR3calcewald_dft_host(int k[], int knum, double x[], int n, double chg[], double cellsize[3], double bs[], double bc[]);
void MR3calcewald_idft_eng_host(int k[], double bs[], double bc[], int knum, double x[], int n, double cellsize[3], double force[]);
void MR3calcewald_idft_force_host(int k[], double bs[], double bc[], int knum, double x[], int n, double cellsize[3], double force[]);
void MR3calcewald_host(int *k, int knum_org, double *x, int n, double *chg, double alpha, double epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_host__(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_host_(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void MR3SetTable(char *filename, int tblno, int flag);
void mr3settable_nf_(char *fname, int *tblno, int *flag, int *n);
void mr3settable_nf__(char *fname, int *tblno, int *flag, int *n);
void MR3_setup_exlist(int n, int *bckptr);
void mr3_setup_exlist_(int *n, int *bckptr);
void MR3_make_natex2_from_natex(int n, int natex[], int numex[], int **natex_offset, int **natex2, int **numex2, int **natex2_offset, int flag);
void calccoulomb_vdw_ij_exlist_host_sub(int i, int j, double xi[], double xj[], double qj, double gsf, double gsp, double rs, double rscale, double cutoff, double *fc, double *fv, double *pc, double *pv, int tblno, double size[3], int potflag);
void MR3calccoulomb_vdw_ij_exlist_cutoff_host(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double cutoff, double size[3], double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_host(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_host2(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_host_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_host__(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void MR3_get_cputime(double *laptime, double *sprittime);
void MR3_set_ldim(int ldim[3]);
void mr3_set_ldim_(int ldim[3]);
void mr3_set_ldim__(int ldim[3]);
void MR3_set_coulomb_vdw_factor(double cgf);
void mr3_set_coulomb_vdw_factor_(double *cgf);
void mr3_set_coulomb_vdw_factor__(double *cgf);
void MR3calccoulomb_ij_emu(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag);
void MR3calccoulomb_nlist_ij_emu(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calccoulomb_nlist_emu(double xd[], int n, double qd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calcvdw_ij_emu(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void MR3calccoulomb_vdw_nlist_ij_emu(int ni, double xid[], double qid[], int atypei[], double force[], int nj, double xjd[], double qjd[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblno, double volume[], int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_ij_emu(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_emu2(double xd[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calccoulomb_ij_exlist(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void mr3calccoulomb_ij_exlist_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag, int numexorg[], int natexorg[]);
void mr3calccoulomb_ij_exlist__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag, int numexorg[], int natexorg[]);
void MR3calcvdw_ij_exlist(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void mr3calcvdw_ij_exlist_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int numex[], int natex[]);
void mr3calcvdw_ij_exlist__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_core_old(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_core(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_virial_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_exlist(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double volume1, double *potc, double *potv, int *convert_index, int potflag, int flag);
void MR3calccoulomb_vdw_exlist_from_cell(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double volume1, double *potc, double *potv, int *convert_index, int potflag, int flag);
void mr3calccoulomb_vdw_exlist_(int *n, double x[], double q[], int atype[], int *nat, double force[], double *rscale, double gscalesf[], double gscalesp[], double rscales[], int *tblno, int numex[], int natex[], double *volume1, double *potc, double *potv, int *convert_index, int *potflag, int *flag);
void MR3_get_forces_overlap(double force[]);
void mr3_get_forces_overlap_(double force[]);
void MR3_get_potc_and_potv_overlap(double *potc, double *potv);
void mr3_get_potc_and_potv_overlap_(double *potc, double *potv);
void mr3_get_potc_and_potv_overlap__(double *potc, double *potv);
void MR3_get_forces_and_virial_overlap(double force[], double virial[3][3]);
void mr3_get_forces_and_virial_overlap_(double force[], double virial[3][3]);
void MR3calccoulomb_ci_exlist(int n, double x[], double q[], double force[], double rscale, int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], int *convert_index, int flag);
void mr3calccoulomb_ci_exlist_(int *n, double x[], double q[], double force[], double *rscale, int *tblno, int numex[], int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], int *convert_index, int *flag);
void MR3calcvdw_ci(int n, double x[], int atype[], int nat, double force[], double gscales[], double rscales[], int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calcvdw_ci_(int *n, double x[], int atype[], int *nat, double force[], double gscales[], double rscales[], int *tblno, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calcvdw_ci_exlist(int n, double x[], int atype[], int nat, double force[], double gscales[], double rscales[], int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], int *convert_index, int flag);
void mr3calcvdw_ci_exlist_(int *n, double x[], int atype[], int *nat, double force[], double gscales[], double rscales[], int *tblno, int numex[], int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], int *convert_index, int *flag);
void MR3calccoulomb_vdw_ci_exlist(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], double *potc, double *potv, int *convert_index, int potflag, int flag);
void mr3calccoulomb_vdw_ci_exlist_(int *n, double x[], double q[], int atype[], int *nat, double force[], double *rscale, double gscalesf[], double gscalesp[], double rscales[], int *tblno, int *numex, int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], double *potc, double *potv, int *convert_index, int *potflag, int *flag);
void MR3calccoulomb_ci(int n, double x[], double q[], double force[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calccoulomb_ci_(int *n, double x[], double q[], double force[], double *rscale, int *tblno, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_ij_ci(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_ij_ci_old(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calcvdw_ij_ci(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_virial(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut_org, double skinnb, double volume[3], int ldim[3], double virial[3][3], int flag);
void MR3calccoulomb_vdw_ij_ci(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calccoulomb_vdw_ij_ci_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscales[], double rscales[], double *rscale, int *tblnoc, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_old_09(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_old_090121(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_exlist(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3], int numex[], int natex[], int flag);
void mr3calccoulomb_vdw_ij_ci_exlist_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscales[], double rscales[], double *rscale, int *tblnoc, double *rcut, double *skinnb, double volume[3], int ldim[3], int numex[], int natex[], int *flag);
void MR3_get_board_version(int *version, int *freq);
void MR3_rscale_and_pack(int n, double (*x)[3], int *atype, longlong (*rj)[2]);
void MR3_rscale_and_pack_old(int n, double (*x)[3], int *atype, longlong (*rj)[2]);
void MR3SetTable_emu(char *filename, int tblno, int flag);
int MR3_get_total_num_chips(void);
void MR3print_chip_temperature(int flag);
int MR3_get_retry_count(void);
void m3_free_unit(VG_UNIT *unit);
VG_UNIT *m3_allocate_periodic_unit(const char *fname, int mode, double size, int dum);
void m3_set_positions(VG_UNIT *unit, double (*pos)[3], int n);
void m3_set_charges(VG_UNIT *unit, const double *q, int n);
void m3_set_cells(VG_UNIT *unit, M3_CELL *cell, int ncell);
void m3_calculate_forces(VG_UNIT *unit, double (*xi)[3], int ni, double (*force)[3]);
void m3_calculate_potentials(VG_UNIT *unit, double (*xi)[3], int ni, double *eng);
void m3_set_types(VG_UNIT *unit, const int *atype, int n);
void m3_set_pipeline_types(VG_UNIT *unit, const int *atype, int n);
void m3_set_charge_matrix(VG_UNIT *unit, const double *gscale, int nati, int natj);
void m3_set_rscale_matrix(VG_UNIT *unit, const double *rscale, int nati, int natj);
int MR3_close_ch(int s_sock);
int mr3_close_ch_(int *s_sock);
int MR3_open_port(int port_number);
int MR3_sock_read(int sockfd, char *buf, size_t count);
int mr3_sock_read_(int *sockfd, char *buf, int *count);
int mr3_sock_read__(int *sockfd, char *buf, int *count);
int mr3_sock_read_i_(int *sockfd, int *buf);
int mr3_sock_read_i__(int *sockfd, int *buf);
int MR3_sock_read_iv(int sockfd, int *buf, int count);
int mr3_sock_read_iv_(int *sockfd, int *buf, int *count);
int mr3_sock_read_iv__(int *sockfd, int *buf, int *count);
int MR3_sock_read_d(int sockfd, double *buf);
int mr3_sock_read_d__(int *sockfd, double *buf);
int mr3_sock_read_d_(int *sockfd, double *buf);
int MR3_sock_read_dv(int sockfd, double *buf, int count);
int mr3_sock_read_dv__(int *sockfd, double *buf, int *count);
int mr3_sock_read_dv_(int *sockfd, double *buf, int *count);
int MR3_sock_write(int sockfd, char *buf, size_t count);
int MR3_sock_write_c(int sockfd, char *buf);
int mr3_sock_write_c_(int *sockfd, char *buf);
int mr3_sock_write_c__(int *sockfd, char *buf);
int MR3_sock_write_i(int sockfd, int buf);
int mr3_sock_write_i_(int *sockfd, int *buf);
int mr3_sock_write_i__(int *sockfd, int *buf);
int MR3_sock_write_iv(int sockfd, int *buf, int count);
int mr3_sock_write_iv_(int *sockfd, int *buf, int *count);
int mr3_sock_write_iv__(int *sockfd, int *buf, int *count);
int MR3_sock_write_dv(int sockfd, double *buf, int count);
int mr3_sock_write_dv__(int *sockfd, double *buf, int *count);
int mr3_sock_write_dv_(int *sockfd, double *buf, int *count);
int MR3_sock_gets(int sockfd, char *str, size_t count);
int MR3_sock_puts(int sockfd, char *str);
void MR3_sock_init(int *s_sock_org, int port_num, double x[], int igraph[], int natom, int str_len, int lbres[], int ipres[], int nres);
void mr3_sock_init_(int *s_sock, int *port_num, double x[], int igraph[], int *natom, int *str_len, int lbres[], int ipres[], int *nres);
void mr3_sock_init__(int *s_sock, int *port_num, double x[], int igraph[], int *natom, int *str_len, int lbres[], int ipres[], int *nres);
void MR3_sock_1step(int s_sock, double t1, double time, double t2, int recv_buf[], int natom, double x[], double f[], double f_temp[]);
void mr3_sock_1step_(int *s_sock, double *t1, double *time, double *t2, int recv_buf[], int *natom, double x[], double f[], double f_tmp[]);
void mr3_sock_1step__(int *s_sock, double *t1, double *time, double *t2, int recv_buf[], int *natom, double x[], double f[], double f_tmp[]);
void MR3calc_ij_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, char method);
void MR3calc_ij_exlist_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], char method);
void MR3calc_ij_nlist_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], char method);
/* vtgrape.c */
void *MR3_my_malloc2(size_t n, char *s);
void MR3_my_free2(void **p, char *s);
VG_UNIT *m3_get_unit(void);
void vg_exit(int ret);
VG_UNIT *vg_allocate_unit(void (*function)(void *));
void vg_free_unit(VG_UNIT *unit);
void vg_set_function(VG_UNIT *unit, int function_index, void (*function)(void *));
void vg_set_vectors(VG_UNIT *unit, int nj, void *jvectors);
void vg_set_matrices(VG_UNIT *unit, int nati, int natj, void *matrices);
void vg_set_scalers(VG_UNIT *unit, void *scalers);
void vg_set_pipeline_vectors(VG_UNIT *unit, int ni, void *ivectors);
void vg_calculate(VG_UNIT *unit, int function_index, int nf, void *fvectors, void *pscalers);
void vg_set_vectors_pos_charge_atype(VG_UNIT *unit, int nj, double pos[][3], double charge[], int atype[]);
void vg_set_vectors_pos_charge(VG_UNIT *unit, int nj, double pos[][3], double charge[]);
void vg_set_vectors_pos_atype(VG_UNIT *unit, int nj, double pos[][3], int atype[]);
void vg_set_matrices_gscales_rscales(VG_UNIT *unit, int nati_org, int natj_org, double gscales[], double rscales[]);
void vg_set_pol_sigm_ipotro_pc_pd_zz(VG_UNIT *unit, int nati, int natj, double pol[], double sigm[], double ipotro[], double pc[], double pd[], double zz[]);
void vg_set_scalers_volume_alpha(VG_UNIT *unit, double volume[3], double alpha);
void vg_set_pipeline_vectors_pos_charge_atype(VG_UNIT *unit, int ni, double pos[][3], double charge[], int atype[]);
void vg_set_pipeline_vectors_pos_charge(VG_UNIT *unit, int ni, double pos[][3], double charge[]);
void vg_set_pipeline_vectors_pos_atype(VG_UNIT *unit, int ni, double pos[][3], int atype[]);
void vg_convert_forces(VG_UNIT *unit, int nf, int function_index, double fi[][3]);
void vg_calculate_forces_potentials(VG_UNIT *unit, int function_index, int nf, double fi[][3], double *potc, double *potv);
void vg_get_r1result(int n_org, float r[], float r1[]);
void vg_get_rsqrtresult(int n_org, float r[], float r1[]);
void vg_get_mulresult(int n_org, float r[], float q[], float rq[]);
int vg_write_emufile(int flag);
void vg_initialize_emu(void);
float vg_r1emu(float x);
float vg_rsqrtemu(float x);
void vg_set_scaleq(int n, double q[], double *scaleq, float *scaleq_1);
void m3_set_softening(VG_UNIT *unit, double eps);
void MR3_exit(int ret);
void MR3init(void);
void mr3init_(void);
void mr3init__(void);
void MR3free(void);
void mr3free_(void);
void mr3free__(void);
void MR3calccoulomb(double x[], int n, double q[], double rscale, int tblno, double xmax, int periodicflag, int natchangeflag, double force[]);
void mr3calccoulomb_(double x[], int *n, double q[], double *rscale, int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void mr3calccoulomb__(double x[], int *n, double q[], double *rscale, int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void MR3calccoulomb_ij(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag);
void mr3calccoulomb_ij_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void mr3calccoulomb_ij__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void MR3_sort_with_index_int(int data[], int index[], int left, int right);
void MR3calcvdw_ij_core(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void MR3calcvdw_ij(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void mr3calcvdw_ij_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void mr3calcvdw_ij__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void MR3calcvdw(double x[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int natchangeflag, double force[]);
void mr3calcvdw_(double x[], int *n, int atype[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void mr3calcvdw__(double x[], int *n, int atype[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void MR3calcewald(int *k, int knum_org, double *x, int n, double *chg, double alpha, double epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald__(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void MR3calcnacl(double x[], int n, int atype[], int nat, double pol[], double sigm[], double ipotro[], double pc[], double pd[], double zz[], int tblno, double xmax, int periodicflag, double force[]);
void vtgrape_force(double xj[][3], double mj[], double xi[][3], double eps2, double a[][3], int ni, int nj);
void vg_set_rcut2(VG_UNIT *unit, double rcut2);
void mr3_set_rcut2_(double *rcut2);
int md5sum(unsigned char *buffer, int totallen, unsigned char sum[16]);
int md5sum_file(char *filename, unsigned char sum[16]);
void MR3calccoulomb_ij_host(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag);
void mr3calccoulomb_ij_host_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void mr3calccoulomb_ij_host__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void MR3calcvdw_ij_host(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void mr3calcvdw_ij_host_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void mr3calcvdw_ij_host__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void MR3calccoulomb_nlist_ij_host_notwork(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[], double factorall);
void MR3calccoulomb_nlist_ij_host(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calccoulomb_nlist_host(double xd[], int n, double qd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calcvdw_nlist_ij_host_notwork(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[], double factor);
void MR3calcvdw_nlist_ij_host(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_host2(double x[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[], double factor, double force[]);
void MR3calccoulomb_ij_exlist_host(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void MR3calcvdw_ij_exlist_host(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void MR3calcewald_dft_host(int k[], int knum, double x[], int n, double chg[], double cellsize[3], double bs[], double bc[]);
void MR3calcewald_idft_eng_host(int k[], double bs[], double bc[], int knum, double x[], int n, double cellsize[3], double force[]);
void MR3calcewald_idft_force_host(int k[], double bs[], double bc[], int knum, double x[], int n, double cellsize[3], double force[]);
void MR3calcewald_host(int *k, int knum_org, double *x, int n, double *chg, double alpha, double epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_host__(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_host_(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void MR3SetTable(char *filename, int tblno, int flag);
void mr3settable_nf_(char *fname, int *tblno, int *flag, int *n);
void mr3settable_nf__(char *fname, int *tblno, int *flag, int *n);
void MR3_setup_exlist(int n, int *bckptr);
void mr3_setup_exlist_(int *n, int *bckptr);
void MR3_make_natex2_from_natex(int n, int natex[], int numex[], int **natex_offset, int **natex2, int **numex2, int **natex2_offset, int flag);
void calccoulomb_vdw_ij_exlist_host_sub(int i, int j, double xi[], double xj[], double qj, double gsf, double gsp, double rs, double rscale, double cutoff, double *fc, double *fv, double *pc, double *pv, int tblno, double size[3], int potflag);
void MR3calccoulomb_vdw_ij_exlist_cutoff_host(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double cutoff, double size[3], double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_host(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_host2(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_host_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_host__(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void MR3_get_cputime(double *laptime, double *sprittime);
void MR3_set_ldim(int ldim[3]);
void mr3_set_ldim_(int ldim[3]);
void mr3_set_ldim__(int ldim[3]);
void MR3_set_coulomb_vdw_factor(double cgf);
void mr3_set_coulomb_vdw_factor_(double *cgf);
void mr3_set_coulomb_vdw_factor__(double *cgf);
void MR3calccoulomb_ij_emu(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag);
void MR3calccoulomb_nlist_ij_emu(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calccoulomb_nlist_emu(double xd[], int n, double qd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calcvdw_ij_emu(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void MR3calccoulomb_vdw_nlist_ij_emu(int ni, double xid[], double qid[], int atypei[], double force[], int nj, double xjd[], double qjd[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblno, double volume[], int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_ij_emu(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_emu2(double xd[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calccoulomb_ij_exlist(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void mr3calccoulomb_ij_exlist_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag, int numexorg[], int natexorg[]);
void mr3calccoulomb_ij_exlist__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag, int numexorg[], int natexorg[]);
void MR3calcvdw_ij_exlist(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void mr3calcvdw_ij_exlist_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int numex[], int natex[]);
void mr3calcvdw_ij_exlist__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_core_old(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_core(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_virial_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_exlist(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double volume1, double *potc, double *potv, int *convert_index, int potflag, int flag);
void MR3calccoulomb_vdw_exlist_from_cell(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double volume1, double *potc, double *potv, int *convert_index, int potflag, int flag);
void mr3calccoulomb_vdw_exlist_(int *n, double x[], double q[], int atype[], int *nat, double force[], double *rscale, double gscalesf[], double gscalesp[], double rscales[], int *tblno, int numex[], int natex[], double *volume1, double *potc, double *potv, int *convert_index, int *potflag, int *flag);
void MR3_get_forces_overlap(double force[]);
void mr3_get_forces_overlap_(double force[]);
void MR3_get_potc_and_potv_overlap(double *potc, double *potv);
void mr3_get_potc_and_potv_overlap_(double *potc, double *potv);
void mr3_get_potc_and_potv_overlap__(double *potc, double *potv);
void MR3_get_forces_and_virial_overlap(double force[], double virial[3][3]);
void mr3_get_forces_and_virial_overlap_(double force[], double virial[3][3]);
void MR3calccoulomb_ci_exlist(int n, double x[], double q[], double force[], double rscale, int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], int *convert_index, int flag);
void mr3calccoulomb_ci_exlist_(int *n, double x[], double q[], double force[], double *rscale, int *tblno, int numex[], int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], int *convert_index, int *flag);
void MR3calcvdw_ci(int n, double x[], int atype[], int nat, double force[], double gscales[], double rscales[], int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calcvdw_ci_(int *n, double x[], int atype[], int *nat, double force[], double gscales[], double rscales[], int *tblno, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calcvdw_ci_exlist(int n, double x[], int atype[], int nat, double force[], double gscales[], double rscales[], int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], int *convert_index, int flag);
void mr3calcvdw_ci_exlist_(int *n, double x[], int atype[], int *nat, double force[], double gscales[], double rscales[], int *tblno, int numex[], int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], int *convert_index, int *flag);
void MR3calccoulomb_vdw_ci_exlist(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], double *potc, double *potv, int *convert_index, int potflag, int flag);
void mr3calccoulomb_vdw_ci_exlist_(int *n, double x[], double q[], int atype[], int *nat, double force[], double *rscale, double gscalesf[], double gscalesp[], double rscales[], int *tblno, int *numex, int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], double *potc, double *potv, int *convert_index, int *potflag, int *flag);
void MR3calccoulomb_ci(int n, double x[], double q[], double force[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calccoulomb_ci_(int *n, double x[], double q[], double force[], double *rscale, int *tblno, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_ij_ci(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_ij_ci_old(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calcvdw_ij_ci(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_virial(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut_org, double skinnb, double volume[3], int ldim[3], double virial[3][3], int flag);
void MR3calccoulomb_vdw_ij_ci(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calccoulomb_vdw_ij_ci_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscales[], double rscales[], double *rscale, int *tblnoc, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_old_09(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_old_090121(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_exlist(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3], int numex[], int natex[], int flag);
void mr3calccoulomb_vdw_ij_ci_exlist_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscales[], double rscales[], double *rscale, int *tblnoc, double *rcut, double *skinnb, double volume[3], int ldim[3], int numex[], int natex[], int *flag);
void MR3_get_board_version(int *version, int *freq);
void MR3_rscale_and_pack(int n, double (*x)[3], int *atype, longlong (*rj)[2]);
void MR3_rscale_and_pack_old(int n, double (*x)[3], int *atype, longlong (*rj)[2]);
void MR3SetTable_emu(char *filename, int tblno, int flag);
int MR3_get_total_num_chips(void);
void MR3print_chip_temperature(int flag);
int MR3_get_retry_count(void);
void m3_free_unit(VG_UNIT *unit);
VG_UNIT *m3_allocate_periodic_unit(const char *fname, int mode, double size, int dum);
void m3_set_positions(VG_UNIT *unit, double (*pos)[3], int n);
void m3_set_charges(VG_UNIT *unit, const double *q, int n);
void m3_set_cells(VG_UNIT *unit, M3_CELL *cell, int ncell);
void m3_calculate_forces(VG_UNIT *unit, double (*xi)[3], int ni, double (*force)[3]);
void m3_calculate_potentials(VG_UNIT *unit, double (*xi)[3], int ni, double *eng);
void m3_set_types(VG_UNIT *unit, const int *atype, int n);
void m3_set_pipeline_types(VG_UNIT *unit, const int *atype, int n);
void m3_set_charge_matrix(VG_UNIT *unit, const double *gscale, int nati, int natj);
void m3_set_rscale_matrix(VG_UNIT *unit, const double *rscale, int nati, int natj);
int MR3_close_ch(int s_sock);
int mr3_close_ch_(int *s_sock);
int MR3_open_port(int port_number);
int MR3_sock_read(int sockfd, char *buf, size_t count);
int mr3_sock_read_(int *sockfd, char *buf, int *count);
int mr3_sock_read__(int *sockfd, char *buf, int *count);
int mr3_sock_read_i_(int *sockfd, int *buf);
int mr3_sock_read_i__(int *sockfd, int *buf);
int MR3_sock_read_iv(int sockfd, int *buf, int count);
int mr3_sock_read_iv_(int *sockfd, int *buf, int *count);
int mr3_sock_read_iv__(int *sockfd, int *buf, int *count);
int MR3_sock_read_d(int sockfd, double *buf);
int mr3_sock_read_d__(int *sockfd, double *buf);
int mr3_sock_read_d_(int *sockfd, double *buf);
int MR3_sock_read_dv(int sockfd, double *buf, int count);
int mr3_sock_read_dv__(int *sockfd, double *buf, int *count);
int mr3_sock_read_dv_(int *sockfd, double *buf, int *count);
int MR3_sock_write(int sockfd, char *buf, size_t count);
int MR3_sock_write_c(int sockfd, char *buf);
int mr3_sock_write_c_(int *sockfd, char *buf);
int mr3_sock_write_c__(int *sockfd, char *buf);
int MR3_sock_write_i(int sockfd, int buf);
int mr3_sock_write_i_(int *sockfd, int *buf);
int mr3_sock_write_i__(int *sockfd, int *buf);
int MR3_sock_write_iv(int sockfd, int *buf, int count);
int mr3_sock_write_iv_(int *sockfd, int *buf, int *count);
int mr3_sock_write_iv__(int *sockfd, int *buf, int *count);
int MR3_sock_write_dv(int sockfd, double *buf, int count);
int mr3_sock_write_dv__(int *sockfd, double *buf, int *count);
int mr3_sock_write_dv_(int *sockfd, double *buf, int *count);
int MR3_sock_gets(int sockfd, char *str, size_t count);
int MR3_sock_puts(int sockfd, char *str);
void MR3_sock_init(int *s_sock_org, int port_num, double x[], int igraph[], int natom, int str_len, int lbres[], int ipres[], int nres);
void mr3_sock_init_(int *s_sock, int *port_num, double x[], int igraph[], int *natom, int *str_len, int lbres[], int ipres[], int *nres);
void mr3_sock_init__(int *s_sock, int *port_num, double x[], int igraph[], int *natom, int *str_len, int lbres[], int ipres[], int *nres);
void MR3_sock_1step(int s_sock, double t1, double time, double t2, int recv_buf[], int natom, double x[], double f[], double f_temp[]);
void mr3_sock_1step_(int *s_sock, double *t1, double *time, double *t2, int recv_buf[], int *natom, double x[], double f[], double f_tmp[]);
void mr3_sock_1step__(int *s_sock, double *t1, double *time, double *t2, int recv_buf[], int *natom, double x[], double f[], double f_tmp[]);
void MR3calc_ij_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, char method);
void MR3calc_ij_exlist_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], char method);
void MR3calc_ij_nlist_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], char method);
/* vtgrape.c */
void *MR3_my_malloc2(size_t n, char *s);
void MR3_my_free2(void **p, char *s);
VG_UNIT *m3_get_unit(void);
void vg_exit(int ret);
VG_UNIT *vg_allocate_unit(void (*function)(void *));
void vg_free_unit(VG_UNIT *unit);
void vg_set_function(VG_UNIT *unit, int function_index, void (*function)(void *));
void vg_set_vectors(VG_UNIT *unit, int nj, void *jvectors);
void vg_set_matrices(VG_UNIT *unit, int nati, int natj, void *matrices);
void vg_set_scalers(VG_UNIT *unit, void *scalers);
void vg_set_pipeline_vectors(VG_UNIT *unit, int ni, void *ivectors);
void vg_calculate(VG_UNIT *unit, int function_index, int nf, void *fvectors, void *pscalers);
void vg_set_vectors_pos_charge_atype(VG_UNIT *unit, int nj, double pos[][3], double charge[], int atype[]);
void vg_set_vectors_pos_charge(VG_UNIT *unit, int nj, double pos[][3], double charge[]);
void vg_set_vectors_pos_atype(VG_UNIT *unit, int nj, double pos[][3], int atype[]);
void vg_set_matrices_gscales_rscales(VG_UNIT *unit, int nati_org, int natj_org, double gscales[], double rscales[]);
void vg_set_pol_sigm_ipotro_pc_pd_zz(VG_UNIT *unit, int nati, int natj, double pol[], double sigm[], double ipotro[], double pc[], double pd[], double zz[]);
void vg_set_scalers_volume_alpha(VG_UNIT *unit, double volume[3], double alpha);
void vg_set_pipeline_vectors_pos_charge_atype(VG_UNIT *unit, int ni, double pos[][3], double charge[], int atype[]);
void vg_set_pipeline_vectors_pos_charge(VG_UNIT *unit, int ni, double pos[][3], double charge[]);
void vg_set_pipeline_vectors_pos_atype(VG_UNIT *unit, int ni, double pos[][3], int atype[]);
void vg_convert_forces(VG_UNIT *unit, int nf, int function_index, double fi[][3]);
void vg_calculate_forces_potentials(VG_UNIT *unit, int function_index, int nf, double fi[][3], double *potc, double *potv);
void vg_get_r1result(int n_org, float r[], float r1[]);
void vg_get_rsqrtresult(int n_org, float r[], float r1[]);
void vg_get_mulresult(int n_org, float r[], float q[], float rq[]);
int vg_write_emufile(int flag);
void vg_initialize_emu(void);
float vg_r1emu(float x);
float vg_rsqrtemu(float x);
void vg_set_scaleq(int n, double q[], double *scaleq, float *scaleq_1);
void m3_set_softening(VG_UNIT *unit, double eps);
void MR3_exit(int ret);
void MR3init(void);
void mr3init_(void);
void mr3init__(void);
void MR3free(void);
void mr3free_(void);
void mr3free__(void);
void MR3calccoulomb(double x[], int n, double q[], double rscale, int tblno, double xmax, int periodicflag, int natchangeflag, double force[]);
void mr3calccoulomb_(double x[], int *n, double q[], double *rscale, int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void mr3calccoulomb__(double x[], int *n, double q[], double *rscale, int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void MR3calccoulomb_ij(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag);
void mr3calccoulomb_ij_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void mr3calccoulomb_ij__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void MR3_sort_with_index_int(int data[], int index[], int left, int right);
void MR3calcvdw_ij_core(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void MR3calcvdw_ij(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void mr3calcvdw_ij_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void mr3calcvdw_ij__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void MR3calcvdw(double x[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int natchangeflag, double force[]);
void mr3calcvdw_(double x[], int *n, int atype[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void mr3calcvdw__(double x[], int *n, int atype[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void MR3calcewald(int *k, int knum_org, double *x, int n, double *chg, double alpha, double epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald__(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void MR3calcnacl(double x[], int n, int atype[], int nat, double pol[], double sigm[], double ipotro[], double pc[], double pd[], double zz[], int tblno, double xmax, int periodicflag, double force[]);
void vtgrape_force(double xj[][3], double mj[], double xi[][3], double eps2, double a[][3], int ni, int nj);
void vg_set_rcut2(VG_UNIT *unit, double rcut2);
void mr3_set_rcut2_(double *rcut2);
int md5sum(unsigned char *buffer, int totallen, unsigned char sum[16]);
int md5sum_file(char *filename, unsigned char sum[16]);
void MR3calccoulomb_ij_host(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag);
void mr3calccoulomb_ij_host_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void mr3calccoulomb_ij_host__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void MR3calcvdw_ij_host(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void mr3calcvdw_ij_host_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void mr3calcvdw_ij_host__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void MR3calccoulomb_nlist_ij_host_notwork(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[], double factorall);
void MR3calccoulomb_nlist_ij_host(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calccoulomb_nlist_host(double xd[], int n, double qd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calcvdw_nlist_ij_host_notwork(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[], double factor);
void MR3calcvdw_nlist_ij_host(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_host2(double x[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[], double factor, double force[]);
void MR3calccoulomb_ij_exlist_host(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void MR3calcvdw_ij_exlist_host(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void MR3calcewald_dft_host(int k[], int knum, double x[], int n, double chg[], double cellsize[3], double bs[], double bc[]);
void MR3calcewald_idft_eng_host(int k[], double bs[], double bc[], int knum, double x[], int n, double cellsize[3], double force[]);
void MR3calcewald_idft_force_host(int k[], double bs[], double bc[], int knum, double x[], int n, double cellsize[3], double force[]);
void MR3calcewald_host(int *k, int knum_org, double *x, int n, double *chg, double alpha, double epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_host__(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_host_(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void MR3SetTable(char *filename, int tblno, int flag);
void mr3settable_nf_(char *fname, int *tblno, int *flag, int *n);
void mr3settable_nf__(char *fname, int *tblno, int *flag, int *n);
void MR3_setup_exlist(int n, int *bckptr);
void mr3_setup_exlist_(int *n, int *bckptr);
void MR3_make_natex2_from_natex(int n, int natex[], int numex[], int **natex_offset, int **natex2, int **numex2, int **natex2_offset, int flag);
void calccoulomb_vdw_ij_exlist_host_sub(int i, int j, double xi[], double xj[], double qj, double gsf, double gsp, double rs, double rscale, double cutoff, double *fc, double *fv, double *pc, double *pv, int tblno, double size[3], int potflag);
void MR3calccoulomb_vdw_ij_exlist_cutoff_host(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double cutoff, double size[3], double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_host(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_host2(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_host_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_host__(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void MR3_get_cputime(double *laptime, double *sprittime);
void MR3_set_ldim(int ldim[3]);
void mr3_set_ldim_(int ldim[3]);
void mr3_set_ldim__(int ldim[3]);
void MR3_set_coulomb_vdw_factor(double cgf);
void mr3_set_coulomb_vdw_factor_(double *cgf);
void mr3_set_coulomb_vdw_factor__(double *cgf);
void MR3calccoulomb_ij_emu(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag);
void MR3calccoulomb_nlist_ij_emu(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calccoulomb_nlist_emu(double xd[], int n, double qd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calcvdw_ij_emu(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void MR3calccoulomb_vdw_nlist_ij_emu(int ni, double xid[], double qid[], int atypei[], double force[], int nj, double xjd[], double qjd[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblno, double volume[], int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_ij_emu(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_emu2(double xd[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calccoulomb_ij_exlist(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void mr3calccoulomb_ij_exlist_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag, int numexorg[], int natexorg[]);
void mr3calccoulomb_ij_exlist__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag, int numexorg[], int natexorg[]);
void MR3calcvdw_ij_exlist(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void mr3calcvdw_ij_exlist_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int numex[], int natex[]);
void mr3calcvdw_ij_exlist__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_core_old(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_core(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_virial_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_exlist(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double volume1, double *potc, double *potv, int *convert_index, int potflag, int flag);
void MR3calccoulomb_vdw_exlist_from_cell(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double volume1, double *potc, double *potv, int *convert_index, int potflag, int flag);
void mr3calccoulomb_vdw_exlist_(int *n, double x[], double q[], int atype[], int *nat, double force[], double *rscale, double gscalesf[], double gscalesp[], double rscales[], int *tblno, int numex[], int natex[], double *volume1, double *potc, double *potv, int *convert_index, int *potflag, int *flag);
void MR3_get_forces_overlap(double force[]);
void mr3_get_forces_overlap_(double force[]);
void MR3_get_potc_and_potv_overlap(double *potc, double *potv);
void mr3_get_potc_and_potv_overlap_(double *potc, double *potv);
void mr3_get_potc_and_potv_overlap__(double *potc, double *potv);
void MR3_get_forces_and_virial_overlap(double force[], double virial[3][3]);
void mr3_get_forces_and_virial_overlap_(double force[], double virial[3][3]);
void MR3calccoulomb_ci_exlist(int n, double x[], double q[], double force[], double rscale, int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], int *convert_index, int flag);
void mr3calccoulomb_ci_exlist_(int *n, double x[], double q[], double force[], double *rscale, int *tblno, int numex[], int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], int *convert_index, int *flag);
void MR3calcvdw_ci(int n, double x[], int atype[], int nat, double force[], double gscales[], double rscales[], int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calcvdw_ci_(int *n, double x[], int atype[], int *nat, double force[], double gscales[], double rscales[], int *tblno, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calcvdw_ci_exlist(int n, double x[], int atype[], int nat, double force[], double gscales[], double rscales[], int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], int *convert_index, int flag);
void mr3calcvdw_ci_exlist_(int *n, double x[], int atype[], int *nat, double force[], double gscales[], double rscales[], int *tblno, int numex[], int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], int *convert_index, int *flag);
void MR3calccoulomb_vdw_ci_exlist(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], double *potc, double *potv, int *convert_index, int potflag, int flag);
void mr3calccoulomb_vdw_ci_exlist_(int *n, double x[], double q[], int atype[], int *nat, double force[], double *rscale, double gscalesf[], double gscalesp[], double rscales[], int *tblno, int *numex, int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], double *potc, double *potv, int *convert_index, int *potflag, int *flag);
void MR3calccoulomb_ci(int n, double x[], double q[], double force[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calccoulomb_ci_(int *n, double x[], double q[], double force[], double *rscale, int *tblno, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_ij_ci(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_ij_ci_old(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calcvdw_ij_ci(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_virial(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut_org, double skinnb, double volume[3], int ldim[3], double virial[3][3], int flag);
void MR3calccoulomb_vdw_ij_ci(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calccoulomb_vdw_ij_ci_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscales[], double rscales[], double *rscale, int *tblnoc, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_old_09(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_old_090121(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_exlist(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3], int numex[], int natex[], int flag);
void mr3calccoulomb_vdw_ij_ci_exlist_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscales[], double rscales[], double *rscale, int *tblnoc, double *rcut, double *skinnb, double volume[3], int ldim[3], int numex[], int natex[], int *flag);
void MR3_get_board_version(int *version, int *freq);
void MR3_rscale_and_pack(int n, double (*x)[3], int *atype, longlong (*rj)[2]);
void MR3_rscale_and_pack_old(int n, double (*x)[3], int *atype, longlong (*rj)[2]);
void MR3SetTable_emu(char *filename, int tblno, int flag);
int MR3_get_total_num_chips(void);
void MR3print_chip_temperature(int flag);
int MR3_get_retry_count(void);
void m3_free_unit(VG_UNIT *unit);
VG_UNIT *m3_allocate_periodic_unit(const char *fname, int mode, double size, int dum);
void m3_set_positions(VG_UNIT *unit, double (*pos)[3], int n);
void m3_set_charges(VG_UNIT *unit, const double *q, int n);
void m3_set_cells(VG_UNIT *unit, M3_CELL *cell, int ncell);
void m3_calculate_forces(VG_UNIT *unit, double (*xi)[3], int ni, double (*force)[3]);
void m3_calculate_potentials(VG_UNIT *unit, double (*xi)[3], int ni, double *eng);
void m3_set_types(VG_UNIT *unit, const int *atype, int n);
void m3_set_pipeline_types(VG_UNIT *unit, const int *atype, int n);
void m3_set_charge_matrix(VG_UNIT *unit, const double *gscale, int nati, int natj);
void m3_set_rscale_matrix(VG_UNIT *unit, const double *rscale, int nati, int natj);
int MR3_close_ch(int s_sock);
int mr3_close_ch_(int *s_sock);
int MR3_open_port(int port_number);
int MR3_sock_read(int sockfd, char *buf, size_t count);
int mr3_sock_read_(int *sockfd, char *buf, int *count);
int mr3_sock_read__(int *sockfd, char *buf, int *count);
int mr3_sock_read_i_(int *sockfd, int *buf);
int mr3_sock_read_i__(int *sockfd, int *buf);
int MR3_sock_read_iv(int sockfd, int *buf, int count);
int mr3_sock_read_iv_(int *sockfd, int *buf, int *count);
int mr3_sock_read_iv__(int *sockfd, int *buf, int *count);
int MR3_sock_read_d(int sockfd, double *buf);
int mr3_sock_read_d__(int *sockfd, double *buf);
int mr3_sock_read_d_(int *sockfd, double *buf);
int MR3_sock_read_dv(int sockfd, double *buf, int count);
int mr3_sock_read_dv__(int *sockfd, double *buf, int *count);
int mr3_sock_read_dv_(int *sockfd, double *buf, int *count);
int MR3_sock_write(int sockfd, char *buf, size_t count);
int MR3_sock_write_c(int sockfd, char *buf);
int mr3_sock_write_c_(int *sockfd, char *buf);
int mr3_sock_write_c__(int *sockfd, char *buf);
int MR3_sock_write_i(int sockfd, int buf);
int mr3_sock_write_i_(int *sockfd, int *buf);
int mr3_sock_write_i__(int *sockfd, int *buf);
int MR3_sock_write_iv(int sockfd, int *buf, int count);
int mr3_sock_write_iv_(int *sockfd, int *buf, int *count);
int mr3_sock_write_iv__(int *sockfd, int *buf, int *count);
int MR3_sock_write_dv(int sockfd, double *buf, int count);
int mr3_sock_write_dv__(int *sockfd, double *buf, int *count);
int mr3_sock_write_dv_(int *sockfd, double *buf, int *count);
int MR3_sock_gets(int sockfd, char *str, size_t count);
int MR3_sock_puts(int sockfd, char *str);
void MR3_sock_init(int *s_sock_org, int port_num, double x[], int igraph[], int natom, int str_len, int lbres[], int ipres[], int nres);
void mr3_sock_init_(int *s_sock, int *port_num, double x[], int igraph[], int *natom, int *str_len, int lbres[], int ipres[], int *nres);
void mr3_sock_init__(int *s_sock, int *port_num, double x[], int igraph[], int *natom, int *str_len, int lbres[], int ipres[], int *nres);
void MR3_sock_1step(int s_sock, double t1, double time, double t2, int recv_buf[], int natom, double x[], double f[], double f_temp[]);
void mr3_sock_1step_(int *s_sock, double *t1, double *time, double *t2, int recv_buf[], int *natom, double x[], double f[], double f_tmp[]);
void mr3_sock_1step__(int *s_sock, double *t1, double *time, double *t2, int recv_buf[], int *natom, double x[], double f[], double f_tmp[]);
void MR3calc_ij_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, char method);
void MR3calc_ij_exlist_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], char method);
void MR3calc_ij_nlist_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], char method);
/* vtgrape.c */
void *MR3_my_malloc2(size_t n, char *s);
void MR3_my_free2(void **p, char *s);
VG_UNIT *m3_get_unit(void);
void vg_exit(int ret);
VG_UNIT *vg_allocate_unit(void (*function)(void *));
void vg_free_unit(VG_UNIT *unit);
void vg_set_function(VG_UNIT *unit, int function_index, void (*function)(void *));
void vg_set_vectors(VG_UNIT *unit, int nj, void *jvectors);
void vg_set_matrices(VG_UNIT *unit, int nati, int natj, void *matrices);
void vg_set_scalers(VG_UNIT *unit, void *scalers);
void vg_set_pipeline_vectors(VG_UNIT *unit, int ni, void *ivectors);
void vg_calculate(VG_UNIT *unit, int function_index, int nf, void *fvectors, void *pscalers);
void vg_set_vectors_pos_charge_atype(VG_UNIT *unit, int nj, double pos[][3], double charge[], int atype[]);
void vg_set_vectors_pos_charge(VG_UNIT *unit, int nj, double pos[][3], double charge[]);
void vg_set_vectors_pos_atype(VG_UNIT *unit, int nj, double pos[][3], int atype[]);
void vg_set_matrices_gscales_rscales(VG_UNIT *unit, int nati_org, int natj_org, double gscales[], double rscales[]);
void vg_set_pol_sigm_ipotro_pc_pd_zz(VG_UNIT *unit, int nati, int natj, double pol[], double sigm[], double ipotro[], double pc[], double pd[], double zz[]);
void vg_set_scalers_volume_alpha(VG_UNIT *unit, double volume[3], double alpha);
void vg_set_pipeline_vectors_pos_charge_atype(VG_UNIT *unit, int ni, double pos[][3], double charge[], int atype[]);
void vg_set_pipeline_vectors_pos_charge(VG_UNIT *unit, int ni, double pos[][3], double charge[]);
void vg_set_pipeline_vectors_pos_atype(VG_UNIT *unit, int ni, double pos[][3], int atype[]);
void vg_convert_forces(VG_UNIT *unit, int nf, int function_index, double fi[][3]);
void vg_calculate_forces_potentials(VG_UNIT *unit, int function_index, int nf, double fi[][3], double *potc, double *potv);
void vg_get_r1result(int n_org, float r[], float r1[]);
void vg_get_rsqrtresult(int n_org, float r[], float r1[]);
void vg_get_mulresult(int n_org, float r[], float q[], float rq[]);
int vg_write_emufile(int flag);
void vg_initialize_emu(void);
float vg_r1emu(float x);
float vg_rsqrtemu(float x);
void vg_set_scaleq(int n, double q[], double *scaleq, float *scaleq_1);
void m3_set_softening(VG_UNIT *unit, double eps);
void MR3_exit(int ret);
void MR3init(void);
void mr3init_(void);
void mr3init__(void);
void MR3free(void);
void mr3free_(void);
void mr3free__(void);
void MR3calccoulomb(double x[], int n, double q[], double rscale, int tblno, double xmax, int periodicflag, int natchangeflag, double force[]);
void mr3calccoulomb_(double x[], int *n, double q[], double *rscale, int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void mr3calccoulomb__(double x[], int *n, double q[], double *rscale, int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void MR3calccoulomb_ij(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag);
void mr3calccoulomb_ij_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void mr3calccoulomb_ij__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void MR3_sort_with_index_int(int data[], int index[], int left, int right);
void MR3calcvdw_ij_core(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void MR3calcvdw_ij(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void mr3calcvdw_ij_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void mr3calcvdw_ij__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void MR3calcvdw(double x[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int natchangeflag, double force[]);
void mr3calcvdw_(double x[], int *n, int atype[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void mr3calcvdw__(double x[], int *n, int atype[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void MR3calcewald(int *k, int knum_org, double *x, int n, double *chg, double alpha, double epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald__(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void MR3calcnacl(double x[], int n, int atype[], int nat, double pol[], double sigm[], double ipotro[], double pc[], double pd[], double zz[], int tblno, double xmax, int periodicflag, double force[]);
void vtgrape_force(double xj[][3], double mj[], double xi[][3], double eps2, double a[][3], int ni, int nj);
void vg_set_rcut2(VG_UNIT *unit, double rcut2);
void mr3_set_rcut2_(double *rcut2);
int md5sum(unsigned char *buffer, int totallen, unsigned char sum[16]);
int md5sum_file(char *filename, unsigned char sum[16]);
void MR3calccoulomb_ij_host(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag);
void mr3calccoulomb_ij_host_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void mr3calccoulomb_ij_host__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void MR3calcvdw_ij_host(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void mr3calcvdw_ij_host_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void mr3calcvdw_ij_host__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void MR3calccoulomb_nlist_ij_host_notwork(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[], double factorall);
void MR3calccoulomb_nlist_ij_host(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calccoulomb_nlist_host(double xd[], int n, double qd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calcvdw_nlist_ij_host_notwork(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[], double factor);
void MR3calcvdw_nlist_ij_host(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_host2(double x[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[], double factor, double force[]);
void MR3calccoulomb_ij_exlist_host(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void MR3calcvdw_ij_exlist_host(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void MR3calcewald_dft_host(int k[], int knum, double x[], int n, double chg[], double cellsize[3], double bs[], double bc[]);
void MR3calcewald_idft_eng_host(int k[], double bs[], double bc[], int knum, double x[], int n, double cellsize[3], double force[]);
void MR3calcewald_idft_force_host(int k[], double bs[], double bc[], int knum, double x[], int n, double cellsize[3], double force[]);
void MR3calcewald_host(int *k, int knum_org, double *x, int n, double *chg, double alpha, double epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_host__(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_host_(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void MR3SetTable(char *filename, int tblno, int flag);
void mr3settable_nf_(char *fname, int *tblno, int *flag, int *n);
void mr3settable_nf__(char *fname, int *tblno, int *flag, int *n);
void MR3_setup_exlist(int n, int *bckptr);
void mr3_setup_exlist_(int *n, int *bckptr);
void MR3_make_natex2_from_natex(int n, int natex[], int numex[], int **natex_offset, int **natex2, int **numex2, int **natex2_offset, int flag);
void calccoulomb_vdw_ij_exlist_host_sub(int i, int j, double xi[], double xj[], double qj, double gsf, double gsp, double rs, double rscale, double cutoff, double *fc, double *fv, double *pc, double *pv, int tblno, double size[3], int potflag);
void MR3calccoulomb_vdw_ij_exlist_cutoff_host(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double cutoff, double size[3], double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_host(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_host2(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_host_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_host__(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void MR3_get_cputime(double *laptime, double *sprittime);
void MR3_set_ldim(int ldim[3]);
void mr3_set_ldim_(int ldim[3]);
void mr3_set_ldim__(int ldim[3]);
void MR3_set_coulomb_vdw_factor(double cgf);
void mr3_set_coulomb_vdw_factor_(double *cgf);
void mr3_set_coulomb_vdw_factor__(double *cgf);
void MR3calccoulomb_ij_emu(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag);
void MR3calccoulomb_nlist_ij_emu(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calccoulomb_nlist_emu(double xd[], int n, double qd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calcvdw_ij_emu(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void MR3calccoulomb_vdw_nlist_ij_emu(int ni, double xid[], double qid[], int atypei[], double force[], int nj, double xjd[], double qjd[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblno, double volume[], int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_ij_emu(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_emu2(double xd[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calccoulomb_ij_exlist(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void mr3calccoulomb_ij_exlist_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag, int numexorg[], int natexorg[]);
void mr3calccoulomb_ij_exlist__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag, int numexorg[], int natexorg[]);
void MR3calcvdw_ij_exlist(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void mr3calcvdw_ij_exlist_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int numex[], int natex[]);
void mr3calcvdw_ij_exlist__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_core_old(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_core(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_virial_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_exlist(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double volume1, double *potc, double *potv, int *convert_index, int potflag, int flag);
void MR3calccoulomb_vdw_exlist_from_cell(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double volume1, double *potc, double *potv, int *convert_index, int potflag, int flag);
void mr3calccoulomb_vdw_exlist_(int *n, double x[], double q[], int atype[], int *nat, double force[], double *rscale, double gscalesf[], double gscalesp[], double rscales[], int *tblno, int numex[], int natex[], double *volume1, double *potc, double *potv, int *convert_index, int *potflag, int *flag);
void MR3_get_forces_overlap(double force[]);
void mr3_get_forces_overlap_(double force[]);
void MR3_get_potc_and_potv_overlap(double *potc, double *potv);
void mr3_get_potc_and_potv_overlap_(double *potc, double *potv);
void mr3_get_potc_and_potv_overlap__(double *potc, double *potv);
void MR3_get_forces_and_virial_overlap(double force[], double virial[3][3]);
void mr3_get_forces_and_virial_overlap_(double force[], double virial[3][3]);
void MR3calccoulomb_ci_exlist(int n, double x[], double q[], double force[], double rscale, int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], int *convert_index, int flag);
void mr3calccoulomb_ci_exlist_(int *n, double x[], double q[], double force[], double *rscale, int *tblno, int numex[], int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], int *convert_index, int *flag);
void MR3calcvdw_ci(int n, double x[], int atype[], int nat, double force[], double gscales[], double rscales[], int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calcvdw_ci_(int *n, double x[], int atype[], int *nat, double force[], double gscales[], double rscales[], int *tblno, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calcvdw_ci_exlist(int n, double x[], int atype[], int nat, double force[], double gscales[], double rscales[], int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], int *convert_index, int flag);
void mr3calcvdw_ci_exlist_(int *n, double x[], int atype[], int *nat, double force[], double gscales[], double rscales[], int *tblno, int numex[], int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], int *convert_index, int *flag);
void MR3calccoulomb_vdw_ci_exlist(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], double *potc, double *potv, int *convert_index, int potflag, int flag);
void mr3calccoulomb_vdw_ci_exlist_(int *n, double x[], double q[], int atype[], int *nat, double force[], double *rscale, double gscalesf[], double gscalesp[], double rscales[], int *tblno, int *numex, int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], double *potc, double *potv, int *convert_index, int *potflag, int *flag);
void MR3calccoulomb_ci(int n, double x[], double q[], double force[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calccoulomb_ci_(int *n, double x[], double q[], double force[], double *rscale, int *tblno, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_ij_ci(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_ij_ci_old(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calcvdw_ij_ci(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_virial(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut_org, double skinnb, double volume[3], int ldim[3], double virial[3][3], int flag);
void MR3calccoulomb_vdw_ij_ci(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calccoulomb_vdw_ij_ci_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscales[], double rscales[], double *rscale, int *tblnoc, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_old_09(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_old_090121(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_exlist(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3], int numex[], int natex[], int flag);
void mr3calccoulomb_vdw_ij_ci_exlist_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscales[], double rscales[], double *rscale, int *tblnoc, double *rcut, double *skinnb, double volume[3], int ldim[3], int numex[], int natex[], int *flag);
void MR3_get_board_version(int *version, int *freq);
void MR3_rscale_and_pack(int n, double (*x)[3], int *atype, longlong (*rj)[2]);
void MR3_rscale_and_pack_old(int n, double (*x)[3], int *atype, longlong (*rj)[2]);
void MR3SetTable_emu(char *filename, int tblno, int flag);
int MR3_get_total_num_chips(void);
void MR3print_chip_temperature(int flag);
int MR3_get_retry_count(void);
void m3_free_unit(VG_UNIT *unit);
VG_UNIT *m3_allocate_periodic_unit(const char *fname, int mode, double size, int dum);
void m3_set_positions(VG_UNIT *unit, double (*pos)[3], int n);
void m3_set_charges(VG_UNIT *unit, const double *q, int n);
void m3_set_cells(VG_UNIT *unit, M3_CELL *cell, int ncell);
void m3_calculate_forces(VG_UNIT *unit, double (*xi)[3], int ni, double (*force)[3]);
void m3_calculate_potentials(VG_UNIT *unit, double (*xi)[3], int ni, double *eng);
void m3_set_types(VG_UNIT *unit, const int *atype, int n);
void m3_set_pipeline_types(VG_UNIT *unit, const int *atype, int n);
void m3_set_charge_matrix(VG_UNIT *unit, const double *gscale, int nati, int natj);
void m3_set_rscale_matrix(VG_UNIT *unit, const double *rscale, int nati, int natj);
int MR3_close_ch(int s_sock);
int mr3_close_ch_(int *s_sock);
int MR3_open_port(int port_number);
int MR3_sock_read(int sockfd, char *buf, size_t count);
int mr3_sock_read_(int *sockfd, char *buf, int *count);
int mr3_sock_read__(int *sockfd, char *buf, int *count);
int mr3_sock_read_i_(int *sockfd, int *buf);
int mr3_sock_read_i__(int *sockfd, int *buf);
int MR3_sock_read_iv(int sockfd, int *buf, int count);
int mr3_sock_read_iv_(int *sockfd, int *buf, int *count);
int mr3_sock_read_iv__(int *sockfd, int *buf, int *count);
int MR3_sock_read_d(int sockfd, double *buf);
int mr3_sock_read_d__(int *sockfd, double *buf);
int mr3_sock_read_d_(int *sockfd, double *buf);
int MR3_sock_read_dv(int sockfd, double *buf, int count);
int mr3_sock_read_dv__(int *sockfd, double *buf, int *count);
int mr3_sock_read_dv_(int *sockfd, double *buf, int *count);
int MR3_sock_write(int sockfd, char *buf, size_t count);
int MR3_sock_write_c(int sockfd, char *buf);
int mr3_sock_write_c_(int *sockfd, char *buf);
int mr3_sock_write_c__(int *sockfd, char *buf);
int MR3_sock_write_i(int sockfd, int buf);
int mr3_sock_write_i_(int *sockfd, int *buf);
int mr3_sock_write_i__(int *sockfd, int *buf);
int MR3_sock_write_iv(int sockfd, int *buf, int count);
int mr3_sock_write_iv_(int *sockfd, int *buf, int *count);
int mr3_sock_write_iv__(int *sockfd, int *buf, int *count);
int MR3_sock_write_dv(int sockfd, double *buf, int count);
int mr3_sock_write_dv__(int *sockfd, double *buf, int *count);
int mr3_sock_write_dv_(int *sockfd, double *buf, int *count);
int MR3_sock_gets(int sockfd, char *str, size_t count);
int MR3_sock_puts(int sockfd, char *str);
void MR3_sock_init(int *s_sock_org, int port_num, double x[], int igraph[], int natom, int str_len, int lbres[], int ipres[], int nres);
void mr3_sock_init_(int *s_sock, int *port_num, double x[], int igraph[], int *natom, int *str_len, int lbres[], int ipres[], int *nres);
void mr3_sock_init__(int *s_sock, int *port_num, double x[], int igraph[], int *natom, int *str_len, int lbres[], int ipres[], int *nres);
void MR3_sock_1step(int s_sock, double t1, double time, double t2, int recv_buf[], int natom, double x[], double f[], double f_temp[]);
void mr3_sock_1step_(int *s_sock, double *t1, double *time, double *t2, int recv_buf[], int *natom, double x[], double f[], double f_tmp[]);
void mr3_sock_1step__(int *s_sock, double *t1, double *time, double *t2, int recv_buf[], int *natom, double x[], double f[], double f_tmp[]);
void MR3calc_ij_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, char method);
void MR3calc_ij_exlist_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], char method);
void MR3calc_ij_nlist_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], char method);
/* vtgrape.c */
void *MR3_my_malloc2(size_t n, char *s);
void MR3_my_free2(void **p, char *s);
VG_UNIT *m3_get_unit(void);
void vg_exit(int ret);
VG_UNIT *vg_allocate_unit(void (*function)(void *));
void vg_free_unit(VG_UNIT *unit);
void vg_set_function(VG_UNIT *unit, int function_index, void (*function)(void *));
void vg_set_vectors(VG_UNIT *unit, int nj, void *jvectors);
void vg_set_matrices(VG_UNIT *unit, int nati, int natj, void *matrices);
void vg_set_scalers(VG_UNIT *unit, void *scalers);
void vg_set_pipeline_vectors(VG_UNIT *unit, int ni, void *ivectors);
void vg_calculate(VG_UNIT *unit, int function_index, int nf, void *fvectors, void *pscalers);
void vg_set_vectors_pos_charge_atype(VG_UNIT *unit, int nj, double pos[][3], double charge[], int atype[]);
void vg_set_vectors_pos_charge(VG_UNIT *unit, int nj, double pos[][3], double charge[]);
void vg_set_vectors_pos_atype(VG_UNIT *unit, int nj, double pos[][3], int atype[]);
void vg_set_matrices_gscales_rscales(VG_UNIT *unit, int nati_org, int natj_org, double gscales[], double rscales[]);
void vg_set_pol_sigm_ipotro_pc_pd_zz(VG_UNIT *unit, int nati, int natj, double pol[], double sigm[], double ipotro[], double pc[], double pd[], double zz[]);
void vg_set_scalers_volume_alpha(VG_UNIT *unit, double volume[3], double alpha);
void vg_set_pipeline_vectors_pos_charge_atype(VG_UNIT *unit, int ni, double pos[][3], double charge[], int atype[]);
void vg_set_pipeline_vectors_pos_charge(VG_UNIT *unit, int ni, double pos[][3], double charge[]);
void vg_set_pipeline_vectors_pos_atype(VG_UNIT *unit, int ni, double pos[][3], int atype[]);
void vg_convert_forces(VG_UNIT *unit, int nf, int function_index, double fi[][3]);
void vg_calculate_forces_potentials(VG_UNIT *unit, int function_index, int nf, double fi[][3], double *potc, double *potv);
void vg_get_r1result(int n_org, float r[], float r1[]);
void vg_get_rsqrtresult(int n_org, float r[], float r1[]);
void vg_get_mulresult(int n_org, float r[], float q[], float rq[]);
int vg_write_emufile(int flag);
void vg_initialize_emu(void);
float vg_r1emu(float x);
float vg_rsqrtemu(float x);
void vg_set_scaleq(int n, double q[], double *scaleq, float *scaleq_1);
void m3_set_softening(VG_UNIT *unit, double eps);
void MR3_exit(int ret);
void MR3init(void);
void mr3init_(void);
void mr3init__(void);
void MR3free(void);
void mr3free_(void);
void mr3free__(void);
void MR3calccoulomb(double x[], int n, double q[], double rscale, int tblno, double xmax, int periodicflag, int natchangeflag, double force[]);
void mr3calccoulomb_(double x[], int *n, double q[], double *rscale, int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void mr3calccoulomb__(double x[], int *n, double q[], double *rscale, int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void MR3calccoulomb_ij(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag);
void mr3calccoulomb_ij_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void mr3calccoulomb_ij__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void MR3_sort_with_index_int(int data[], int index[], int left, int right);
void MR3calcvdw_ij_core(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void MR3calcvdw_ij(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void mr3calcvdw_ij_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void mr3calcvdw_ij__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void MR3calcvdw(double x[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int natchangeflag, double force[]);
void mr3calcvdw_(double x[], int *n, int atype[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void mr3calcvdw__(double x[], int *n, int atype[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void MR3calcewald(int *k, int knum_org, double *x, int n, double *chg, double alpha, double epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald__(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void MR3calcnacl(double x[], int n, int atype[], int nat, double pol[], double sigm[], double ipotro[], double pc[], double pd[], double zz[], int tblno, double xmax, int periodicflag, double force[]);
void vtgrape_force(double xj[][3], double mj[], double xi[][3], double eps2, double a[][3], int ni, int nj);
void vg_set_rcut2(VG_UNIT *unit, double rcut2);
void mr3_set_rcut2_(double *rcut2);
int md5sum(unsigned char *buffer, int totallen, unsigned char sum[16]);
int md5sum_file(char *filename, unsigned char sum[16]);
void MR3calccoulomb_ij_host(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag);
void mr3calccoulomb_ij_host_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void mr3calccoulomb_ij_host__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void MR3calcvdw_ij_host(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void mr3calcvdw_ij_host_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void mr3calcvdw_ij_host__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void MR3calccoulomb_nlist_ij_host_notwork(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[], double factorall);
void MR3calccoulomb_nlist_ij_host(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calccoulomb_nlist_host(double xd[], int n, double qd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calcvdw_nlist_ij_host_notwork(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[], double factor);
void MR3calcvdw_nlist_ij_host(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_host2(double x[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[], double factor, double force[]);
void MR3calccoulomb_ij_exlist_host(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void MR3calcvdw_ij_exlist_host(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void MR3calcewald_dft_host(int k[], int knum, double x[], int n, double chg[], double cellsize[3], double bs[], double bc[]);
void MR3calcewald_idft_eng_host(int k[], double bs[], double bc[], int knum, double x[], int n, double cellsize[3], double force[]);
void MR3calcewald_idft_force_host(int k[], double bs[], double bc[], int knum, double x[], int n, double cellsize[3], double force[]);
void MR3calcewald_host(int *k, int knum_org, double *x, int n, double *chg, double alpha, double epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_host__(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_host_(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void MR3SetTable(char *filename, int tblno, int flag);
void mr3settable_nf_(char *fname, int *tblno, int *flag, int *n);
void mr3settable_nf__(char *fname, int *tblno, int *flag, int *n);
void MR3_setup_exlist(int n, int *bckptr);
void mr3_setup_exlist_(int *n, int *bckptr);
void MR3_make_natex2_from_natex(int n, int natex[], int numex[], int **natex_offset, int **natex2, int **numex2, int **natex2_offset, int flag);
void calccoulomb_vdw_ij_exlist_host_sub(int i, int j, double xi[], double xj[], double qj, double gsf, double gsp, double rs, double rscale, double cutoff, double *fc, double *fv, double *pc, double *pv, int tblno, double size[3], int potflag);
void MR3calccoulomb_vdw_ij_exlist_cutoff_host(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double cutoff, double size[3], double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_host(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_host2(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_host_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_host__(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void MR3_get_cputime(double *laptime, double *sprittime);
void MR3_set_ldim(int ldim[3]);
void mr3_set_ldim_(int ldim[3]);
void mr3_set_ldim__(int ldim[3]);
void MR3_set_coulomb_vdw_factor(double cgf);
void mr3_set_coulomb_vdw_factor_(double *cgf);
void mr3_set_coulomb_vdw_factor__(double *cgf);
void MR3calccoulomb_ij_emu(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag);
void MR3calccoulomb_nlist_ij_emu(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calccoulomb_nlist_emu(double xd[], int n, double qd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calcvdw_ij_emu(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void MR3calccoulomb_vdw_nlist_ij_emu(int ni, double xid[], double qid[], int atypei[], double force[], int nj, double xjd[], double qjd[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblno, double volume[], int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_ij_emu(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_emu2(double xd[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calccoulomb_ij_exlist(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void mr3calccoulomb_ij_exlist_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag, int numexorg[], int natexorg[]);
void mr3calccoulomb_ij_exlist__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag, int numexorg[], int natexorg[]);
void MR3calcvdw_ij_exlist(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void mr3calcvdw_ij_exlist_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int numex[], int natex[]);
void mr3calcvdw_ij_exlist__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_core_old(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_core(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_virial_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_exlist(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double volume1, double *potc, double *potv, int *convert_index, int potflag, int flag);
void MR3calccoulomb_vdw_exlist_from_cell(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double volume1, double *potc, double *potv, int *convert_index, int potflag, int flag);
void mr3calccoulomb_vdw_exlist_(int *n, double x[], double q[], int atype[], int *nat, double force[], double *rscale, double gscalesf[], double gscalesp[], double rscales[], int *tblno, int numex[], int natex[], double *volume1, double *potc, double *potv, int *convert_index, int *potflag, int *flag);
void MR3_get_forces_overlap(double force[]);
void mr3_get_forces_overlap_(double force[]);
void MR3_get_potc_and_potv_overlap(double *potc, double *potv);
void mr3_get_potc_and_potv_overlap_(double *potc, double *potv);
void mr3_get_potc_and_potv_overlap__(double *potc, double *potv);
void MR3_get_forces_and_virial_overlap(double force[], double virial[3][3]);
void mr3_get_forces_and_virial_overlap_(double force[], double virial[3][3]);
void MR3calccoulomb_ci_exlist(int n, double x[], double q[], double force[], double rscale, int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], int *convert_index, int flag);
void mr3calccoulomb_ci_exlist_(int *n, double x[], double q[], double force[], double *rscale, int *tblno, int numex[], int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], int *convert_index, int *flag);
void MR3calcvdw_ci(int n, double x[], int atype[], int nat, double force[], double gscales[], double rscales[], int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calcvdw_ci_(int *n, double x[], int atype[], int *nat, double force[], double gscales[], double rscales[], int *tblno, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calcvdw_ci_exlist(int n, double x[], int atype[], int nat, double force[], double gscales[], double rscales[], int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], int *convert_index, int flag);
void mr3calcvdw_ci_exlist_(int *n, double x[], int atype[], int *nat, double force[], double gscales[], double rscales[], int *tblno, int numex[], int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], int *convert_index, int *flag);
void MR3calccoulomb_vdw_ci_exlist(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], double *potc, double *potv, int *convert_index, int potflag, int flag);
void mr3calccoulomb_vdw_ci_exlist_(int *n, double x[], double q[], int atype[], int *nat, double force[], double *rscale, double gscalesf[], double gscalesp[], double rscales[], int *tblno, int *numex, int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], double *potc, double *potv, int *convert_index, int *potflag, int *flag);
void MR3calccoulomb_ci(int n, double x[], double q[], double force[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calccoulomb_ci_(int *n, double x[], double q[], double force[], double *rscale, int *tblno, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_ij_ci(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_ij_ci_old(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calcvdw_ij_ci(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_virial(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut_org, double skinnb, double volume[3], int ldim[3], double virial[3][3], int flag);
void MR3calccoulomb_vdw_ij_ci(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calccoulomb_vdw_ij_ci_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscales[], double rscales[], double *rscale, int *tblnoc, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_old_09(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_old_090121(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_exlist(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3], int numex[], int natex[], int flag);
void mr3calccoulomb_vdw_ij_ci_exlist_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscales[], double rscales[], double *rscale, int *tblnoc, double *rcut, double *skinnb, double volume[3], int ldim[3], int numex[], int natex[], int *flag);
void MR3_get_board_version(int *version, int *freq);
void MR3_rscale_and_pack(int n, double (*x)[3], int *atype, longlong (*rj)[2]);
void MR3_rscale_and_pack_old(int n, double (*x)[3], int *atype, longlong (*rj)[2]);
void MR3SetTable_emu(char *filename, int tblno, int flag);
int MR3_get_total_num_chips(void);
void MR3print_chip_temperature(int flag);
int MR3_get_retry_count(void);
void m3_free_unit(VG_UNIT *unit);
VG_UNIT *m3_allocate_periodic_unit(const char *fname, int mode, double size, int dum);
void m3_set_positions(VG_UNIT *unit, double (*pos)[3], int n);
void m3_set_charges(VG_UNIT *unit, const double *q, int n);
void m3_set_cells(VG_UNIT *unit, M3_CELL *cell, int ncell);
void m3_calculate_forces(VG_UNIT *unit, double (*xi)[3], int ni, double (*force)[3]);
void m3_calculate_potentials(VG_UNIT *unit, double (*xi)[3], int ni, double *eng);
void m3_set_types(VG_UNIT *unit, const int *atype, int n);
void m3_set_pipeline_types(VG_UNIT *unit, const int *atype, int n);
void m3_set_charge_matrix(VG_UNIT *unit, const double *gscale, int nati, int natj);
void m3_set_rscale_matrix(VG_UNIT *unit, const double *rscale, int nati, int natj);
int MR3_close_ch(int s_sock);
int mr3_close_ch_(int *s_sock);
int MR3_open_port(int port_number);
int MR3_sock_read(int sockfd, char *buf, size_t count);
int mr3_sock_read_(int *sockfd, char *buf, int *count);
int mr3_sock_read__(int *sockfd, char *buf, int *count);
int mr3_sock_read_i_(int *sockfd, int *buf);
int mr3_sock_read_i__(int *sockfd, int *buf);
int MR3_sock_read_iv(int sockfd, int *buf, int count);
int mr3_sock_read_iv_(int *sockfd, int *buf, int *count);
int mr3_sock_read_iv__(int *sockfd, int *buf, int *count);
int MR3_sock_read_d(int sockfd, double *buf);
int mr3_sock_read_d__(int *sockfd, double *buf);
int mr3_sock_read_d_(int *sockfd, double *buf);
int MR3_sock_read_dv(int sockfd, double *buf, int count);
int mr3_sock_read_dv__(int *sockfd, double *buf, int *count);
int mr3_sock_read_dv_(int *sockfd, double *buf, int *count);
int MR3_sock_write(int sockfd, char *buf, size_t count);
int MR3_sock_write_c(int sockfd, char *buf);
int mr3_sock_write_c_(int *sockfd, char *buf);
int mr3_sock_write_c__(int *sockfd, char *buf);
int MR3_sock_write_i(int sockfd, int buf);
int mr3_sock_write_i_(int *sockfd, int *buf);
int mr3_sock_write_i__(int *sockfd, int *buf);
int MR3_sock_write_iv(int sockfd, int *buf, int count);
int mr3_sock_write_iv_(int *sockfd, int *buf, int *count);
int mr3_sock_write_iv__(int *sockfd, int *buf, int *count);
int MR3_sock_write_dv(int sockfd, double *buf, int count);
int mr3_sock_write_dv__(int *sockfd, double *buf, int *count);
int mr3_sock_write_dv_(int *sockfd, double *buf, int *count);
int MR3_sock_gets(int sockfd, char *str, size_t count);
int MR3_sock_puts(int sockfd, char *str);
void MR3_sock_init(int *s_sock_org, int port_num, double x[], int igraph[], int natom, int str_len, int lbres[], int ipres[], int nres);
void mr3_sock_init_(int *s_sock, int *port_num, double x[], int igraph[], int *natom, int *str_len, int lbres[], int ipres[], int *nres);
void mr3_sock_init__(int *s_sock, int *port_num, double x[], int igraph[], int *natom, int *str_len, int lbres[], int ipres[], int *nres);
void MR3_sock_1step(int s_sock, double t1, double time, double t2, int recv_buf[], int natom, double x[], double f[], double f_temp[]);
void mr3_sock_1step_(int *s_sock, double *t1, double *time, double *t2, int recv_buf[], int *natom, double x[], double f[], double f_tmp[]);
void mr3_sock_1step__(int *s_sock, double *t1, double *time, double *t2, int recv_buf[], int *natom, double x[], double f[], double f_tmp[]);
void MR3calc_ij_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, char method);
void MR3calc_ij_exlist_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], char method);
void MR3calc_ij_nlist_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], char method);
/* vtgrape.c */
void *MR3_my_malloc2(size_t n, char *s);
void MR3_my_free2(void **p, char *s);
VG_UNIT *m3_get_unit(void);
void vg_exit(int ret);
VG_UNIT *vg_allocate_unit(void (*function)(void *));
void vg_free_unit(VG_UNIT *unit);
void vg_set_function(VG_UNIT *unit, int function_index, void (*function)(void *));
void vg_set_vectors(VG_UNIT *unit, int nj, void *jvectors);
void vg_set_matrices(VG_UNIT *unit, int nati, int natj, void *matrices);
void vg_set_scalers(VG_UNIT *unit, void *scalers);
void vg_set_pipeline_vectors(VG_UNIT *unit, int ni, void *ivectors);
void vg_calculate(VG_UNIT *unit, int function_index, int nf, void *fvectors, void *pscalers);
void vg_set_vectors_pos_charge_atype(VG_UNIT *unit, int nj, double pos[][3], double charge[], int atype[]);
void vg_set_vectors_pos_charge(VG_UNIT *unit, int nj, double pos[][3], double charge[]);
void vg_set_vectors_pos_atype(VG_UNIT *unit, int nj, double pos[][3], int atype[]);
void vg_set_matrices_gscales_rscales(VG_UNIT *unit, int nati_org, int natj_org, double gscales[], double rscales[]);
void vg_set_pol_sigm_ipotro_pc_pd_zz(VG_UNIT *unit, int nati, int natj, double pol[], double sigm[], double ipotro[], double pc[], double pd[], double zz[]);
void vg_set_scalers_volume_alpha(VG_UNIT *unit, double volume[3], double alpha);
void vg_set_pipeline_vectors_pos_charge_atype(VG_UNIT *unit, int ni, double pos[][3], double charge[], int atype[]);
void vg_set_pipeline_vectors_pos_charge(VG_UNIT *unit, int ni, double pos[][3], double charge[]);
void vg_set_pipeline_vectors_pos_atype(VG_UNIT *unit, int ni, double pos[][3], int atype[]);
void vg_convert_forces(VG_UNIT *unit, int nf, int function_index, double fi[][3]);
void vg_calculate_forces_potentials(VG_UNIT *unit, int function_index, int nf, double fi[][3], double *potc, double *potv);
void vg_get_r1result(int n_org, float r[], float r1[]);
void vg_get_rsqrtresult(int n_org, float r[], float r1[]);
void vg_get_mulresult(int n_org, float r[], float q[], float rq[]);
int vg_write_emufile(int flag);
void vg_initialize_emu(void);
float vg_r1emu(float x);
float vg_rsqrtemu(float x);
void vg_set_scaleq(int n, double q[], double *scaleq, float *scaleq_1);
void m3_set_softening(VG_UNIT *unit, double eps);
void MR3_exit(int ret);
void MR3init(void);
void mr3init_(void);
void mr3init__(void);
void MR3free(void);
void mr3free_(void);
void mr3free__(void);
void MR3calccoulomb(double x[], int n, double q[], double rscale, int tblno, double xmax, int periodicflag, int natchangeflag, double force[]);
void mr3calccoulomb_(double x[], int *n, double q[], double *rscale, int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void mr3calccoulomb__(double x[], int *n, double q[], double *rscale, int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void MR3calccoulomb_ij(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag);
void mr3calccoulomb_ij_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void mr3calccoulomb_ij__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void MR3_sort_with_index_int(int data[], int index[], int left, int right);
void MR3calcvdw_ij_core(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void MR3calcvdw_ij(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void mr3calcvdw_ij_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void mr3calcvdw_ij__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void MR3calcvdw(double x[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int natchangeflag, double force[]);
void mr3calcvdw_(double x[], int *n, int atype[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void mr3calcvdw__(double x[], int *n, int atype[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void MR3calcewald(int *k, int knum_org, double *x, int n, double *chg, double alpha, double epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald__(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void MR3calcnacl(double x[], int n, int atype[], int nat, double pol[], double sigm[], double ipotro[], double pc[], double pd[], double zz[], int tblno, double xmax, int periodicflag, double force[]);
void vtgrape_force(double xj[][3], double mj[], double xi[][3], double eps2, double a[][3], int ni, int nj);
void vg_set_rcut2(VG_UNIT *unit, double rcut2);
void mr3_set_rcut2_(double *rcut2);
int md5sum(unsigned char *buffer, int totallen, unsigned char sum[16]);
int md5sum_file(char *filename, unsigned char sum[16]);
void MR3calccoulomb_ij_host(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag);
void mr3calccoulomb_ij_host_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void mr3calccoulomb_ij_host__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void MR3calcvdw_ij_host(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void mr3calcvdw_ij_host_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void mr3calcvdw_ij_host__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void MR3calccoulomb_nlist_ij_host_notwork(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[], double factorall);
void MR3calccoulomb_nlist_ij_host(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calccoulomb_nlist_host(double xd[], int n, double qd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calcvdw_nlist_ij_host_notwork(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[], double factor);
void MR3calcvdw_nlist_ij_host(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_host2(double x[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[], double factor, double force[]);
void MR3calccoulomb_ij_exlist_host(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void MR3calcvdw_ij_exlist_host(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void MR3calcewald_dft_host(int k[], int knum, double x[], int n, double chg[], double cellsize[3], double bs[], double bc[]);
void MR3calcewald_idft_eng_host(int k[], double bs[], double bc[], int knum, double x[], int n, double cellsize[3], double force[]);
void MR3calcewald_idft_force_host(int k[], double bs[], double bc[], int knum, double x[], int n, double cellsize[3], double force[]);
void MR3calcewald_host(int *k, int knum_org, double *x, int n, double *chg, double alpha, double epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_host__(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_host_(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void MR3SetTable(char *filename, int tblno, int flag);
void mr3settable_nf_(char *fname, int *tblno, int *flag, int *n);
void mr3settable_nf__(char *fname, int *tblno, int *flag, int *n);
void MR3_setup_exlist(int n, int *bckptr);
void mr3_setup_exlist_(int *n, int *bckptr);
void MR3_make_natex2_from_natex(int n, int natex[], int numex[], int **natex_offset, int **natex2, int **numex2, int **natex2_offset, int flag);
void calccoulomb_vdw_ij_exlist_host_sub(int i, int j, double xi[], double xj[], double qj, double gsf, double gsp, double rs, double rscale, double cutoff, double *fc, double *fv, double *pc, double *pv, int tblno, double size[3], int potflag);
void MR3calccoulomb_vdw_ij_exlist_cutoff_host(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double cutoff, double size[3], double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_host(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_host2(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_host_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_host__(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void MR3_get_cputime(double *laptime, double *sprittime);
void MR3_set_ldim(int ldim[3]);
void mr3_set_ldim_(int ldim[3]);
void mr3_set_ldim__(int ldim[3]);
void MR3_set_coulomb_vdw_factor(double cgf);
void mr3_set_coulomb_vdw_factor_(double *cgf);
void mr3_set_coulomb_vdw_factor__(double *cgf);
void MR3calccoulomb_ij_emu(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag);
void MR3calccoulomb_nlist_ij_emu(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calccoulomb_nlist_emu(double xd[], int n, double qd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calcvdw_ij_emu(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void MR3calccoulomb_vdw_nlist_ij_emu(int ni, double xid[], double qid[], int atypei[], double force[], int nj, double xjd[], double qjd[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblno, double volume[], int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_ij_emu(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_emu2(double xd[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calccoulomb_ij_exlist(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void mr3calccoulomb_ij_exlist_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag, int numexorg[], int natexorg[]);
void mr3calccoulomb_ij_exlist__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag, int numexorg[], int natexorg[]);
void MR3calcvdw_ij_exlist(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void mr3calcvdw_ij_exlist_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int numex[], int natex[]);
void mr3calcvdw_ij_exlist__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_core_old(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_core(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_virial_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_exlist(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double volume1, double *potc, double *potv, int *convert_index, int potflag, int flag);
void MR3calccoulomb_vdw_exlist_from_cell(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double volume1, double *potc, double *potv, int *convert_index, int potflag, int flag);
void mr3calccoulomb_vdw_exlist_(int *n, double x[], double q[], int atype[], int *nat, double force[], double *rscale, double gscalesf[], double gscalesp[], double rscales[], int *tblno, int numex[], int natex[], double *volume1, double *potc, double *potv, int *convert_index, int *potflag, int *flag);
void MR3_get_forces_overlap(double force[]);
void mr3_get_forces_overlap_(double force[]);
void MR3_get_potc_and_potv_overlap(double *potc, double *potv);
void mr3_get_potc_and_potv_overlap_(double *potc, double *potv);
void mr3_get_potc_and_potv_overlap__(double *potc, double *potv);
void MR3_get_forces_and_virial_overlap(double force[], double virial[3][3]);
void mr3_get_forces_and_virial_overlap_(double force[], double virial[3][3]);
void MR3calccoulomb_ci_exlist(int n, double x[], double q[], double force[], double rscale, int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], int *convert_index, int flag);
void mr3calccoulomb_ci_exlist_(int *n, double x[], double q[], double force[], double *rscale, int *tblno, int numex[], int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], int *convert_index, int *flag);
void MR3calcvdw_ci(int n, double x[], int atype[], int nat, double force[], double gscales[], double rscales[], int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calcvdw_ci_(int *n, double x[], int atype[], int *nat, double force[], double gscales[], double rscales[], int *tblno, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calcvdw_ci_exlist(int n, double x[], int atype[], int nat, double force[], double gscales[], double rscales[], int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], int *convert_index, int flag);
void mr3calcvdw_ci_exlist_(int *n, double x[], int atype[], int *nat, double force[], double gscales[], double rscales[], int *tblno, int numex[], int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], int *convert_index, int *flag);
void MR3calccoulomb_vdw_ci_exlist(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], double *potc, double *potv, int *convert_index, int potflag, int flag);
void mr3calccoulomb_vdw_ci_exlist_(int *n, double x[], double q[], int atype[], int *nat, double force[], double *rscale, double gscalesf[], double gscalesp[], double rscales[], int *tblno, int *numex, int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], double *potc, double *potv, int *convert_index, int *potflag, int *flag);
void MR3calccoulomb_ci(int n, double x[], double q[], double force[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calccoulomb_ci_(int *n, double x[], double q[], double force[], double *rscale, int *tblno, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_ij_ci(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_ij_ci_old(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calcvdw_ij_ci(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_virial(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut_org, double skinnb, double volume[3], int ldim[3], double virial[3][3], int flag);
void MR3calccoulomb_vdw_ij_ci(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calccoulomb_vdw_ij_ci_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscales[], double rscales[], double *rscale, int *tblnoc, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_old_09(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_old_090121(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_exlist(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3], int numex[], int natex[], int flag);
void mr3calccoulomb_vdw_ij_ci_exlist_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscales[], double rscales[], double *rscale, int *tblnoc, double *rcut, double *skinnb, double volume[3], int ldim[3], int numex[], int natex[], int *flag);
void MR3_get_board_version(int *version, int *freq);
void MR3_rscale_and_pack(int n, double (*x)[3], int *atype, longlong (*rj)[2]);
void MR3_rscale_and_pack_old(int n, double (*x)[3], int *atype, longlong (*rj)[2]);
void MR3SetTable_emu(char *filename, int tblno, int flag);
int MR3_get_total_num_chips(void);
void MR3print_chip_temperature(int flag);
int MR3_get_retry_count(void);
void m3_free_unit(VG_UNIT *unit);
VG_UNIT *m3_allocate_periodic_unit(const char *fname, int mode, double size, int dum);
void m3_set_positions(VG_UNIT *unit, double (*pos)[3], int n);
void m3_set_charges(VG_UNIT *unit, const double *q, int n);
void m3_set_cells(VG_UNIT *unit, M3_CELL *cell, int ncell);
void m3_calculate_forces(VG_UNIT *unit, double (*xi)[3], int ni, double (*force)[3]);
void m3_calculate_potentials(VG_UNIT *unit, double (*xi)[3], int ni, double *eng);
void m3_set_types(VG_UNIT *unit, const int *atype, int n);
void m3_set_pipeline_types(VG_UNIT *unit, const int *atype, int n);
void m3_set_charge_matrix(VG_UNIT *unit, const double *gscale, int nati, int natj);
void m3_set_rscale_matrix(VG_UNIT *unit, const double *rscale, int nati, int natj);
int MR3_close_ch(int s_sock);
int mr3_close_ch_(int *s_sock);
int MR3_open_port(int port_number);
int MR3_sock_read(int sockfd, char *buf, size_t count);
int mr3_sock_read_(int *sockfd, char *buf, int *count);
int mr3_sock_read__(int *sockfd, char *buf, int *count);
int mr3_sock_read_i_(int *sockfd, int *buf);
int mr3_sock_read_i__(int *sockfd, int *buf);
int MR3_sock_read_iv(int sockfd, int *buf, int count);
int mr3_sock_read_iv_(int *sockfd, int *buf, int *count);
int mr3_sock_read_iv__(int *sockfd, int *buf, int *count);
int MR3_sock_read_d(int sockfd, double *buf);
int mr3_sock_read_d__(int *sockfd, double *buf);
int mr3_sock_read_d_(int *sockfd, double *buf);
int MR3_sock_read_dv(int sockfd, double *buf, int count);
int mr3_sock_read_dv__(int *sockfd, double *buf, int *count);
int mr3_sock_read_dv_(int *sockfd, double *buf, int *count);
int MR3_sock_write(int sockfd, char *buf, size_t count);
int MR3_sock_write_c(int sockfd, char *buf);
int mr3_sock_write_c_(int *sockfd, char *buf);
int mr3_sock_write_c__(int *sockfd, char *buf);
int MR3_sock_write_i(int sockfd, int buf);
int mr3_sock_write_i_(int *sockfd, int *buf);
int mr3_sock_write_i__(int *sockfd, int *buf);
int MR3_sock_write_iv(int sockfd, int *buf, int count);
int mr3_sock_write_iv_(int *sockfd, int *buf, int *count);
int mr3_sock_write_iv__(int *sockfd, int *buf, int *count);
int MR3_sock_write_dv(int sockfd, double *buf, int count);
int mr3_sock_write_dv__(int *sockfd, double *buf, int *count);
int mr3_sock_write_dv_(int *sockfd, double *buf, int *count);
int MR3_sock_gets(int sockfd, char *str, size_t count);
int MR3_sock_puts(int sockfd, char *str);
void MR3_sock_init(int *s_sock_org, int port_num, double x[], int igraph[], int natom, int str_len, int lbres[], int ipres[], int nres);
void mr3_sock_init_(int *s_sock, int *port_num, double x[], int igraph[], int *natom, int *str_len, int lbres[], int ipres[], int *nres);
void mr3_sock_init__(int *s_sock, int *port_num, double x[], int igraph[], int *natom, int *str_len, int lbres[], int ipres[], int *nres);
void MR3_sock_1step(int s_sock, double t1, double time, double t2, int recv_buf[], int natom, double x[], double f[], double f_temp[]);
void mr3_sock_1step_(int *s_sock, double *t1, double *time, double *t2, int recv_buf[], int *natom, double x[], double f[], double f_tmp[]);
void mr3_sock_1step__(int *s_sock, double *t1, double *time, double *t2, int recv_buf[], int *natom, double x[], double f[], double f_tmp[]);
void MR3calc_ij_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, char method);
void MR3calc_ij_exlist_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], char method);
void MR3calc_ij_nlist_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], char method);
/* vtgrape.c */
void *MR3_my_malloc2(size_t n, char *s);
void MR3_my_free2(void **p, char *s);
VG_UNIT *m3_get_unit(void);
void vg_exit(int ret);
VG_UNIT *vg_allocate_unit(void (*function)(void *));
void vg_free_unit(VG_UNIT *unit);
void vg_set_function(VG_UNIT *unit, int function_index, void (*function)(void *));
void vg_set_vectors(VG_UNIT *unit, int nj, void *jvectors);
void vg_set_matrices(VG_UNIT *unit, int nati, int natj, void *matrices);
void vg_set_scalers(VG_UNIT *unit, void *scalers);
void vg_set_pipeline_vectors(VG_UNIT *unit, int ni, void *ivectors);
void vg_calculate(VG_UNIT *unit, int function_index, int nf, void *fvectors, void *pscalers);
void vg_set_vectors_pos_charge_atype(VG_UNIT *unit, int nj, double pos[][3], double charge[], int atype[]);
void vg_set_vectors_pos_charge(VG_UNIT *unit, int nj, double pos[][3], double charge[]);
void vg_set_vectors_pos_atype(VG_UNIT *unit, int nj, double pos[][3], int atype[]);
void vg_set_matrices_gscales_rscales(VG_UNIT *unit, int nati_org, int natj_org, double gscales[], double rscales[]);
void vg_set_pol_sigm_ipotro_pc_pd_zz(VG_UNIT *unit, int nati, int natj, double pol[], double sigm[], double ipotro[], double pc[], double pd[], double zz[]);
void vg_set_scalers_volume_alpha(VG_UNIT *unit, double volume[3], double alpha);
void vg_set_pipeline_vectors_pos_charge_atype(VG_UNIT *unit, int ni, double pos[][3], double charge[], int atype[]);
void vg_set_pipeline_vectors_pos_charge(VG_UNIT *unit, int ni, double pos[][3], double charge[]);
void vg_set_pipeline_vectors_pos_atype(VG_UNIT *unit, int ni, double pos[][3], int atype[]);
void vg_convert_forces(VG_UNIT *unit, int nf, int function_index, double fi[][3]);
void vg_calculate_forces_potentials(VG_UNIT *unit, int function_index, int nf, double fi[][3], double *potc, double *potv);
void vg_get_r1result(int n_org, float r[], float r1[]);
void vg_get_rsqrtresult(int n_org, float r[], float r1[]);
void vg_get_mulresult(int n_org, float r[], float q[], float rq[]);
int vg_write_emufile(int flag);
void vg_initialize_emu(void);
float vg_r1emu(float x);
float vg_rsqrtemu(float x);
void vg_set_scaleq(int n, double q[], double *scaleq, float *scaleq_1);
void m3_set_softening(VG_UNIT *unit, double eps);
void MR3_exit(int ret);
void MR3init(void);
void mr3init_(void);
void mr3init__(void);
void MR3free(void);
void mr3free_(void);
void mr3free__(void);
void MR3calccoulomb(double x[], int n, double q[], double rscale, int tblno, double xmax, int periodicflag, int natchangeflag, double force[]);
void mr3calccoulomb_(double x[], int *n, double q[], double *rscale, int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void mr3calccoulomb__(double x[], int *n, double q[], double *rscale, int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void MR3calccoulomb_ij(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag);
void mr3calccoulomb_ij_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void mr3calccoulomb_ij__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void MR3_sort_with_index_int(int data[], int index[], int left, int right);
void MR3calcvdw_ij_core(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void MR3calcvdw_ij(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void mr3calcvdw_ij_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void mr3calcvdw_ij__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void MR3calcvdw(double x[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int natchangeflag, double force[]);
void mr3calcvdw_(double x[], int *n, int atype[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void mr3calcvdw__(double x[], int *n, int atype[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void MR3calcewald(int *k, int knum_org, double *x, int n, double *chg, double alpha, double epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald__(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void MR3calcnacl(double x[], int n, int atype[], int nat, double pol[], double sigm[], double ipotro[], double pc[], double pd[], double zz[], int tblno, double xmax, int periodicflag, double force[]);
void vtgrape_force(double xj[][3], double mj[], double xi[][3], double eps2, double a[][3], int ni, int nj);
void vg_set_rcut2(VG_UNIT *unit, double rcut2);
void mr3_set_rcut2_(double *rcut2);
int md5sum(unsigned char *buffer, int totallen, unsigned char sum[16]);
int md5sum_file(char *filename, unsigned char sum[16]);
void MR3calccoulomb_ij_host(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag);
void mr3calccoulomb_ij_host_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void mr3calccoulomb_ij_host__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void MR3calcvdw_ij_host(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void mr3calcvdw_ij_host_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void mr3calcvdw_ij_host__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void MR3calccoulomb_nlist_ij_host_notwork(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[], double factorall);
void MR3calccoulomb_nlist_ij_host(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calccoulomb_nlist_host(double xd[], int n, double qd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calcvdw_nlist_ij_host_notwork(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[], double factor);
void MR3calcvdw_nlist_ij_host(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_host2(double x[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[], double factor, double force[]);
void MR3calccoulomb_ij_exlist_host(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void MR3calcvdw_ij_exlist_host(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void MR3calcewald_dft_host(int k[], int knum, double x[], int n, double chg[], double cellsize[3], double bs[], double bc[]);
void MR3calcewald_idft_eng_host(int k[], double bs[], double bc[], int knum, double x[], int n, double cellsize[3], double force[]);
void MR3calcewald_idft_force_host(int k[], double bs[], double bc[], int knum, double x[], int n, double cellsize[3], double force[]);
void MR3calcewald_host(int *k, int knum_org, double *x, int n, double *chg, double alpha, double epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_host__(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_host_(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void MR3SetTable(char *filename, int tblno, int flag);
void mr3settable_nf_(char *fname, int *tblno, int *flag, int *n);
void mr3settable_nf__(char *fname, int *tblno, int *flag, int *n);
void MR3_setup_exlist(int n, int *bckptr);
void mr3_setup_exlist_(int *n, int *bckptr);
void MR3_make_natex2_from_natex(int n, int natex[], int numex[], int **natex_offset, int **natex2, int **numex2, int **natex2_offset, int flag);
void calccoulomb_vdw_ij_exlist_host_sub(int i, int j, double xi[], double xj[], double qj, double gsf, double gsp, double rs, double rscale, double cutoff, double *fc, double *fv, double *pc, double *pv, int tblno, double size[3], int potflag);
void MR3calccoulomb_vdw_ij_exlist_cutoff_host(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double cutoff, double size[3], double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_host(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_host2(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_host_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_host__(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void MR3_get_cputime(double *laptime, double *sprittime);
void MR3_set_ldim(int ldim[3]);
void mr3_set_ldim_(int ldim[3]);
void mr3_set_ldim__(int ldim[3]);
void MR3_set_coulomb_vdw_factor(double cgf);
void mr3_set_coulomb_vdw_factor_(double *cgf);
void mr3_set_coulomb_vdw_factor__(double *cgf);
void MR3calccoulomb_ij_emu(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag);
void MR3calccoulomb_nlist_ij_emu(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calccoulomb_nlist_emu(double xd[], int n, double qd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calcvdw_ij_emu(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void MR3calccoulomb_vdw_nlist_ij_emu(int ni, double xid[], double qid[], int atypei[], double force[], int nj, double xjd[], double qjd[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblno, double volume[], int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_ij_emu(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_emu2(double xd[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calccoulomb_ij_exlist(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void mr3calccoulomb_ij_exlist_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag, int numexorg[], int natexorg[]);
void mr3calccoulomb_ij_exlist__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag, int numexorg[], int natexorg[]);
void MR3calcvdw_ij_exlist(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void mr3calcvdw_ij_exlist_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int numex[], int natex[]);
void mr3calcvdw_ij_exlist__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_core_old(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_core(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_virial_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_exlist(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double volume1, double *potc, double *potv, int *convert_index, int potflag, int flag);
void MR3calccoulomb_vdw_exlist_from_cell(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double volume1, double *potc, double *potv, int *convert_index, int potflag, int flag);
void mr3calccoulomb_vdw_exlist_(int *n, double x[], double q[], int atype[], int *nat, double force[], double *rscale, double gscalesf[], double gscalesp[], double rscales[], int *tblno, int numex[], int natex[], double *volume1, double *potc, double *potv, int *convert_index, int *potflag, int *flag);
void MR3_get_forces_overlap(double force[]);
void mr3_get_forces_overlap_(double force[]);
void MR3_get_potc_and_potv_overlap(double *potc, double *potv);
void mr3_get_potc_and_potv_overlap_(double *potc, double *potv);
void mr3_get_potc_and_potv_overlap__(double *potc, double *potv);
void MR3_get_forces_and_virial_overlap(double force[], double virial[3][3]);
void mr3_get_forces_and_virial_overlap_(double force[], double virial[3][3]);
void MR3calccoulomb_ci_exlist(int n, double x[], double q[], double force[], double rscale, int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], int *convert_index, int flag);
void mr3calccoulomb_ci_exlist_(int *n, double x[], double q[], double force[], double *rscale, int *tblno, int numex[], int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], int *convert_index, int *flag);
void MR3calcvdw_ci(int n, double x[], int atype[], int nat, double force[], double gscales[], double rscales[], int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calcvdw_ci_(int *n, double x[], int atype[], int *nat, double force[], double gscales[], double rscales[], int *tblno, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calcvdw_ci_exlist(int n, double x[], int atype[], int nat, double force[], double gscales[], double rscales[], int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], int *convert_index, int flag);
void mr3calcvdw_ci_exlist_(int *n, double x[], int atype[], int *nat, double force[], double gscales[], double rscales[], int *tblno, int numex[], int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], int *convert_index, int *flag);
void MR3calccoulomb_vdw_ci_exlist(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], double *potc, double *potv, int *convert_index, int potflag, int flag);
void mr3calccoulomb_vdw_ci_exlist_(int *n, double x[], double q[], int atype[], int *nat, double force[], double *rscale, double gscalesf[], double gscalesp[], double rscales[], int *tblno, int *numex, int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], double *potc, double *potv, int *convert_index, int *potflag, int *flag);
void MR3calccoulomb_ci(int n, double x[], double q[], double force[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calccoulomb_ci_(int *n, double x[], double q[], double force[], double *rscale, int *tblno, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_ij_ci(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_ij_ci_old(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calcvdw_ij_ci(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_virial(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut_org, double skinnb, double volume[3], int ldim[3], double virial[3][3], int flag);
void MR3calccoulomb_vdw_ij_ci(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calccoulomb_vdw_ij_ci_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscales[], double rscales[], double *rscale, int *tblnoc, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_old_09(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_old_090121(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_exlist(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3], int numex[], int natex[], int flag);
void mr3calccoulomb_vdw_ij_ci_exlist_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscales[], double rscales[], double *rscale, int *tblnoc, double *rcut, double *skinnb, double volume[3], int ldim[3], int numex[], int natex[], int *flag);
void MR3_get_board_version(int *version, int *freq);
void MR3_rscale_and_pack(int n, double (*x)[3], int *atype, longlong (*rj)[2]);
void MR3_rscale_and_pack_old(int n, double (*x)[3], int *atype, longlong (*rj)[2]);
void MR3SetTable_emu(char *filename, int tblno, int flag);
int MR3_get_total_num_chips(void);
void MR3print_chip_temperature(int flag);
int MR3_get_retry_count(void);
void m3_free_unit(VG_UNIT *unit);
VG_UNIT *m3_allocate_periodic_unit(const char *fname, int mode, double size, int dum);
void m3_set_positions(VG_UNIT *unit, double (*pos)[3], int n);
void m3_set_charges(VG_UNIT *unit, const double *q, int n);
void m3_set_cells(VG_UNIT *unit, M3_CELL *cell, int ncell);
void m3_calculate_forces(VG_UNIT *unit, double (*xi)[3], int ni, double (*force)[3]);
void m3_calculate_potentials(VG_UNIT *unit, double (*xi)[3], int ni, double *eng);
void m3_set_types(VG_UNIT *unit, const int *atype, int n);
void m3_set_pipeline_types(VG_UNIT *unit, const int *atype, int n);
void m3_set_charge_matrix(VG_UNIT *unit, const double *gscale, int nati, int natj);
void m3_set_rscale_matrix(VG_UNIT *unit, const double *rscale, int nati, int natj);
int MR3_close_ch(int s_sock);
int mr3_close_ch_(int *s_sock);
int MR3_open_port(int port_number);
int MR3_sock_read(int sockfd, char *buf, size_t count);
int mr3_sock_read_(int *sockfd, char *buf, int *count);
int mr3_sock_read__(int *sockfd, char *buf, int *count);
int mr3_sock_read_i_(int *sockfd, int *buf);
int mr3_sock_read_i__(int *sockfd, int *buf);
int MR3_sock_read_iv(int sockfd, int *buf, int count);
int mr3_sock_read_iv_(int *sockfd, int *buf, int *count);
int mr3_sock_read_iv__(int *sockfd, int *buf, int *count);
int MR3_sock_read_d(int sockfd, double *buf);
int mr3_sock_read_d__(int *sockfd, double *buf);
int mr3_sock_read_d_(int *sockfd, double *buf);
int MR3_sock_read_dv(int sockfd, double *buf, int count);
int mr3_sock_read_dv__(int *sockfd, double *buf, int *count);
int mr3_sock_read_dv_(int *sockfd, double *buf, int *count);
int MR3_sock_write(int sockfd, char *buf, size_t count);
int MR3_sock_write_c(int sockfd, char *buf);
int mr3_sock_write_c_(int *sockfd, char *buf);
int mr3_sock_write_c__(int *sockfd, char *buf);
int MR3_sock_write_i(int sockfd, int buf);
int mr3_sock_write_i_(int *sockfd, int *buf);
int mr3_sock_write_i__(int *sockfd, int *buf);
int MR3_sock_write_iv(int sockfd, int *buf, int count);
int mr3_sock_write_iv_(int *sockfd, int *buf, int *count);
int mr3_sock_write_iv__(int *sockfd, int *buf, int *count);
int MR3_sock_write_dv(int sockfd, double *buf, int count);
int mr3_sock_write_dv__(int *sockfd, double *buf, int *count);
int mr3_sock_write_dv_(int *sockfd, double *buf, int *count);
int MR3_sock_gets(int sockfd, char *str, size_t count);
int MR3_sock_puts(int sockfd, char *str);
void MR3_sock_init(int *s_sock_org, int port_num, double x[], int igraph[], int natom, int str_len, int lbres[], int ipres[], int nres);
void mr3_sock_init_(int *s_sock, int *port_num, double x[], int igraph[], int *natom, int *str_len, int lbres[], int ipres[], int *nres);
void mr3_sock_init__(int *s_sock, int *port_num, double x[], int igraph[], int *natom, int *str_len, int lbres[], int ipres[], int *nres);
void MR3_sock_1step(int s_sock, double t1, double time, double t2, int recv_buf[], int natom, double x[], double f[], double f_temp[]);
void mr3_sock_1step_(int *s_sock, double *t1, double *time, double *t2, int recv_buf[], int *natom, double x[], double f[], double f_tmp[]);
void mr3_sock_1step__(int *s_sock, double *t1, double *time, double *t2, int recv_buf[], int *natom, double x[], double f[], double f_tmp[]);
void MR3calc_ij_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, char method);
void MR3calc_ij_exlist_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], char method);
void MR3calc_ij_nlist_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], char method);
/* vtgrape.c */
void *MR3_my_malloc2(size_t n, char *s);
void MR3_my_free2(void **p, char *s);
VG_UNIT *m3_get_unit(void);
void vg_exit(int ret);
VG_UNIT *vg_allocate_unit(void (*function)(void *));
void vg_free_unit(VG_UNIT *unit);
void vg_set_function(VG_UNIT *unit, int function_index, void (*function)(void *));
void vg_set_vectors(VG_UNIT *unit, int nj, void *jvectors);
void vg_set_matrices(VG_UNIT *unit, int nati, int natj, void *matrices);
void vg_set_scalers(VG_UNIT *unit, void *scalers);
void vg_set_pipeline_vectors(VG_UNIT *unit, int ni, void *ivectors);
void vg_calculate(VG_UNIT *unit, int function_index, int nf, void *fvectors, void *pscalers);
void vg_set_vectors_pos_charge_atype(VG_UNIT *unit, int nj, double pos[][3], double charge[], int atype[]);
void vg_set_vectors_pos_charge(VG_UNIT *unit, int nj, double pos[][3], double charge[]);
void vg_set_vectors_pos_atype(VG_UNIT *unit, int nj, double pos[][3], int atype[]);
void vg_set_matrices_gscales_rscales(VG_UNIT *unit, int nati_org, int natj_org, double gscales[], double rscales[]);
void vg_set_pol_sigm_ipotro_pc_pd_zz(VG_UNIT *unit, int nati, int natj, double pol[], double sigm[], double ipotro[], double pc[], double pd[], double zz[]);
void vg_set_scalers_volume_alpha(VG_UNIT *unit, double volume[3], double alpha);
void vg_set_pipeline_vectors_pos_charge_atype(VG_UNIT *unit, int ni, double pos[][3], double charge[], int atype[]);
void vg_set_pipeline_vectors_pos_charge(VG_UNIT *unit, int ni, double pos[][3], double charge[]);
void vg_set_pipeline_vectors_pos_atype(VG_UNIT *unit, int ni, double pos[][3], int atype[]);
void vg_convert_forces(VG_UNIT *unit, int nf, int function_index, double fi[][3]);
void vg_calculate_forces_potentials(VG_UNIT *unit, int function_index, int nf, double fi[][3], double *potc, double *potv);
void vg_get_r1result(int n_org, float r[], float r1[]);
void vg_get_rsqrtresult(int n_org, float r[], float r1[]);
void vg_get_mulresult(int n_org, float r[], float q[], float rq[]);
int vg_write_emufile(int flag);
void vg_initialize_emu(void);
float vg_r1emu(float x);
float vg_rsqrtemu(float x);
void vg_set_scaleq(int n, double q[], double *scaleq, float *scaleq_1);
void m3_set_softening(VG_UNIT *unit, double eps);
void MR3_exit(int ret);
void MR3init(void);
void mr3init_(void);
void mr3init__(void);
void MR3free(void);
void mr3free_(void);
void mr3free__(void);
void MR3calccoulomb(double x[], int n, double q[], double rscale, int tblno, double xmax, int periodicflag, int natchangeflag, double force[]);
void mr3calccoulomb_(double x[], int *n, double q[], double *rscale, int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void mr3calccoulomb__(double x[], int *n, double q[], double *rscale, int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void MR3calccoulomb_ij(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag);
void mr3calccoulomb_ij_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void mr3calccoulomb_ij__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void MR3_sort_with_index_int(int data[], int index[], int left, int right);
void MR3calcvdw_ij_core(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void MR3calcvdw_ij(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void mr3calcvdw_ij_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void mr3calcvdw_ij__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void MR3calcvdw(double x[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int natchangeflag, double force[]);
void mr3calcvdw_(double x[], int *n, int atype[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void mr3calcvdw__(double x[], int *n, int atype[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void MR3calcewald(int *k, int knum_org, double *x, int n, double *chg, double alpha, double epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald__(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void MR3calcnacl(double x[], int n, int atype[], int nat, double pol[], double sigm[], double ipotro[], double pc[], double pd[], double zz[], int tblno, double xmax, int periodicflag, double force[]);
void vtgrape_force(double xj[][3], double mj[], double xi[][3], double eps2, double a[][3], int ni, int nj);
void vg_set_rcut2(VG_UNIT *unit, double rcut2);
void mr3_set_rcut2_(double *rcut2);
int md5sum(unsigned char *buffer, int totallen, unsigned char sum[16]);
int md5sum_file(char *filename, unsigned char sum[16]);
void MR3calccoulomb_ij_host(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag);
void mr3calccoulomb_ij_host_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void mr3calccoulomb_ij_host__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void MR3calcvdw_ij_host(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void mr3calcvdw_ij_host_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void mr3calcvdw_ij_host__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void MR3calccoulomb_nlist_ij_host_notwork(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[], double factorall);
void MR3calccoulomb_nlist_ij_host(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calccoulomb_nlist_host(double xd[], int n, double qd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calcvdw_nlist_ij_host_notwork(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[], double factor);
void MR3calcvdw_nlist_ij_host(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_host2(double x[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[], double factor, double force[]);
void MR3calccoulomb_ij_exlist_host(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void MR3calcvdw_ij_exlist_host(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void MR3calcewald_dft_host(int k[], int knum, double x[], int n, double chg[], double cellsize[3], double bs[], double bc[]);
void MR3calcewald_idft_eng_host(int k[], double bs[], double bc[], int knum, double x[], int n, double cellsize[3], double force[]);
void MR3calcewald_idft_force_host(int k[], double bs[], double bc[], int knum, double x[], int n, double cellsize[3], double force[]);
void MR3calcewald_host(int *k, int knum_org, double *x, int n, double *chg, double alpha, double epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_host__(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_host_(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void MR3SetTable(char *filename, int tblno, int flag);
void mr3settable_nf_(char *fname, int *tblno, int *flag, int *n);
void mr3settable_nf__(char *fname, int *tblno, int *flag, int *n);
void MR3_setup_exlist(int n, int *bckptr);
void mr3_setup_exlist_(int *n, int *bckptr);
void MR3_make_natex2_from_natex(int n, int natex[], int numex[], int **natex_offset, int **natex2, int **numex2, int **natex2_offset, int flag);
void calccoulomb_vdw_ij_exlist_host_sub(int i, int j, double xi[], double xj[], double qj, double gsf, double gsp, double rs, double rscale, double cutoff, double *fc, double *fv, double *pc, double *pv, int tblno, double size[3], int potflag);
void MR3calccoulomb_vdw_ij_exlist_cutoff_host(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double cutoff, double size[3], double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_host(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_host2(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_host_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_host__(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void MR3_get_cputime(double *laptime, double *sprittime);
void MR3_set_ldim(int ldim[3]);
void mr3_set_ldim_(int ldim[3]);
void mr3_set_ldim__(int ldim[3]);
void MR3_set_coulomb_vdw_factor(double cgf);
void mr3_set_coulomb_vdw_factor_(double *cgf);
void mr3_set_coulomb_vdw_factor__(double *cgf);
void MR3calccoulomb_ij_emu(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag);
void MR3calccoulomb_nlist_ij_emu(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calccoulomb_nlist_emu(double xd[], int n, double qd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calcvdw_ij_emu(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void MR3calccoulomb_vdw_nlist_ij_emu(int ni, double xid[], double qid[], int atypei[], double force[], int nj, double xjd[], double qjd[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblno, double volume[], int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_ij_emu(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_emu2(double xd[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calccoulomb_ij_exlist(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void mr3calccoulomb_ij_exlist_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag, int numexorg[], int natexorg[]);
void mr3calccoulomb_ij_exlist__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag, int numexorg[], int natexorg[]);
void MR3calcvdw_ij_exlist(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void mr3calcvdw_ij_exlist_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int numex[], int natex[]);
void mr3calcvdw_ij_exlist__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_core_old(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_core(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_virial_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_exlist(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double volume1, double *potc, double *potv, int *convert_index, int potflag, int flag);
void MR3calccoulomb_vdw_exlist_from_cell(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double volume1, double *potc, double *potv, int *convert_index, int potflag, int flag);
void mr3calccoulomb_vdw_exlist_(int *n, double x[], double q[], int atype[], int *nat, double force[], double *rscale, double gscalesf[], double gscalesp[], double rscales[], int *tblno, int numex[], int natex[], double *volume1, double *potc, double *potv, int *convert_index, int *potflag, int *flag);
void MR3_get_forces_overlap(double force[]);
void mr3_get_forces_overlap_(double force[]);
void MR3_get_potc_and_potv_overlap(double *potc, double *potv);
void mr3_get_potc_and_potv_overlap_(double *potc, double *potv);
void mr3_get_potc_and_potv_overlap__(double *potc, double *potv);
void MR3_get_forces_and_virial_overlap(double force[], double virial[3][3]);
void mr3_get_forces_and_virial_overlap_(double force[], double virial[3][3]);
void MR3calccoulomb_ci_exlist(int n, double x[], double q[], double force[], double rscale, int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], int *convert_index, int flag);
void mr3calccoulomb_ci_exlist_(int *n, double x[], double q[], double force[], double *rscale, int *tblno, int numex[], int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], int *convert_index, int *flag);
void MR3calcvdw_ci(int n, double x[], int atype[], int nat, double force[], double gscales[], double rscales[], int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calcvdw_ci_(int *n, double x[], int atype[], int *nat, double force[], double gscales[], double rscales[], int *tblno, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calcvdw_ci_exlist(int n, double x[], int atype[], int nat, double force[], double gscales[], double rscales[], int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], int *convert_index, int flag);
void mr3calcvdw_ci_exlist_(int *n, double x[], int atype[], int *nat, double force[], double gscales[], double rscales[], int *tblno, int numex[], int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], int *convert_index, int *flag);
void MR3calccoulomb_vdw_ci_exlist(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], double *potc, double *potv, int *convert_index, int potflag, int flag);
void mr3calccoulomb_vdw_ci_exlist_(int *n, double x[], double q[], int atype[], int *nat, double force[], double *rscale, double gscalesf[], double gscalesp[], double rscales[], int *tblno, int *numex, int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], double *potc, double *potv, int *convert_index, int *potflag, int *flag);
void MR3calccoulomb_ci(int n, double x[], double q[], double force[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calccoulomb_ci_(int *n, double x[], double q[], double force[], double *rscale, int *tblno, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_ij_ci(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_ij_ci_old(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calcvdw_ij_ci(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_virial(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut_org, double skinnb, double volume[3], int ldim[3], double virial[3][3], int flag);
void MR3calccoulomb_vdw_ij_ci(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calccoulomb_vdw_ij_ci_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscales[], double rscales[], double *rscale, int *tblnoc, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_old_09(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_old_090121(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_exlist(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3], int numex[], int natex[], int flag);
void mr3calccoulomb_vdw_ij_ci_exlist_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscales[], double rscales[], double *rscale, int *tblnoc, double *rcut, double *skinnb, double volume[3], int ldim[3], int numex[], int natex[], int *flag);
void MR3_get_board_version(int *version, int *freq);
void MR3_rscale_and_pack(int n, double (*x)[3], int *atype, longlong (*rj)[2]);
void MR3_rscale_and_pack_old(int n, double (*x)[3], int *atype, longlong (*rj)[2]);
void MR3SetTable_emu(char *filename, int tblno, int flag);
int MR3_get_total_num_chips(void);
void MR3print_chip_temperature(int flag);
int MR3_get_retry_count(void);
void m3_free_unit(VG_UNIT *unit);
VG_UNIT *m3_allocate_periodic_unit(const char *fname, int mode, double size, int dum);
void m3_set_positions(VG_UNIT *unit, double (*pos)[3], int n);
void m3_set_charges(VG_UNIT *unit, const double *q, int n);
void m3_set_cells(VG_UNIT *unit, M3_CELL *cell, int ncell);
void m3_calculate_forces(VG_UNIT *unit, double (*xi)[3], int ni, double (*force)[3]);
void m3_calculate_potentials(VG_UNIT *unit, double (*xi)[3], int ni, double *eng);
void m3_set_types(VG_UNIT *unit, const int *atype, int n);
void m3_set_pipeline_types(VG_UNIT *unit, const int *atype, int n);
void m3_set_charge_matrix(VG_UNIT *unit, const double *gscale, int nati, int natj);
void m3_set_rscale_matrix(VG_UNIT *unit, const double *rscale, int nati, int natj);
int MR3_close_ch(int s_sock);
int mr3_close_ch_(int *s_sock);
int MR3_open_port(int port_number);
int MR3_sock_read(int sockfd, char *buf, size_t count);
int mr3_sock_read_(int *sockfd, char *buf, int *count);
int mr3_sock_read__(int *sockfd, char *buf, int *count);
int mr3_sock_read_i_(int *sockfd, int *buf);
int mr3_sock_read_i__(int *sockfd, int *buf);
int MR3_sock_read_iv(int sockfd, int *buf, int count);
int mr3_sock_read_iv_(int *sockfd, int *buf, int *count);
int mr3_sock_read_iv__(int *sockfd, int *buf, int *count);
int MR3_sock_read_d(int sockfd, double *buf);
int mr3_sock_read_d__(int *sockfd, double *buf);
int mr3_sock_read_d_(int *sockfd, double *buf);
int MR3_sock_read_dv(int sockfd, double *buf, int count);
int mr3_sock_read_dv__(int *sockfd, double *buf, int *count);
int mr3_sock_read_dv_(int *sockfd, double *buf, int *count);
int MR3_sock_write(int sockfd, char *buf, size_t count);
int MR3_sock_write_c(int sockfd, char *buf);
int mr3_sock_write_c_(int *sockfd, char *buf);
int mr3_sock_write_c__(int *sockfd, char *buf);
int MR3_sock_write_i(int sockfd, int buf);
int mr3_sock_write_i_(int *sockfd, int *buf);
int mr3_sock_write_i__(int *sockfd, int *buf);
int MR3_sock_write_iv(int sockfd, int *buf, int count);
int mr3_sock_write_iv_(int *sockfd, int *buf, int *count);
int mr3_sock_write_iv__(int *sockfd, int *buf, int *count);
int MR3_sock_write_dv(int sockfd, double *buf, int count);
int mr3_sock_write_dv__(int *sockfd, double *buf, int *count);
int mr3_sock_write_dv_(int *sockfd, double *buf, int *count);
int MR3_sock_gets(int sockfd, char *str, size_t count);
int MR3_sock_puts(int sockfd, char *str);
void MR3_sock_init(int *s_sock_org, int port_num, double x[], int igraph[], int natom, int str_len, int lbres[], int ipres[], int nres);
void mr3_sock_init_(int *s_sock, int *port_num, double x[], int igraph[], int *natom, int *str_len, int lbres[], int ipres[], int *nres);
void mr3_sock_init__(int *s_sock, int *port_num, double x[], int igraph[], int *natom, int *str_len, int lbres[], int ipres[], int *nres);
void MR3_sock_1step(int s_sock, double t1, double time, double t2, int recv_buf[], int natom, double x[], double f[], double f_temp[]);
void mr3_sock_1step_(int *s_sock, double *t1, double *time, double *t2, int recv_buf[], int *natom, double x[], double f[], double f_tmp[]);
void mr3_sock_1step__(int *s_sock, double *t1, double *time, double *t2, int recv_buf[], int *natom, double x[], double f[], double f_tmp[]);
void MR3calc_ij_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, char method);
void MR3calc_ij_exlist_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], char method);
void MR3calc_ij_nlist_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], char method);
/* vtgrape.c */
void *MR3_my_malloc2(size_t n, char *s);
void MR3_my_free2(void **p, char *s);
VG_UNIT *m3_get_unit(void);
void vg_exit(int ret);
VG_UNIT *vg_allocate_unit(void (*function)(void *));
void vg_free_unit(VG_UNIT *unit);
void vg_set_function(VG_UNIT *unit, int function_index, void (*function)(void *));
void vg_set_vectors(VG_UNIT *unit, int nj, void *jvectors);
void vg_set_matrices(VG_UNIT *unit, int nati, int natj, void *matrices);
void vg_set_scalers(VG_UNIT *unit, void *scalers);
void vg_set_pipeline_vectors(VG_UNIT *unit, int ni, void *ivectors);
void vg_calculate(VG_UNIT *unit, int function_index, int nf, void *fvectors, void *pscalers);
void vg_set_vectors_pos_charge_atype(VG_UNIT *unit, int nj, double pos[][3], double charge[], int atype[]);
void vg_set_vectors_pos_charge(VG_UNIT *unit, int nj, double pos[][3], double charge[]);
void vg_set_vectors_pos_atype(VG_UNIT *unit, int nj, double pos[][3], int atype[]);
void vg_set_matrices_gscales_rscales(VG_UNIT *unit, int nati_org, int natj_org, double gscales[], double rscales[]);
void vg_set_pol_sigm_ipotro_pc_pd_zz(VG_UNIT *unit, int nati, int natj, double pol[], double sigm[], double ipotro[], double pc[], double pd[], double zz[]);
void vg_set_scalers_volume_alpha(VG_UNIT *unit, double volume[3], double alpha);
void vg_set_pipeline_vectors_pos_charge_atype(VG_UNIT *unit, int ni, double pos[][3], double charge[], int atype[]);
void vg_set_pipeline_vectors_pos_charge(VG_UNIT *unit, int ni, double pos[][3], double charge[]);
void vg_set_pipeline_vectors_pos_atype(VG_UNIT *unit, int ni, double pos[][3], int atype[]);
void vg_convert_forces(VG_UNIT *unit, int nf, int function_index, double fi[][3]);
void vg_calculate_forces_potentials(VG_UNIT *unit, int function_index, int nf, double fi[][3], double *potc, double *potv);
void vg_get_r1result(int n_org, float r[], float r1[]);
void vg_get_rsqrtresult(int n_org, float r[], float r1[]);
void vg_get_mulresult(int n_org, float r[], float q[], float rq[]);
int vg_write_emufile(int flag);
void vg_initialize_emu(void);
float vg_r1emu(float x);
float vg_rsqrtemu(float x);
void vg_set_scaleq(int n, double q[], double *scaleq, float *scaleq_1);
void m3_set_softening(VG_UNIT *unit, double eps);
void MR3_exit(int ret);
void MR3init(void);
void mr3init_(void);
void mr3init__(void);
void MR3free(void);
void mr3free_(void);
void mr3free__(void);
void MR3calccoulomb(double x[], int n, double q[], double rscale, int tblno, double xmax, int periodicflag, int natchangeflag, double force[]);
void mr3calccoulomb_(double x[], int *n, double q[], double *rscale, int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void mr3calccoulomb__(double x[], int *n, double q[], double *rscale, int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void MR3calccoulomb_ij(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag);
void mr3calccoulomb_ij_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void mr3calccoulomb_ij__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void MR3_sort_with_index_int(int data[], int index[], int left, int right);
void MR3calcvdw_ij_core(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void MR3calcvdw_ij(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void mr3calcvdw_ij_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void mr3calcvdw_ij__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void MR3calcvdw(double x[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int natchangeflag, double force[]);
void mr3calcvdw_(double x[], int *n, int atype[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void mr3calcvdw__(double x[], int *n, int atype[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void MR3calcewald(int *k, int knum_org, double *x, int n, double *chg, double alpha, double epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald__(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void MR3calcnacl(double x[], int n, int atype[], int nat, double pol[], double sigm[], double ipotro[], double pc[], double pd[], double zz[], int tblno, double xmax, int periodicflag, double force[]);
void vtgrape_force(double xj[][3], double mj[], double xi[][3], double eps2, double a[][3], int ni, int nj);
void vg_set_rcut2(VG_UNIT *unit, double rcut2);
void mr3_set_rcut2_(double *rcut2);
int md5sum(unsigned char *buffer, int totallen, unsigned char sum[16]);
int md5sum_file(char *filename, unsigned char sum[16]);
void MR3calccoulomb_ij_host(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag);
void mr3calccoulomb_ij_host_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void mr3calccoulomb_ij_host__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void MR3calcvdw_ij_host(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void mr3calcvdw_ij_host_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void mr3calcvdw_ij_host__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void MR3calccoulomb_nlist_ij_host_notwork(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[], double factorall);
void MR3calccoulomb_nlist_ij_host(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calccoulomb_nlist_host(double xd[], int n, double qd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calcvdw_nlist_ij_host_notwork(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[], double factor);
void MR3calcvdw_nlist_ij_host(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_host2(double x[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[], double factor, double force[]);
void MR3calccoulomb_ij_exlist_host(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void MR3calcvdw_ij_exlist_host(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void MR3calcewald_dft_host(int k[], int knum, double x[], int n, double chg[], double cellsize[3], double bs[], double bc[]);
void MR3calcewald_idft_eng_host(int k[], double bs[], double bc[], int knum, double x[], int n, double cellsize[3], double force[]);
void MR3calcewald_idft_force_host(int k[], double bs[], double bc[], int knum, double x[], int n, double cellsize[3], double force[]);
void MR3calcewald_host(int *k, int knum_org, double *x, int n, double *chg, double alpha, double epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_host__(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_host_(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void MR3SetTable(char *filename, int tblno, int flag);
void mr3settable_nf_(char *fname, int *tblno, int *flag, int *n);
void mr3settable_nf__(char *fname, int *tblno, int *flag, int *n);
void MR3_setup_exlist(int n, int *bckptr);
void mr3_setup_exlist_(int *n, int *bckptr);
void MR3_make_natex2_from_natex(int n, int natex[], int numex[], int **natex_offset, int **natex2, int **numex2, int **natex2_offset, int flag);
void calccoulomb_vdw_ij_exlist_host_sub(int i, int j, double xi[], double xj[], double qj, double gsf, double gsp, double rs, double rscale, double cutoff, double *fc, double *fv, double *pc, double *pv, int tblno, double size[3], int potflag);
void MR3calccoulomb_vdw_ij_exlist_cutoff_host(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double cutoff, double size[3], double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_host(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_host2(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_host_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_host__(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void MR3_get_cputime(double *laptime, double *sprittime);
void MR3_set_ldim(int ldim[3]);
void mr3_set_ldim_(int ldim[3]);
void mr3_set_ldim__(int ldim[3]);
void MR3_set_coulomb_vdw_factor(double cgf);
void mr3_set_coulomb_vdw_factor_(double *cgf);
void mr3_set_coulomb_vdw_factor__(double *cgf);
void MR3calccoulomb_ij_emu(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag);
void MR3calccoulomb_nlist_ij_emu(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calccoulomb_nlist_emu(double xd[], int n, double qd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calcvdw_ij_emu(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void MR3calccoulomb_vdw_nlist_ij_emu(int ni, double xid[], double qid[], int atypei[], double force[], int nj, double xjd[], double qjd[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblno, double volume[], int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_ij_emu(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_emu2(double xd[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calccoulomb_ij_exlist(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void mr3calccoulomb_ij_exlist_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag, int numexorg[], int natexorg[]);
void mr3calccoulomb_ij_exlist__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag, int numexorg[], int natexorg[]);
void MR3calcvdw_ij_exlist(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void mr3calcvdw_ij_exlist_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int numex[], int natex[]);
void mr3calcvdw_ij_exlist__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_core_old(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_core(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_virial_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_exlist(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double volume1, double *potc, double *potv, int *convert_index, int potflag, int flag);
void MR3calccoulomb_vdw_exlist_from_cell(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double volume1, double *potc, double *potv, int *convert_index, int potflag, int flag);
void mr3calccoulomb_vdw_exlist_(int *n, double x[], double q[], int atype[], int *nat, double force[], double *rscale, double gscalesf[], double gscalesp[], double rscales[], int *tblno, int numex[], int natex[], double *volume1, double *potc, double *potv, int *convert_index, int *potflag, int *flag);
void MR3_get_forces_overlap(double force[]);
void mr3_get_forces_overlap_(double force[]);
void MR3_get_potc_and_potv_overlap(double *potc, double *potv);
void mr3_get_potc_and_potv_overlap_(double *potc, double *potv);
void mr3_get_potc_and_potv_overlap__(double *potc, double *potv);
void MR3_get_forces_and_virial_overlap(double force[], double virial[3][3]);
void mr3_get_forces_and_virial_overlap_(double force[], double virial[3][3]);
void MR3calccoulomb_ci_exlist(int n, double x[], double q[], double force[], double rscale, int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], int *convert_index, int flag);
void mr3calccoulomb_ci_exlist_(int *n, double x[], double q[], double force[], double *rscale, int *tblno, int numex[], int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], int *convert_index, int *flag);
void MR3calcvdw_ci(int n, double x[], int atype[], int nat, double force[], double gscales[], double rscales[], int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calcvdw_ci_(int *n, double x[], int atype[], int *nat, double force[], double gscales[], double rscales[], int *tblno, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calcvdw_ci_exlist(int n, double x[], int atype[], int nat, double force[], double gscales[], double rscales[], int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], int *convert_index, int flag);
void mr3calcvdw_ci_exlist_(int *n, double x[], int atype[], int *nat, double force[], double gscales[], double rscales[], int *tblno, int numex[], int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], int *convert_index, int *flag);
void MR3calccoulomb_vdw_ci_exlist(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], double *potc, double *potv, int *convert_index, int potflag, int flag);
void mr3calccoulomb_vdw_ci_exlist_(int *n, double x[], double q[], int atype[], int *nat, double force[], double *rscale, double gscalesf[], double gscalesp[], double rscales[], int *tblno, int *numex, int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], double *potc, double *potv, int *convert_index, int *potflag, int *flag);
void MR3calccoulomb_ci(int n, double x[], double q[], double force[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calccoulomb_ci_(int *n, double x[], double q[], double force[], double *rscale, int *tblno, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_ij_ci(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_ij_ci_old(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calcvdw_ij_ci(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_virial(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut_org, double skinnb, double volume[3], int ldim[3], double virial[3][3], int flag);
void MR3calccoulomb_vdw_ij_ci(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calccoulomb_vdw_ij_ci_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscales[], double rscales[], double *rscale, int *tblnoc, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_old_09(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_old_090121(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_exlist(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3], int numex[], int natex[], int flag);
void mr3calccoulomb_vdw_ij_ci_exlist_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscales[], double rscales[], double *rscale, int *tblnoc, double *rcut, double *skinnb, double volume[3], int ldim[3], int numex[], int natex[], int *flag);
void MR3_get_board_version(int *version, int *freq);
void MR3_rscale_and_pack(int n, double (*x)[3], int *atype, longlong (*rj)[2]);
void MR3_rscale_and_pack_old(int n, double (*x)[3], int *atype, longlong (*rj)[2]);
void MR3SetTable_emu(char *filename, int tblno, int flag);
int MR3_get_total_num_chips(void);
void MR3print_chip_temperature(int flag);
int MR3_get_retry_count(void);
void m3_free_unit(VG_UNIT *unit);
VG_UNIT *m3_allocate_periodic_unit(const char *fname, int mode, double size, int dum);
void m3_set_positions(VG_UNIT *unit, double (*pos)[3], int n);
void m3_set_charges(VG_UNIT *unit, const double *q, int n);
void m3_set_cells(VG_UNIT *unit, M3_CELL *cell, int ncell);
void m3_calculate_forces(VG_UNIT *unit, double (*xi)[3], int ni, double (*force)[3]);
void m3_calculate_potentials(VG_UNIT *unit, double (*xi)[3], int ni, double *eng);
void m3_set_types(VG_UNIT *unit, const int *atype, int n);
void m3_set_pipeline_types(VG_UNIT *unit, const int *atype, int n);
void m3_set_charge_matrix(VG_UNIT *unit, const double *gscale, int nati, int natj);
void m3_set_rscale_matrix(VG_UNIT *unit, const double *rscale, int nati, int natj);
int MR3_close_ch(int s_sock);
int mr3_close_ch_(int *s_sock);
int MR3_open_port(int port_number);
int MR3_sock_read(int sockfd, char *buf, size_t count);
int mr3_sock_read_(int *sockfd, char *buf, int *count);
int mr3_sock_read__(int *sockfd, char *buf, int *count);
int mr3_sock_read_i_(int *sockfd, int *buf);
int mr3_sock_read_i__(int *sockfd, int *buf);
int MR3_sock_read_iv(int sockfd, int *buf, int count);
int mr3_sock_read_iv_(int *sockfd, int *buf, int *count);
int mr3_sock_read_iv__(int *sockfd, int *buf, int *count);
int MR3_sock_read_d(int sockfd, double *buf);
int mr3_sock_read_d__(int *sockfd, double *buf);
int mr3_sock_read_d_(int *sockfd, double *buf);
int MR3_sock_read_dv(int sockfd, double *buf, int count);
int mr3_sock_read_dv__(int *sockfd, double *buf, int *count);
int mr3_sock_read_dv_(int *sockfd, double *buf, int *count);
int MR3_sock_write(int sockfd, char *buf, size_t count);
int MR3_sock_write_c(int sockfd, char *buf);
int mr3_sock_write_c_(int *sockfd, char *buf);
int mr3_sock_write_c__(int *sockfd, char *buf);
int MR3_sock_write_i(int sockfd, int buf);
int mr3_sock_write_i_(int *sockfd, int *buf);
int mr3_sock_write_i__(int *sockfd, int *buf);
int MR3_sock_write_iv(int sockfd, int *buf, int count);
int mr3_sock_write_iv_(int *sockfd, int *buf, int *count);
int mr3_sock_write_iv__(int *sockfd, int *buf, int *count);
int MR3_sock_write_dv(int sockfd, double *buf, int count);
int mr3_sock_write_dv__(int *sockfd, double *buf, int *count);
int mr3_sock_write_dv_(int *sockfd, double *buf, int *count);
int MR3_sock_gets(int sockfd, char *str, size_t count);
int MR3_sock_puts(int sockfd, char *str);
void MR3_sock_init(int *s_sock_org, int port_num, double x[], int igraph[], int natom, int str_len, int lbres[], int ipres[], int nres);
void mr3_sock_init_(int *s_sock, int *port_num, double x[], int igraph[], int *natom, int *str_len, int lbres[], int ipres[], int *nres);
void mr3_sock_init__(int *s_sock, int *port_num, double x[], int igraph[], int *natom, int *str_len, int lbres[], int ipres[], int *nres);
void MR3_sock_1step(int s_sock, double t1, double time, double t2, int recv_buf[], int natom, double x[], double f[], double f_temp[]);
void mr3_sock_1step_(int *s_sock, double *t1, double *time, double *t2, int recv_buf[], int *natom, double x[], double f[], double f_tmp[]);
void mr3_sock_1step__(int *s_sock, double *t1, double *time, double *t2, int recv_buf[], int *natom, double x[], double f[], double f_tmp[]);
void MR3calc_ij_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, char method);
void MR3calc_ij_exlist_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], char method);
void MR3calc_ij_nlist_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], char method);
/* vtgrape.c */
void *MR3_my_malloc2(size_t n, char *s);
void MR3_my_free2(void **p, char *s);
VG_UNIT *m3_get_unit(void);
void vg_exit(int ret);
VG_UNIT *vg_allocate_unit(void (*function)(void *));
void vg_free_unit(VG_UNIT *unit);
void vg_set_function(VG_UNIT *unit, int function_index, void (*function)(void *));
void vg_set_vectors(VG_UNIT *unit, int nj, void *jvectors);
void vg_set_matrices(VG_UNIT *unit, int nati, int natj, void *matrices);
void vg_set_scalers(VG_UNIT *unit, void *scalers);
void vg_set_pipeline_vectors(VG_UNIT *unit, int ni, void *ivectors);
void vg_calculate(VG_UNIT *unit, int function_index, int nf, void *fvectors, void *pscalers);
void vg_set_vectors_pos_charge_atype(VG_UNIT *unit, int nj, double pos[][3], double charge[], int atype[]);
void vg_set_vectors_pos_charge(VG_UNIT *unit, int nj, double pos[][3], double charge[]);
void vg_set_vectors_pos_atype(VG_UNIT *unit, int nj, double pos[][3], int atype[]);
void vg_set_matrices_gscales_rscales(VG_UNIT *unit, int nati_org, int natj_org, double gscales[], double rscales[]);
void vg_set_pol_sigm_ipotro_pc_pd_zz(VG_UNIT *unit, int nati, int natj, double pol[], double sigm[], double ipotro[], double pc[], double pd[], double zz[]);
void vg_set_scalers_volume_alpha(VG_UNIT *unit, double volume[3], double alpha);
void vg_set_pipeline_vectors_pos_charge_atype(VG_UNIT *unit, int ni, double pos[][3], double charge[], int atype[]);
void vg_set_pipeline_vectors_pos_charge(VG_UNIT *unit, int ni, double pos[][3], double charge[]);
void vg_set_pipeline_vectors_pos_atype(VG_UNIT *unit, int ni, double pos[][3], int atype[]);
void vg_convert_forces(VG_UNIT *unit, int nf, int function_index, double fi[][3]);
void vg_calculate_forces_potentials(VG_UNIT *unit, int function_index, int nf, double fi[][3], double *potc, double *potv);
void vg_get_r1result(int n_org, float r[], float r1[]);
void vg_get_rsqrtresult(int n_org, float r[], float r1[]);
void vg_get_mulresult(int n_org, float r[], float q[], float rq[]);
int vg_write_emufile(int flag);
void vg_initialize_emu(void);
float vg_r1emu(float x);
float vg_rsqrtemu(float x);
void vg_set_scaleq(int n, double q[], double *scaleq, float *scaleq_1);
void m3_set_softening(VG_UNIT *unit, double eps);
void MR3_exit(int ret);
void MR3init(void);
void mr3init_(void);
void mr3init__(void);
void MR3free(void);
void mr3free_(void);
void mr3free__(void);
void MR3calccoulomb(double x[], int n, double q[], double rscale, int tblno, double xmax, int periodicflag, int natchangeflag, double force[]);
void mr3calccoulomb_(double x[], int *n, double q[], double *rscale, int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void mr3calccoulomb__(double x[], int *n, double q[], double *rscale, int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void MR3calccoulomb_ij(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag);
void mr3calccoulomb_ij_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void mr3calccoulomb_ij__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void MR3_sort_with_index_int(int data[], int index[], int left, int right);
void MR3calcvdw_ij_core(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void MR3calcvdw_ij(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void mr3calcvdw_ij_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void mr3calcvdw_ij__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void MR3calcvdw(double x[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int natchangeflag, double force[]);
void mr3calcvdw_(double x[], int *n, int atype[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void mr3calcvdw__(double x[], int *n, int atype[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void MR3calcewald(int *k, int knum_org, double *x, int n, double *chg, double alpha, double epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald__(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void MR3calcnacl(double x[], int n, int atype[], int nat, double pol[], double sigm[], double ipotro[], double pc[], double pd[], double zz[], int tblno, double xmax, int periodicflag, double force[]);
void vtgrape_force(double xj[][3], double mj[], double xi[][3], double eps2, double a[][3], int ni, int nj);
void vg_set_rcut2(VG_UNIT *unit, double rcut2);
void mr3_set_rcut2_(double *rcut2);
int md5sum(unsigned char *buffer, int totallen, unsigned char sum[16]);
int md5sum_file(char *filename, unsigned char sum[16]);
void MR3calccoulomb_ij_host(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag);
void mr3calccoulomb_ij_host_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void mr3calccoulomb_ij_host__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void MR3calcvdw_ij_host(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void mr3calcvdw_ij_host_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void mr3calcvdw_ij_host__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void MR3calccoulomb_nlist_ij_host_notwork(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[], double factorall);
void MR3calccoulomb_nlist_ij_host(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calccoulomb_nlist_host(double xd[], int n, double qd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calcvdw_nlist_ij_host_notwork(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[], double factor);
void MR3calcvdw_nlist_ij_host(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_host2(double x[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[], double factor, double force[]);
void MR3calccoulomb_ij_exlist_host(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void MR3calcvdw_ij_exlist_host(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void MR3calcewald_dft_host(int k[], int knum, double x[], int n, double chg[], double cellsize[3], double bs[], double bc[]);
void MR3calcewald_idft_eng_host(int k[], double bs[], double bc[], int knum, double x[], int n, double cellsize[3], double force[]);
void MR3calcewald_idft_force_host(int k[], double bs[], double bc[], int knum, double x[], int n, double cellsize[3], double force[]);
void MR3calcewald_host(int *k, int knum_org, double *x, int n, double *chg, double alpha, double epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_host__(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_host_(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void MR3SetTable(char *filename, int tblno, int flag);
void mr3settable_nf_(char *fname, int *tblno, int *flag, int *n);
void mr3settable_nf__(char *fname, int *tblno, int *flag, int *n);
void MR3_setup_exlist(int n, int *bckptr);
void mr3_setup_exlist_(int *n, int *bckptr);
void MR3_make_natex2_from_natex(int n, int natex[], int numex[], int **natex_offset, int **natex2, int **numex2, int **natex2_offset, int flag);
void calccoulomb_vdw_ij_exlist_host_sub(int i, int j, double xi[], double xj[], double qj, double gsf, double gsp, double rs, double rscale, double cutoff, double *fc, double *fv, double *pc, double *pv, int tblno, double size[3], int potflag);
void MR3calccoulomb_vdw_ij_exlist_cutoff_host(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double cutoff, double size[3], double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_host(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_host2(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_host_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_host__(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void MR3_get_cputime(double *laptime, double *sprittime);
void MR3_set_ldim(int ldim[3]);
void mr3_set_ldim_(int ldim[3]);
void mr3_set_ldim__(int ldim[3]);
void MR3_set_coulomb_vdw_factor(double cgf);
void mr3_set_coulomb_vdw_factor_(double *cgf);
void mr3_set_coulomb_vdw_factor__(double *cgf);
void MR3calccoulomb_ij_emu(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag);
void MR3calccoulomb_nlist_ij_emu(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calccoulomb_nlist_emu(double xd[], int n, double qd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calcvdw_ij_emu(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void MR3calccoulomb_vdw_nlist_ij_emu(int ni, double xid[], double qid[], int atypei[], double force[], int nj, double xjd[], double qjd[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblno, double volume[], int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_ij_emu(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_emu2(double xd[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calccoulomb_ij_exlist(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void mr3calccoulomb_ij_exlist_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag, int numexorg[], int natexorg[]);
void mr3calccoulomb_ij_exlist__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag, int numexorg[], int natexorg[]);
void MR3calcvdw_ij_exlist(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void mr3calcvdw_ij_exlist_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int numex[], int natex[]);
void mr3calcvdw_ij_exlist__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_core_old(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_core(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_virial_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_exlist(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double volume1, double *potc, double *potv, int *convert_index, int potflag, int flag);
void MR3calccoulomb_vdw_exlist_from_cell(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double volume1, double *potc, double *potv, int *convert_index, int potflag, int flag);
void mr3calccoulomb_vdw_exlist_(int *n, double x[], double q[], int atype[], int *nat, double force[], double *rscale, double gscalesf[], double gscalesp[], double rscales[], int *tblno, int numex[], int natex[], double *volume1, double *potc, double *potv, int *convert_index, int *potflag, int *flag);
void MR3_get_forces_overlap(double force[]);
void mr3_get_forces_overlap_(double force[]);
void MR3_get_potc_and_potv_overlap(double *potc, double *potv);
void mr3_get_potc_and_potv_overlap_(double *potc, double *potv);
void mr3_get_potc_and_potv_overlap__(double *potc, double *potv);
void MR3_get_forces_and_virial_overlap(double force[], double virial[3][3]);
void mr3_get_forces_and_virial_overlap_(double force[], double virial[3][3]);
void MR3calccoulomb_ci_exlist(int n, double x[], double q[], double force[], double rscale, int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], int *convert_index, int flag);
void mr3calccoulomb_ci_exlist_(int *n, double x[], double q[], double force[], double *rscale, int *tblno, int numex[], int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], int *convert_index, int *flag);
void MR3calcvdw_ci(int n, double x[], int atype[], int nat, double force[], double gscales[], double rscales[], int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calcvdw_ci_(int *n, double x[], int atype[], int *nat, double force[], double gscales[], double rscales[], int *tblno, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calcvdw_ci_exlist(int n, double x[], int atype[], int nat, double force[], double gscales[], double rscales[], int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], int *convert_index, int flag);
void mr3calcvdw_ci_exlist_(int *n, double x[], int atype[], int *nat, double force[], double gscales[], double rscales[], int *tblno, int numex[], int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], int *convert_index, int *flag);
void MR3calccoulomb_vdw_ci_exlist(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], double *potc, double *potv, int *convert_index, int potflag, int flag);
void mr3calccoulomb_vdw_ci_exlist_(int *n, double x[], double q[], int atype[], int *nat, double force[], double *rscale, double gscalesf[], double gscalesp[], double rscales[], int *tblno, int *numex, int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], double *potc, double *potv, int *convert_index, int *potflag, int *flag);
void MR3calccoulomb_ci(int n, double x[], double q[], double force[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calccoulomb_ci_(int *n, double x[], double q[], double force[], double *rscale, int *tblno, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_ij_ci(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_ij_ci_old(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calcvdw_ij_ci(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_virial(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut_org, double skinnb, double volume[3], int ldim[3], double virial[3][3], int flag);
void MR3calccoulomb_vdw_ij_ci(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calccoulomb_vdw_ij_ci_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscales[], double rscales[], double *rscale, int *tblnoc, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_old_09(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_old_090121(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_exlist(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3], int numex[], int natex[], int flag);
void mr3calccoulomb_vdw_ij_ci_exlist_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscales[], double rscales[], double *rscale, int *tblnoc, double *rcut, double *skinnb, double volume[3], int ldim[3], int numex[], int natex[], int *flag);
void MR3_get_board_version(int *version, int *freq);
void MR3_rscale_and_pack(int n, double (*x)[3], int *atype, longlong (*rj)[2]);
void MR3_rscale_and_pack_old(int n, double (*x)[3], int *atype, longlong (*rj)[2]);
void MR3SetTable_emu(char *filename, int tblno, int flag);
int MR3_get_total_num_chips(void);
void MR3print_chip_temperature(int flag);
int MR3_get_retry_count(void);
void m3_free_unit(VG_UNIT *unit);
VG_UNIT *m3_allocate_periodic_unit(const char *fname, int mode, double size, int dum);
void m3_set_positions(VG_UNIT *unit, double (*pos)[3], int n);
void m3_set_charges(VG_UNIT *unit, const double *q, int n);
void m3_set_cells(VG_UNIT *unit, M3_CELL *cell, int ncell);
void m3_calculate_forces(VG_UNIT *unit, double (*xi)[3], int ni, double (*force)[3]);
void m3_calculate_potentials(VG_UNIT *unit, double (*xi)[3], int ni, double *eng);
void m3_set_types(VG_UNIT *unit, const int *atype, int n);
void m3_set_pipeline_types(VG_UNIT *unit, const int *atype, int n);
void m3_set_charge_matrix(VG_UNIT *unit, const double *gscale, int nati, int natj);
void m3_set_rscale_matrix(VG_UNIT *unit, const double *rscale, int nati, int natj);
int MR3_close_ch(int s_sock);
int mr3_close_ch_(int *s_sock);
int MR3_open_port(int port_number);
int MR3_sock_read(int sockfd, char *buf, size_t count);
int mr3_sock_read_(int *sockfd, char *buf, int *count);
int mr3_sock_read__(int *sockfd, char *buf, int *count);
int mr3_sock_read_i_(int *sockfd, int *buf);
int mr3_sock_read_i__(int *sockfd, int *buf);
int MR3_sock_read_iv(int sockfd, int *buf, int count);
int mr3_sock_read_iv_(int *sockfd, int *buf, int *count);
int mr3_sock_read_iv__(int *sockfd, int *buf, int *count);
int MR3_sock_read_d(int sockfd, double *buf);
int mr3_sock_read_d__(int *sockfd, double *buf);
int mr3_sock_read_d_(int *sockfd, double *buf);
int MR3_sock_read_dv(int sockfd, double *buf, int count);
int mr3_sock_read_dv__(int *sockfd, double *buf, int *count);
int mr3_sock_read_dv_(int *sockfd, double *buf, int *count);
int MR3_sock_write(int sockfd, char *buf, size_t count);
int MR3_sock_write_c(int sockfd, char *buf);
int mr3_sock_write_c_(int *sockfd, char *buf);
int mr3_sock_write_c__(int *sockfd, char *buf);
int MR3_sock_write_i(int sockfd, int buf);
int mr3_sock_write_i_(int *sockfd, int *buf);
int mr3_sock_write_i__(int *sockfd, int *buf);
int MR3_sock_write_iv(int sockfd, int *buf, int count);
int mr3_sock_write_iv_(int *sockfd, int *buf, int *count);
int mr3_sock_write_iv__(int *sockfd, int *buf, int *count);
int MR3_sock_write_dv(int sockfd, double *buf, int count);
int mr3_sock_write_dv__(int *sockfd, double *buf, int *count);
int mr3_sock_write_dv_(int *sockfd, double *buf, int *count);
int MR3_sock_gets(int sockfd, char *str, size_t count);
int MR3_sock_puts(int sockfd, char *str);
void MR3_sock_init(int *s_sock_org, int port_num, double x[], int igraph[], int natom, int str_len, int lbres[], int ipres[], int nres);
void mr3_sock_init_(int *s_sock, int *port_num, double x[], int igraph[], int *natom, int *str_len, int lbres[], int ipres[], int *nres);
void mr3_sock_init__(int *s_sock, int *port_num, double x[], int igraph[], int *natom, int *str_len, int lbres[], int ipres[], int *nres);
void MR3_sock_1step(int s_sock, double t1, double time, double t2, int recv_buf[], int natom, double x[], double f[], double f_temp[]);
void mr3_sock_1step_(int *s_sock, double *t1, double *time, double *t2, int recv_buf[], int *natom, double x[], double f[], double f_tmp[]);
void mr3_sock_1step__(int *s_sock, double *t1, double *time, double *t2, int recv_buf[], int *natom, double x[], double f[], double f_tmp[]);
void MR3calc_ij_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, char method);
void MR3calc_ij_exlist_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], char method);
void MR3calc_ij_nlist_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], char method);
/* vtgrape.c */
void *MR3_my_malloc2(size_t n, char *s);
void MR3_my_free2(void **p, char *s);
VG_UNIT *m3_get_unit(void);
void vg_exit(int ret);
VG_UNIT *vg_allocate_unit(void (*function)(void *));
void vg_free_unit(VG_UNIT *unit);
void vg_set_function(VG_UNIT *unit, int function_index, void (*function)(void *));
void vg_set_vectors(VG_UNIT *unit, int nj, void *jvectors);
void vg_set_matrices(VG_UNIT *unit, int nati, int natj, void *matrices);
void vg_set_scalers(VG_UNIT *unit, void *scalers);
void vg_set_pipeline_vectors(VG_UNIT *unit, int ni, void *ivectors);
void vg_calculate(VG_UNIT *unit, int function_index, int nf, void *fvectors, void *pscalers);
void vg_set_vectors_pos_charge_atype(VG_UNIT *unit, int nj, double pos[][3], double charge[], int atype[]);
void vg_set_vectors_pos_charge(VG_UNIT *unit, int nj, double pos[][3], double charge[]);
void vg_set_vectors_pos_atype(VG_UNIT *unit, int nj, double pos[][3], int atype[]);
void vg_set_matrices_gscales_rscales(VG_UNIT *unit, int nati_org, int natj_org, double gscales[], double rscales[]);
void vg_set_pol_sigm_ipotro_pc_pd_zz(VG_UNIT *unit, int nati, int natj, double pol[], double sigm[], double ipotro[], double pc[], double pd[], double zz[]);
void vg_set_scalers_volume_alpha(VG_UNIT *unit, double volume[3], double alpha);
void vg_set_pipeline_vectors_pos_charge_atype(VG_UNIT *unit, int ni, double pos[][3], double charge[], int atype[]);
void vg_set_pipeline_vectors_pos_charge(VG_UNIT *unit, int ni, double pos[][3], double charge[]);
void vg_set_pipeline_vectors_pos_atype(VG_UNIT *unit, int ni, double pos[][3], int atype[]);
void vg_convert_forces(VG_UNIT *unit, int nf, int function_index, double fi[][3]);
void vg_calculate_forces_potentials(VG_UNIT *unit, int function_index, int nf, double fi[][3], double *potc, double *potv);
void vg_get_r1result(int n_org, float r[], float r1[]);
void vg_get_rsqrtresult(int n_org, float r[], float r1[]);
void vg_get_mulresult(int n_org, float r[], float q[], float rq[]);
int vg_write_emufile(int flag);
void vg_initialize_emu(void);
float vg_r1emu(float x);
float vg_rsqrtemu(float x);
void vg_set_scaleq(int n, double q[], double *scaleq, float *scaleq_1);
void m3_set_softening(VG_UNIT *unit, double eps);
void MR3_exit(int ret);
void MR3init(void);
void mr3init_(void);
void mr3init__(void);
void MR3free(void);
void mr3free_(void);
void mr3free__(void);
void MR3calccoulomb(double x[], int n, double q[], double rscale, int tblno, double xmax, int periodicflag, int natchangeflag, double force[]);
void mr3calccoulomb_(double x[], int *n, double q[], double *rscale, int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void mr3calccoulomb__(double x[], int *n, double q[], double *rscale, int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void MR3calccoulomb_ij(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag);
void mr3calccoulomb_ij_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void mr3calccoulomb_ij__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void MR3_sort_with_index_int(int data[], int index[], int left, int right);
void MR3calcvdw_ij_core(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void MR3calcvdw_ij(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void mr3calcvdw_ij_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void mr3calcvdw_ij__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void MR3calcvdw(double x[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int natchangeflag, double force[]);
void mr3calcvdw_(double x[], int *n, int atype[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void mr3calcvdw__(double x[], int *n, int atype[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void MR3calcewald(int *k, int knum_org, double *x, int n, double *chg, double alpha, double epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald__(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void MR3calcnacl(double x[], int n, int atype[], int nat, double pol[], double sigm[], double ipotro[], double pc[], double pd[], double zz[], int tblno, double xmax, int periodicflag, double force[]);
void vtgrape_force(double xj[][3], double mj[], double xi[][3], double eps2, double a[][3], int ni, int nj);
void vg_set_rcut2(VG_UNIT *unit, double rcut2);
void mr3_set_rcut2_(double *rcut2);
int md5sum(unsigned char *buffer, int totallen, unsigned char sum[16]);
int md5sum_file(char *filename, unsigned char sum[16]);
void MR3calccoulomb_ij_host(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag);
void mr3calccoulomb_ij_host_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void mr3calccoulomb_ij_host__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void MR3calcvdw_ij_host(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void mr3calcvdw_ij_host_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void mr3calcvdw_ij_host__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void MR3calccoulomb_nlist_ij_host_notwork(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[], double factorall);
void MR3calccoulomb_nlist_ij_host(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calccoulomb_nlist_host(double xd[], int n, double qd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calcvdw_nlist_ij_host_notwork(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[], double factor);
void MR3calcvdw_nlist_ij_host(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_host2(double x[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[], double factor, double force[]);
void MR3calccoulomb_ij_exlist_host(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void MR3calcvdw_ij_exlist_host(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void MR3calcewald_dft_host(int k[], int knum, double x[], int n, double chg[], double cellsize[3], double bs[], double bc[]);
void MR3calcewald_idft_eng_host(int k[], double bs[], double bc[], int knum, double x[], int n, double cellsize[3], double force[]);
void MR3calcewald_idft_force_host(int k[], double bs[], double bc[], int knum, double x[], int n, double cellsize[3], double force[]);
void MR3calcewald_host(int *k, int knum_org, double *x, int n, double *chg, double alpha, double epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_host__(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_host_(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void MR3SetTable(char *filename, int tblno, int flag);
void mr3settable_nf_(char *fname, int *tblno, int *flag, int *n);
void mr3settable_nf__(char *fname, int *tblno, int *flag, int *n);
void MR3_setup_exlist(int n, int *bckptr);
void mr3_setup_exlist_(int *n, int *bckptr);
void MR3_make_natex2_from_natex(int n, int natex[], int numex[], int **natex_offset, int **natex2, int **numex2, int **natex2_offset, int flag);
void calccoulomb_vdw_ij_exlist_host_sub(int i, int j, double xi[], double xj[], double qj, double gsf, double gsp, double rs, double rscale, double cutoff, double *fc, double *fv, double *pc, double *pv, int tblno, double size[3], int potflag);
void MR3calccoulomb_vdw_ij_exlist_cutoff_host(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double cutoff, double size[3], double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_host(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_host2(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_host_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_host__(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void MR3_get_cputime(double *laptime, double *sprittime);
void MR3_set_ldim(int ldim[3]);
void mr3_set_ldim_(int ldim[3]);
void mr3_set_ldim__(int ldim[3]);
void MR3_set_coulomb_vdw_factor(double cgf);
void mr3_set_coulomb_vdw_factor_(double *cgf);
void mr3_set_coulomb_vdw_factor__(double *cgf);
void MR3calccoulomb_ij_emu(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag);
void MR3calccoulomb_nlist_ij_emu(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calccoulomb_nlist_emu(double xd[], int n, double qd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calcvdw_ij_emu(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void MR3calccoulomb_vdw_nlist_ij_emu(int ni, double xid[], double qid[], int atypei[], double force[], int nj, double xjd[], double qjd[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblno, double volume[], int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_ij_emu(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_emu2(double xd[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calccoulomb_ij_exlist(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void mr3calccoulomb_ij_exlist_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag, int numexorg[], int natexorg[]);
void mr3calccoulomb_ij_exlist__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag, int numexorg[], int natexorg[]);
void MR3calcvdw_ij_exlist(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void mr3calcvdw_ij_exlist_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int numex[], int natex[]);
void mr3calcvdw_ij_exlist__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_core_old(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_core(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_virial_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_exlist(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double volume1, double *potc, double *potv, int *convert_index, int potflag, int flag);
void MR3calccoulomb_vdw_exlist_from_cell(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double volume1, double *potc, double *potv, int *convert_index, int potflag, int flag);
void mr3calccoulomb_vdw_exlist_(int *n, double x[], double q[], int atype[], int *nat, double force[], double *rscale, double gscalesf[], double gscalesp[], double rscales[], int *tblno, int numex[], int natex[], double *volume1, double *potc, double *potv, int *convert_index, int *potflag, int *flag);
void MR3_get_forces_overlap(double force[]);
void mr3_get_forces_overlap_(double force[]);
void MR3_get_potc_and_potv_overlap(double *potc, double *potv);
void mr3_get_potc_and_potv_overlap_(double *potc, double *potv);
void mr3_get_potc_and_potv_overlap__(double *potc, double *potv);
void MR3_get_forces_and_virial_overlap(double force[], double virial[3][3]);
void mr3_get_forces_and_virial_overlap_(double force[], double virial[3][3]);
void MR3calccoulomb_ci_exlist(int n, double x[], double q[], double force[], double rscale, int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], int *convert_index, int flag);
void mr3calccoulomb_ci_exlist_(int *n, double x[], double q[], double force[], double *rscale, int *tblno, int numex[], int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], int *convert_index, int *flag);
void MR3calcvdw_ci(int n, double x[], int atype[], int nat, double force[], double gscales[], double rscales[], int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calcvdw_ci_(int *n, double x[], int atype[], int *nat, double force[], double gscales[], double rscales[], int *tblno, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calcvdw_ci_exlist(int n, double x[], int atype[], int nat, double force[], double gscales[], double rscales[], int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], int *convert_index, int flag);
void mr3calcvdw_ci_exlist_(int *n, double x[], int atype[], int *nat, double force[], double gscales[], double rscales[], int *tblno, int numex[], int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], int *convert_index, int *flag);
void MR3calccoulomb_vdw_ci_exlist(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], double *potc, double *potv, int *convert_index, int potflag, int flag);
void mr3calccoulomb_vdw_ci_exlist_(int *n, double x[], double q[], int atype[], int *nat, double force[], double *rscale, double gscalesf[], double gscalesp[], double rscales[], int *tblno, int *numex, int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], double *potc, double *potv, int *convert_index, int *potflag, int *flag);
void MR3calccoulomb_ci(int n, double x[], double q[], double force[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calccoulomb_ci_(int *n, double x[], double q[], double force[], double *rscale, int *tblno, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_ij_ci(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_ij_ci_old(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calcvdw_ij_ci(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_virial(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut_org, double skinnb, double volume[3], int ldim[3], double virial[3][3], int flag);
void MR3calccoulomb_vdw_ij_ci(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calccoulomb_vdw_ij_ci_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscales[], double rscales[], double *rscale, int *tblnoc, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_old_09(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_old_090121(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_exlist(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3], int numex[], int natex[], int flag);
void mr3calccoulomb_vdw_ij_ci_exlist_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscales[], double rscales[], double *rscale, int *tblnoc, double *rcut, double *skinnb, double volume[3], int ldim[3], int numex[], int natex[], int *flag);
void MR3_get_board_version(int *version, int *freq);
void MR3_rscale_and_pack(int n, double (*x)[3], int *atype, longlong (*rj)[2]);
void MR3_rscale_and_pack_old(int n, double (*x)[3], int *atype, longlong (*rj)[2]);
void MR3SetTable_emu(char *filename, int tblno, int flag);
int MR3_get_total_num_chips(void);
void MR3print_chip_temperature(int flag);
int MR3_get_retry_count(void);
void m3_free_unit(VG_UNIT *unit);
VG_UNIT *m3_allocate_periodic_unit(const char *fname, int mode, double size, int dum);
void m3_set_positions(VG_UNIT *unit, double (*pos)[3], int n);
void m3_set_charges(VG_UNIT *unit, const double *q, int n);
void m3_set_cells(VG_UNIT *unit, M3_CELL *cell, int ncell);
void m3_calculate_forces(VG_UNIT *unit, double (*xi)[3], int ni, double (*force)[3]);
void m3_calculate_potentials(VG_UNIT *unit, double (*xi)[3], int ni, double *eng);
void m3_set_types(VG_UNIT *unit, const int *atype, int n);
void m3_set_pipeline_types(VG_UNIT *unit, const int *atype, int n);
void m3_set_charge_matrix(VG_UNIT *unit, const double *gscale, int nati, int natj);
void m3_set_rscale_matrix(VG_UNIT *unit, const double *rscale, int nati, int natj);
int MR3_close_ch(int s_sock);
int mr3_close_ch_(int *s_sock);
int MR3_open_port(int port_number);
int MR3_sock_read(int sockfd, char *buf, size_t count);
int mr3_sock_read_(int *sockfd, char *buf, int *count);
int mr3_sock_read__(int *sockfd, char *buf, int *count);
int mr3_sock_read_i_(int *sockfd, int *buf);
int mr3_sock_read_i__(int *sockfd, int *buf);
int MR3_sock_read_iv(int sockfd, int *buf, int count);
int mr3_sock_read_iv_(int *sockfd, int *buf, int *count);
int mr3_sock_read_iv__(int *sockfd, int *buf, int *count);
int MR3_sock_read_d(int sockfd, double *buf);
int mr3_sock_read_d__(int *sockfd, double *buf);
int mr3_sock_read_d_(int *sockfd, double *buf);
int MR3_sock_read_dv(int sockfd, double *buf, int count);
int mr3_sock_read_dv__(int *sockfd, double *buf, int *count);
int mr3_sock_read_dv_(int *sockfd, double *buf, int *count);
int MR3_sock_write(int sockfd, char *buf, size_t count);
int MR3_sock_write_c(int sockfd, char *buf);
int mr3_sock_write_c_(int *sockfd, char *buf);
int mr3_sock_write_c__(int *sockfd, char *buf);
int MR3_sock_write_i(int sockfd, int buf);
int mr3_sock_write_i_(int *sockfd, int *buf);
int mr3_sock_write_i__(int *sockfd, int *buf);
int MR3_sock_write_iv(int sockfd, int *buf, int count);
int mr3_sock_write_iv_(int *sockfd, int *buf, int *count);
int mr3_sock_write_iv__(int *sockfd, int *buf, int *count);
int MR3_sock_write_dv(int sockfd, double *buf, int count);
int mr3_sock_write_dv__(int *sockfd, double *buf, int *count);
int mr3_sock_write_dv_(int *sockfd, double *buf, int *count);
int MR3_sock_gets(int sockfd, char *str, size_t count);
int MR3_sock_puts(int sockfd, char *str);
void MR3_sock_init(int *s_sock_org, int port_num, double x[], int igraph[], int natom, int str_len, int lbres[], int ipres[], int nres);
void mr3_sock_init_(int *s_sock, int *port_num, double x[], int igraph[], int *natom, int *str_len, int lbres[], int ipres[], int *nres);
void mr3_sock_init__(int *s_sock, int *port_num, double x[], int igraph[], int *natom, int *str_len, int lbres[], int ipres[], int *nres);
void MR3_sock_1step(int s_sock, double t1, double time, double t2, int recv_buf[], int natom, double x[], double f[], double f_temp[]);
void mr3_sock_1step_(int *s_sock, double *t1, double *time, double *t2, int recv_buf[], int *natom, double x[], double f[], double f_tmp[]);
void mr3_sock_1step__(int *s_sock, double *t1, double *time, double *t2, int recv_buf[], int *natom, double x[], double f[], double f_tmp[]);
void MR3calc_ij_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, char method);
void MR3calc_ij_exlist_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], char method);
void MR3calc_ij_nlist_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], char method);
/* vtgrape.c */
void *MR3_my_malloc2(size_t n, char *s);
void MR3_my_free2(void **p, char *s);
VG_UNIT *m3_get_unit(void);
void vg_exit(int ret);
VG_UNIT *vg_allocate_unit(void (*function)(void *));
void vg_free_unit(VG_UNIT *unit);
void vg_set_function(VG_UNIT *unit, int function_index, void (*function)(void *));
void vg_set_vectors(VG_UNIT *unit, int nj, void *jvectors);
void vg_set_matrices(VG_UNIT *unit, int nati, int natj, void *matrices);
void vg_set_scalers(VG_UNIT *unit, void *scalers);
void vg_set_pipeline_vectors(VG_UNIT *unit, int ni, void *ivectors);
void vg_calculate(VG_UNIT *unit, int function_index, int nf, void *fvectors, void *pscalers);
void vg_set_vectors_pos_charge_atype(VG_UNIT *unit, int nj, double pos[][3], double charge[], int atype[]);
void vg_set_vectors_pos_charge(VG_UNIT *unit, int nj, double pos[][3], double charge[]);
void vg_set_vectors_pos_atype(VG_UNIT *unit, int nj, double pos[][3], int atype[]);
void vg_set_matrices_gscales_rscales(VG_UNIT *unit, int nati_org, int natj_org, double gscales[], double rscales[]);
void vg_set_pol_sigm_ipotro_pc_pd_zz(VG_UNIT *unit, int nati, int natj, double pol[], double sigm[], double ipotro[], double pc[], double pd[], double zz[]);
void vg_set_scalers_volume_alpha(VG_UNIT *unit, double volume[3], double alpha);
void vg_set_pipeline_vectors_pos_charge_atype(VG_UNIT *unit, int ni, double pos[][3], double charge[], int atype[]);
void vg_set_pipeline_vectors_pos_charge(VG_UNIT *unit, int ni, double pos[][3], double charge[]);
void vg_set_pipeline_vectors_pos_atype(VG_UNIT *unit, int ni, double pos[][3], int atype[]);
void vg_convert_forces(VG_UNIT *unit, int nf, int function_index, double fi[][3]);
void vg_calculate_forces_potentials(VG_UNIT *unit, int function_index, int nf, double fi[][3], double *potc, double *potv);
void vg_get_r1result(int n_org, float r[], float r1[]);
void vg_get_rsqrtresult(int n_org, float r[], float r1[]);
void vg_get_mulresult(int n_org, float r[], float q[], float rq[]);
int vg_write_emufile(int flag);
void vg_initialize_emu(void);
float vg_r1emu(float x);
float vg_rsqrtemu(float x);
void vg_set_scaleq(int n, double q[], double *scaleq, float *scaleq_1);
void m3_set_softening(VG_UNIT *unit, double eps);
void MR3_exit(int ret);
void MR3init(void);
void mr3init_(void);
void mr3init__(void);
void MR3free(void);
void mr3free_(void);
void mr3free__(void);
void MR3calccoulomb(double x[], int n, double q[], double rscale, int tblno, double xmax, int periodicflag, int natchangeflag, double force[]);
void mr3calccoulomb_(double x[], int *n, double q[], double *rscale, int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void mr3calccoulomb__(double x[], int *n, double q[], double *rscale, int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void MR3calccoulomb_ij(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag);
void mr3calccoulomb_ij_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void mr3calccoulomb_ij__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void MR3_sort_with_index_int(int data[], int index[], int left, int right);
void MR3calcvdw_ij_core(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void MR3calcvdw_ij(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void mr3calcvdw_ij_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void mr3calcvdw_ij__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void MR3calcvdw(double x[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int natchangeflag, double force[]);
void mr3calcvdw_(double x[], int *n, int atype[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void mr3calcvdw__(double x[], int *n, int atype[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void MR3calcewald(int *k, int knum_org, double *x, int n, double *chg, double alpha, double epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald__(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void MR3calcnacl(double x[], int n, int atype[], int nat, double pol[], double sigm[], double ipotro[], double pc[], double pd[], double zz[], int tblno, double xmax, int periodicflag, double force[]);
void vtgrape_force(double xj[][3], double mj[], double xi[][3], double eps2, double a[][3], int ni, int nj);
void vg_set_rcut2(VG_UNIT *unit, double rcut2);
void mr3_set_rcut2_(double *rcut2);
int md5sum(unsigned char *buffer, int totallen, unsigned char sum[16]);
int md5sum_file(char *filename, unsigned char sum[16]);
void MR3calccoulomb_ij_host(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag);
void mr3calccoulomb_ij_host_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void mr3calccoulomb_ij_host__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void MR3calcvdw_ij_host(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void mr3calcvdw_ij_host_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void mr3calcvdw_ij_host__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void MR3calccoulomb_nlist_ij_host_notwork(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[], double factorall);
void MR3calccoulomb_nlist_ij_host(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calccoulomb_nlist_host(double xd[], int n, double qd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calcvdw_nlist_ij_host_notwork(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[], double factor);
void MR3calcvdw_nlist_ij_host(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_host2(double x[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[], double factor, double force[]);
void MR3calccoulomb_ij_exlist_host(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void MR3calcvdw_ij_exlist_host(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void MR3calcewald_dft_host(int k[], int knum, double x[], int n, double chg[], double cellsize[3], double bs[], double bc[]);
void MR3calcewald_idft_eng_host(int k[], double bs[], double bc[], int knum, double x[], int n, double cellsize[3], double force[]);
void MR3calcewald_idft_force_host(int k[], double bs[], double bc[], int knum, double x[], int n, double cellsize[3], double force[]);
void MR3calcewald_host(int *k, int knum_org, double *x, int n, double *chg, double alpha, double epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_host__(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_host_(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void MR3SetTable(char *filename, int tblno, int flag);
void mr3settable_nf_(char *fname, int *tblno, int *flag, int *n);
void mr3settable_nf__(char *fname, int *tblno, int *flag, int *n);
void MR3_setup_exlist(int n, int *bckptr);
void mr3_setup_exlist_(int *n, int *bckptr);
void MR3_make_natex2_from_natex(int n, int natex[], int numex[], int **natex_offset, int **natex2, int **numex2, int **natex2_offset, int flag);
void calccoulomb_vdw_ij_exlist_host_sub(int i, int j, double xi[], double xj[], double qj, double gsf, double gsp, double rs, double rscale, double cutoff, double *fc, double *fv, double *pc, double *pv, int tblno, double size[3], int potflag);
void MR3calccoulomb_vdw_ij_exlist_cutoff_host(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double cutoff, double size[3], double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_host(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_host2(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_host_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_host__(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void MR3_get_cputime(double *laptime, double *sprittime);
void MR3_set_ldim(int ldim[3]);
void mr3_set_ldim_(int ldim[3]);
void mr3_set_ldim__(int ldim[3]);
void MR3_set_coulomb_vdw_factor(double cgf);
void mr3_set_coulomb_vdw_factor_(double *cgf);
void mr3_set_coulomb_vdw_factor__(double *cgf);
void MR3calccoulomb_ij_emu(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag);
void MR3calccoulomb_nlist_ij_emu(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calccoulomb_nlist_emu(double xd[], int n, double qd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calcvdw_ij_emu(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void MR3calccoulomb_vdw_nlist_ij_emu(int ni, double xid[], double qid[], int atypei[], double force[], int nj, double xjd[], double qjd[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblno, double volume[], int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_ij_emu(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_emu2(double xd[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calccoulomb_ij_exlist(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void mr3calccoulomb_ij_exlist_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag, int numexorg[], int natexorg[]);
void mr3calccoulomb_ij_exlist__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag, int numexorg[], int natexorg[]);
void MR3calcvdw_ij_exlist(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void mr3calcvdw_ij_exlist_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int numex[], int natex[]);
void mr3calcvdw_ij_exlist__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_core_old(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_core(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_virial_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_exlist(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double volume1, double *potc, double *potv, int *convert_index, int potflag, int flag);
void MR3calccoulomb_vdw_exlist_from_cell(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double volume1, double *potc, double *potv, int *convert_index, int potflag, int flag);
void mr3calccoulomb_vdw_exlist_(int *n, double x[], double q[], int atype[], int *nat, double force[], double *rscale, double gscalesf[], double gscalesp[], double rscales[], int *tblno, int numex[], int natex[], double *volume1, double *potc, double *potv, int *convert_index, int *potflag, int *flag);
void MR3_get_forces_overlap(double force[]);
void mr3_get_forces_overlap_(double force[]);
void MR3_get_potc_and_potv_overlap(double *potc, double *potv);
void mr3_get_potc_and_potv_overlap_(double *potc, double *potv);
void mr3_get_potc_and_potv_overlap__(double *potc, double *potv);
void MR3_get_forces_and_virial_overlap(double force[], double virial[3][3]);
void mr3_get_forces_and_virial_overlap_(double force[], double virial[3][3]);
void MR3calccoulomb_ci_exlist(int n, double x[], double q[], double force[], double rscale, int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], int *convert_index, int flag);
void mr3calccoulomb_ci_exlist_(int *n, double x[], double q[], double force[], double *rscale, int *tblno, int numex[], int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], int *convert_index, int *flag);
void MR3calcvdw_ci(int n, double x[], int atype[], int nat, double force[], double gscales[], double rscales[], int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calcvdw_ci_(int *n, double x[], int atype[], int *nat, double force[], double gscales[], double rscales[], int *tblno, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calcvdw_ci_exlist(int n, double x[], int atype[], int nat, double force[], double gscales[], double rscales[], int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], int *convert_index, int flag);
void mr3calcvdw_ci_exlist_(int *n, double x[], int atype[], int *nat, double force[], double gscales[], double rscales[], int *tblno, int numex[], int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], int *convert_index, int *flag);
void MR3calccoulomb_vdw_ci_exlist(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], double *potc, double *potv, int *convert_index, int potflag, int flag);
void mr3calccoulomb_vdw_ci_exlist_(int *n, double x[], double q[], int atype[], int *nat, double force[], double *rscale, double gscalesf[], double gscalesp[], double rscales[], int *tblno, int *numex, int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], double *potc, double *potv, int *convert_index, int *potflag, int *flag);
void MR3calccoulomb_ci(int n, double x[], double q[], double force[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calccoulomb_ci_(int *n, double x[], double q[], double force[], double *rscale, int *tblno, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_ij_ci(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_ij_ci_old(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calcvdw_ij_ci(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_virial(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut_org, double skinnb, double volume[3], int ldim[3], double virial[3][3], int flag);
void MR3calccoulomb_vdw_ij_ci(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calccoulomb_vdw_ij_ci_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscales[], double rscales[], double *rscale, int *tblnoc, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_old_09(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_old_090121(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_exlist(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3], int numex[], int natex[], int flag);
void mr3calccoulomb_vdw_ij_ci_exlist_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscales[], double rscales[], double *rscale, int *tblnoc, double *rcut, double *skinnb, double volume[3], int ldim[3], int numex[], int natex[], int *flag);
void MR3_get_board_version(int *version, int *freq);
void MR3_rscale_and_pack(int n, double (*x)[3], int *atype, longlong (*rj)[2]);
void MR3_rscale_and_pack_old(int n, double (*x)[3], int *atype, longlong (*rj)[2]);
void MR3SetTable_emu(char *filename, int tblno, int flag);
int MR3_get_total_num_chips(void);
void MR3print_chip_temperature(int flag);
int MR3_get_retry_count(void);
void m3_free_unit(VG_UNIT *unit);
VG_UNIT *m3_allocate_periodic_unit(const char *fname, int mode, double size, int dum);
void m3_set_positions(VG_UNIT *unit, double (*pos)[3], int n);
void m3_set_charges(VG_UNIT *unit, const double *q, int n);
void m3_set_cells(VG_UNIT *unit, M3_CELL *cell, int ncell);
void m3_calculate_forces(VG_UNIT *unit, double (*xi)[3], int ni, double (*force)[3]);
void m3_calculate_potentials(VG_UNIT *unit, double (*xi)[3], int ni, double *eng);
void m3_set_types(VG_UNIT *unit, const int *atype, int n);
void m3_set_pipeline_types(VG_UNIT *unit, const int *atype, int n);
void m3_set_charge_matrix(VG_UNIT *unit, const double *gscale, int nati, int natj);
void m3_set_rscale_matrix(VG_UNIT *unit, const double *rscale, int nati, int natj);
int MR3_close_ch(int s_sock);
int mr3_close_ch_(int *s_sock);
int MR3_open_port(int port_number);
int MR3_sock_read(int sockfd, char *buf, size_t count);
int mr3_sock_read_(int *sockfd, char *buf, int *count);
int mr3_sock_read__(int *sockfd, char *buf, int *count);
int mr3_sock_read_i_(int *sockfd, int *buf);
int mr3_sock_read_i__(int *sockfd, int *buf);
int MR3_sock_read_iv(int sockfd, int *buf, int count);
int mr3_sock_read_iv_(int *sockfd, int *buf, int *count);
int mr3_sock_read_iv__(int *sockfd, int *buf, int *count);
int MR3_sock_read_d(int sockfd, double *buf);
int mr3_sock_read_d__(int *sockfd, double *buf);
int mr3_sock_read_d_(int *sockfd, double *buf);
int MR3_sock_read_dv(int sockfd, double *buf, int count);
int mr3_sock_read_dv__(int *sockfd, double *buf, int *count);
int mr3_sock_read_dv_(int *sockfd, double *buf, int *count);
int MR3_sock_write(int sockfd, char *buf, size_t count);
int MR3_sock_write_c(int sockfd, char *buf);
int mr3_sock_write_c_(int *sockfd, char *buf);
int mr3_sock_write_c__(int *sockfd, char *buf);
int MR3_sock_write_i(int sockfd, int buf);
int mr3_sock_write_i_(int *sockfd, int *buf);
int mr3_sock_write_i__(int *sockfd, int *buf);
int MR3_sock_write_iv(int sockfd, int *buf, int count);
int mr3_sock_write_iv_(int *sockfd, int *buf, int *count);
int mr3_sock_write_iv__(int *sockfd, int *buf, int *count);
int MR3_sock_write_dv(int sockfd, double *buf, int count);
int mr3_sock_write_dv__(int *sockfd, double *buf, int *count);
int mr3_sock_write_dv_(int *sockfd, double *buf, int *count);
int MR3_sock_gets(int sockfd, char *str, size_t count);
int MR3_sock_puts(int sockfd, char *str);
void MR3_sock_init(int *s_sock_org, int port_num, double x[], int igraph[], int natom, int str_len, int lbres[], int ipres[], int nres);
void mr3_sock_init_(int *s_sock, int *port_num, double x[], int igraph[], int *natom, int *str_len, int lbres[], int ipres[], int *nres);
void mr3_sock_init__(int *s_sock, int *port_num, double x[], int igraph[], int *natom, int *str_len, int lbres[], int ipres[], int *nres);
void MR3_sock_1step(int s_sock, double t1, double time, double t2, int recv_buf[], int natom, double x[], double f[], double f_temp[]);
void mr3_sock_1step_(int *s_sock, double *t1, double *time, double *t2, int recv_buf[], int *natom, double x[], double f[], double f_tmp[]);
void mr3_sock_1step__(int *s_sock, double *t1, double *time, double *t2, int recv_buf[], int *natom, double x[], double f[], double f_tmp[]);
void MR3calc_ij_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, char method);
void MR3calc_ij_exlist_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], char method);
void MR3calc_ij_nlist_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], char method);
/* vtgrape.c */
void *MR3_my_malloc2(size_t n, char *s);
void MR3_my_free2(void **p, char *s);
VG_UNIT *m3_get_unit(void);
void vg_exit(int ret);
VG_UNIT *vg_allocate_unit(void (*function)(void *));
void vg_free_unit(VG_UNIT *unit);
void vg_set_function(VG_UNIT *unit, int function_index, void (*function)(void *));
void vg_set_vectors(VG_UNIT *unit, int nj, void *jvectors);
void vg_set_matrices(VG_UNIT *unit, int nati, int natj, void *matrices);
void vg_set_scalers(VG_UNIT *unit, void *scalers);
void vg_set_pipeline_vectors(VG_UNIT *unit, int ni, void *ivectors);
void vg_calculate(VG_UNIT *unit, int function_index, int nf, void *fvectors, void *pscalers);
void vg_set_vectors_pos_charge_atype(VG_UNIT *unit, int nj, double pos[][3], double charge[], int atype[]);
void vg_set_vectors_pos_charge(VG_UNIT *unit, int nj, double pos[][3], double charge[]);
void vg_set_vectors_pos_atype(VG_UNIT *unit, int nj, double pos[][3], int atype[]);
void vg_set_matrices_gscales_rscales(VG_UNIT *unit, int nati_org, int natj_org, double gscales[], double rscales[]);
void vg_set_pol_sigm_ipotro_pc_pd_zz(VG_UNIT *unit, int nati, int natj, double pol[], double sigm[], double ipotro[], double pc[], double pd[], double zz[]);
void vg_set_scalers_volume_alpha(VG_UNIT *unit, double volume[3], double alpha);
void vg_set_pipeline_vectors_pos_charge_atype(VG_UNIT *unit, int ni, double pos[][3], double charge[], int atype[]);
void vg_set_pipeline_vectors_pos_charge(VG_UNIT *unit, int ni, double pos[][3], double charge[]);
void vg_set_pipeline_vectors_pos_atype(VG_UNIT *unit, int ni, double pos[][3], int atype[]);
void vg_convert_forces(VG_UNIT *unit, int nf, int function_index, double fi[][3]);
void vg_calculate_forces_potentials(VG_UNIT *unit, int function_index, int nf, double fi[][3], double *potc, double *potv);
void vg_get_r1result(int n_org, float r[], float r1[]);
void vg_get_rsqrtresult(int n_org, float r[], float r1[]);
void vg_get_mulresult(int n_org, float r[], float q[], float rq[]);
int vg_write_emufile(int flag);
void vg_initialize_emu(void);
float vg_r1emu(float x);
float vg_rsqrtemu(float x);
void vg_set_scaleq(int n, double q[], double *scaleq, float *scaleq_1);
void m3_set_softening(VG_UNIT *unit, double eps);
void MR3_exit(int ret);
void MR3init(void);
void mr3init_(void);
void mr3init__(void);
void MR3free(void);
void mr3free_(void);
void mr3free__(void);
void MR3calccoulomb(double x[], int n, double q[], double rscale, int tblno, double xmax, int periodicflag, int natchangeflag, double force[]);
void mr3calccoulomb_(double x[], int *n, double q[], double *rscale, int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void mr3calccoulomb__(double x[], int *n, double q[], double *rscale, int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void MR3calccoulomb_ij(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag);
void mr3calccoulomb_ij_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void mr3calccoulomb_ij__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void MR3_sort_with_index_int(int data[], int index[], int left, int right);
void MR3calcvdw_ij_core(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void MR3calcvdw_ij(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void mr3calcvdw_ij_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void mr3calcvdw_ij__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void MR3calcvdw(double x[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int natchangeflag, double force[]);
void mr3calcvdw_(double x[], int *n, int atype[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void mr3calcvdw__(double x[], int *n, int atype[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void MR3calcewald(int *k, int knum_org, double *x, int n, double *chg, double alpha, double epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald__(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void MR3calcnacl(double x[], int n, int atype[], int nat, double pol[], double sigm[], double ipotro[], double pc[], double pd[], double zz[], int tblno, double xmax, int periodicflag, double force[]);
void vtgrape_force(double xj[][3], double mj[], double xi[][3], double eps2, double a[][3], int ni, int nj);
void vg_set_rcut2(VG_UNIT *unit, double rcut2);
void mr3_set_rcut2_(double *rcut2);
int md5sum(unsigned char *buffer, int totallen, unsigned char sum[16]);
int md5sum_file(char *filename, unsigned char sum[16]);
void MR3calccoulomb_ij_host(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag);
void mr3calccoulomb_ij_host_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void mr3calccoulomb_ij_host__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void MR3calcvdw_ij_host(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void mr3calcvdw_ij_host_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void mr3calcvdw_ij_host__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void MR3calccoulomb_nlist_ij_host_notwork(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[], double factorall);
void MR3calccoulomb_nlist_ij_host(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calccoulomb_nlist_host(double xd[], int n, double qd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calcvdw_nlist_ij_host_notwork(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[], double factor);
void MR3calcvdw_nlist_ij_host(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_host2(double x[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[], double factor, double force[]);
void MR3calccoulomb_ij_exlist_host(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void MR3calcvdw_ij_exlist_host(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void MR3calcewald_dft_host(int k[], int knum, double x[], int n, double chg[], double cellsize[3], double bs[], double bc[]);
void MR3calcewald_idft_eng_host(int k[], double bs[], double bc[], int knum, double x[], int n, double cellsize[3], double force[]);
void MR3calcewald_idft_force_host(int k[], double bs[], double bc[], int knum, double x[], int n, double cellsize[3], double force[]);
void MR3calcewald_host(int *k, int knum_org, double *x, int n, double *chg, double alpha, double epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_host__(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_host_(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void MR3SetTable(char *filename, int tblno, int flag);
void mr3settable_nf_(char *fname, int *tblno, int *flag, int *n);
void mr3settable_nf__(char *fname, int *tblno, int *flag, int *n);
void MR3_setup_exlist(int n, int *bckptr);
void mr3_setup_exlist_(int *n, int *bckptr);
void MR3_make_natex2_from_natex(int n, int natex[], int numex[], int **natex_offset, int **natex2, int **numex2, int **natex2_offset, int flag);
void calccoulomb_vdw_ij_exlist_host_sub(int i, int j, double xi[], double xj[], double qj, double gsf, double gsp, double rs, double rscale, double cutoff, double *fc, double *fv, double *pc, double *pv, int tblno, double size[3], int potflag);
void MR3calccoulomb_vdw_ij_exlist_cutoff_host(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double cutoff, double size[3], double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_host(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_host2(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_host_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_host__(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void MR3_get_cputime(double *laptime, double *sprittime);
void MR3_set_ldim(int ldim[3]);
void mr3_set_ldim_(int ldim[3]);
void mr3_set_ldim__(int ldim[3]);
void MR3_set_coulomb_vdw_factor(double cgf);
void mr3_set_coulomb_vdw_factor_(double *cgf);
void mr3_set_coulomb_vdw_factor__(double *cgf);
void MR3calccoulomb_ij_emu(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag);
void MR3calccoulomb_nlist_ij_emu(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calccoulomb_nlist_emu(double xd[], int n, double qd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calcvdw_ij_emu(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void MR3calccoulomb_vdw_nlist_ij_emu(int ni, double xid[], double qid[], int atypei[], double force[], int nj, double xjd[], double qjd[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblno, double volume[], int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_ij_emu(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_emu2(double xd[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calccoulomb_ij_exlist(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void mr3calccoulomb_ij_exlist_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag, int numexorg[], int natexorg[]);
void mr3calccoulomb_ij_exlist__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag, int numexorg[], int natexorg[]);
void MR3calcvdw_ij_exlist(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void mr3calcvdw_ij_exlist_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int numex[], int natex[]);
void mr3calcvdw_ij_exlist__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_core_old(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_core(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_virial_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_exlist(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double volume1, double *potc, double *potv, int *convert_index, int potflag, int flag);
void MR3calccoulomb_vdw_exlist_from_cell(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double volume1, double *potc, double *potv, int *convert_index, int potflag, int flag);
void mr3calccoulomb_vdw_exlist_(int *n, double x[], double q[], int atype[], int *nat, double force[], double *rscale, double gscalesf[], double gscalesp[], double rscales[], int *tblno, int numex[], int natex[], double *volume1, double *potc, double *potv, int *convert_index, int *potflag, int *flag);
void MR3_get_forces_overlap(double force[]);
void mr3_get_forces_overlap_(double force[]);
void MR3_get_potc_and_potv_overlap(double *potc, double *potv);
void mr3_get_potc_and_potv_overlap_(double *potc, double *potv);
void mr3_get_potc_and_potv_overlap__(double *potc, double *potv);
void MR3_get_forces_and_virial_overlap(double force[], double virial[3][3]);
void mr3_get_forces_and_virial_overlap_(double force[], double virial[3][3]);
void MR3calccoulomb_ci_exlist(int n, double x[], double q[], double force[], double rscale, int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], int *convert_index, int flag);
void mr3calccoulomb_ci_exlist_(int *n, double x[], double q[], double force[], double *rscale, int *tblno, int numex[], int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], int *convert_index, int *flag);
void MR3calcvdw_ci(int n, double x[], int atype[], int nat, double force[], double gscales[], double rscales[], int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calcvdw_ci_(int *n, double x[], int atype[], int *nat, double force[], double gscales[], double rscales[], int *tblno, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calcvdw_ci_exlist(int n, double x[], int atype[], int nat, double force[], double gscales[], double rscales[], int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], int *convert_index, int flag);
void mr3calcvdw_ci_exlist_(int *n, double x[], int atype[], int *nat, double force[], double gscales[], double rscales[], int *tblno, int numex[], int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], int *convert_index, int *flag);
void MR3calccoulomb_vdw_ci_exlist(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], double *potc, double *potv, int *convert_index, int potflag, int flag);
void mr3calccoulomb_vdw_ci_exlist_(int *n, double x[], double q[], int atype[], int *nat, double force[], double *rscale, double gscalesf[], double gscalesp[], double rscales[], int *tblno, int *numex, int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], double *potc, double *potv, int *convert_index, int *potflag, int *flag);
void MR3calccoulomb_ci(int n, double x[], double q[], double force[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calccoulomb_ci_(int *n, double x[], double q[], double force[], double *rscale, int *tblno, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_ij_ci(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_ij_ci_old(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calcvdw_ij_ci(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_virial(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut_org, double skinnb, double volume[3], int ldim[3], double virial[3][3], int flag);
void MR3calccoulomb_vdw_ij_ci(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calccoulomb_vdw_ij_ci_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscales[], double rscales[], double *rscale, int *tblnoc, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_old_09(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_old_090121(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_exlist(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3], int numex[], int natex[], int flag);
void mr3calccoulomb_vdw_ij_ci_exlist_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscales[], double rscales[], double *rscale, int *tblnoc, double *rcut, double *skinnb, double volume[3], int ldim[3], int numex[], int natex[], int *flag);
void MR3_get_board_version(int *version, int *freq);
void MR3_rscale_and_pack(int n, double (*x)[3], int *atype, longlong (*rj)[2]);
void MR3_rscale_and_pack_old(int n, double (*x)[3], int *atype, longlong (*rj)[2]);
void MR3SetTable_emu(char *filename, int tblno, int flag);
int MR3_get_total_num_chips(void);
void MR3print_chip_temperature(int flag);
int MR3_get_retry_count(void);
void m3_free_unit(VG_UNIT *unit);
VG_UNIT *m3_allocate_periodic_unit(const char *fname, int mode, double size, int dum);
void m3_set_positions(VG_UNIT *unit, double (*pos)[3], int n);
void m3_set_charges(VG_UNIT *unit, const double *q, int n);
void m3_set_cells(VG_UNIT *unit, M3_CELL *cell, int ncell);
void m3_calculate_forces(VG_UNIT *unit, double (*xi)[3], int ni, double (*force)[3]);
void m3_calculate_potentials(VG_UNIT *unit, double (*xi)[3], int ni, double *eng);
void m3_set_types(VG_UNIT *unit, const int *atype, int n);
void m3_set_pipeline_types(VG_UNIT *unit, const int *atype, int n);
void m3_set_charge_matrix(VG_UNIT *unit, const double *gscale, int nati, int natj);
void m3_set_rscale_matrix(VG_UNIT *unit, const double *rscale, int nati, int natj);
int MR3_close_ch(int s_sock);
int mr3_close_ch_(int *s_sock);
int MR3_open_port(int port_number);
int MR3_sock_read(int sockfd, char *buf, size_t count);
int mr3_sock_read_(int *sockfd, char *buf, int *count);
int mr3_sock_read__(int *sockfd, char *buf, int *count);
int mr3_sock_read_i_(int *sockfd, int *buf);
int mr3_sock_read_i__(int *sockfd, int *buf);
int MR3_sock_read_iv(int sockfd, int *buf, int count);
int mr3_sock_read_iv_(int *sockfd, int *buf, int *count);
int mr3_sock_read_iv__(int *sockfd, int *buf, int *count);
int MR3_sock_read_d(int sockfd, double *buf);
int mr3_sock_read_d__(int *sockfd, double *buf);
int mr3_sock_read_d_(int *sockfd, double *buf);
int MR3_sock_read_dv(int sockfd, double *buf, int count);
int mr3_sock_read_dv__(int *sockfd, double *buf, int *count);
int mr3_sock_read_dv_(int *sockfd, double *buf, int *count);
int MR3_sock_write(int sockfd, char *buf, size_t count);
int MR3_sock_write_c(int sockfd, char *buf);
int mr3_sock_write_c_(int *sockfd, char *buf);
int mr3_sock_write_c__(int *sockfd, char *buf);
int MR3_sock_write_i(int sockfd, int buf);
int mr3_sock_write_i_(int *sockfd, int *buf);
int mr3_sock_write_i__(int *sockfd, int *buf);
int MR3_sock_write_iv(int sockfd, int *buf, int count);
int mr3_sock_write_iv_(int *sockfd, int *buf, int *count);
int mr3_sock_write_iv__(int *sockfd, int *buf, int *count);
int MR3_sock_write_dv(int sockfd, double *buf, int count);
int mr3_sock_write_dv__(int *sockfd, double *buf, int *count);
int mr3_sock_write_dv_(int *sockfd, double *buf, int *count);
int MR3_sock_gets(int sockfd, char *str, size_t count);
int MR3_sock_puts(int sockfd, char *str);
void MR3_sock_init(int *s_sock_org, int port_num, double x[], int igraph[], int natom, int str_len, int lbres[], int ipres[], int nres);
void mr3_sock_init_(int *s_sock, int *port_num, double x[], int igraph[], int *natom, int *str_len, int lbres[], int ipres[], int *nres);
void mr3_sock_init__(int *s_sock, int *port_num, double x[], int igraph[], int *natom, int *str_len, int lbres[], int ipres[], int *nres);
void MR3_sock_1step(int s_sock, double t1, double time, double t2, int recv_buf[], int natom, double x[], double f[], double f_temp[]);
void mr3_sock_1step_(int *s_sock, double *t1, double *time, double *t2, int recv_buf[], int *natom, double x[], double f[], double f_tmp[]);
void mr3_sock_1step__(int *s_sock, double *t1, double *time, double *t2, int recv_buf[], int *natom, double x[], double f[], double f_tmp[]);
void MR3calc_ij_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, char method);
void MR3calc_ij_exlist_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], char method);
void MR3calc_ij_nlist_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], char method);
/* vtgrape.c */
void *MR3_my_malloc2(size_t n, char *s);
void MR3_my_free2(void **p, char *s);
VG_UNIT *m3_get_unit(void);
void vg_exit(int ret);
VG_UNIT *vg_allocate_unit(void (*function)(void *));
void vg_free_unit(VG_UNIT *unit);
void vg_set_function(VG_UNIT *unit, int function_index, void (*function)(void *));
void vg_set_vectors(VG_UNIT *unit, int nj, void *jvectors);
void vg_set_matrices(VG_UNIT *unit, int nati, int natj, void *matrices);
void vg_set_scalers(VG_UNIT *unit, void *scalers);
void vg_set_pipeline_vectors(VG_UNIT *unit, int ni, void *ivectors);
void vg_calculate(VG_UNIT *unit, int function_index, int nf, void *fvectors, void *pscalers);
void vg_set_vectors_pos_charge_atype(VG_UNIT *unit, int nj, double pos[][3], double charge[], int atype[]);
void vg_set_vectors_pos_charge(VG_UNIT *unit, int nj, double pos[][3], double charge[]);
void vg_set_vectors_pos_atype(VG_UNIT *unit, int nj, double pos[][3], int atype[]);
void vg_set_matrices_gscales_rscales(VG_UNIT *unit, int nati_org, int natj_org, double gscales[], double rscales[]);
void vg_set_pol_sigm_ipotro_pc_pd_zz(VG_UNIT *unit, int nati, int natj, double pol[], double sigm[], double ipotro[], double pc[], double pd[], double zz[]);
void vg_set_scalers_volume_alpha(VG_UNIT *unit, double volume[3], double alpha);
void vg_set_pipeline_vectors_pos_charge_atype(VG_UNIT *unit, int ni, double pos[][3], double charge[], int atype[]);
void vg_set_pipeline_vectors_pos_charge(VG_UNIT *unit, int ni, double pos[][3], double charge[]);
void vg_set_pipeline_vectors_pos_atype(VG_UNIT *unit, int ni, double pos[][3], int atype[]);
void vg_convert_forces(VG_UNIT *unit, int nf, int function_index, double fi[][3]);
void vg_calculate_forces_potentials(VG_UNIT *unit, int function_index, int nf, double fi[][3], double *potc, double *potv);
void vg_get_r1result(int n_org, float r[], float r1[]);
void vg_get_rsqrtresult(int n_org, float r[], float r1[]);
void vg_get_mulresult(int n_org, float r[], float q[], float rq[]);
int vg_write_emufile(int flag);
void vg_initialize_emu(void);
float vg_r1emu(float x);
float vg_rsqrtemu(float x);
void vg_set_scaleq(int n, double q[], double *scaleq, float *scaleq_1);
void m3_set_softening(VG_UNIT *unit, double eps);
void MR3_exit(int ret);
void MR3init(void);
void mr3init_(void);
void mr3init__(void);
void MR3free(void);
void mr3free_(void);
void mr3free__(void);
void MR3calccoulomb(double x[], int n, double q[], double rscale, int tblno, double xmax, int periodicflag, int natchangeflag, double force[]);
void mr3calccoulomb_(double x[], int *n, double q[], double *rscale, int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void mr3calccoulomb__(double x[], int *n, double q[], double *rscale, int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void MR3calccoulomb_ij(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag);
void mr3calccoulomb_ij_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void mr3calccoulomb_ij__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void MR3_sort_with_index_int(int data[], int index[], int left, int right);
void MR3calcvdw_ij_core(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void MR3calcvdw_ij(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void mr3calcvdw_ij_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void mr3calcvdw_ij__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void MR3calcvdw(double x[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int natchangeflag, double force[]);
void mr3calcvdw_(double x[], int *n, int atype[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void mr3calcvdw__(double x[], int *n, int atype[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void MR3calcewald(int *k, int knum_org, double *x, int n, double *chg, double alpha, double epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald__(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void MR3calcnacl(double x[], int n, int atype[], int nat, double pol[], double sigm[], double ipotro[], double pc[], double pd[], double zz[], int tblno, double xmax, int periodicflag, double force[]);
void vtgrape_force(double xj[][3], double mj[], double xi[][3], double eps2, double a[][3], int ni, int nj);
void vg_set_rcut2(VG_UNIT *unit, double rcut2);
void mr3_set_rcut2_(double *rcut2);
int md5sum(unsigned char *buffer, int totallen, unsigned char sum[16]);
int md5sum_file(char *filename, unsigned char sum[16]);
void MR3calccoulomb_ij_host(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag);
void mr3calccoulomb_ij_host_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void mr3calccoulomb_ij_host__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void MR3calcvdw_ij_host(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void mr3calcvdw_ij_host_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void mr3calcvdw_ij_host__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void MR3calccoulomb_nlist_ij_host_notwork(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[], double factorall);
void MR3calccoulomb_nlist_ij_host(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calccoulomb_nlist_host(double xd[], int n, double qd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calcvdw_nlist_ij_host_notwork(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[], double factor);
void MR3calcvdw_nlist_ij_host(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_host2(double x[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[], double factor, double force[]);
void MR3calccoulomb_ij_exlist_host(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void MR3calcvdw_ij_exlist_host(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void MR3calcewald_dft_host(int k[], int knum, double x[], int n, double chg[], double cellsize[3], double bs[], double bc[]);
void MR3calcewald_idft_eng_host(int k[], double bs[], double bc[], int knum, double x[], int n, double cellsize[3], double force[]);
void MR3calcewald_idft_force_host(int k[], double bs[], double bc[], int knum, double x[], int n, double cellsize[3], double force[]);
void MR3calcewald_host(int *k, int knum_org, double *x, int n, double *chg, double alpha, double epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_host__(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_host_(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void MR3SetTable(char *filename, int tblno, int flag);
void mr3settable_nf_(char *fname, int *tblno, int *flag, int *n);
void mr3settable_nf__(char *fname, int *tblno, int *flag, int *n);
void MR3_setup_exlist(int n, int *bckptr);
void mr3_setup_exlist_(int *n, int *bckptr);
void MR3_make_natex2_from_natex(int n, int natex[], int numex[], int **natex_offset, int **natex2, int **numex2, int **natex2_offset, int flag);
void calccoulomb_vdw_ij_exlist_host_sub(int i, int j, double xi[], double xj[], double qj, double gsf, double gsp, double rs, double rscale, double cutoff, double *fc, double *fv, double *pc, double *pv, int tblno, double size[3], int potflag);
void MR3calccoulomb_vdw_ij_exlist_cutoff_host(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double cutoff, double size[3], double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_host(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_host2(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_host_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_host__(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void MR3_get_cputime(double *laptime, double *sprittime);
void MR3_set_ldim(int ldim[3]);
void mr3_set_ldim_(int ldim[3]);
void mr3_set_ldim__(int ldim[3]);
void MR3_set_coulomb_vdw_factor(double cgf);
void mr3_set_coulomb_vdw_factor_(double *cgf);
void mr3_set_coulomb_vdw_factor__(double *cgf);
void MR3calccoulomb_ij_emu(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag);
void MR3calccoulomb_nlist_ij_emu(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calccoulomb_nlist_emu(double xd[], int n, double qd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calcvdw_ij_emu(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void MR3calccoulomb_vdw_nlist_ij_emu(int ni, double xid[], double qid[], int atypei[], double force[], int nj, double xjd[], double qjd[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblno, double volume[], int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_ij_emu(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_emu2(double xd[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calccoulomb_ij_exlist(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void mr3calccoulomb_ij_exlist_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag, int numexorg[], int natexorg[]);
void mr3calccoulomb_ij_exlist__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag, int numexorg[], int natexorg[]);
void MR3calcvdw_ij_exlist(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void mr3calcvdw_ij_exlist_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int numex[], int natex[]);
void mr3calcvdw_ij_exlist__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_core_old(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_core(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_virial_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_exlist(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double volume1, double *potc, double *potv, int *convert_index, int potflag, int flag);
void MR3calccoulomb_vdw_exlist_from_cell(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double volume1, double *potc, double *potv, int *convert_index, int potflag, int flag);
void mr3calccoulomb_vdw_exlist_(int *n, double x[], double q[], int atype[], int *nat, double force[], double *rscale, double gscalesf[], double gscalesp[], double rscales[], int *tblno, int numex[], int natex[], double *volume1, double *potc, double *potv, int *convert_index, int *potflag, int *flag);
void MR3_get_forces_overlap(double force[]);
void mr3_get_forces_overlap_(double force[]);
void MR3_get_potc_and_potv_overlap(double *potc, double *potv);
void mr3_get_potc_and_potv_overlap_(double *potc, double *potv);
void mr3_get_potc_and_potv_overlap__(double *potc, double *potv);
void MR3_get_forces_and_virial_overlap(double force[], double virial[3][3]);
void mr3_get_forces_and_virial_overlap_(double force[], double virial[3][3]);
void MR3calccoulomb_ci_exlist(int n, double x[], double q[], double force[], double rscale, int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], int *convert_index, int flag);
void mr3calccoulomb_ci_exlist_(int *n, double x[], double q[], double force[], double *rscale, int *tblno, int numex[], int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], int *convert_index, int *flag);
void MR3calcvdw_ci(int n, double x[], int atype[], int nat, double force[], double gscales[], double rscales[], int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calcvdw_ci_(int *n, double x[], int atype[], int *nat, double force[], double gscales[], double rscales[], int *tblno, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calcvdw_ci_exlist(int n, double x[], int atype[], int nat, double force[], double gscales[], double rscales[], int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], int *convert_index, int flag);
void mr3calcvdw_ci_exlist_(int *n, double x[], int atype[], int *nat, double force[], double gscales[], double rscales[], int *tblno, int numex[], int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], int *convert_index, int *flag);
void MR3calccoulomb_vdw_ci_exlist(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], double *potc, double *potv, int *convert_index, int potflag, int flag);
void mr3calccoulomb_vdw_ci_exlist_(int *n, double x[], double q[], int atype[], int *nat, double force[], double *rscale, double gscalesf[], double gscalesp[], double rscales[], int *tblno, int *numex, int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], double *potc, double *potv, int *convert_index, int *potflag, int *flag);
void MR3calccoulomb_ci(int n, double x[], double q[], double force[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calccoulomb_ci_(int *n, double x[], double q[], double force[], double *rscale, int *tblno, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_ij_ci(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_ij_ci_old(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calcvdw_ij_ci(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_virial(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut_org, double skinnb, double volume[3], int ldim[3], double virial[3][3], int flag);
void MR3calccoulomb_vdw_ij_ci(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calccoulomb_vdw_ij_ci_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscales[], double rscales[], double *rscale, int *tblnoc, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_old_09(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_old_090121(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_exlist(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3], int numex[], int natex[], int flag);
void mr3calccoulomb_vdw_ij_ci_exlist_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscales[], double rscales[], double *rscale, int *tblnoc, double *rcut, double *skinnb, double volume[3], int ldim[3], int numex[], int natex[], int *flag);
void MR3_get_board_version(int *version, int *freq);
void MR3_rscale_and_pack(int n, double (*x)[3], int *atype, longlong (*rj)[2]);
void MR3_rscale_and_pack_old(int n, double (*x)[3], int *atype, longlong (*rj)[2]);
void MR3SetTable_emu(char *filename, int tblno, int flag);
int MR3_get_total_num_chips(void);
void MR3print_chip_temperature(int flag);
int MR3_get_retry_count(void);
void m3_free_unit(VG_UNIT *unit);
VG_UNIT *m3_allocate_periodic_unit(const char *fname, int mode, double size, int dum);
void m3_set_positions(VG_UNIT *unit, double (*pos)[3], int n);
void m3_set_charges(VG_UNIT *unit, const double *q, int n);
void m3_set_cells(VG_UNIT *unit, M3_CELL *cell, int ncell);
void m3_calculate_forces(VG_UNIT *unit, double (*xi)[3], int ni, double (*force)[3]);
void m3_calculate_potentials(VG_UNIT *unit, double (*xi)[3], int ni, double *eng);
void m3_set_types(VG_UNIT *unit, const int *atype, int n);
void m3_set_pipeline_types(VG_UNIT *unit, const int *atype, int n);
void m3_set_charge_matrix(VG_UNIT *unit, const double *gscale, int nati, int natj);
void m3_set_rscale_matrix(VG_UNIT *unit, const double *rscale, int nati, int natj);
int MR3_close_ch(int s_sock);
int mr3_close_ch_(int *s_sock);
int MR3_open_port(int port_number);
int MR3_sock_read(int sockfd, char *buf, size_t count);
int mr3_sock_read_(int *sockfd, char *buf, int *count);
int mr3_sock_read__(int *sockfd, char *buf, int *count);
int mr3_sock_read_i_(int *sockfd, int *buf);
int mr3_sock_read_i__(int *sockfd, int *buf);
int MR3_sock_read_iv(int sockfd, int *buf, int count);
int mr3_sock_read_iv_(int *sockfd, int *buf, int *count);
int mr3_sock_read_iv__(int *sockfd, int *buf, int *count);
int MR3_sock_read_d(int sockfd, double *buf);
int mr3_sock_read_d__(int *sockfd, double *buf);
int mr3_sock_read_d_(int *sockfd, double *buf);
int MR3_sock_read_dv(int sockfd, double *buf, int count);
int mr3_sock_read_dv__(int *sockfd, double *buf, int *count);
int mr3_sock_read_dv_(int *sockfd, double *buf, int *count);
int MR3_sock_write(int sockfd, char *buf, size_t count);
int MR3_sock_write_c(int sockfd, char *buf);
int mr3_sock_write_c_(int *sockfd, char *buf);
int mr3_sock_write_c__(int *sockfd, char *buf);
int MR3_sock_write_i(int sockfd, int buf);
int mr3_sock_write_i_(int *sockfd, int *buf);
int mr3_sock_write_i__(int *sockfd, int *buf);
int MR3_sock_write_iv(int sockfd, int *buf, int count);
int mr3_sock_write_iv_(int *sockfd, int *buf, int *count);
int mr3_sock_write_iv__(int *sockfd, int *buf, int *count);
int MR3_sock_write_dv(int sockfd, double *buf, int count);
int mr3_sock_write_dv__(int *sockfd, double *buf, int *count);
int mr3_sock_write_dv_(int *sockfd, double *buf, int *count);
int MR3_sock_gets(int sockfd, char *str, size_t count);
int MR3_sock_puts(int sockfd, char *str);
void MR3_sock_init(int *s_sock_org, int port_num, double x[], int igraph[], int natom, int str_len, int lbres[], int ipres[], int nres);
void mr3_sock_init_(int *s_sock, int *port_num, double x[], int igraph[], int *natom, int *str_len, int lbres[], int ipres[], int *nres);
void mr3_sock_init__(int *s_sock, int *port_num, double x[], int igraph[], int *natom, int *str_len, int lbres[], int ipres[], int *nres);
void MR3_sock_1step(int s_sock, double t1, double time, double t2, int recv_buf[], int natom, double x[], double f[], double f_temp[]);
void mr3_sock_1step_(int *s_sock, double *t1, double *time, double *t2, int recv_buf[], int *natom, double x[], double f[], double f_tmp[]);
void mr3_sock_1step__(int *s_sock, double *t1, double *time, double *t2, int recv_buf[], int *natom, double x[], double f[], double f_tmp[]);
void MR3calc_ij_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, char method);
void MR3calc_ij_exlist_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], char method);
void MR3calc_ij_nlist_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], char method);
/* vtgrape.c */
void *MR3_my_malloc2(size_t n, char *s);
void MR3_my_free2(void **p, char *s);
VG_UNIT *m3_get_unit(void);
void vg_exit(int ret);
VG_UNIT *vg_allocate_unit(void (*function)(void *));
void vg_free_unit(VG_UNIT *unit);
void vg_set_function(VG_UNIT *unit, int function_index, void (*function)(void *));
void vg_set_vectors(VG_UNIT *unit, int nj, void *jvectors);
void vg_set_matrices(VG_UNIT *unit, int nati, int natj, void *matrices);
void vg_set_scalers(VG_UNIT *unit, void *scalers);
void vg_set_pipeline_vectors(VG_UNIT *unit, int ni, void *ivectors);
void vg_calculate(VG_UNIT *unit, int function_index, int nf, void *fvectors, void *pscalers);
void vg_set_vectors_pos_charge_atype(VG_UNIT *unit, int nj, double pos[][3], double charge[], int atype[]);
void vg_set_vectors_pos_charge(VG_UNIT *unit, int nj, double pos[][3], double charge[]);
void vg_set_vectors_pos_atype(VG_UNIT *unit, int nj, double pos[][3], int atype[]);
void vg_set_matrices_gscales_rscales(VG_UNIT *unit, int nati_org, int natj_org, double gscales[], double rscales[]);
/* vtgrape.c */
void *MR3_my_malloc2(size_t n, char *s);
void MR3_my_free2(void **p, char *s);
VG_UNIT *m3_get_unit(void);
void vg_exit(int ret);
VG_UNIT *vg_allocate_unit(void (*function)(void *));
void vg_free_unit(VG_UNIT *unit);
void vg_set_function(VG_UNIT *unit, int function_index, void (*function)(void *));
void vg_set_vectors(VG_UNIT *unit, int nj, void *jvectors);
void vg_set_matrices(VG_UNIT *unit, int nati, int natj, void *matrices);
void vg_set_scalers(VG_UNIT *unit, void *scalers);
void vg_set_pipeline_vectors(VG_UNIT *unit, int ni, void *ivectors);
void vg_calculate(VG_UNIT *unit, int function_index, int nf, void *fvectors, void *pscalers);
void vg_set_vectors_pos_charge_atype(VG_UNIT *unit, int nj, double pos[][3], double charge[], int atype[]);
void vg_set_vectors_pos_charge(VG_UNIT *unit, int nj, double pos[][3], double charge[]);
void vg_set_vectors_pos_atype(VG_UNIT *unit, int nj, double pos[][3], int atype[]);
void vg_set_matrices_gscales_rscales(VG_UNIT *unit, int nati_org, int natj_org, double gscales[], double rscales[]);
void vg_set_pol_sigm_ipotro_pc_pd_zz(VG_UNIT *unit, int nati, int natj, double pol[], double sigm[], double ipotro[], double pc[], double pd[], double zz[]);
void vg_set_scalers_volume_alpha(VG_UNIT *unit, double volume[3], double alpha);
void vg_set_pipeline_vectors_pos_charge_atype(VG_UNIT *unit, int ni, double pos[][3], double charge[], int atype[]);
void vg_set_pipeline_vectors_pos_charge(VG_UNIT *unit, int ni, double pos[][3], double charge[]);
void vg_set_pipeline_vectors_pos_atype(VG_UNIT *unit, int ni, double pos[][3], int atype[]);
void vg_convert_forces(VG_UNIT *unit, int nf, int function_index, double fi[][3]);
void vg_calculate_forces_potentials(VG_UNIT *unit, int function_index, int nf, double fi[][3], double *potc, double *potv);
void vg_get_r1result(int n_org, float r[], float r1[]);
void vg_get_rsqrtresult(int n_org, float r[], float r1[]);
void vg_get_mulresult(int n_org, float r[], float q[], float rq[]);
int vg_write_emufile(int flag);
void vg_initialize_emu(void);
float vg_r1emu(float x);
float vg_rsqrtemu(float x);
void vg_set_scaleq(int n, double q[], double *scaleq, float *scaleq_1);
void m3_set_softening(VG_UNIT *unit, double eps);
void MR3_exit(int ret);
void MR3init(void);
void mr3init_(void);
void mr3init__(void);
void MR3free(void);
void mr3free_(void);
void mr3free__(void);
void MR3calccoulomb(double x[], int n, double q[], double rscale, int tblno, double xmax, int periodicflag, int natchangeflag, double force[]);
void mr3calccoulomb_(double x[], int *n, double q[], double *rscale, int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void mr3calccoulomb__(double x[], int *n, double q[], double *rscale, int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void MR3calccoulomb_ij(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag);
void mr3calccoulomb_ij_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void mr3calccoulomb_ij__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void MR3_sort_with_index_int(int data[], int index[], int left, int right);
void MR3calcvdw_ij_core(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void MR3calcvdw_ij(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void mr3calcvdw_ij_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void mr3calcvdw_ij__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void MR3calcvdw(double x[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int natchangeflag, double force[]);
void mr3calcvdw_(double x[], int *n, int atype[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void mr3calcvdw__(double x[], int *n, int atype[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void MR3calcewald(int *k, int knum_org, double *x, int n, double *chg, double alpha, double epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald__(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void MR3calcnacl(double x[], int n, int atype[], int nat, double pol[], double sigm[], double ipotro[], double pc[], double pd[], double zz[], int tblno, double xmax, int periodicflag, double force[]);
void vtgrape_force(double xj[][3], double mj[], double xi[][3], double eps2, double a[][3], int ni, int nj);
void vg_set_rcut2(VG_UNIT *unit, double rcut2);
void mr3_set_rcut2_(double *rcut2);
int md5sum(unsigned char *buffer, int totallen, unsigned char sum[16]);
int md5sum_file(char *filename, unsigned char sum[16]);
void MR3calccoulomb_ij_host(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag);
void mr3calccoulomb_ij_host_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void mr3calccoulomb_ij_host__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void MR3calcvdw_ij_host(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void mr3calcvdw_ij_host_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void mr3calcvdw_ij_host__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void MR3calccoulomb_nlist_ij_host_notwork(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[], double factorall);
void MR3calccoulomb_nlist_ij_host(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calccoulomb_nlist_host(double xd[], int n, double qd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calcvdw_nlist_ij_host_notwork(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[], double factor);
void MR3calcvdw_nlist_ij_host(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_host2(double x[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[], double factor, double force[]);
void MR3calccoulomb_ij_exlist_host(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void MR3calcvdw_ij_exlist_host(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void MR3calcewald_dft_host(int k[], int knum, double x[], int n, double chg[], double cellsize[3], double bs[], double bc[]);
void MR3calcewald_idft_eng_host(int k[], double bs[], double bc[], int knum, double x[], int n, double cellsize[3], double force[]);
void MR3calcewald_idft_force_host(int k[], double bs[], double bc[], int knum, double x[], int n, double cellsize[3], double force[]);
void MR3calcewald_host(int *k, int knum_org, double *x, int n, double *chg, double alpha, double epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_host__(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_host_(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void MR3SetTable(char *filename, int tblno, int flag);
void mr3settable_nf_(char *fname, int *tblno, int *flag, int *n);
void mr3settable_nf__(char *fname, int *tblno, int *flag, int *n);
void MR3_setup_exlist(int n, int *bckptr);
void mr3_setup_exlist_(int *n, int *bckptr);
void MR3_make_natex2_from_natex(int n, int natex[], int numex[], int **natex_offset, int **natex2, int **numex2, int **natex2_offset, int flag);
void calccoulomb_vdw_ij_exlist_host_sub(int i, int j, double xi[], double xj[], double qj, double gsf, double gsp, double rs, double rscale, double cutoff, double *fc, double *fv, double *pc, double *pv, int tblno, double size[3], int potflag);
void MR3calccoulomb_vdw_ij_exlist_cutoff_host(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double cutoff, double size[3], double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_host(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_host2(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_host_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_host__(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void MR3_get_cputime(double *laptime, double *sprittime);
void MR3_set_ldim(int ldim[3]);
void mr3_set_ldim_(int ldim[3]);
void mr3_set_ldim__(int ldim[3]);
void MR3_set_coulomb_vdw_factor(double cgf);
void mr3_set_coulomb_vdw_factor_(double *cgf);
void mr3_set_coulomb_vdw_factor__(double *cgf);
void MR3calccoulomb_ij_emu(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag);
void MR3calccoulomb_nlist_ij_emu(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calccoulomb_nlist_emu(double xd[], int n, double qd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calcvdw_ij_emu(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void MR3calccoulomb_vdw_nlist_ij_emu(int ni, double xid[], double qid[], int atypei[], double force[], int nj, double xjd[], double qjd[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblno, double volume[], int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_ij_emu(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_emu2(double xd[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calccoulomb_ij_exlist(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void mr3calccoulomb_ij_exlist_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag, int numexorg[], int natexorg[]);
void mr3calccoulomb_ij_exlist__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag, int numexorg[], int natexorg[]);
void MR3calcvdw_ij_exlist(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void mr3calcvdw_ij_exlist_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int numex[], int natex[]);
void mr3calcvdw_ij_exlist__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_core_old(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_core(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_virial_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_exlist(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double volume1, double *potc, double *potv, int *convert_index, int potflag, int flag);
void MR3calccoulomb_vdw_exlist_from_cell(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double volume1, double *potc, double *potv, int *convert_index, int potflag, int flag);
void mr3calccoulomb_vdw_exlist_(int *n, double x[], double q[], int atype[], int *nat, double force[], double *rscale, double gscalesf[], double gscalesp[], double rscales[], int *tblno, int numex[], int natex[], double *volume1, double *potc, double *potv, int *convert_index, int *potflag, int *flag);
void MR3_get_forces_overlap(double force[]);
void mr3_get_forces_overlap_(double force[]);
void MR3_get_potc_and_potv_overlap(double *potc, double *potv);
void mr3_get_potc_and_potv_overlap_(double *potc, double *potv);
void mr3_get_potc_and_potv_overlap__(double *potc, double *potv);
void MR3_get_forces_and_virial_overlap(double force[], double virial[3][3]);
void mr3_get_forces_and_virial_overlap_(double force[], double virial[3][3]);
void MR3calccoulomb_ci_exlist(int n, double x[], double q[], double force[], double rscale, int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], int *convert_index, int flag);
void mr3calccoulomb_ci_exlist_(int *n, double x[], double q[], double force[], double *rscale, int *tblno, int numex[], int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], int *convert_index, int *flag);
void MR3calcvdw_ci(int n, double x[], int atype[], int nat, double force[], double gscales[], double rscales[], int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calcvdw_ci_(int *n, double x[], int atype[], int *nat, double force[], double gscales[], double rscales[], int *tblno, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calcvdw_ci_exlist(int n, double x[], int atype[], int nat, double force[], double gscales[], double rscales[], int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], int *convert_index, int flag);
void mr3calcvdw_ci_exlist_(int *n, double x[], int atype[], int *nat, double force[], double gscales[], double rscales[], int *tblno, int numex[], int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], int *convert_index, int *flag);
void MR3calccoulomb_vdw_ci_exlist(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], double *potc, double *potv, int *convert_index, int potflag, int flag);
void mr3calccoulomb_vdw_ci_exlist_(int *n, double x[], double q[], int atype[], int *nat, double force[], double *rscale, double gscalesf[], double gscalesp[], double rscales[], int *tblno, int *numex, int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], double *potc, double *potv, int *convert_index, int *potflag, int *flag);
void MR3calccoulomb_ci(int n, double x[], double q[], double force[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calccoulomb_ci_(int *n, double x[], double q[], double force[], double *rscale, int *tblno, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_ij_ci(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_ij_ci_old(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calcvdw_ij_ci(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_virial(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut_org, double skinnb, double volume[3], int ldim[3], double virial[3][3], int flag);
void MR3calccoulomb_vdw_ij_ci(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calccoulomb_vdw_ij_ci_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscales[], double rscales[], double *rscale, int *tblnoc, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_old_09(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_old_090121(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_exlist(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3], int numex[], int natex[], int flag);
void mr3calccoulomb_vdw_ij_ci_exlist_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscales[], double rscales[], double *rscale, int *tblnoc, double *rcut, double *skinnb, double volume[3], int ldim[3], int numex[], int natex[], int *flag);
void MR3_get_board_version(int *version, int *freq);
void MR3_rscale_and_pack(int n, double (*x)[3], int *atype, longlong (*rj)[2]);
void MR3_rscale_and_pack_old(int n, double (*x)[3], int *atype, longlong (*rj)[2]);
void MR3SetTable_emu(char *filename, int tblno, int flag);
int MR3_get_total_num_chips(void);
void MR3print_chip_temperature(int flag);
int MR3_get_retry_count(void);
void m3_free_unit(VG_UNIT *unit);
VG_UNIT *m3_allocate_periodic_unit(const char *fname, int mode, double size, int dum);
void m3_set_positions(VG_UNIT *unit, double (*pos)[3], int n);
void m3_set_charges(VG_UNIT *unit, const double *q, int n);
void m3_set_cells(VG_UNIT *unit, M3_CELL *cell, int ncell);
void m3_calculate_forces(VG_UNIT *unit, double (*xi)[3], int ni, double (*force)[3]);
void m3_calculate_potentials(VG_UNIT *unit, double (*xi)[3], int ni, double *eng);
void m3_set_types(VG_UNIT *unit, const int *atype, int n);
void m3_set_pipeline_types(VG_UNIT *unit, const int *atype, int n);
void m3_set_charge_matrix(VG_UNIT *unit, const double *gscale, int nati, int natj);
void m3_set_rscale_matrix(VG_UNIT *unit, const double *rscale, int nati, int natj);
int MR3_close_ch(int s_sock);
int mr3_close_ch_(int *s_sock);
int MR3_open_port(int port_number);
int MR3_sock_read(int sockfd, char *buf, size_t count);
int mr3_sock_read_(int *sockfd, char *buf, int *count);
int mr3_sock_read__(int *sockfd, char *buf, int *count);
int mr3_sock_read_i_(int *sockfd, int *buf);
int mr3_sock_read_i__(int *sockfd, int *buf);
int MR3_sock_read_iv(int sockfd, int *buf, int count);
int mr3_sock_read_iv_(int *sockfd, int *buf, int *count);
int mr3_sock_read_iv__(int *sockfd, int *buf, int *count);
int MR3_sock_read_d(int sockfd, double *buf);
int mr3_sock_read_d__(int *sockfd, double *buf);
int mr3_sock_read_d_(int *sockfd, double *buf);
int MR3_sock_read_dv(int sockfd, double *buf, int count);
int mr3_sock_read_dv__(int *sockfd, double *buf, int *count);
int mr3_sock_read_dv_(int *sockfd, double *buf, int *count);
int MR3_sock_write(int sockfd, char *buf, size_t count);
int MR3_sock_write_c(int sockfd, char *buf);
int mr3_sock_write_c_(int *sockfd, char *buf);
int mr3_sock_write_c__(int *sockfd, char *buf);
int MR3_sock_write_i(int sockfd, int buf);
int mr3_sock_write_i_(int *sockfd, int *buf);
int mr3_sock_write_i__(int *sockfd, int *buf);
int MR3_sock_write_iv(int sockfd, int *buf, int count);
int mr3_sock_write_iv_(int *sockfd, int *buf, int *count);
int mr3_sock_write_iv__(int *sockfd, int *buf, int *count);
int MR3_sock_write_dv(int sockfd, double *buf, int count);
int mr3_sock_write_dv__(int *sockfd, double *buf, int *count);
int mr3_sock_write_dv_(int *sockfd, double *buf, int *count);
int MR3_sock_gets(int sockfd, char *str, size_t count);
int MR3_sock_puts(int sockfd, char *str);
void MR3_sock_init(int *s_sock_org, int port_num, double x[], int igraph[], int natom, int str_len, int lbres[], int ipres[], int nres);
void mr3_sock_init_(int *s_sock, int *port_num, double x[], int igraph[], int *natom, int *str_len, int lbres[], int ipres[], int *nres);
void mr3_sock_init__(int *s_sock, int *port_num, double x[], int igraph[], int *natom, int *str_len, int lbres[], int ipres[], int *nres);
void MR3_sock_1step(int s_sock, double t1, double time, double t2, int recv_buf[], int natom, double x[], double f[], double f_temp[]);
void mr3_sock_1step_(int *s_sock, double *t1, double *time, double *t2, int recv_buf[], int *natom, double x[], double f[], double f_tmp[]);
void mr3_sock_1step__(int *s_sock, double *t1, double *time, double *t2, int recv_buf[], int *natom, double x[], double f[], double f_tmp[]);
void MR3calc_ij_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, char method);
void MR3calc_ij_exlist_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], char method);
void MR3calc_ij_nlist_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], char method);
/* vtgrape.c */
void *MR3_my_malloc2(size_t n, char *s);
void MR3_my_free2(void **p, char *s);
VG_UNIT *m3_get_unit(void);
void vg_exit(int ret);
VG_UNIT *vg_allocate_unit(void (*function)(void *));
void vg_free_unit(VG_UNIT *unit);
void vg_set_function(VG_UNIT *unit, int function_index, void (*function)(void *));
void vg_set_vectors(VG_UNIT *unit, int nj, void *jvectors);
void vg_set_matrices(VG_UNIT *unit, int nati, int natj, void *matrices);
void vg_set_scalers(VG_UNIT *unit, void *scalers);
void vg_set_pipeline_vectors(VG_UNIT *unit, int ni, void *ivectors);
void vg_calculate(VG_UNIT *unit, int function_index, int nf, void *fvectors, void *pscalers);
void vg_set_vectors_pos_charge_atype(VG_UNIT *unit, int nj, double pos[][3], double charge[], int atype[]);
void vg_set_vectors_pos_charge(VG_UNIT *unit, int nj, double pos[][3], double charge[]);
void vg_set_vectors_pos_atype(VG_UNIT *unit, int nj, double pos[][3], int atype[]);
void vg_set_matrices_gscales_rscales(VG_UNIT *unit, int nati_org, int natj_org, double gscales[], double rscales[]);
void vg_set_pol_sigm_ipotro_pc_pd_zz(VG_UNIT *unit, int nati, int natj, double pol[], double sigm[], double ipotro[], double pc[], double pd[], double zz[]);
void vg_set_scalers_volume_alpha(VG_UNIT *unit, double volume[3], double alpha);
void vg_set_pipeline_vectors_pos_charge_atype(VG_UNIT *unit, int ni, double pos[][3], double charge[], int atype[]);
void vg_set_pipeline_vectors_pos_charge(VG_UNIT *unit, int ni, double pos[][3], double charge[]);
void vg_set_pipeline_vectors_pos_atype(VG_UNIT *unit, int ni, double pos[][3], int atype[]);
void vg_convert_forces(VG_UNIT *unit, int nf, int function_index, double fi[][3]);
void vg_calculate_forces_potentials(VG_UNIT *unit, int function_index, int nf, double fi[][3], double *potc, double *potv);
void vg_get_r1result(int n_org, float r[], float r1[]);
void vg_get_rsqrtresult(int n_org, float r[], float r1[]);
void vg_get_mulresult(int n_org, float r[], float q[], float rq[]);
int vg_write_emufile(int flag);
void vg_initialize_emu(void);
float vg_r1emu(float x);
float vg_rsqrtemu(float x);
void vg_set_scaleq(int n, double q[], double *scaleq, float *scaleq_1);
void m3_set_softening(VG_UNIT *unit, double eps);
void MR3_exit(int ret);
void MR3init(void);
void mr3init_(void);
void mr3init__(void);
void MR3free(void);
void mr3free_(void);
void mr3free__(void);
void MR3calccoulomb(double x[], int n, double q[], double rscale, int tblno, double xmax, int periodicflag, int natchangeflag, double force[]);
void mr3calccoulomb_(double x[], int *n, double q[], double *rscale, int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void mr3calccoulomb__(double x[], int *n, double q[], double *rscale, int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void MR3calccoulomb_ij(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag);
void mr3calccoulomb_ij_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void mr3calccoulomb_ij__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void MR3_sort_with_index_int(int data[], int index[], int left, int right);
void MR3calcvdw_ij_core(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void MR3calcvdw_ij(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void mr3calcvdw_ij_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void mr3calcvdw_ij__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void MR3calcvdw(double x[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int natchangeflag, double force[]);
void mr3calcvdw_(double x[], int *n, int atype[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void mr3calcvdw__(double x[], int *n, int atype[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void MR3calcewald(int *k, int knum_org, double *x, int n, double *chg, double alpha, double epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald__(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void MR3calcnacl(double x[], int n, int atype[], int nat, double pol[], double sigm[], double ipotro[], double pc[], double pd[], double zz[], int tblno, double xmax, int periodicflag, double force[]);
void vtgrape_force(double xj[][3], double mj[], double xi[][3], double eps2, double a[][3], int ni, int nj);
void vg_set_rcut2(VG_UNIT *unit, double rcut2);
void mr3_set_rcut2_(double *rcut2);
int md5sum(unsigned char *buffer, int totallen, unsigned char sum[16]);
int md5sum_file(char *filename, unsigned char sum[16]);
void MR3calccoulomb_ij_host(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag);
void mr3calccoulomb_ij_host_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void mr3calccoulomb_ij_host__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void MR3calcvdw_ij_host(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void mr3calcvdw_ij_host_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void mr3calcvdw_ij_host__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void MR3calccoulomb_nlist_ij_host_notwork(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[], double factorall);
void MR3calccoulomb_nlist_ij_host(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calccoulomb_nlist_host(double xd[], int n, double qd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calcvdw_nlist_ij_host_notwork(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[], double factor);
void MR3calcvdw_nlist_ij_host(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_host2(double x[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[], double factor, double force[]);
void MR3calccoulomb_ij_exlist_host(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void MR3calcvdw_ij_exlist_host(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void MR3calcewald_dft_host(int k[], int knum, double x[], int n, double chg[], double cellsize[3], double bs[], double bc[]);
void MR3calcewald_idft_eng_host(int k[], double bs[], double bc[], int knum, double x[], int n, double cellsize[3], double force[]);
void MR3calcewald_idft_force_host(int k[], double bs[], double bc[], int knum, double x[], int n, double cellsize[3], double force[]);
void MR3calcewald_host(int *k, int knum_org, double *x, int n, double *chg, double alpha, double epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_host__(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_host_(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void MR3SetTable(char *filename, int tblno, int flag);
void mr3settable_nf_(char *fname, int *tblno, int *flag, int *n);
void mr3settable_nf__(char *fname, int *tblno, int *flag, int *n);
void MR3_setup_exlist(int n, int *bckptr);
void mr3_setup_exlist_(int *n, int *bckptr);
void MR3_make_natex2_from_natex(int n, int natex[], int numex[], int **natex_offset, int **natex2, int **numex2, int **natex2_offset, int flag);
void calccoulomb_vdw_ij_exlist_host_sub(int i, int j, double xi[], double xj[], double qj, double gsf, double gsp, double rs, double rscale, double cutoff, double *fc, double *fv, double *pc, double *pv, int tblno, double size[3], int potflag);
void MR3calccoulomb_vdw_ij_exlist_cutoff_host(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double cutoff, double size[3], double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_host(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_host2(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_host_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_host__(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void MR3_get_cputime(double *laptime, double *sprittime);
void MR3_set_ldim(int ldim[3]);
void mr3_set_ldim_(int ldim[3]);
void mr3_set_ldim__(int ldim[3]);
void MR3_set_coulomb_vdw_factor(double cgf);
void mr3_set_coulomb_vdw_factor_(double *cgf);
void mr3_set_coulomb_vdw_factor__(double *cgf);
void MR3calccoulomb_ij_emu(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag);
void MR3calccoulomb_nlist_ij_emu(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calccoulomb_nlist_emu(double xd[], int n, double qd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calcvdw_ij_emu(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void MR3calccoulomb_vdw_nlist_ij_emu(int ni, double xid[], double qid[], int atypei[], double force[], int nj, double xjd[], double qjd[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblno, double volume[], int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_ij_emu(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_emu2(double xd[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calccoulomb_ij_exlist(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void mr3calccoulomb_ij_exlist_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag, int numexorg[], int natexorg[]);
void mr3calccoulomb_ij_exlist__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag, int numexorg[], int natexorg[]);
void MR3calcvdw_ij_exlist(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void mr3calcvdw_ij_exlist_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int numex[], int natex[]);
void mr3calcvdw_ij_exlist__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_core_old(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_core(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_virial_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_exlist(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double volume1, double *potc, double *potv, int *convert_index, int potflag, int flag);
void MR3calccoulomb_vdw_exlist_from_cell(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double volume1, double *potc, double *potv, int *convert_index, int potflag, int flag);
void mr3calccoulomb_vdw_exlist_(int *n, double x[], double q[], int atype[], int *nat, double force[], double *rscale, double gscalesf[], double gscalesp[], double rscales[], int *tblno, int numex[], int natex[], double *volume1, double *potc, double *potv, int *convert_index, int *potflag, int *flag);
void MR3_get_forces_overlap(double force[]);
void mr3_get_forces_overlap_(double force[]);
void MR3_get_potc_and_potv_overlap(double *potc, double *potv);
void mr3_get_potc_and_potv_overlap_(double *potc, double *potv);
void mr3_get_potc_and_potv_overlap__(double *potc, double *potv);
void MR3_get_forces_and_virial_overlap(double force[], double virial[3][3]);
void mr3_get_forces_and_virial_overlap_(double force[], double virial[3][3]);
void MR3calccoulomb_ci_exlist(int n, double x[], double q[], double force[], double rscale, int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], int *convert_index, int flag);
void mr3calccoulomb_ci_exlist_(int *n, double x[], double q[], double force[], double *rscale, int *tblno, int numex[], int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], int *convert_index, int *flag);
void MR3calcvdw_ci(int n, double x[], int atype[], int nat, double force[], double gscales[], double rscales[], int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calcvdw_ci_(int *n, double x[], int atype[], int *nat, double force[], double gscales[], double rscales[], int *tblno, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calcvdw_ci_exlist(int n, double x[], int atype[], int nat, double force[], double gscales[], double rscales[], int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], int *convert_index, int flag);
void mr3calcvdw_ci_exlist_(int *n, double x[], int atype[], int *nat, double force[], double gscales[], double rscales[], int *tblno, int numex[], int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], int *convert_index, int *flag);
void MR3calccoulomb_vdw_ci_exlist(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], double *potc, double *potv, int *convert_index, int potflag, int flag);
void mr3calccoulomb_vdw_ci_exlist_(int *n, double x[], double q[], int atype[], int *nat, double force[], double *rscale, double gscalesf[], double gscalesp[], double rscales[], int *tblno, int *numex, int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], double *potc, double *potv, int *convert_index, int *potflag, int *flag);
void MR3calccoulomb_ci(int n, double x[], double q[], double force[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calccoulomb_ci_(int *n, double x[], double q[], double force[], double *rscale, int *tblno, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_ij_ci(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_ij_ci_old(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calcvdw_ij_ci(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_virial(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut_org, double skinnb, double volume[3], int ldim[3], double virial[3][3], int flag);
void MR3calccoulomb_vdw_ij_ci(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calccoulomb_vdw_ij_ci_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscales[], double rscales[], double *rscale, int *tblnoc, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_old_09(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_old_090121(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_exlist(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3], int numex[], int natex[], int flag);
void mr3calccoulomb_vdw_ij_ci_exlist_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscales[], double rscales[], double *rscale, int *tblnoc, double *rcut, double *skinnb, double volume[3], int ldim[3], int numex[], int natex[], int *flag);
void MR3_get_board_version(int *version, int *freq);
void MR3_rscale_and_pack(int n, double (*x)[3], int *atype, longlong (*rj)[2]);
void MR3_rscale_and_pack_old(int n, double (*x)[3], int *atype, longlong (*rj)[2]);
void MR3SetTable_emu(char *filename, int tblno, int flag);
int MR3_get_total_num_chips(void);
void MR3print_chip_temperature(int flag);
int MR3_get_retry_count(void);
void m3_free_unit(VG_UNIT *unit);
VG_UNIT *m3_allocate_periodic_unit(const char *fname, int mode, double size, int dum);
void m3_set_positions(VG_UNIT *unit, double (*pos)[3], int n);
void m3_set_charges(VG_UNIT *unit, const double *q, int n);
void m3_set_cells(VG_UNIT *unit, M3_CELL *cell, int ncell);
void m3_calculate_forces(VG_UNIT *unit, double (*xi)[3], int ni, double (*force)[3]);
void m3_calculate_potentials(VG_UNIT *unit, double (*xi)[3], int ni, double *eng);
void m3_set_types(VG_UNIT *unit, const int *atype, int n);
void m3_set_pipeline_types(VG_UNIT *unit, const int *atype, int n);
void m3_set_charge_matrix(VG_UNIT *unit, const double *gscale, int nati, int natj);
void m3_set_rscale_matrix(VG_UNIT *unit, const double *rscale, int nati, int natj);
int MR3_close_ch(int s_sock);
int mr3_close_ch_(int *s_sock);
int MR3_open_port(int port_number);
int MR3_sock_read(int sockfd, char *buf, size_t count);
int mr3_sock_read_(int *sockfd, char *buf, int *count);
int mr3_sock_read__(int *sockfd, char *buf, int *count);
int mr3_sock_read_i_(int *sockfd, int *buf);
int mr3_sock_read_i__(int *sockfd, int *buf);
int MR3_sock_read_iv(int sockfd, int *buf, int count);
int mr3_sock_read_iv_(int *sockfd, int *buf, int *count);
int mr3_sock_read_iv__(int *sockfd, int *buf, int *count);
int MR3_sock_read_d(int sockfd, double *buf);
int mr3_sock_read_d__(int *sockfd, double *buf);
int mr3_sock_read_d_(int *sockfd, double *buf);
int MR3_sock_read_dv(int sockfd, double *buf, int count);
int mr3_sock_read_dv__(int *sockfd, double *buf, int *count);
int mr3_sock_read_dv_(int *sockfd, double *buf, int *count);
int MR3_sock_write(int sockfd, char *buf, size_t count);
int MR3_sock_write_c(int sockfd, char *buf);
int mr3_sock_write_c_(int *sockfd, char *buf);
int mr3_sock_write_c__(int *sockfd, char *buf);
int MR3_sock_write_i(int sockfd, int buf);
int mr3_sock_write_i_(int *sockfd, int *buf);
int mr3_sock_write_i__(int *sockfd, int *buf);
int MR3_sock_write_iv(int sockfd, int *buf, int count);
int mr3_sock_write_iv_(int *sockfd, int *buf, int *count);
int mr3_sock_write_iv__(int *sockfd, int *buf, int *count);
int MR3_sock_write_dv(int sockfd, double *buf, int count);
int mr3_sock_write_dv__(int *sockfd, double *buf, int *count);
int mr3_sock_write_dv_(int *sockfd, double *buf, int *count);
int MR3_sock_gets(int sockfd, char *str, size_t count);
int MR3_sock_puts(int sockfd, char *str);
void MR3_sock_init(int *s_sock_org, int port_num, double x[], int igraph[], int natom, int str_len, int lbres[], int ipres[], int nres);
void mr3_sock_init_(int *s_sock, int *port_num, double x[], int igraph[], int *natom, int *str_len, int lbres[], int ipres[], int *nres);
void mr3_sock_init__(int *s_sock, int *port_num, double x[], int igraph[], int *natom, int *str_len, int lbres[], int ipres[], int *nres);
void MR3_sock_1step(int s_sock, double t1, double time, double t2, int recv_buf[], int natom, double x[], double f[], double f_temp[]);
void mr3_sock_1step_(int *s_sock, double *t1, double *time, double *t2, int recv_buf[], int *natom, double x[], double f[], double f_tmp[]);
void mr3_sock_1step__(int *s_sock, double *t1, double *time, double *t2, int recv_buf[], int *natom, double x[], double f[], double f_tmp[]);
void MR3calc_ij_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, char method);
void MR3calc_ij_exlist_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], char method);
void MR3calc_ij_nlist_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], char method);
/* vtgrape.c */
void *MR3_my_malloc2(size_t n, char *s);
void MR3_my_free2(void **p, char *s);
VG_UNIT *m3_get_unit(void);
void vg_exit(int ret);
VG_UNIT *vg_allocate_unit(void (*function)(void *));
void vg_free_unit(VG_UNIT *unit);
void vg_set_function(VG_UNIT *unit, int function_index, void (*function)(void *));
void vg_set_vectors(VG_UNIT *unit, int nj, void *jvectors);
void vg_set_matrices(VG_UNIT *unit, int nati, int natj, void *matrices);
void vg_set_scalers(VG_UNIT *unit, void *scalers);
void vg_set_pipeline_vectors(VG_UNIT *unit, int ni, void *ivectors);
void vg_calculate(VG_UNIT *unit, int function_index, int nf, void *fvectors, void *pscalers);
void vg_set_vectors_pos_charge_atype(VG_UNIT *unit, int nj, double pos[][3], double charge[], int atype[]);
void vg_set_vectors_pos_charge(VG_UNIT *unit, int nj, double pos[][3], double charge[]);
void vg_set_vectors_pos_atype(VG_UNIT *unit, int nj, double pos[][3], int atype[]);
void vg_set_matrices_gscales_rscales(VG_UNIT *unit, int nati_org, int natj_org, double gscales[], double rscales[]);
void vg_set_pol_sigm_ipotro_pc_pd_zz(VG_UNIT *unit, int nati, int natj, double pol[], double sigm[], double ipotro[], double pc[], double pd[], double zz[]);
void vg_set_scalers_volume_alpha(VG_UNIT *unit, double volume[3], double alpha);
void vg_set_pipeline_vectors_pos_charge_atype(VG_UNIT *unit, int ni, double pos[][3], double charge[], int atype[]);
void vg_set_pipeline_vectors_pos_charge(VG_UNIT *unit, int ni, double pos[][3], double charge[]);
void vg_set_pipeline_vectors_pos_atype(VG_UNIT *unit, int ni, double pos[][3], int atype[]);
void vg_convert_forces(VG_UNIT *unit, int nf, int function_index, double fi[][3]);
void vg_calculate_forces_potentials(VG_UNIT *unit, int function_index, int nf, double fi[][3], double *potc, double *potv);
void vg_get_r1result(int n_org, float r[], float r1[]);
void vg_get_rsqrtresult(int n_org, float r[], float r1[]);
void vg_get_mulresult(int n_org, float r[], float q[], float rq[]);
int vg_write_emufile(int flag);
void vg_initialize_emu(void);
float vg_r1emu(float x);
float vg_rsqrtemu(float x);
void vg_set_scaleq(int n, double q[], double *scaleq, float *scaleq_1);
void m3_set_softening(VG_UNIT *unit, double eps);
void MR3_exit(int ret);
void MR3init(void);
void mr3init_(void);
void mr3init__(void);
void MR3free(void);
void mr3free_(void);
void mr3free__(void);
void MR3calccoulomb(double x[], int n, double q[], double rscale, int tblno, double xmax, int periodicflag, int natchangeflag, double force[]);
void mr3calccoulomb_(double x[], int *n, double q[], double *rscale, int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void mr3calccoulomb__(double x[], int *n, double q[], double *rscale, int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void MR3calccoulomb_ij(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag);
void mr3calccoulomb_ij_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void mr3calccoulomb_ij__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void MR3_sort_with_index_int(int data[], int index[], int left, int right);
void MR3calcvdw_ij_core(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void MR3calcvdw_ij(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void mr3calcvdw_ij_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void mr3calcvdw_ij__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void MR3calcvdw(double x[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int natchangeflag, double force[]);
void mr3calcvdw_(double x[], int *n, int atype[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void mr3calcvdw__(double x[], int *n, int atype[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void MR3calcewald(int *k, int knum_org, double *x, int n, double *chg, double alpha, double epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald__(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void MR3calcnacl(double x[], int n, int atype[], int nat, double pol[], double sigm[], double ipotro[], double pc[], double pd[], double zz[], int tblno, double xmax, int periodicflag, double force[]);
void vtgrape_force(double xj[][3], double mj[], double xi[][3], double eps2, double a[][3], int ni, int nj);
void vg_set_rcut2(VG_UNIT *unit, double rcut2);
void mr3_set_rcut2_(double *rcut2);
int md5sum(unsigned char *buffer, int totallen, unsigned char sum[16]);
int md5sum_file(char *filename, unsigned char sum[16]);
void MR3calccoulomb_ij_host(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag);
void mr3calccoulomb_ij_host_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void mr3calccoulomb_ij_host__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void MR3calcvdw_ij_host(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void mr3calcvdw_ij_host_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void mr3calcvdw_ij_host__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void MR3calccoulomb_nlist_ij_host_notwork(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[], double factorall);
void MR3calccoulomb_nlist_ij_host(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calccoulomb_nlist_host(double xd[], int n, double qd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calcvdw_nlist_ij_host_notwork(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[], double factor);
void MR3calcvdw_nlist_ij_host(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_host2(double x[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[], double factor, double force[]);
void MR3calccoulomb_ij_exlist_host(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void MR3calcvdw_ij_exlist_host(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void MR3calcewald_dft_host(int k[], int knum, double x[], int n, double chg[], double cellsize[3], double bs[], double bc[]);
void MR3calcewald_idft_eng_host(int k[], double bs[], double bc[], int knum, double x[], int n, double cellsize[3], double force[]);
void MR3calcewald_idft_force_host(int k[], double bs[], double bc[], int knum, double x[], int n, double cellsize[3], double force[]);
void MR3calcewald_host(int *k, int knum_org, double *x, int n, double *chg, double alpha, double epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_host__(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_host_(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void MR3SetTable(char *filename, int tblno, int flag);
void mr3settable_nf_(char *fname, int *tblno, int *flag, int *n);
void mr3settable_nf__(char *fname, int *tblno, int *flag, int *n);
void MR3_setup_exlist(int n, int *bckptr);
void mr3_setup_exlist_(int *n, int *bckptr);
void MR3_make_natex2_from_natex(int n, int natex[], int numex[], int **natex_offset, int **natex2, int **numex2, int **natex2_offset, int flag);
void calccoulomb_vdw_ij_exlist_host_sub(int i, int j, double xi[], double xj[], double qj, double gsf, double gsp, double rs, double rscale, double cutoff, double *fc, double *fv, double *pc, double *pv, int tblno, double size[3], int potflag);
void MR3calccoulomb_vdw_ij_exlist_cutoff_host(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double cutoff, double size[3], double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_host(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_host2(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_host_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_host__(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void MR3_get_cputime(double *laptime, double *sprittime);
void MR3_set_ldim(int ldim[3]);
void mr3_set_ldim_(int ldim[3]);
void mr3_set_ldim__(int ldim[3]);
void MR3_set_coulomb_vdw_factor(double cgf);
void mr3_set_coulomb_vdw_factor_(double *cgf);
void mr3_set_coulomb_vdw_factor__(double *cgf);
void MR3calccoulomb_ij_emu(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag);
void MR3calccoulomb_nlist_ij_emu(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calccoulomb_nlist_emu(double xd[], int n, double qd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calcvdw_ij_emu(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void MR3calccoulomb_vdw_nlist_ij_emu(int ni, double xid[], double qid[], int atypei[], double force[], int nj, double xjd[], double qjd[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblno, double volume[], int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_ij_emu(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_emu2(double xd[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calccoulomb_ij_exlist(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void mr3calccoulomb_ij_exlist_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag, int numexorg[], int natexorg[]);
void mr3calccoulomb_ij_exlist__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag, int numexorg[], int natexorg[]);
void MR3calcvdw_ij_exlist(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void mr3calcvdw_ij_exlist_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int numex[], int natex[]);
void mr3calcvdw_ij_exlist__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_core_old(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_core(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_virial_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_exlist(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double volume1, double *potc, double *potv, int *convert_index, int potflag, int flag);
void MR3calccoulomb_vdw_exlist_from_cell(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double volume1, double *potc, double *potv, int *convert_index, int potflag, int flag);
void mr3calccoulomb_vdw_exlist_(int *n, double x[], double q[], int atype[], int *nat, double force[], double *rscale, double gscalesf[], double gscalesp[], double rscales[], int *tblno, int numex[], int natex[], double *volume1, double *potc, double *potv, int *convert_index, int *potflag, int *flag);
void MR3_get_forces_overlap(double force[]);
void mr3_get_forces_overlap_(double force[]);
void MR3_get_potc_and_potv_overlap(double *potc, double *potv);
void mr3_get_potc_and_potv_overlap_(double *potc, double *potv);
void mr3_get_potc_and_potv_overlap__(double *potc, double *potv);
void MR3_get_forces_and_virial_overlap(double force[], double virial[3][3]);
void mr3_get_forces_and_virial_overlap_(double force[], double virial[3][3]);
void MR3calccoulomb_ci_exlist(int n, double x[], double q[], double force[], double rscale, int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], int *convert_index, int flag);
void mr3calccoulomb_ci_exlist_(int *n, double x[], double q[], double force[], double *rscale, int *tblno, int numex[], int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], int *convert_index, int *flag);
void MR3calcvdw_ci(int n, double x[], int atype[], int nat, double force[], double gscales[], double rscales[], int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calcvdw_ci_(int *n, double x[], int atype[], int *nat, double force[], double gscales[], double rscales[], int *tblno, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calcvdw_ci_exlist(int n, double x[], int atype[], int nat, double force[], double gscales[], double rscales[], int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], int *convert_index, int flag);
void mr3calcvdw_ci_exlist_(int *n, double x[], int atype[], int *nat, double force[], double gscales[], double rscales[], int *tblno, int numex[], int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], int *convert_index, int *flag);
void MR3calccoulomb_vdw_ci_exlist(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], double *potc, double *potv, int *convert_index, int potflag, int flag);
void mr3calccoulomb_vdw_ci_exlist_(int *n, double x[], double q[], int atype[], int *nat, double force[], double *rscale, double gscalesf[], double gscalesp[], double rscales[], int *tblno, int *numex, int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], double *potc, double *potv, int *convert_index, int *potflag, int *flag);
void MR3calccoulomb_ci(int n, double x[], double q[], double force[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calccoulomb_ci_(int *n, double x[], double q[], double force[], double *rscale, int *tblno, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_ij_ci(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_ij_ci_old(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calcvdw_ij_ci(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_virial(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut_org, double skinnb, double volume[3], int ldim[3], double virial[3][3], int flag);
void MR3calccoulomb_vdw_ij_ci(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calccoulomb_vdw_ij_ci_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscales[], double rscales[], double *rscale, int *tblnoc, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_old_09(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_old_090121(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_exlist(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3], int numex[], int natex[], int flag);
void mr3calccoulomb_vdw_ij_ci_exlist_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscales[], double rscales[], double *rscale, int *tblnoc, double *rcut, double *skinnb, double volume[3], int ldim[3], int numex[], int natex[], int *flag);
void MR3_get_board_version(int *version, int *freq);
void MR3_rscale_and_pack(int n, double (*x)[3], int *atype, longlong (*rj)[2]);
void MR3_rscale_and_pack_old(int n, double (*x)[3], int *atype, longlong (*rj)[2]);
void MR3SetTable_emu(char *filename, int tblno, int flag);
int MR3_get_total_num_chips(void);
void MR3print_chip_temperature(int flag);
int MR3_get_retry_count(void);
void m3_free_unit(VG_UNIT *unit);
VG_UNIT *m3_allocate_periodic_unit(const char *fname, int mode, double size, int dum);
void m3_set_positions(VG_UNIT *unit, double (*pos)[3], int n);
void m3_set_charges(VG_UNIT *unit, const double *q, int n);
void m3_set_cells(VG_UNIT *unit, M3_CELL *cell, int ncell);
void m3_calculate_forces(VG_UNIT *unit, double (*xi)[3], int ni, double (*force)[3]);
void m3_calculate_potentials(VG_UNIT *unit, double (*xi)[3], int ni, double *eng);
void m3_set_types(VG_UNIT *unit, const int *atype, int n);
void m3_set_pipeline_types(VG_UNIT *unit, const int *atype, int n);
void m3_set_charge_matrix(VG_UNIT *unit, const double *gscale, int nati, int natj);
void m3_set_rscale_matrix(VG_UNIT *unit, const double *rscale, int nati, int natj);
int MR3_close_ch(int s_sock);
int mr3_close_ch_(int *s_sock);
int MR3_open_port(int port_number);
int MR3_sock_read(int sockfd, char *buf, size_t count);
int mr3_sock_read_(int *sockfd, char *buf, int *count);
int mr3_sock_read__(int *sockfd, char *buf, int *count);
int mr3_sock_read_i_(int *sockfd, int *buf);
int mr3_sock_read_i__(int *sockfd, int *buf);
int MR3_sock_read_iv(int sockfd, int *buf, int count);
int mr3_sock_read_iv_(int *sockfd, int *buf, int *count);
int mr3_sock_read_iv__(int *sockfd, int *buf, int *count);
int MR3_sock_read_d(int sockfd, double *buf);
int mr3_sock_read_d__(int *sockfd, double *buf);
int mr3_sock_read_d_(int *sockfd, double *buf);
int MR3_sock_read_dv(int sockfd, double *buf, int count);
int mr3_sock_read_dv__(int *sockfd, double *buf, int *count);
int mr3_sock_read_dv_(int *sockfd, double *buf, int *count);
int MR3_sock_write(int sockfd, char *buf, size_t count);
int MR3_sock_write_c(int sockfd, char *buf);
int mr3_sock_write_c_(int *sockfd, char *buf);
int mr3_sock_write_c__(int *sockfd, char *buf);
int MR3_sock_write_i(int sockfd, int buf);
int mr3_sock_write_i_(int *sockfd, int *buf);
int mr3_sock_write_i__(int *sockfd, int *buf);
int MR3_sock_write_iv(int sockfd, int *buf, int count);
int mr3_sock_write_iv_(int *sockfd, int *buf, int *count);
int mr3_sock_write_iv__(int *sockfd, int *buf, int *count);
int MR3_sock_write_dv(int sockfd, double *buf, int count);
int mr3_sock_write_dv__(int *sockfd, double *buf, int *count);
int mr3_sock_write_dv_(int *sockfd, double *buf, int *count);
int MR3_sock_gets(int sockfd, char *str, size_t count);
int MR3_sock_puts(int sockfd, char *str);
void MR3_sock_init(int *s_sock_org, int port_num, double x[], int igraph[], int natom, int str_len, int lbres[], int ipres[], int nres);
void mr3_sock_init_(int *s_sock, int *port_num, double x[], int igraph[], int *natom, int *str_len, int lbres[], int ipres[], int *nres);
void mr3_sock_init__(int *s_sock, int *port_num, double x[], int igraph[], int *natom, int *str_len, int lbres[], int ipres[], int *nres);
void MR3_sock_1step(int s_sock, double t1, double time, double t2, int recv_buf[], int natom, double x[], double f[], double f_temp[]);
void mr3_sock_1step_(int *s_sock, double *t1, double *time, double *t2, int recv_buf[], int *natom, double x[], double f[], double f_tmp[]);
void mr3_sock_1step__(int *s_sock, double *t1, double *time, double *t2, int recv_buf[], int *natom, double x[], double f[], double f_tmp[]);
void MR3calc_ij_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, char method);
void MR3calc_ij_exlist_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], char method);
void MR3calc_ij_nlist_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], char method);
/* vtgrape.c */
void *MR3_my_malloc2(size_t n, char *s);
void MR3_my_free2(void **p, char *s);
VG_UNIT *m3_get_unit(void);
void vg_exit(int ret);
VG_UNIT *vg_allocate_unit(void (*function)(void *));
void vg_free_unit(VG_UNIT *unit);
void vg_set_function(VG_UNIT *unit, int function_index, void (*function)(void *));
void vg_set_vectors(VG_UNIT *unit, int nj, void *jvectors);
void vg_set_matrices(VG_UNIT *unit, int nati, int natj, void *matrices);
void vg_set_scalers(VG_UNIT *unit, void *scalers);
void vg_set_pipeline_vectors(VG_UNIT *unit, int ni, void *ivectors);
void vg_calculate(VG_UNIT *unit, int function_index, int nf, void *fvectors, void *pscalers);
void vg_set_vectors_pos_charge_atype(VG_UNIT *unit, int nj, double pos[][3], double charge[], int atype[]);
void vg_set_vectors_pos_charge(VG_UNIT *unit, int nj, double pos[][3], double charge[]);
void vg_set_vectors_pos_atype(VG_UNIT *unit, int nj, double pos[][3], int atype[]);
void vg_set_matrices_gscales_rscales(VG_UNIT *unit, int nati_org, int natj_org, double gscales[], double rscales[]);
void vg_set_pol_sigm_ipotro_pc_pd_zz(VG_UNIT *unit, int nati, int natj, double pol[], double sigm[], double ipotro[], double pc[], double pd[], double zz[]);
void vg_set_scalers_volume_alpha(VG_UNIT *unit, double volume[3], double alpha);
void vg_set_pipeline_vectors_pos_charge_atype(VG_UNIT *unit, int ni, double pos[][3], double charge[], int atype[]);
void vg_set_pipeline_vectors_pos_charge(VG_UNIT *unit, int ni, double pos[][3], double charge[]);
void vg_set_pipeline_vectors_pos_atype(VG_UNIT *unit, int ni, double pos[][3], int atype[]);
void vg_convert_forces(VG_UNIT *unit, int nf, int function_index, double fi[][3]);
void vg_calculate_forces_potentials(VG_UNIT *unit, int function_index, int nf, double fi[][3], double *potc, double *potv);
void vg_get_r1result(int n_org, float r[], float r1[]);
void vg_get_rsqrtresult(int n_org, float r[], float r1[]);
void vg_get_mulresult(int n_org, float r[], float q[], float rq[]);
int vg_write_emufile(int flag);
void vg_initialize_emu(void);
float vg_r1emu(float x);
float vg_rsqrtemu(float x);
void vg_set_scaleq(int n, double q[], double *scaleq, float *scaleq_1);
void m3_set_softening(VG_UNIT *unit, double eps);
void MR3_exit(int ret);
void MR3init(void);
void mr3init_(void);
void mr3init__(void);
void MR3free(void);
void mr3free_(void);
void mr3free__(void);
void MR3calccoulomb(double x[], int n, double q[], double rscale, int tblno, double xmax, int periodicflag, int natchangeflag, double force[]);
void mr3calccoulomb_(double x[], int *n, double q[], double *rscale, int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void mr3calccoulomb__(double x[], int *n, double q[], double *rscale, int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void MR3calccoulomb_ij(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag);
void mr3calccoulomb_ij_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void mr3calccoulomb_ij__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void MR3_sort_with_index_int(int data[], int index[], int left, int right);
void MR3calcvdw_ij_core(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void MR3calcvdw_ij(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void mr3calcvdw_ij_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void mr3calcvdw_ij__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void MR3calcvdw(double x[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int natchangeflag, double force[]);
void mr3calcvdw_(double x[], int *n, int atype[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void mr3calcvdw__(double x[], int *n, int atype[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void MR3calcewald(int *k, int knum_org, double *x, int n, double *chg, double alpha, double epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald__(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void MR3calcnacl(double x[], int n, int atype[], int nat, double pol[], double sigm[], double ipotro[], double pc[], double pd[], double zz[], int tblno, double xmax, int periodicflag, double force[]);
void vtgrape_force(double xj[][3], double mj[], double xi[][3], double eps2, double a[][3], int ni, int nj);
void vg_set_rcut2(VG_UNIT *unit, double rcut2);
void mr3_set_rcut2_(double *rcut2);
int md5sum(unsigned char *buffer, int totallen, unsigned char sum[16]);
int md5sum_file(char *filename, unsigned char sum[16]);
void MR3calccoulomb_ij_host(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag);
void mr3calccoulomb_ij_host_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void mr3calccoulomb_ij_host__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void MR3calcvdw_ij_host(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void mr3calcvdw_ij_host_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void mr3calcvdw_ij_host__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void MR3calccoulomb_nlist_ij_host_notwork(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[], double factorall);
void MR3calccoulomb_nlist_ij_host(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calccoulomb_nlist_host(double xd[], int n, double qd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calcvdw_nlist_ij_host_notwork(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[], double factor);
void MR3calcvdw_nlist_ij_host(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_host2(double x[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[], double factor, double force[]);
void MR3calccoulomb_ij_exlist_host(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void MR3calcvdw_ij_exlist_host(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void MR3calcewald_dft_host(int k[], int knum, double x[], int n, double chg[], double cellsize[3], double bs[], double bc[]);
void MR3calcewald_idft_eng_host(int k[], double bs[], double bc[], int knum, double x[], int n, double cellsize[3], double force[]);
void MR3calcewald_idft_force_host(int k[], double bs[], double bc[], int knum, double x[], int n, double cellsize[3], double force[]);
void MR3calcewald_host(int *k, int knum_org, double *x, int n, double *chg, double alpha, double epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_host__(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_host_(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void MR3SetTable(char *filename, int tblno, int flag);
void mr3settable_nf_(char *fname, int *tblno, int *flag, int *n);
void mr3settable_nf__(char *fname, int *tblno, int *flag, int *n);
void MR3_setup_exlist(int n, int *bckptr);
void mr3_setup_exlist_(int *n, int *bckptr);
void MR3_make_natex2_from_natex(int n, int natex[], int numex[], int **natex_offset, int **natex2, int **numex2, int **natex2_offset, int flag);
void calccoulomb_vdw_ij_exlist_host_sub(int i, int j, double xi[], double xj[], double qj, double gsf, double gsp, double rs, double rscale, double cutoff, double *fc, double *fv, double *pc, double *pv, int tblno, double size[3], int potflag);
void MR3calccoulomb_vdw_ij_exlist_cutoff_host(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double cutoff, double size[3], double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_host(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_host2(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_host_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_host__(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void MR3_get_cputime(double *laptime, double *sprittime);
void MR3_set_ldim(int ldim[3]);
void mr3_set_ldim_(int ldim[3]);
void mr3_set_ldim__(int ldim[3]);
void MR3_set_coulomb_vdw_factor(double cgf);
void mr3_set_coulomb_vdw_factor_(double *cgf);
void mr3_set_coulomb_vdw_factor__(double *cgf);
void MR3calccoulomb_ij_emu(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag);
void MR3calccoulomb_nlist_ij_emu(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calccoulomb_nlist_emu(double xd[], int n, double qd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calcvdw_ij_emu(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void MR3calccoulomb_vdw_nlist_ij_emu(int ni, double xid[], double qid[], int atypei[], double force[], int nj, double xjd[], double qjd[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblno, double volume[], int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_ij_emu(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_emu2(double xd[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calccoulomb_ij_exlist(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void mr3calccoulomb_ij_exlist_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag, int numexorg[], int natexorg[]);
void mr3calccoulomb_ij_exlist__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag, int numexorg[], int natexorg[]);
void MR3calcvdw_ij_exlist(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void mr3calcvdw_ij_exlist_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int numex[], int natex[]);
void mr3calcvdw_ij_exlist__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_core_old(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_core(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_virial_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_exlist(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double volume1, double *potc, double *potv, int *convert_index, int potflag, int flag);
void MR3calccoulomb_vdw_exlist_from_cell(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double volume1, double *potc, double *potv, int *convert_index, int potflag, int flag);
void mr3calccoulomb_vdw_exlist_(int *n, double x[], double q[], int atype[], int *nat, double force[], double *rscale, double gscalesf[], double gscalesp[], double rscales[], int *tblno, int numex[], int natex[], double *volume1, double *potc, double *potv, int *convert_index, int *potflag, int *flag);
void MR3_get_forces_overlap(double force[]);
void mr3_get_forces_overlap_(double force[]);
void MR3_get_potc_and_potv_overlap(double *potc, double *potv);
void mr3_get_potc_and_potv_overlap_(double *potc, double *potv);
void mr3_get_potc_and_potv_overlap__(double *potc, double *potv);
void MR3_get_forces_and_virial_overlap(double force[], double virial[3][3]);
void mr3_get_forces_and_virial_overlap_(double force[], double virial[3][3]);
void MR3calccoulomb_ci_exlist(int n, double x[], double q[], double force[], double rscale, int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], int *convert_index, int flag);
void mr3calccoulomb_ci_exlist_(int *n, double x[], double q[], double force[], double *rscale, int *tblno, int numex[], int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], int *convert_index, int *flag);
void MR3calcvdw_ci(int n, double x[], int atype[], int nat, double force[], double gscales[], double rscales[], int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calcvdw_ci_(int *n, double x[], int atype[], int *nat, double force[], double gscales[], double rscales[], int *tblno, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calcvdw_ci_exlist(int n, double x[], int atype[], int nat, double force[], double gscales[], double rscales[], int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], int *convert_index, int flag);
void mr3calcvdw_ci_exlist_(int *n, double x[], int atype[], int *nat, double force[], double gscales[], double rscales[], int *tblno, int numex[], int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], int *convert_index, int *flag);
void MR3calccoulomb_vdw_ci_exlist(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], double *potc, double *potv, int *convert_index, int potflag, int flag);
void mr3calccoulomb_vdw_ci_exlist_(int *n, double x[], double q[], int atype[], int *nat, double force[], double *rscale, double gscalesf[], double gscalesp[], double rscales[], int *tblno, int *numex, int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], double *potc, double *potv, int *convert_index, int *potflag, int *flag);
void MR3calccoulomb_ci(int n, double x[], double q[], double force[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calccoulomb_ci_(int *n, double x[], double q[], double force[], double *rscale, int *tblno, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_ij_ci(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_ij_ci_old(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calcvdw_ij_ci(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_virial(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut_org, double skinnb, double volume[3], int ldim[3], double virial[3][3], int flag);
void MR3calccoulomb_vdw_ij_ci(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calccoulomb_vdw_ij_ci_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscales[], double rscales[], double *rscale, int *tblnoc, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_old_09(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_old_090121(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_exlist(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3], int numex[], int natex[], int flag);
void mr3calccoulomb_vdw_ij_ci_exlist_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscales[], double rscales[], double *rscale, int *tblnoc, double *rcut, double *skinnb, double volume[3], int ldim[3], int numex[], int natex[], int *flag);
void MR3_get_board_version(int *version, int *freq);
void MR3_rscale_and_pack(int n, double (*x)[3], int *atype, longlong (*rj)[2]);
void MR3_rscale_and_pack_old(int n, double (*x)[3], int *atype, longlong (*rj)[2]);
void MR3SetTable_emu(char *filename, int tblno, int flag);
int MR3_get_total_num_chips(void);
void MR3print_chip_temperature(int flag);
int MR3_get_retry_count(void);
void m3_free_unit(VG_UNIT *unit);
VG_UNIT *m3_allocate_periodic_unit(const char *fname, int mode, double size, int dum);
void m3_set_positions(VG_UNIT *unit, double (*pos)[3], int n);
void m3_set_charges(VG_UNIT *unit, const double *q, int n);
void m3_set_cells(VG_UNIT *unit, M3_CELL *cell, int ncell);
void m3_calculate_forces(VG_UNIT *unit, double (*xi)[3], int ni, double (*force)[3]);
void m3_calculate_potentials(VG_UNIT *unit, double (*xi)[3], int ni, double *eng);
void m3_set_types(VG_UNIT *unit, const int *atype, int n);
void m3_set_pipeline_types(VG_UNIT *unit, const int *atype, int n);
void m3_set_charge_matrix(VG_UNIT *unit, const double *gscale, int nati, int natj);
void m3_set_rscale_matrix(VG_UNIT *unit, const double *rscale, int nati, int natj);
int MR3_close_ch(int s_sock);
int mr3_close_ch_(int *s_sock);
int MR3_open_port(int port_number);
int MR3_sock_read(int sockfd, char *buf, size_t count);
int mr3_sock_read_(int *sockfd, char *buf, int *count);
int mr3_sock_read__(int *sockfd, char *buf, int *count);
int mr3_sock_read_i_(int *sockfd, int *buf);
int mr3_sock_read_i__(int *sockfd, int *buf);
int MR3_sock_read_iv(int sockfd, int *buf, int count);
int mr3_sock_read_iv_(int *sockfd, int *buf, int *count);
int mr3_sock_read_iv__(int *sockfd, int *buf, int *count);
int MR3_sock_read_d(int sockfd, double *buf);
int mr3_sock_read_d__(int *sockfd, double *buf);
int mr3_sock_read_d_(int *sockfd, double *buf);
int MR3_sock_read_dv(int sockfd, double *buf, int count);
int mr3_sock_read_dv__(int *sockfd, double *buf, int *count);
int mr3_sock_read_dv_(int *sockfd, double *buf, int *count);
int MR3_sock_write(int sockfd, char *buf, size_t count);
int MR3_sock_write_c(int sockfd, char *buf);
int mr3_sock_write_c_(int *sockfd, char *buf);
int mr3_sock_write_c__(int *sockfd, char *buf);
int MR3_sock_write_i(int sockfd, int buf);
int mr3_sock_write_i_(int *sockfd, int *buf);
int mr3_sock_write_i__(int *sockfd, int *buf);
int MR3_sock_write_iv(int sockfd, int *buf, int count);
int mr3_sock_write_iv_(int *sockfd, int *buf, int *count);
int mr3_sock_write_iv__(int *sockfd, int *buf, int *count);
int MR3_sock_write_dv(int sockfd, double *buf, int count);
int mr3_sock_write_dv__(int *sockfd, double *buf, int *count);
int mr3_sock_write_dv_(int *sockfd, double *buf, int *count);
int MR3_sock_gets(int sockfd, char *str, size_t count);
int MR3_sock_puts(int sockfd, char *str);
void MR3_sock_init(int *s_sock_org, int port_num, double x[], int igraph[], int natom, int str_len, int lbres[], int ipres[], int nres);
void mr3_sock_init_(int *s_sock, int *port_num, double x[], int igraph[], int *natom, int *str_len, int lbres[], int ipres[], int *nres);
void mr3_sock_init__(int *s_sock, int *port_num, double x[], int igraph[], int *natom, int *str_len, int lbres[], int ipres[], int *nres);
void MR3_sock_1step(int s_sock, double t1, double time, double t2, int recv_buf[], int natom, double x[], double f[], double f_temp[]);
void mr3_sock_1step_(int *s_sock, double *t1, double *time, double *t2, int recv_buf[], int *natom, double x[], double f[], double f_tmp[]);
void mr3_sock_1step__(int *s_sock, double *t1, double *time, double *t2, int recv_buf[], int *natom, double x[], double f[], double f_tmp[]);
void MR3calc_ij_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, char method);
void MR3calc_ij_exlist_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], char method);
void MR3calc_ij_nlist_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], char method);
/* vtgrape.c */
void *MR3_my_malloc2(size_t n, char *s);
void MR3_my_free2(void **p, char *s);
VG_UNIT *m3_get_unit(void);
void vg_exit(int ret);
VG_UNIT *vg_allocate_unit(void (*function)(void *));
void vg_free_unit(VG_UNIT *unit);
void vg_set_function(VG_UNIT *unit, int function_index, void (*function)(void *));
void vg_set_vectors(VG_UNIT *unit, int nj, void *jvectors);
void vg_set_matrices(VG_UNIT *unit, int nati, int natj, void *matrices);
void vg_set_scalers(VG_UNIT *unit, void *scalers);
void vg_set_pipeline_vectors(VG_UNIT *unit, int ni, void *ivectors);
void vg_calculate(VG_UNIT *unit, int function_index, int nf, void *fvectors, void *pscalers);
void vg_set_vectors_pos_charge_atype(VG_UNIT *unit, int nj, double pos[][3], double charge[], int atype[]);
void vg_set_vectors_pos_charge(VG_UNIT *unit, int nj, double pos[][3], double charge[]);
void vg_set_vectors_pos_atype(VG_UNIT *unit, int nj, double pos[][3], int atype[]);
void vg_set_matrices_gscales_rscales(VG_UNIT *unit, int nati_org, int natj_org, double gscales[], double rscales[]);
void vg_set_pol_sigm_ipotro_pc_pd_zz(VG_UNIT *unit, int nati, int natj, double pol[], double sigm[], double ipotro[], double pc[], double pd[], double zz[]);
void vg_set_scalers_volume_alpha(VG_UNIT *unit, double volume[3], double alpha);
void vg_set_pipeline_vectors_pos_charge_atype(VG_UNIT *unit, int ni, double pos[][3], double charge[], int atype[]);
void vg_set_pipeline_vectors_pos_charge(VG_UNIT *unit, int ni, double pos[][3], double charge[]);
void vg_set_pipeline_vectors_pos_atype(VG_UNIT *unit, int ni, double pos[][3], int atype[]);
void vg_convert_forces(VG_UNIT *unit, int nf, int function_index, double fi[][3]);
void vg_calculate_forces_potentials(VG_UNIT *unit, int function_index, int nf, double fi[][3], double *potc, double *potv);
void vg_get_r1result(int n_org, float r[], float r1[]);
void vg_get_rsqrtresult(int n_org, float r[], float r1[]);
void vg_get_mulresult(int n_org, float r[], float q[], float rq[]);
int vg_write_emufile(int flag);
void vg_initialize_emu(void);
float vg_r1emu(float x);
float vg_rsqrtemu(float x);
void vg_set_scaleq(int n, double q[], double *scaleq, float *scaleq_1);
void m3_set_softening(VG_UNIT *unit, double eps);
void MR3_exit(int ret);
void MR3init(void);
void mr3init_(void);
void mr3init__(void);
void MR3free(void);
void mr3free_(void);
void mr3free__(void);
void MR3calccoulomb(double x[], int n, double q[], double rscale, int tblno, double xmax, int periodicflag, int natchangeflag, double force[]);
void mr3calccoulomb_(double x[], int *n, double q[], double *rscale, int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void mr3calccoulomb__(double x[], int *n, double q[], double *rscale, int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void MR3calccoulomb_ij(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag);
void mr3calccoulomb_ij_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void mr3calccoulomb_ij__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void MR3_sort_with_index_int(int data[], int index[], int left, int right);
void MR3calcvdw_ij_core(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void MR3calcvdw_ij(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void mr3calcvdw_ij_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void mr3calcvdw_ij__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void MR3calcvdw(double x[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int natchangeflag, double force[]);
void mr3calcvdw_(double x[], int *n, int atype[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void mr3calcvdw__(double x[], int *n, int atype[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void MR3calcewald(int *k, int knum_org, double *x, int n, double *chg, double alpha, double epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald__(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void MR3calcnacl(double x[], int n, int atype[], int nat, double pol[], double sigm[], double ipotro[], double pc[], double pd[], double zz[], int tblno, double xmax, int periodicflag, double force[]);
void vtgrape_force(double xj[][3], double mj[], double xi[][3], double eps2, double a[][3], int ni, int nj);
void vg_set_rcut2(VG_UNIT *unit, double rcut2);
void mr3_set_rcut2_(double *rcut2);
int md5sum(unsigned char *buffer, int totallen, unsigned char sum[16]);
int md5sum_file(char *filename, unsigned char sum[16]);
void MR3calccoulomb_ij_host(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag);
void mr3calccoulomb_ij_host_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void mr3calccoulomb_ij_host__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void MR3calcvdw_ij_host(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void mr3calcvdw_ij_host_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void mr3calcvdw_ij_host__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void MR3calccoulomb_nlist_ij_host_notwork(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[], double factorall);
void MR3calccoulomb_nlist_ij_host(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calccoulomb_nlist_host(double xd[], int n, double qd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calcvdw_nlist_ij_host_notwork(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[], double factor);
void MR3calcvdw_nlist_ij_host(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_host2(double x[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[], double factor, double force[]);
void MR3calccoulomb_ij_exlist_host(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void MR3calcvdw_ij_exlist_host(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void MR3calcewald_dft_host(int k[], int knum, double x[], int n, double chg[], double cellsize[3], double bs[], double bc[]);
void MR3calcewald_idft_eng_host(int k[], double bs[], double bc[], int knum, double x[], int n, double cellsize[3], double force[]);
void MR3calcewald_idft_force_host(int k[], double bs[], double bc[], int knum, double x[], int n, double cellsize[3], double force[]);
void MR3calcewald_host(int *k, int knum_org, double *x, int n, double *chg, double alpha, double epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_host__(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_host_(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void MR3SetTable(char *filename, int tblno, int flag);
void mr3settable_nf_(char *fname, int *tblno, int *flag, int *n);
void mr3settable_nf__(char *fname, int *tblno, int *flag, int *n);
void MR3_setup_exlist(int n, int *bckptr);
void mr3_setup_exlist_(int *n, int *bckptr);
void MR3_make_natex2_from_natex(int n, int natex[], int numex[], int **natex_offset, int **natex2, int **numex2, int **natex2_offset, int flag);
void calccoulomb_vdw_ij_exlist_host_sub(int i, int j, double xi[], double xj[], double qj, double gsf, double gsp, double rs, double rscale, double cutoff, double *fc, double *fv, double *pc, double *pv, int tblno, double size[3], int potflag);
void MR3calccoulomb_vdw_ij_exlist_cutoff_host(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double cutoff, double size[3], double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_host(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_host2(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_host_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_host__(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void MR3_get_cputime(double *laptime, double *sprittime);
void MR3_set_ldim(int ldim[3]);
void mr3_set_ldim_(int ldim[3]);
void mr3_set_ldim__(int ldim[3]);
void MR3_set_coulomb_vdw_factor(double cgf);
void mr3_set_coulomb_vdw_factor_(double *cgf);
void mr3_set_coulomb_vdw_factor__(double *cgf);
void MR3calccoulomb_ij_emu(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag);
void MR3calccoulomb_nlist_ij_emu(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calccoulomb_nlist_emu(double xd[], int n, double qd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calcvdw_ij_emu(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void MR3calccoulomb_vdw_nlist_ij_emu(int ni, double xid[], double qid[], int atypei[], double force[], int nj, double xjd[], double qjd[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblno, double volume[], int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_ij_emu(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_emu2(double xd[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calccoulomb_ij_exlist(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void mr3calccoulomb_ij_exlist_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag, int numexorg[], int natexorg[]);
void mr3calccoulomb_ij_exlist__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag, int numexorg[], int natexorg[]);
void MR3calcvdw_ij_exlist(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void mr3calcvdw_ij_exlist_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int numex[], int natex[]);
void mr3calcvdw_ij_exlist__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_core_old(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_core(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_virial_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_exlist(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double volume1, double *potc, double *potv, int *convert_index, int potflag, int flag);
void MR3calccoulomb_vdw_exlist_from_cell(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double volume1, double *potc, double *potv, int *convert_index, int potflag, int flag);
void mr3calccoulomb_vdw_exlist_(int *n, double x[], double q[], int atype[], int *nat, double force[], double *rscale, double gscalesf[], double gscalesp[], double rscales[], int *tblno, int numex[], int natex[], double *volume1, double *potc, double *potv, int *convert_index, int *potflag, int *flag);
void MR3_get_forces_overlap(double force[]);
void mr3_get_forces_overlap_(double force[]);
void MR3_get_potc_and_potv_overlap(double *potc, double *potv);
void mr3_get_potc_and_potv_overlap_(double *potc, double *potv);
void mr3_get_potc_and_potv_overlap__(double *potc, double *potv);
void MR3_get_forces_and_virial_overlap(double force[], double virial[3][3]);
void mr3_get_forces_and_virial_overlap_(double force[], double virial[3][3]);
void MR3calccoulomb_ci_exlist(int n, double x[], double q[], double force[], double rscale, int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], int *convert_index, int flag);
void mr3calccoulomb_ci_exlist_(int *n, double x[], double q[], double force[], double *rscale, int *tblno, int numex[], int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], int *convert_index, int *flag);
void MR3calcvdw_ci(int n, double x[], int atype[], int nat, double force[], double gscales[], double rscales[], int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calcvdw_ci_(int *n, double x[], int atype[], int *nat, double force[], double gscales[], double rscales[], int *tblno, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calcvdw_ci_exlist(int n, double x[], int atype[], int nat, double force[], double gscales[], double rscales[], int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], int *convert_index, int flag);
void mr3calcvdw_ci_exlist_(int *n, double x[], int atype[], int *nat, double force[], double gscales[], double rscales[], int *tblno, int numex[], int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], int *convert_index, int *flag);
void MR3calccoulomb_vdw_ci_exlist(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], double *potc, double *potv, int *convert_index, int potflag, int flag);
void mr3calccoulomb_vdw_ci_exlist_(int *n, double x[], double q[], int atype[], int *nat, double force[], double *rscale, double gscalesf[], double gscalesp[], double rscales[], int *tblno, int *numex, int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], double *potc, double *potv, int *convert_index, int *potflag, int *flag);
void MR3calccoulomb_ci(int n, double x[], double q[], double force[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calccoulomb_ci_(int *n, double x[], double q[], double force[], double *rscale, int *tblno, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_ij_ci(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_ij_ci_old(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calcvdw_ij_ci(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_virial(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut_org, double skinnb, double volume[3], int ldim[3], double virial[3][3], int flag);
void MR3calccoulomb_vdw_ij_ci(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calccoulomb_vdw_ij_ci_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscales[], double rscales[], double *rscale, int *tblnoc, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_old_09(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_old_090121(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_exlist(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3], int numex[], int natex[], int flag);
void mr3calccoulomb_vdw_ij_ci_exlist_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscales[], double rscales[], double *rscale, int *tblnoc, double *rcut, double *skinnb, double volume[3], int ldim[3], int numex[], int natex[], int *flag);
void MR3_get_board_version(int *version, int *freq);
void MR3_rscale_and_pack(int n, double (*x)[3], int *atype, longlong (*rj)[2]);
void MR3_rscale_and_pack_old(int n, double (*x)[3], int *atype, longlong (*rj)[2]);
void MR3SetTable_emu(char *filename, int tblno, int flag);
int MR3_get_total_num_chips(void);
void MR3print_chip_temperature(int flag);
int MR3_get_retry_count(void);
void m3_free_unit(VG_UNIT *unit);
VG_UNIT *m3_allocate_periodic_unit(const char *fname, int mode, double size, int dum);
void m3_set_positions(VG_UNIT *unit, double (*pos)[3], int n);
void m3_set_charges(VG_UNIT *unit, const double *q, int n);
void m3_set_cells(VG_UNIT *unit, M3_CELL *cell, int ncell);
void m3_calculate_forces(VG_UNIT *unit, double (*xi)[3], int ni, double (*force)[3]);
void m3_calculate_potentials(VG_UNIT *unit, double (*xi)[3], int ni, double *eng);
void m3_set_types(VG_UNIT *unit, const int *atype, int n);
void m3_set_pipeline_types(VG_UNIT *unit, const int *atype, int n);
void m3_set_charge_matrix(VG_UNIT *unit, const double *gscale, int nati, int natj);
void m3_set_rscale_matrix(VG_UNIT *unit, const double *rscale, int nati, int natj);
int MR3_close_ch(int s_sock);
int mr3_close_ch_(int *s_sock);
int MR3_open_port(int port_number);
int MR3_sock_read(int sockfd, char *buf, size_t count);
int mr3_sock_read_(int *sockfd, char *buf, int *count);
int mr3_sock_read__(int *sockfd, char *buf, int *count);
int mr3_sock_read_i_(int *sockfd, int *buf);
int mr3_sock_read_i__(int *sockfd, int *buf);
int MR3_sock_read_iv(int sockfd, int *buf, int count);
int mr3_sock_read_iv_(int *sockfd, int *buf, int *count);
int mr3_sock_read_iv__(int *sockfd, int *buf, int *count);
int MR3_sock_read_d(int sockfd, double *buf);
int mr3_sock_read_d__(int *sockfd, double *buf);
int mr3_sock_read_d_(int *sockfd, double *buf);
int MR3_sock_read_dv(int sockfd, double *buf, int count);
int mr3_sock_read_dv__(int *sockfd, double *buf, int *count);
int mr3_sock_read_dv_(int *sockfd, double *buf, int *count);
int MR3_sock_write(int sockfd, char *buf, size_t count);
int MR3_sock_write_c(int sockfd, char *buf);
int mr3_sock_write_c_(int *sockfd, char *buf);
int mr3_sock_write_c__(int *sockfd, char *buf);
int MR3_sock_write_i(int sockfd, int buf);
int mr3_sock_write_i_(int *sockfd, int *buf);
int mr3_sock_write_i__(int *sockfd, int *buf);
int MR3_sock_write_iv(int sockfd, int *buf, int count);
int mr3_sock_write_iv_(int *sockfd, int *buf, int *count);
int mr3_sock_write_iv__(int *sockfd, int *buf, int *count);
int MR3_sock_write_dv(int sockfd, double *buf, int count);
int mr3_sock_write_dv__(int *sockfd, double *buf, int *count);
int mr3_sock_write_dv_(int *sockfd, double *buf, int *count);
int MR3_sock_gets(int sockfd, char *str, size_t count);
int MR3_sock_puts(int sockfd, char *str);
void MR3_sock_init(int *s_sock_org, int port_num, double x[], int igraph[], int natom, int str_len, int lbres[], int ipres[], int nres);
void mr3_sock_init_(int *s_sock, int *port_num, double x[], int igraph[], int *natom, int *str_len, int lbres[], int ipres[], int *nres);
void mr3_sock_init__(int *s_sock, int *port_num, double x[], int igraph[], int *natom, int *str_len, int lbres[], int ipres[], int *nres);
void MR3_sock_1step(int s_sock, double t1, double time, double t2, int recv_buf[], int natom, double x[], double f[], double f_temp[]);
void mr3_sock_1step_(int *s_sock, double *t1, double *time, double *t2, int recv_buf[], int *natom, double x[], double f[], double f_tmp[]);
void mr3_sock_1step__(int *s_sock, double *t1, double *time, double *t2, int recv_buf[], int *natom, double x[], double f[], double f_tmp[]);
void MR3calc_ij_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, char method);
void MR3calc_ij_exlist_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], char method);
void MR3calc_ij_nlist_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], char method);
/* vtgrape.c */
void *MR3_my_malloc2(size_t n, char *s);
void MR3_my_free2(void **p, char *s);
VG_UNIT *m3_get_unit(void);
void vg_exit(int ret);
VG_UNIT *vg_allocate_unit(void (*function)(void *));
void vg_free_unit(VG_UNIT *unit);
void vg_set_function(VG_UNIT *unit, int function_index, void (*function)(void *));
void vg_set_vectors(VG_UNIT *unit, int nj, void *jvectors);
void vg_set_matrices(VG_UNIT *unit, int nati, int natj, void *matrices);
void vg_set_scalers(VG_UNIT *unit, void *scalers);
void vg_set_pipeline_vectors(VG_UNIT *unit, int ni, void *ivectors);
void vg_calculate(VG_UNIT *unit, int function_index, int nf, void *fvectors, void *pscalers);
void vg_set_vectors_pos_charge_atype(VG_UNIT *unit, int nj, double pos[][3], double charge[], int atype[]);
void vg_set_vectors_pos_charge(VG_UNIT *unit, int nj, double pos[][3], double charge[]);
void vg_set_vectors_pos_atype(VG_UNIT *unit, int nj, double pos[][3], int atype[]);
void vg_set_matrices_gscales_rscales(VG_UNIT *unit, int nati_org, int natj_org, double gscales[], double rscales[]);
void vg_set_pol_sigm_ipotro_pc_pd_zz(VG_UNIT *unit, int nati, int natj, double pol[], double sigm[], double ipotro[], double pc[], double pd[], double zz[]);
void vg_set_scalers_volume_alpha(VG_UNIT *unit, double volume[3], double alpha);
void vg_set_pipeline_vectors_pos_charge_atype(VG_UNIT *unit, int ni, double pos[][3], double charge[], int atype[]);
void vg_set_pipeline_vectors_pos_charge(VG_UNIT *unit, int ni, double pos[][3], double charge[]);
void vg_set_pipeline_vectors_pos_atype(VG_UNIT *unit, int ni, double pos[][3], int atype[]);
void vg_convert_forces(VG_UNIT *unit, int nf, int function_index, double fi[][3]);
void vg_calculate_forces_potentials(VG_UNIT *unit, int function_index, int nf, double fi[][3], double *potc, double *potv);
void vg_get_r1result(int n_org, float r[], float r1[]);
void vg_get_rsqrtresult(int n_org, float r[], float r1[]);
void vg_get_mulresult(int n_org, float r[], float q[], float rq[]);
int vg_write_emufile(int flag);
void vg_initialize_emu(void);
float vg_r1emu(float x);
float vg_rsqrtemu(float x);
void vg_set_scaleq(int n, double q[], double *scaleq, float *scaleq_1);
void m3_set_softening(VG_UNIT *unit, double eps);
void MR3_exit(int ret);
void MR3init(void);
void mr3init_(void);
void mr3init__(void);
void MR3free(void);
void mr3free_(void);
void mr3free__(void);
void MR3calccoulomb(double x[], int n, double q[], double rscale, int tblno, double xmax, int periodicflag, int natchangeflag, double force[]);
void mr3calccoulomb_(double x[], int *n, double q[], double *rscale, int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void mr3calccoulomb__(double x[], int *n, double q[], double *rscale, int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void MR3calccoulomb_ij(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag);
void mr3calccoulomb_ij_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void mr3calccoulomb_ij__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void MR3_sort_with_index_int(int data[], int index[], int left, int right);
void MR3calcvdw_ij_core(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void MR3calcvdw_ij(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void mr3calcvdw_ij_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void mr3calcvdw_ij__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void MR3calcvdw(double x[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int natchangeflag, double force[]);
void mr3calcvdw_(double x[], int *n, int atype[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void mr3calcvdw__(double x[], int *n, int atype[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void MR3calcewald(int *k, int knum_org, double *x, int n, double *chg, double alpha, double epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald__(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void MR3calcnacl(double x[], int n, int atype[], int nat, double pol[], double sigm[], double ipotro[], double pc[], double pd[], double zz[], int tblno, double xmax, int periodicflag, double force[]);
void vtgrape_force(double xj[][3], double mj[], double xi[][3], double eps2, double a[][3], int ni, int nj);
void vg_set_rcut2(VG_UNIT *unit, double rcut2);
void mr3_set_rcut2_(double *rcut2);
int md5sum(unsigned char *buffer, int totallen, unsigned char sum[16]);
int md5sum_file(char *filename, unsigned char sum[16]);
void MR3calccoulomb_ij_host(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag);
void mr3calccoulomb_ij_host_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void mr3calccoulomb_ij_host__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void MR3calcvdw_ij_host(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void mr3calcvdw_ij_host_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void mr3calcvdw_ij_host__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void MR3calccoulomb_nlist_ij_host_notwork(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[], double factorall);
void MR3calccoulomb_nlist_ij_host(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calccoulomb_nlist_host(double xd[], int n, double qd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calcvdw_nlist_ij_host_notwork(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[], double factor);
void MR3calcvdw_nlist_ij_host(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_host2(double x[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[], double factor, double force[]);
void MR3calccoulomb_ij_exlist_host(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void MR3calcvdw_ij_exlist_host(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void MR3calcewald_dft_host(int k[], int knum, double x[], int n, double chg[], double cellsize[3], double bs[], double bc[]);
void MR3calcewald_idft_eng_host(int k[], double bs[], double bc[], int knum, double x[], int n, double cellsize[3], double force[]);
void MR3calcewald_idft_force_host(int k[], double bs[], double bc[], int knum, double x[], int n, double cellsize[3], double force[]);
void MR3calcewald_host(int *k, int knum_org, double *x, int n, double *chg, double alpha, double epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_host__(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_host_(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void MR3SetTable(char *filename, int tblno, int flag);
void mr3settable_nf_(char *fname, int *tblno, int *flag, int *n);
void mr3settable_nf__(char *fname, int *tblno, int *flag, int *n);
void MR3_setup_exlist(int n, int *bckptr);
void mr3_setup_exlist_(int *n, int *bckptr);
void MR3_make_natex2_from_natex(int n, int natex[], int numex[], int **natex_offset, int **natex2, int **numex2, int **natex2_offset, int flag);
void calccoulomb_vdw_ij_exlist_host_sub(int i, int j, double xi[], double xj[], double qj, double gsf, double gsp, double rs, double rscale, double cutoff, double *fc, double *fv, double *pc, double *pv, int tblno, double size[3], int potflag);
void MR3calccoulomb_vdw_ij_exlist_cutoff_host(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double cutoff, double size[3], double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_host(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_host2(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_host_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_host__(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void MR3_get_cputime(double *laptime, double *sprittime);
void MR3_set_ldim(int ldim[3]);
void mr3_set_ldim_(int ldim[3]);
void mr3_set_ldim__(int ldim[3]);
void MR3_set_coulomb_vdw_factor(double cgf);
void mr3_set_coulomb_vdw_factor_(double *cgf);
void mr3_set_coulomb_vdw_factor__(double *cgf);
void MR3calccoulomb_ij_emu(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag);
void MR3calccoulomb_nlist_ij_emu(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calccoulomb_nlist_emu(double xd[], int n, double qd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calcvdw_ij_emu(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void MR3calccoulomb_vdw_nlist_ij_emu(int ni, double xid[], double qid[], int atypei[], double force[], int nj, double xjd[], double qjd[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblno, double volume[], int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_ij_emu(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_emu2(double xd[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calccoulomb_ij_exlist(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void mr3calccoulomb_ij_exlist_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag, int numexorg[], int natexorg[]);
void mr3calccoulomb_ij_exlist__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag, int numexorg[], int natexorg[]);
void MR3calcvdw_ij_exlist(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void mr3calcvdw_ij_exlist_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int numex[], int natex[]);
void mr3calcvdw_ij_exlist__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_core_old(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_core(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_virial_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_exlist(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double volume1, double *potc, double *potv, int *convert_index, int potflag, int flag);
void MR3calccoulomb_vdw_exlist_from_cell(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double volume1, double *potc, double *potv, int *convert_index, int potflag, int flag);
void mr3calccoulomb_vdw_exlist_(int *n, double x[], double q[], int atype[], int *nat, double force[], double *rscale, double gscalesf[], double gscalesp[], double rscales[], int *tblno, int numex[], int natex[], double *volume1, double *potc, double *potv, int *convert_index, int *potflag, int *flag);
void MR3_get_forces_overlap(double force[]);
void mr3_get_forces_overlap_(double force[]);
void MR3_get_potc_and_potv_overlap(double *potc, double *potv);
void mr3_get_potc_and_potv_overlap_(double *potc, double *potv);
void mr3_get_potc_and_potv_overlap__(double *potc, double *potv);
void MR3_get_forces_and_virial_overlap(double force[], double virial[3][3]);
void mr3_get_forces_and_virial_overlap_(double force[], double virial[3][3]);
void MR3calccoulomb_ci_exlist(int n, double x[], double q[], double force[], double rscale, int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], int *convert_index, int flag);
void mr3calccoulomb_ci_exlist_(int *n, double x[], double q[], double force[], double *rscale, int *tblno, int numex[], int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], int *convert_index, int *flag);
void MR3calcvdw_ci(int n, double x[], int atype[], int nat, double force[], double gscales[], double rscales[], int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calcvdw_ci_(int *n, double x[], int atype[], int *nat, double force[], double gscales[], double rscales[], int *tblno, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calcvdw_ci_exlist(int n, double x[], int atype[], int nat, double force[], double gscales[], double rscales[], int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], int *convert_index, int flag);
void mr3calcvdw_ci_exlist_(int *n, double x[], int atype[], int *nat, double force[], double gscales[], double rscales[], int *tblno, int numex[], int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], int *convert_index, int *flag);
void MR3calccoulomb_vdw_ci_exlist(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], double *potc, double *potv, int *convert_index, int potflag, int flag);
void mr3calccoulomb_vdw_ci_exlist_(int *n, double x[], double q[], int atype[], int *nat, double force[], double *rscale, double gscalesf[], double gscalesp[], double rscales[], int *tblno, int *numex, int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], double *potc, double *potv, int *convert_index, int *potflag, int *flag);
void MR3calccoulomb_ci(int n, double x[], double q[], double force[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calccoulomb_ci_(int *n, double x[], double q[], double force[], double *rscale, int *tblno, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_ij_ci(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_ij_ci_old(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calcvdw_ij_ci(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_virial(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut_org, double skinnb, double volume[3], int ldim[3], double virial[3][3], int flag);
void MR3calccoulomb_vdw_ij_ci(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calccoulomb_vdw_ij_ci_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscales[], double rscales[], double *rscale, int *tblnoc, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_old_09(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_old_090121(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_exlist(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3], int numex[], int natex[], int flag);
void mr3calccoulomb_vdw_ij_ci_exlist_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscales[], double rscales[], double *rscale, int *tblnoc, double *rcut, double *skinnb, double volume[3], int ldim[3], int numex[], int natex[], int *flag);
void MR3_get_board_version(int *version, int *freq);
void MR3_rscale_and_pack(int n, double (*x)[3], int *atype, longlong (*rj)[2]);
void MR3_rscale_and_pack_old(int n, double (*x)[3], int *atype, longlong (*rj)[2]);
void MR3SetTable_emu(char *filename, int tblno, int flag);
int MR3_get_total_num_chips(void);
void MR3print_chip_temperature(int flag);
int MR3_get_retry_count(void);
void m3_free_unit(VG_UNIT *unit);
VG_UNIT *m3_allocate_periodic_unit(const char *fname, int mode, double size, int dum);
void m3_set_positions(VG_UNIT *unit, double (*pos)[3], int n);
void m3_set_charges(VG_UNIT *unit, const double *q, int n);
void m3_set_cells(VG_UNIT *unit, M3_CELL *cell, int ncell);
void m3_calculate_forces(VG_UNIT *unit, double (*xi)[3], int ni, double (*force)[3]);
void m3_calculate_potentials(VG_UNIT *unit, double (*xi)[3], int ni, double *eng);
void m3_set_types(VG_UNIT *unit, const int *atype, int n);
void m3_set_pipeline_types(VG_UNIT *unit, const int *atype, int n);
void m3_set_charge_matrix(VG_UNIT *unit, const double *gscale, int nati, int natj);
void m3_set_rscale_matrix(VG_UNIT *unit, const double *rscale, int nati, int natj);
int MR3_close_ch(int s_sock);
int mr3_close_ch_(int *s_sock);
int MR3_open_port(int port_number);
int MR3_sock_read(int sockfd, char *buf, size_t count);
int mr3_sock_read_(int *sockfd, char *buf, int *count);
int mr3_sock_read__(int *sockfd, char *buf, int *count);
int mr3_sock_read_i_(int *sockfd, int *buf);
int mr3_sock_read_i__(int *sockfd, int *buf);
int MR3_sock_read_iv(int sockfd, int *buf, int count);
int mr3_sock_read_iv_(int *sockfd, int *buf, int *count);
int mr3_sock_read_iv__(int *sockfd, int *buf, int *count);
int MR3_sock_read_d(int sockfd, double *buf);
int mr3_sock_read_d__(int *sockfd, double *buf);
int mr3_sock_read_d_(int *sockfd, double *buf);
int MR3_sock_read_dv(int sockfd, double *buf, int count);
int mr3_sock_read_dv__(int *sockfd, double *buf, int *count);
int mr3_sock_read_dv_(int *sockfd, double *buf, int *count);
int MR3_sock_write(int sockfd, char *buf, size_t count);
int MR3_sock_write_c(int sockfd, char *buf);
int mr3_sock_write_c_(int *sockfd, char *buf);
int mr3_sock_write_c__(int *sockfd, char *buf);
int MR3_sock_write_i(int sockfd, int buf);
int mr3_sock_write_i_(int *sockfd, int *buf);
int mr3_sock_write_i__(int *sockfd, int *buf);
int MR3_sock_write_iv(int sockfd, int *buf, int count);
int mr3_sock_write_iv_(int *sockfd, int *buf, int *count);
int mr3_sock_write_iv__(int *sockfd, int *buf, int *count);
int MR3_sock_write_dv(int sockfd, double *buf, int count);
int mr3_sock_write_dv__(int *sockfd, double *buf, int *count);
int mr3_sock_write_dv_(int *sockfd, double *buf, int *count);
int MR3_sock_gets(int sockfd, char *str, size_t count);
int MR3_sock_puts(int sockfd, char *str);
void MR3_sock_init(int *s_sock_org, int port_num, double x[], int igraph[], int natom, int str_len, int lbres[], int ipres[], int nres);
void mr3_sock_init_(int *s_sock, int *port_num, double x[], int igraph[], int *natom, int *str_len, int lbres[], int ipres[], int *nres);
void mr3_sock_init__(int *s_sock, int *port_num, double x[], int igraph[], int *natom, int *str_len, int lbres[], int ipres[], int *nres);
void MR3_sock_1step(int s_sock, double t1, double time, double t2, int recv_buf[], int natom, double x[], double f[], double f_temp[]);
void mr3_sock_1step_(int *s_sock, double *t1, double *time, double *t2, int recv_buf[], int *natom, double x[], double f[], double f_tmp[]);
void mr3_sock_1step__(int *s_sock, double *t1, double *time, double *t2, int recv_buf[], int *natom, double x[], double f[], double f_tmp[]);
void MR3calc_ij_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, char method);
void MR3calc_ij_exlist_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], char method);
void MR3calc_ij_nlist_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], char method);
/* vtgrape.c */
void *MR3_my_malloc2(size_t n, char *s);
void MR3_my_free2(void **p, char *s);
VG_UNIT *m3_get_unit(void);
void vg_exit(int ret);
VG_UNIT *vg_allocate_unit(void (*function)(void *));
void vg_free_unit(VG_UNIT *unit);
void vg_set_function(VG_UNIT *unit, int function_index, void (*function)(void *));
void vg_set_vectors(VG_UNIT *unit, int nj, void *jvectors);
void vg_set_matrices(VG_UNIT *unit, int nati, int natj, void *matrices);
void vg_set_scalers(VG_UNIT *unit, void *scalers);
void vg_set_pipeline_vectors(VG_UNIT *unit, int ni, void *ivectors);
void vg_calculate(VG_UNIT *unit, int function_index, int nf, void *fvectors, void *pscalers);
void vg_set_vectors_pos_charge_atype(VG_UNIT *unit, int nj, double pos[][3], double charge[], int atype[]);
void vg_set_vectors_pos_charge(VG_UNIT *unit, int nj, double pos[][3], double charge[]);
void vg_set_vectors_pos_atype(VG_UNIT *unit, int nj, double pos[][3], int atype[]);
void vg_set_matrices_gscales_rscales(VG_UNIT *unit, int nati_org, int natj_org, double gscales[], double rscales[]);
void vg_set_pol_sigm_ipotro_pc_pd_zz(VG_UNIT *unit, int nati, int natj, double pol[], double sigm[], double ipotro[], double pc[], double pd[], double zz[]);
void vg_set_scalers_volume_alpha(VG_UNIT *unit, double volume[3], double alpha);
void vg_set_pipeline_vectors_pos_charge_atype(VG_UNIT *unit, int ni, double pos[][3], double charge[], int atype[]);
void vg_set_pipeline_vectors_pos_charge(VG_UNIT *unit, int ni, double pos[][3], double charge[]);
void vg_set_pipeline_vectors_pos_atype(VG_UNIT *unit, int ni, double pos[][3], int atype[]);
void vg_convert_forces(VG_UNIT *unit, int nf, int function_index, double fi[][3]);
void vg_calculate_forces_potentials(VG_UNIT *unit, int function_index, int nf, double fi[][3], double *potc, double *potv);
void vg_get_r1result(int n_org, float r[], float r1[]);
void vg_get_rsqrtresult(int n_org, float r[], float r1[]);
void vg_get_mulresult(int n_org, float r[], float q[], float rq[]);
int vg_write_emufile(int flag);
void vg_initialize_emu(void);
float vg_r1emu(float x);
float vg_rsqrtemu(float x);
void vg_set_scaleq(int n, double q[], double *scaleq, float *scaleq_1);
void m3_set_softening(VG_UNIT *unit, double eps);
void MR3_exit(int ret);
void MR3init(void);
void mr3init_(void);
void mr3init__(void);
void MR3free(void);
void mr3free_(void);
void mr3free__(void);
void MR3calccoulomb(double x[], int n, double q[], double rscale, int tblno, double xmax, int periodicflag, int natchangeflag, double force[]);
void mr3calccoulomb_(double x[], int *n, double q[], double *rscale, int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void mr3calccoulomb__(double x[], int *n, double q[], double *rscale, int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void MR3calccoulomb_ij(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag);
void mr3calccoulomb_ij_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void mr3calccoulomb_ij__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void MR3_sort_with_index_int(int data[], int index[], int left, int right);
void MR3calcvdw_ij_core(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void MR3calcvdw_ij(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void mr3calcvdw_ij_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void mr3calcvdw_ij__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void MR3calcvdw(double x[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int natchangeflag, double force[]);
void mr3calcvdw_(double x[], int *n, int atype[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void mr3calcvdw__(double x[], int *n, int atype[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void MR3calcewald(int *k, int knum_org, double *x, int n, double *chg, double alpha, double epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald__(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void MR3calcnacl(double x[], int n, int atype[], int nat, double pol[], double sigm[], double ipotro[], double pc[], double pd[], double zz[], int tblno, double xmax, int periodicflag, double force[]);
void vtgrape_force(double xj[][3], double mj[], double xi[][3], double eps2, double a[][3], int ni, int nj);
void vg_set_rcut2(VG_UNIT *unit, double rcut2);
void mr3_set_rcut2_(double *rcut2);
int md5sum(unsigned char *buffer, int totallen, unsigned char sum[16]);
int md5sum_file(char *filename, unsigned char sum[16]);
void MR3calccoulomb_ij_host(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag);
void mr3calccoulomb_ij_host_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void mr3calccoulomb_ij_host__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void MR3calcvdw_ij_host(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void mr3calcvdw_ij_host_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void mr3calcvdw_ij_host__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void MR3calccoulomb_nlist_ij_host_notwork(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[], double factorall);
void MR3calccoulomb_nlist_ij_host(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calccoulomb_nlist_host(double xd[], int n, double qd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calcvdw_nlist_ij_host_notwork(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[], double factor);
void MR3calcvdw_nlist_ij_host(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_host2(double x[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[], double factor, double force[]);
void MR3calccoulomb_ij_exlist_host(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void MR3calcvdw_ij_exlist_host(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void MR3calcewald_dft_host(int k[], int knum, double x[], int n, double chg[], double cellsize[3], double bs[], double bc[]);
void MR3calcewald_idft_eng_host(int k[], double bs[], double bc[], int knum, double x[], int n, double cellsize[3], double force[]);
void MR3calcewald_idft_force_host(int k[], double bs[], double bc[], int knum, double x[], int n, double cellsize[3], double force[]);
void MR3calcewald_host(int *k, int knum_org, double *x, int n, double *chg, double alpha, double epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_host__(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_host_(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void MR3SetTable(char *filename, int tblno, int flag);
void mr3settable_nf_(char *fname, int *tblno, int *flag, int *n);
void mr3settable_nf__(char *fname, int *tblno, int *flag, int *n);
void MR3_setup_exlist(int n, int *bckptr);
void mr3_setup_exlist_(int *n, int *bckptr);
void MR3_make_natex2_from_natex(int n, int natex[], int numex[], int **natex_offset, int **natex2, int **numex2, int **natex2_offset, int flag);
void calccoulomb_vdw_ij_exlist_host_sub(int i, int j, double xi[], double xj[], double qj, double gsf, double gsp, double rs, double rscale, double cutoff, double *fc, double *fv, double *pc, double *pv, int tblno, double size[3], int potflag);
void MR3calccoulomb_vdw_ij_exlist_cutoff_host(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double cutoff, double size[3], double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_host(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_host2(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_host_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_host__(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void MR3_get_cputime(double *laptime, double *sprittime);
void MR3_set_ldim(int ldim[3]);
void mr3_set_ldim_(int ldim[3]);
void mr3_set_ldim__(int ldim[3]);
void MR3_set_coulomb_vdw_factor(double cgf);
void mr3_set_coulomb_vdw_factor_(double *cgf);
void mr3_set_coulomb_vdw_factor__(double *cgf);
void MR3calccoulomb_ij_emu(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag);
void MR3calccoulomb_nlist_ij_emu(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calccoulomb_nlist_emu(double xd[], int n, double qd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calcvdw_ij_emu(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void MR3calccoulomb_vdw_nlist_ij_emu(int ni, double xid[], double qid[], int atypei[], double force[], int nj, double xjd[], double qjd[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblno, double volume[], int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_ij_emu(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_emu2(double xd[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calccoulomb_ij_exlist(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void mr3calccoulomb_ij_exlist_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag, int numexorg[], int natexorg[]);
void mr3calccoulomb_ij_exlist__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag, int numexorg[], int natexorg[]);
void MR3calcvdw_ij_exlist(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void mr3calcvdw_ij_exlist_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int numex[], int natex[]);
void mr3calcvdw_ij_exlist__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_core_old(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_core(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_virial_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_exlist(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double volume1, double *potc, double *potv, int *convert_index, int potflag, int flag);
void MR3calccoulomb_vdw_exlist_from_cell(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double volume1, double *potc, double *potv, int *convert_index, int potflag, int flag);
void mr3calccoulomb_vdw_exlist_(int *n, double x[], double q[], int atype[], int *nat, double force[], double *rscale, double gscalesf[], double gscalesp[], double rscales[], int *tblno, int numex[], int natex[], double *volume1, double *potc, double *potv, int *convert_index, int *potflag, int *flag);
void MR3_get_forces_overlap(double force[]);
void mr3_get_forces_overlap_(double force[]);
void MR3_get_potc_and_potv_overlap(double *potc, double *potv);
void mr3_get_potc_and_potv_overlap_(double *potc, double *potv);
void mr3_get_potc_and_potv_overlap__(double *potc, double *potv);
void MR3_get_forces_and_virial_overlap(double force[], double virial[3][3]);
void mr3_get_forces_and_virial_overlap_(double force[], double virial[3][3]);
void MR3calccoulomb_ci_exlist(int n, double x[], double q[], double force[], double rscale, int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], int *convert_index, int flag);
void mr3calccoulomb_ci_exlist_(int *n, double x[], double q[], double force[], double *rscale, int *tblno, int numex[], int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], int *convert_index, int *flag);
void MR3calcvdw_ci(int n, double x[], int atype[], int nat, double force[], double gscales[], double rscales[], int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calcvdw_ci_(int *n, double x[], int atype[], int *nat, double force[], double gscales[], double rscales[], int *tblno, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calcvdw_ci_exlist(int n, double x[], int atype[], int nat, double force[], double gscales[], double rscales[], int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], int *convert_index, int flag);
void mr3calcvdw_ci_exlist_(int *n, double x[], int atype[], int *nat, double force[], double gscales[], double rscales[], int *tblno, int numex[], int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], int *convert_index, int *flag);
void MR3calccoulomb_vdw_ci_exlist(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], double *potc, double *potv, int *convert_index, int potflag, int flag);
void mr3calccoulomb_vdw_ci_exlist_(int *n, double x[], double q[], int atype[], int *nat, double force[], double *rscale, double gscalesf[], double gscalesp[], double rscales[], int *tblno, int *numex, int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], double *potc, double *potv, int *convert_index, int *potflag, int *flag);
void MR3calccoulomb_ci(int n, double x[], double q[], double force[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calccoulomb_ci_(int *n, double x[], double q[], double force[], double *rscale, int *tblno, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_ij_ci(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_ij_ci_old(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calcvdw_ij_ci(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_virial(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut_org, double skinnb, double volume[3], int ldim[3], double virial[3][3], int flag);
void MR3calccoulomb_vdw_ij_ci(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calccoulomb_vdw_ij_ci_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscales[], double rscales[], double *rscale, int *tblnoc, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_old_09(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_old_090121(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_exlist(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3], int numex[], int natex[], int flag);
void mr3calccoulomb_vdw_ij_ci_exlist_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscales[], double rscales[], double *rscale, int *tblnoc, double *rcut, double *skinnb, double volume[3], int ldim[3], int numex[], int natex[], int *flag);
void MR3_get_board_version(int *version, int *freq);
void MR3_rscale_and_pack(int n, double (*x)[3], int *atype, longlong (*rj)[2]);
void MR3_rscale_and_pack_old(int n, double (*x)[3], int *atype, longlong (*rj)[2]);
void MR3SetTable_emu(char *filename, int tblno, int flag);
int MR3_get_total_num_chips(void);
void MR3print_chip_temperature(int flag);
int MR3_get_retry_count(void);
void m3_free_unit(VG_UNIT *unit);
VG_UNIT *m3_allocate_periodic_unit(const char *fname, int mode, double size, int dum);
void m3_set_positions(VG_UNIT *unit, double (*pos)[3], int n);
void m3_set_charges(VG_UNIT *unit, const double *q, int n);
void m3_set_cells(VG_UNIT *unit, M3_CELL *cell, int ncell);
void m3_calculate_forces(VG_UNIT *unit, double (*xi)[3], int ni, double (*force)[3]);
void m3_calculate_potentials(VG_UNIT *unit, double (*xi)[3], int ni, double *eng);
void m3_set_types(VG_UNIT *unit, const int *atype, int n);
void m3_set_pipeline_types(VG_UNIT *unit, const int *atype, int n);
void m3_set_charge_matrix(VG_UNIT *unit, const double *gscale, int nati, int natj);
void m3_set_rscale_matrix(VG_UNIT *unit, const double *rscale, int nati, int natj);
int MR3_close_ch(int s_sock);
int mr3_close_ch_(int *s_sock);
int MR3_open_port(int port_number);
int MR3_sock_read(int sockfd, char *buf, size_t count);
int mr3_sock_read_(int *sockfd, char *buf, int *count);
int mr3_sock_read__(int *sockfd, char *buf, int *count);
int mr3_sock_read_i_(int *sockfd, int *buf);
int mr3_sock_read_i__(int *sockfd, int *buf);
int MR3_sock_read_iv(int sockfd, int *buf, int count);
int mr3_sock_read_iv_(int *sockfd, int *buf, int *count);
int mr3_sock_read_iv__(int *sockfd, int *buf, int *count);
int MR3_sock_read_d(int sockfd, double *buf);
int mr3_sock_read_d__(int *sockfd, double *buf);
int mr3_sock_read_d_(int *sockfd, double *buf);
int MR3_sock_read_dv(int sockfd, double *buf, int count);
int mr3_sock_read_dv__(int *sockfd, double *buf, int *count);
int mr3_sock_read_dv_(int *sockfd, double *buf, int *count);
int MR3_sock_write(int sockfd, char *buf, size_t count);
int MR3_sock_write_c(int sockfd, char *buf);
int mr3_sock_write_c_(int *sockfd, char *buf);
int mr3_sock_write_c__(int *sockfd, char *buf);
int MR3_sock_write_i(int sockfd, int buf);
int mr3_sock_write_i_(int *sockfd, int *buf);
int mr3_sock_write_i__(int *sockfd, int *buf);
int MR3_sock_write_iv(int sockfd, int *buf, int count);
int mr3_sock_write_iv_(int *sockfd, int *buf, int *count);
int mr3_sock_write_iv__(int *sockfd, int *buf, int *count);
int MR3_sock_write_dv(int sockfd, double *buf, int count);
int mr3_sock_write_dv__(int *sockfd, double *buf, int *count);
int mr3_sock_write_dv_(int *sockfd, double *buf, int *count);
int MR3_sock_gets(int sockfd, char *str, size_t count);
int MR3_sock_puts(int sockfd, char *str);
void MR3_sock_init(int *s_sock_org, int port_num, double x[], int igraph[], int natom, int str_len, int lbres[], int ipres[], int nres);
void mr3_sock_init_(int *s_sock, int *port_num, double x[], int igraph[], int *natom, int *str_len, int lbres[], int ipres[], int *nres);
void mr3_sock_init__(int *s_sock, int *port_num, double x[], int igraph[], int *natom, int *str_len, int lbres[], int ipres[], int *nres);
void MR3_sock_1step(int s_sock, double t1, double time, double t2, int recv_buf[], int natom, double x[], double f[], double f_temp[]);
void mr3_sock_1step_(int *s_sock, double *t1, double *time, double *t2, int recv_buf[], int *natom, double x[], double f[], double f_tmp[]);
void mr3_sock_1step__(int *s_sock, double *t1, double *time, double *t2, int recv_buf[], int *natom, double x[], double f[], double f_tmp[]);
void MR3calc_ij_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, char method);
void MR3calc_ij_exlist_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], char method);
void MR3calc_ij_nlist_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], char method);
/* vtgrape.c */
void *MR3_my_malloc2(size_t n, char *s);
void MR3_my_free2(void **p, char *s);
VG_UNIT *m3_get_unit(void);
void vg_exit(int ret);
VG_UNIT *vg_allocate_unit(void (*function)(void *));
void vg_free_unit(VG_UNIT *unit);
void vg_set_function(VG_UNIT *unit, int function_index, void (*function)(void *));
void vg_set_vectors(VG_UNIT *unit, int nj, void *jvectors);
void vg_set_matrices(VG_UNIT *unit, int nati, int natj, void *matrices);
void vg_set_scalers(VG_UNIT *unit, void *scalers);
void vg_set_pipeline_vectors(VG_UNIT *unit, int ni, void *ivectors);
void vg_calculate(VG_UNIT *unit, int function_index, int nf, void *fvectors, void *pscalers);
void vg_set_vectors_pos_charge_atype(VG_UNIT *unit, int nj, double pos[][3], double charge[], int atype[]);
void vg_set_vectors_pos_charge(VG_UNIT *unit, int nj, double pos[][3], double charge[]);
void vg_set_vectors_pos_atype(VG_UNIT *unit, int nj, double pos[][3], int atype[]);
void vg_set_matrices_gscales_rscales(VG_UNIT *unit, int nati_org, int natj_org, double gscales[], double rscales[]);
void vg_set_pol_sigm_ipotro_pc_pd_zz(VG_UNIT *unit, int nati, int natj, double pol[], double sigm[], double ipotro[], double pc[], double pd[], double zz[]);
void vg_set_scalers_volume_alpha(VG_UNIT *unit, double volume[3], double alpha);
void vg_set_pipeline_vectors_pos_charge_atype(VG_UNIT *unit, int ni, double pos[][3], double charge[], int atype[]);
void vg_set_pipeline_vectors_pos_charge(VG_UNIT *unit, int ni, double pos[][3], double charge[]);
void vg_set_pipeline_vectors_pos_atype(VG_UNIT *unit, int ni, double pos[][3], int atype[]);
void vg_convert_forces(VG_UNIT *unit, int nf, int function_index, double fi[][3]);
void vg_calculate_forces_potentials(VG_UNIT *unit, int function_index, int nf, double fi[][3], double *potc, double *potv);
void vg_get_r1result(int n_org, float r[], float r1[]);
void vg_get_rsqrtresult(int n_org, float r[], float r1[]);
void vg_get_mulresult(int n_org, float r[], float q[], float rq[]);
int vg_write_emufile(int flag);
void vg_initialize_emu(void);
float vg_r1emu(float x);
float vg_rsqrtemu(float x);
void vg_set_scaleq(int n, double q[], double *scaleq, float *scaleq_1);
void m3_set_softening(VG_UNIT *unit, double eps);
void MR3_exit(int ret);
void MR3init(void);
void mr3init_(void);
void mr3init__(void);
void MR3free(void);
void mr3free_(void);
void mr3free__(void);
void MR3calccoulomb(double x[], int n, double q[], double rscale, int tblno, double xmax, int periodicflag, int natchangeflag, double force[]);
void mr3calccoulomb_(double x[], int *n, double q[], double *rscale, int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void mr3calccoulomb__(double x[], int *n, double q[], double *rscale, int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void MR3calccoulomb_ij(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag);
void mr3calccoulomb_ij_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void mr3calccoulomb_ij__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void MR3_sort_with_index_int(int data[], int index[], int left, int right);
void MR3calcvdw_ij_core(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void MR3calcvdw_ij(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void mr3calcvdw_ij_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void mr3calcvdw_ij__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void MR3calcvdw(double x[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int natchangeflag, double force[]);
void mr3calcvdw_(double x[], int *n, int atype[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void mr3calcvdw__(double x[], int *n, int atype[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void MR3calcewald(int *k, int knum_org, double *x, int n, double *chg, double alpha, double epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald__(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void MR3calcnacl(double x[], int n, int atype[], int nat, double pol[], double sigm[], double ipotro[], double pc[], double pd[], double zz[], int tblno, double xmax, int periodicflag, double force[]);
void vtgrape_force(double xj[][3], double mj[], double xi[][3], double eps2, double a[][3], int ni, int nj);
void vg_set_rcut2(VG_UNIT *unit, double rcut2);
void mr3_set_rcut2_(double *rcut2);
int md5sum(unsigned char *buffer, int totallen, unsigned char sum[16]);
int md5sum_file(char *filename, unsigned char sum[16]);
void MR3_get_cputime(double *laptime, double *sprittime);
void MR3_set_ldim(int ldim[3]);
void mr3_set_ldim_(int ldim[3]);
void mr3_set_ldim__(int ldim[3]);
void MR3_set_coulomb_vdw_factor(double cgf);
void mr3_set_coulomb_vdw_factor_(double *cgf);
void mr3_set_coulomb_vdw_factor__(double *cgf);
void MR3calccoulomb_ij_emu(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag);
void MR3calccoulomb_nlist_ij_emu(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calccoulomb_nlist_emu(double xd[], int n, double qd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calcvdw_ij_emu(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void MR3calccoulomb_vdw_nlist_ij_emu(int ni, double xid[], double qid[], int atypei[], double force[], int nj, double xjd[], double qjd[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblno, double volume[], int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_ij_emu(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_emu2(double xd[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calccoulomb_ij_exlist(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void mr3calccoulomb_ij_exlist_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag, int numexorg[], int natexorg[]);
void mr3calccoulomb_ij_exlist__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag, int numexorg[], int natexorg[]);
void MR3calcvdw_ij_exlist(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void mr3calcvdw_ij_exlist_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int numex[], int natex[]);
void mr3calcvdw_ij_exlist__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_core_old(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_core(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_virial_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_exlist(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double volume1, double *potc, double *potv, int *convert_index, int potflag, int flag);
void MR3calccoulomb_vdw_exlist_from_cell(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double volume1, double *potc, double *potv, int *convert_index, int potflag, int flag);
void mr3calccoulomb_vdw_exlist_(int *n, double x[], double q[], int atype[], int *nat, double force[], double *rscale, double gscalesf[], double gscalesp[], double rscales[], int *tblno, int numex[], int natex[], double *volume1, double *potc, double *potv, int *convert_index, int *potflag, int *flag);
void MR3_get_forces_overlap(double force[]);
void mr3_get_forces_overlap_(double force[]);
void MR3_get_potc_and_potv_overlap(double *potc, double *potv);
void mr3_get_potc_and_potv_overlap_(double *potc, double *potv);
void mr3_get_potc_and_potv_overlap__(double *potc, double *potv);
void MR3_get_forces_and_virial_overlap(double force[], double virial[3][3]);
void mr3_get_forces_and_virial_overlap_(double force[], double virial[3][3]);
void MR3calccoulomb_ci_exlist(int n, double x[], double q[], double force[], double rscale, int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], int *convert_index, int flag);
void mr3calccoulomb_ci_exlist_(int *n, double x[], double q[], double force[], double *rscale, int *tblno, int numex[], int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], int *convert_index, int *flag);
void MR3calcvdw_ci(int n, double x[], int atype[], int nat, double force[], double gscales[], double rscales[], int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calcvdw_ci_(int *n, double x[], int atype[], int *nat, double force[], double gscales[], double rscales[], int *tblno, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calcvdw_ci_exlist(int n, double x[], int atype[], int nat, double force[], double gscales[], double rscales[], int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], int *convert_index, int flag);
void mr3calcvdw_ci_exlist_(int *n, double x[], int atype[], int *nat, double force[], double gscales[], double rscales[], int *tblno, int numex[], int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], int *convert_index, int *flag);
void MR3calccoulomb_vdw_ci_exlist(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], double *potc, double *potv, int *convert_index, int potflag, int flag);
void mr3calccoulomb_vdw_ci_exlist_(int *n, double x[], double q[], int atype[], int *nat, double force[], double *rscale, double gscalesf[], double gscalesp[], double rscales[], int *tblno, int *numex, int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], double *potc, double *potv, int *convert_index, int *potflag, int *flag);
void MR3calccoulomb_ci(int n, double x[], double q[], double force[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calccoulomb_ci_(int *n, double x[], double q[], double force[], double *rscale, int *tblno, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_ij_ci(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_ij_ci_old(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calcvdw_ij_ci(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_virial(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut_org, double skinnb, double volume[3], int ldim[3], double virial[3][3], int flag);
void MR3calccoulomb_vdw_ij_ci(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calccoulomb_vdw_ij_ci_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscales[], double rscales[], double *rscale, int *tblnoc, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_old_09(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_old_090121(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_exlist(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3], int numex[], int natex[], int flag);
void mr3calccoulomb_vdw_ij_ci_exlist_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscales[], double rscales[], double *rscale, int *tblnoc, double *rcut, double *skinnb, double volume[3], int ldim[3], int numex[], int natex[], int *flag);
void MR3calccoulomb_ij_host(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag);
void mr3calccoulomb_ij_host_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void mr3calccoulomb_ij_host__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void MR3calcvdw_ij_host(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void mr3calcvdw_ij_host_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void mr3calcvdw_ij_host__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void MR3calccoulomb_nlist_ij_host_notwork(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[], double factorall);
void MR3calccoulomb_nlist_ij_host(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calccoulomb_nlist_host(double xd[], int n, double qd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calcvdw_nlist_ij_host_notwork(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[], double factor);
void MR3calcvdw_nlist_ij_host(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_host2(double x[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[], double factor, double force[]);
void MR3calccoulomb_ij_exlist_host(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void MR3calcvdw_ij_exlist_host(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void MR3calcewald_dft_host(int k[], int knum, double x[], int n, double chg[], double cellsize[3], double bs[], double bc[]);
void MR3calcewald_idft_eng_host(int k[], double bs[], double bc[], int knum, double x[], int n, double cellsize[3], double force[]);
void MR3calcewald_idft_force_host(int k[], double bs[], double bc[], int knum, double x[], int n, double cellsize[3], double force[]);
void MR3calcewald_host(int *k, int knum_org, double *x, int n, double *chg, double alpha, double epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_host__(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_host_(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void MR3SetTable(char *filename, int tblno, int flag);
void mr3settable_nf_(char *fname, int *tblno, int *flag, int *n);
void mr3settable_nf__(char *fname, int *tblno, int *flag, int *n);
void MR3_setup_exlist(int n, int *bckptr);
void mr3_setup_exlist_(int *n, int *bckptr);
void MR3_make_natex2_from_natex(int n, int natex[], int numex[], int **natex_offset, int **natex2, int **numex2, int **natex2_offset, int flag);
void calccoulomb_vdw_ij_exlist_host_sub(int i, int j, double xi[], double xj[], double qj, double gsf, double gsp, double rs, double rscale, double cutoff, double *fc, double *fv, double *pc, double *pv, int tblno, double size[3], int potflag);
void MR3calccoulomb_vdw_ij_exlist_cutoff_host(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double cutoff, double size[3], double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_host(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_host2(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_host_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_host__(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void MR3_get_board_version(int *version, int *freq);
void MR3_rscale_and_pack(int n, double (*x)[3], int *atype, longlong (*rj)[2]);
void MR3_rscale_and_pack_old(int n, double (*x)[3], int *atype, longlong (*rj)[2]);
void MR3SetTable_emu(char *filename, int tblno, int flag);
int MR3_get_total_num_chips(void);
void MR3print_chip_temperature(int flag);
int MR3_get_retry_count(void);
void m3_free_unit(VG_UNIT *unit);
VG_UNIT *m3_allocate_periodic_unit(const char *fname, int mode, double size, int dum);
void m3_set_positions(VG_UNIT *unit, double (*pos)[3], int n);
void m3_set_charges(VG_UNIT *unit, const double *q, int n);
void m3_set_cells(VG_UNIT *unit, M3_CELL *cell, int ncell);
void m3_calculate_forces(VG_UNIT *unit, double (*xi)[3], int ni, double (*force)[3]);
void m3_calculate_potentials(VG_UNIT *unit, double (*xi)[3], int ni, double *eng);
void m3_set_types(VG_UNIT *unit, const int *atype, int n);
void m3_set_pipeline_types(VG_UNIT *unit, const int *atype, int n);
void m3_set_charge_matrix(VG_UNIT *unit, const double *gscale, int nati, int natj);
void m3_set_rscale_matrix(VG_UNIT *unit, const double *rscale, int nati, int natj);
int MR3_close_ch(int s_sock);
int mr3_close_ch_(int *s_sock);
int MR3_open_port(int port_number);
int MR3_sock_read(int sockfd, char *buf, size_t count);
int mr3_sock_read_(int *sockfd, char *buf, int *count);
int mr3_sock_read__(int *sockfd, char *buf, int *count);
int mr3_sock_read_i_(int *sockfd, int *buf);
int mr3_sock_read_i__(int *sockfd, int *buf);
int MR3_sock_read_iv(int sockfd, int *buf, int count);
int mr3_sock_read_iv_(int *sockfd, int *buf, int *count);
int mr3_sock_read_iv__(int *sockfd, int *buf, int *count);
int MR3_sock_read_d(int sockfd, double *buf);
int mr3_sock_read_d__(int *sockfd, double *buf);
int mr3_sock_read_d_(int *sockfd, double *buf);
int MR3_sock_read_dv(int sockfd, double *buf, int count);
int mr3_sock_read_dv__(int *sockfd, double *buf, int *count);
int mr3_sock_read_dv_(int *sockfd, double *buf, int *count);
int MR3_sock_write(int sockfd, char *buf, size_t count);
int MR3_sock_write_c(int sockfd, char *buf);
int mr3_sock_write_c_(int *sockfd, char *buf);
int mr3_sock_write_c__(int *sockfd, char *buf);
int MR3_sock_write_i(int sockfd, int buf);
int mr3_sock_write_i_(int *sockfd, int *buf);
int mr3_sock_write_i__(int *sockfd, int *buf);
int MR3_sock_write_iv(int sockfd, int *buf, int count);
int mr3_sock_write_iv_(int *sockfd, int *buf, int *count);
int mr3_sock_write_iv__(int *sockfd, int *buf, int *count);
int MR3_sock_write_dv(int sockfd, double *buf, int count);
int mr3_sock_write_dv__(int *sockfd, double *buf, int *count);
int mr3_sock_write_dv_(int *sockfd, double *buf, int *count);
int MR3_sock_gets(int sockfd, char *str, size_t count);
int MR3_sock_puts(int sockfd, char *str);
void MR3_sock_init(int *s_sock_org, int port_num, double x[], int igraph[], int natom, int str_len, int lbres[], int ipres[], int nres);
void mr3_sock_init_(int *s_sock, int *port_num, double x[], int igraph[], int *natom, int *str_len, int lbres[], int ipres[], int *nres);
void mr3_sock_init__(int *s_sock, int *port_num, double x[], int igraph[], int *natom, int *str_len, int lbres[], int ipres[], int *nres);
void MR3_sock_1step(int s_sock, double t1, double time, double t2, int recv_buf[], int natom, double x[], double f[], double f_temp[]);
void mr3_sock_1step_(int *s_sock, double *t1, double *time, double *t2, int recv_buf[], int *natom, double x[], double f[], double f_tmp[]);
void mr3_sock_1step__(int *s_sock, double *t1, double *time, double *t2, int recv_buf[], int *natom, double x[], double f[], double f_tmp[]);
void MR3calc_ij_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, char method);
void MR3calc_ij_exlist_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], char method);
void MR3calc_ij_nlist_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], char method);
/* vtgrape.c */
void *MR3_my_malloc2(size_t n, char *s);
void MR3_my_free2(void **p, char *s);
VG_UNIT *m3_get_unit(void);
void vg_exit(int ret);
VG_UNIT *vg_allocate_unit(void (*function)(void *));
void vg_free_unit(VG_UNIT *unit);
void vg_set_function(VG_UNIT *unit, int function_index, void (*function)(void *));
void vg_set_vectors(VG_UNIT *unit, int nj, void *jvectors);
void vg_set_matrices(VG_UNIT *unit, int nati, int natj, void *matrices);
void vg_set_scalers(VG_UNIT *unit, void *scalers);
void vg_set_pipeline_vectors(VG_UNIT *unit, int ni, void *ivectors);
void vg_calculate(VG_UNIT *unit, int function_index, int nf, void *fvectors, void *pscalers);
void vg_set_vectors_pos_charge_atype(VG_UNIT *unit, int nj, double pos[][3], double charge[], int atype[]);
void vg_set_vectors_pos_charge(VG_UNIT *unit, int nj, double pos[][3], double charge[]);
void vg_set_vectors_pos_atype(VG_UNIT *unit, int nj, double pos[][3], int atype[]);
void vg_set_matrices_gscales_rscales(VG_UNIT *unit, int nati_org, int natj_org, double gscales[], double rscales[]);
void vg_set_pol_sigm_ipotro_pc_pd_zz(VG_UNIT *unit, int nati, int natj, double pol[], double sigm[], double ipotro[], double pc[], double pd[], double zz[]);
void vg_set_scalers_volume_alpha(VG_UNIT *unit, double volume[3], double alpha);
void vg_set_pipeline_vectors_pos_charge_atype(VG_UNIT *unit, int ni, double pos[][3], double charge[], int atype[]);
void vg_set_pipeline_vectors_pos_charge(VG_UNIT *unit, int ni, double pos[][3], double charge[]);
void vg_set_pipeline_vectors_pos_atype(VG_UNIT *unit, int ni, double pos[][3], int atype[]);
void vg_convert_forces(VG_UNIT *unit, int nf, int function_index, double fi[][3]);
void vg_calculate_forces_potentials(VG_UNIT *unit, int function_index, int nf, double fi[][3], double *potc, double *potv);
void vg_get_r1result(int n_org, float r[], float r1[]);
void vg_get_rsqrtresult(int n_org, float r[], float r1[]);
void vg_get_mulresult(int n_org, float r[], float q[], float rq[]);
int vg_write_emufile(int flag);
void vg_initialize_emu(void);
float vg_r1emu(float x);
float vg_rsqrtemu(float x);
void vg_set_scaleq(int n, double q[], double *scaleq, float *scaleq_1);
void m3_set_softening(VG_UNIT *unit, double eps);
void MR3_exit(int ret);
void MR3init(void);
void mr3init_(void);
void mr3init__(void);
void MR3free(void);
void mr3free_(void);
void mr3free__(void);
void MR3calccoulomb(double x[], int n, double q[], double rscale, int tblno, double xmax, int periodicflag, int natchangeflag, double force[]);
void mr3calccoulomb_(double x[], int *n, double q[], double *rscale, int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void mr3calccoulomb__(double x[], int *n, double q[], double *rscale, int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void MR3calccoulomb_ij(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag);
void mr3calccoulomb_ij_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void mr3calccoulomb_ij__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void MR3_sort_with_index_int(int data[], int index[], int left, int right);
void MR3calcvdw_ij_core(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void MR3calcvdw_ij(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void mr3calcvdw_ij_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void mr3calcvdw_ij__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void MR3calcvdw(double x[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int natchangeflag, double force[]);
void mr3calcvdw_(double x[], int *n, int atype[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void mr3calcvdw__(double x[], int *n, int atype[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void MR3calcewald(int *k, int knum_org, double *x, int n, double *chg, double alpha, double epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald__(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void MR3calcnacl(double x[], int n, int atype[], int nat, double pol[], double sigm[], double ipotro[], double pc[], double pd[], double zz[], int tblno, double xmax, int periodicflag, double force[]);
void vtgrape_force(double xj[][3], double mj[], double xi[][3], double eps2, double a[][3], int ni, int nj);
void vg_set_rcut2(VG_UNIT *unit, double rcut2);
void mr3_set_rcut2_(double *rcut2);
int md5sum(unsigned char *buffer, int totallen, unsigned char sum[16]);
int md5sum_file(char *filename, unsigned char sum[16]);
void MR3_get_cputime(double *laptime, double *sprittime);
void MR3_set_ldim(int ldim[3]);
void mr3_set_ldim_(int ldim[3]);
void mr3_set_ldim__(int ldim[3]);
void MR3_set_coulomb_vdw_factor(double cgf);
void mr3_set_coulomb_vdw_factor_(double *cgf);
void mr3_set_coulomb_vdw_factor__(double *cgf);
void MR3calccoulomb_ij_emu(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag);
void MR3calccoulomb_nlist_ij_emu(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calccoulomb_nlist_emu(double xd[], int n, double qd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calcvdw_ij_emu(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void MR3calccoulomb_vdw_nlist_ij_emu(int ni, double xid[], double qid[], int atypei[], double force[], int nj, double xjd[], double qjd[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblno, double volume[], int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_ij_emu(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_emu2(double xd[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calccoulomb_ij_exlist(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void mr3calccoulomb_ij_exlist_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag, int numexorg[], int natexorg[]);
void mr3calccoulomb_ij_exlist__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag, int numexorg[], int natexorg[]);
void MR3calcvdw_ij_exlist(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void mr3calcvdw_ij_exlist_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int numex[], int natex[]);
void mr3calcvdw_ij_exlist__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_core_old(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_core(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_virial_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_exlist(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double volume1, double *potc, double *potv, int *convert_index, int potflag, int flag);
void MR3calccoulomb_vdw_exlist_from_cell(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double volume1, double *potc, double *potv, int *convert_index, int potflag, int flag);
void mr3calccoulomb_vdw_exlist_(int *n, double x[], double q[], int atype[], int *nat, double force[], double *rscale, double gscalesf[], double gscalesp[], double rscales[], int *tblno, int numex[], int natex[], double *volume1, double *potc, double *potv, int *convert_index, int *potflag, int *flag);
void MR3_get_forces_overlap(double force[]);
void mr3_get_forces_overlap_(double force[]);
void MR3_get_potc_and_potv_overlap(double *potc, double *potv);
void mr3_get_potc_and_potv_overlap_(double *potc, double *potv);
void mr3_get_potc_and_potv_overlap__(double *potc, double *potv);
void MR3_get_forces_and_virial_overlap(double force[], double virial[3][3]);
void mr3_get_forces_and_virial_overlap_(double force[], double virial[3][3]);
void MR3calccoulomb_ci_exlist(int n, double x[], double q[], double force[], double rscale, int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], int *convert_index, int flag);
void mr3calccoulomb_ci_exlist_(int *n, double x[], double q[], double force[], double *rscale, int *tblno, int numex[], int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], int *convert_index, int *flag);
void MR3calcvdw_ci(int n, double x[], int atype[], int nat, double force[], double gscales[], double rscales[], int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calcvdw_ci_(int *n, double x[], int atype[], int *nat, double force[], double gscales[], double rscales[], int *tblno, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calcvdw_ci_exlist(int n, double x[], int atype[], int nat, double force[], double gscales[], double rscales[], int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], int *convert_index, int flag);
void mr3calcvdw_ci_exlist_(int *n, double x[], int atype[], int *nat, double force[], double gscales[], double rscales[], int *tblno, int numex[], int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], int *convert_index, int *flag);
void MR3calccoulomb_vdw_ci_exlist(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], double *potc, double *potv, int *convert_index, int potflag, int flag);
void mr3calccoulomb_vdw_ci_exlist_(int *n, double x[], double q[], int atype[], int *nat, double force[], double *rscale, double gscalesf[], double gscalesp[], double rscales[], int *tblno, int *numex, int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], double *potc, double *potv, int *convert_index, int *potflag, int *flag);
void MR3calccoulomb_ci(int n, double x[], double q[], double force[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calccoulomb_ci_(int *n, double x[], double q[], double force[], double *rscale, int *tblno, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_ij_ci(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_ij_ci_old(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calcvdw_ij_ci(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_virial(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut_org, double skinnb, double volume[3], int ldim[3], double virial[3][3], int flag);
void MR3calccoulomb_vdw_ij_ci(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calccoulomb_vdw_ij_ci_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscales[], double rscales[], double *rscale, int *tblnoc, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_old_09(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_old_090121(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_exlist(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3], int numex[], int natex[], int flag);
void mr3calccoulomb_vdw_ij_ci_exlist_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscales[], double rscales[], double *rscale, int *tblnoc, double *rcut, double *skinnb, double volume[3], int ldim[3], int numex[], int natex[], int *flag);
void MR3calccoulomb_ij_host(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag);
void mr3calccoulomb_ij_host_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void mr3calccoulomb_ij_host__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void MR3calcvdw_ij_host(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void mr3calcvdw_ij_host_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void mr3calcvdw_ij_host__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void MR3calccoulomb_nlist_ij_host_notwork(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[], double factorall);
void MR3calccoulomb_nlist_ij_host(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calccoulomb_nlist_host(double xd[], int n, double qd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calcvdw_nlist_ij_host_notwork(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[], double factor);
void MR3calcvdw_nlist_ij_host(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_host2(double x[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[], double factor, double force[]);
void MR3calccoulomb_ij_exlist_host(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void MR3calcvdw_ij_exlist_host(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void MR3calcewald_dft_host(int k[], int knum, double x[], int n, double chg[], double cellsize[3], double bs[], double bc[]);
void MR3calcewald_idft_eng_host(int k[], double bs[], double bc[], int knum, double x[], int n, double cellsize[3], double force[]);
void MR3calcewald_idft_force_host(int k[], double bs[], double bc[], int knum, double x[], int n, double cellsize[3], double force[]);
void MR3calcewald_host(int *k, int knum_org, double *x, int n, double *chg, double alpha, double epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_host__(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_host_(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void MR3SetTable(char *filename, int tblno, int flag);
void mr3settable_nf_(char *fname, int *tblno, int *flag, int *n);
void mr3settable_nf__(char *fname, int *tblno, int *flag, int *n);
void MR3_setup_exlist(int n, int *bckptr);
void mr3_setup_exlist_(int *n, int *bckptr);
void MR3_make_natex2_from_natex(int n, int natex[], int numex[], int **natex_offset, int **natex2, int **numex2, int **natex2_offset, int flag);
void calccoulomb_vdw_ij_exlist_host_sub(int i, int j, double xi[], double xj[], double qj, double gsf, double gsp, double rs, double rscale, double cutoff, double *fc, double *fv, double *pc, double *pv, int tblno, double size[3], int potflag);
void MR3calccoulomb_vdw_ij_exlist_cutoff_host(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double cutoff, double size[3], double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_host(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_host2(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_host_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_host__(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void MR3_get_board_version(int *version, int *freq);
void MR3_rscale_and_pack(int n, double (*x)[3], int *atype, longlong (*rj)[2]);
void MR3_rscale_and_pack_old(int n, double (*x)[3], int *atype, longlong (*rj)[2]);
void MR3SetTable_emu(char *filename, int tblno, int flag);
int MR3_get_total_num_chips(void);
void MR3print_chip_temperature(int flag);
int MR3_get_retry_count(void);
void m3_free_unit(VG_UNIT *unit);
VG_UNIT *m3_allocate_periodic_unit(const char *fname, int mode, double size, int dum);
void m3_set_positions(VG_UNIT *unit, double (*pos)[3], int n);
void m3_set_charges(VG_UNIT *unit, const double *q, int n);
void m3_set_cells(VG_UNIT *unit, M3_CELL *cell, int ncell);
void m3_calculate_forces(VG_UNIT *unit, double (*xi)[3], int ni, double (*force)[3]);
void m3_calculate_potentials(VG_UNIT *unit, double (*xi)[3], int ni, double *eng);
void m3_set_types(VG_UNIT *unit, const int *atype, int n);
void m3_set_pipeline_types(VG_UNIT *unit, const int *atype, int n);
void m3_set_charge_matrix(VG_UNIT *unit, const double *gscale, int nati, int natj);
void m3_set_rscale_matrix(VG_UNIT *unit, const double *rscale, int nati, int natj);
int MR3_close_ch(int s_sock);
int mr3_close_ch_(int *s_sock);
int MR3_open_port(int port_number);
int MR3_sock_read(int sockfd, char *buf, size_t count);
int mr3_sock_read_(int *sockfd, char *buf, int *count);
int mr3_sock_read__(int *sockfd, char *buf, int *count);
int mr3_sock_read_i_(int *sockfd, int *buf);
int mr3_sock_read_i__(int *sockfd, int *buf);
int MR3_sock_read_iv(int sockfd, int *buf, int count);
int mr3_sock_read_iv_(int *sockfd, int *buf, int *count);
int mr3_sock_read_iv__(int *sockfd, int *buf, int *count);
int MR3_sock_read_d(int sockfd, double *buf);
int mr3_sock_read_d__(int *sockfd, double *buf);
int mr3_sock_read_d_(int *sockfd, double *buf);
int MR3_sock_read_dv(int sockfd, double *buf, int count);
int mr3_sock_read_dv__(int *sockfd, double *buf, int *count);
int mr3_sock_read_dv_(int *sockfd, double *buf, int *count);
int MR3_sock_write(int sockfd, char *buf, size_t count);
int MR3_sock_write_c(int sockfd, char *buf);
int mr3_sock_write_c_(int *sockfd, char *buf);
int mr3_sock_write_c__(int *sockfd, char *buf);
int MR3_sock_write_i(int sockfd, int buf);
int mr3_sock_write_i_(int *sockfd, int *buf);
int mr3_sock_write_i__(int *sockfd, int *buf);
int MR3_sock_write_iv(int sockfd, int *buf, int count);
int mr3_sock_write_iv_(int *sockfd, int *buf, int *count);
int mr3_sock_write_iv__(int *sockfd, int *buf, int *count);
int MR3_sock_write_dv(int sockfd, double *buf, int count);
int mr3_sock_write_dv__(int *sockfd, double *buf, int *count);
int mr3_sock_write_dv_(int *sockfd, double *buf, int *count);
int MR3_sock_gets(int sockfd, char *str, size_t count);
int MR3_sock_puts(int sockfd, char *str);
void MR3_sock_init(int *s_sock_org, int port_num, double x[], int igraph[], int natom, int str_len, int lbres[], int ipres[], int nres);
void mr3_sock_init_(int *s_sock, int *port_num, double x[], int igraph[], int *natom, int *str_len, int lbres[], int ipres[], int *nres);
void mr3_sock_init__(int *s_sock, int *port_num, double x[], int igraph[], int *natom, int *str_len, int lbres[], int ipres[], int *nres);
void MR3_sock_1step(int s_sock, double t1, double time, double t2, int recv_buf[], int natom, double x[], double f[], double f_temp[]);
void mr3_sock_1step_(int *s_sock, double *t1, double *time, double *t2, int recv_buf[], int *natom, double x[], double f[], double f_tmp[]);
void mr3_sock_1step__(int *s_sock, double *t1, double *time, double *t2, int recv_buf[], int *natom, double x[], double f[], double f_tmp[]);
void MR3calc_ij_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, char method);
void MR3calc_ij_exlist_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], char method);
void MR3calc_ij_nlist_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], char method);
/* vtgrape.c */
void *MR3_my_malloc2(size_t n, char *s);
void MR3_my_free2(void **p, char *s);
VG_UNIT *m3_get_unit(void);
void vg_exit(int ret);
VG_UNIT *vg_allocate_unit(void (*function)(void *));
void vg_free_unit(VG_UNIT *unit);
void vg_set_function(VG_UNIT *unit, int function_index, void (*function)(void *));
void vg_set_vectors(VG_UNIT *unit, int nj, void *jvectors);
void vg_set_matrices(VG_UNIT *unit, int nati, int natj, void *matrices);
void vg_set_scalers(VG_UNIT *unit, void *scalers);
void vg_set_pipeline_vectors(VG_UNIT *unit, int ni, void *ivectors);
void vg_calculate(VG_UNIT *unit, int function_index, int nf, void *fvectors, void *pscalers);
void vg_set_vectors_pos_charge_atype(VG_UNIT *unit, int nj, double pos[][3], double charge[], int atype[]);
void vg_set_vectors_pos_charge(VG_UNIT *unit, int nj, double pos[][3], double charge[]);
void vg_set_vectors_pos_atype(VG_UNIT *unit, int nj, double pos[][3], int atype[]);
void vg_set_matrices_gscales_rscales(VG_UNIT *unit, int nati_org, int natj_org, double gscales[], double rscales[]);
void vg_set_pol_sigm_ipotro_pc_pd_zz(VG_UNIT *unit, int nati, int natj, double pol[], double sigm[], double ipotro[], double pc[], double pd[], double zz[]);
void vg_set_scalers_volume_alpha(VG_UNIT *unit, double volume[3], double alpha);
void vg_set_pipeline_vectors_pos_charge_atype(VG_UNIT *unit, int ni, double pos[][3], double charge[], int atype[]);
void vg_set_pipeline_vectors_pos_charge(VG_UNIT *unit, int ni, double pos[][3], double charge[]);
void vg_set_pipeline_vectors_pos_atype(VG_UNIT *unit, int ni, double pos[][3], int atype[]);
void vg_convert_forces(VG_UNIT *unit, int nf, int function_index, double fi[][3]);
void vg_calculate_forces_potentials(VG_UNIT *unit, int function_index, int nf, double fi[][3], double *potc, double *potv);
void vg_get_r1result(int n_org, float r[], float r1[]);
void vg_get_rsqrtresult(int n_org, float r[], float r1[]);
void vg_get_mulresult(int n_org, float r[], float q[], float rq[]);
int vg_write_emufile(int flag);
void vg_initialize_emu(void);
float vg_r1emu(float x);
float vg_rsqrtemu(float x);
void vg_set_scaleq(int n, double q[], double *scaleq, float *scaleq_1);
void m3_set_softening(VG_UNIT *unit, double eps);
void MR3_exit(int ret);
void MR3init(void);
void mr3init_(void);
void mr3init__(void);
void MR3free(void);
void mr3free_(void);
void mr3free__(void);
void MR3calccoulomb(double x[], int n, double q[], double rscale, int tblno, double xmax, int periodicflag, int natchangeflag, double force[]);
void mr3calccoulomb_(double x[], int *n, double q[], double *rscale, int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void mr3calccoulomb__(double x[], int *n, double q[], double *rscale, int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void MR3calccoulomb_ij(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag);
void mr3calccoulomb_ij_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void mr3calccoulomb_ij__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void MR3_sort_with_index_int(int data[], int index[], int left, int right);
void MR3calcvdw_ij_core(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void MR3calcvdw_ij(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void mr3calcvdw_ij_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void mr3calcvdw_ij__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void MR3calcvdw(double x[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int natchangeflag, double force[]);
void mr3calcvdw_(double x[], int *n, int atype[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void mr3calcvdw__(double x[], int *n, int atype[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void MR3calcewald(int *k, int knum_org, double *x, int n, double *chg, double alpha, double epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald__(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void MR3calcnacl(double x[], int n, int atype[], int nat, double pol[], double sigm[], double ipotro[], double pc[], double pd[], double zz[], int tblno, double xmax, int periodicflag, double force[]);
void vtgrape_force(double xj[][3], double mj[], double xi[][3], double eps2, double a[][3], int ni, int nj);
void vg_set_rcut2(VG_UNIT *unit, double rcut2);
void mr3_set_rcut2_(double *rcut2);
int md5sum(unsigned char *buffer, int totallen, unsigned char sum[16]);
int md5sum_file(char *filename, unsigned char sum[16]);
void MR3_get_cputime(double *laptime, double *sprittime);
void MR3_set_ldim(int ldim[3]);
void mr3_set_ldim_(int ldim[3]);
void mr3_set_ldim__(int ldim[3]);
void MR3_set_coulomb_vdw_factor(double cgf);
void mr3_set_coulomb_vdw_factor_(double *cgf);
void mr3_set_coulomb_vdw_factor__(double *cgf);
void MR3calccoulomb_ij_emu(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag);
void MR3calccoulomb_nlist_ij_emu(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calccoulomb_nlist_emu(double xd[], int n, double qd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calcvdw_ij_emu(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void MR3calccoulomb_vdw_nlist_ij_emu(int ni, double xid[], double qid[], int atypei[], double force[], int nj, double xjd[], double qjd[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblno, double volume[], int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_ij_emu(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_emu2(double xd[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calccoulomb_ij_exlist(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void mr3calccoulomb_ij_exlist_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag, int numexorg[], int natexorg[]);
void mr3calccoulomb_ij_exlist__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag, int numexorg[], int natexorg[]);
void MR3calcvdw_ij_exlist(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void mr3calcvdw_ij_exlist_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int numex[], int natex[]);
void mr3calcvdw_ij_exlist__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_core_old(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_core(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_virial_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_exlist(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double volume1, double *potc, double *potv, int *convert_index, int potflag, int flag);
void MR3calccoulomb_vdw_exlist_from_cell(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double volume1, double *potc, double *potv, int *convert_index, int potflag, int flag);
void mr3calccoulomb_vdw_exlist_(int *n, double x[], double q[], int atype[], int *nat, double force[], double *rscale, double gscalesf[], double gscalesp[], double rscales[], int *tblno, int numex[], int natex[], double *volume1, double *potc, double *potv, int *convert_index, int *potflag, int *flag);
void MR3_get_forces_overlap(double force[]);
void mr3_get_forces_overlap_(double force[]);
void MR3_get_potc_and_potv_overlap(double *potc, double *potv);
void mr3_get_potc_and_potv_overlap_(double *potc, double *potv);
void mr3_get_potc_and_potv_overlap__(double *potc, double *potv);
void MR3_get_forces_and_virial_overlap(double force[], double virial[3][3]);
void mr3_get_forces_and_virial_overlap_(double force[], double virial[3][3]);
void MR3calccoulomb_ci_exlist(int n, double x[], double q[], double force[], double rscale, int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], int *convert_index, int flag);
void mr3calccoulomb_ci_exlist_(int *n, double x[], double q[], double force[], double *rscale, int *tblno, int numex[], int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], int *convert_index, int *flag);
void MR3calcvdw_ci(int n, double x[], int atype[], int nat, double force[], double gscales[], double rscales[], int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calcvdw_ci_(int *n, double x[], int atype[], int *nat, double force[], double gscales[], double rscales[], int *tblno, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calcvdw_ci_exlist(int n, double x[], int atype[], int nat, double force[], double gscales[], double rscales[], int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], int *convert_index, int flag);
void mr3calcvdw_ci_exlist_(int *n, double x[], int atype[], int *nat, double force[], double gscales[], double rscales[], int *tblno, int numex[], int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], int *convert_index, int *flag);
void MR3calccoulomb_vdw_ci_exlist(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], double *potc, double *potv, int *convert_index, int potflag, int flag);
void mr3calccoulomb_vdw_ci_exlist_(int *n, double x[], double q[], int atype[], int *nat, double force[], double *rscale, double gscalesf[], double gscalesp[], double rscales[], int *tblno, int *numex, int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], double *potc, double *potv, int *convert_index, int *potflag, int *flag);
void MR3calccoulomb_ci(int n, double x[], double q[], double force[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calccoulomb_ci_(int *n, double x[], double q[], double force[], double *rscale, int *tblno, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_ij_ci(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_ij_ci_old(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calcvdw_ij_ci(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_virial(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut_org, double skinnb, double volume[3], int ldim[3], double virial[3][3], int flag);
void MR3calccoulomb_vdw_ij_ci(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calccoulomb_vdw_ij_ci_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscales[], double rscales[], double *rscale, int *tblnoc, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_old_09(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_old_090121(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_exlist(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3], int numex[], int natex[], int flag);
void mr3calccoulomb_vdw_ij_ci_exlist_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscales[], double rscales[], double *rscale, int *tblnoc, double *rcut, double *skinnb, double volume[3], int ldim[3], int numex[], int natex[], int *flag);
void MR3calccoulomb_ij_host(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag);
void mr3calccoulomb_ij_host_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void mr3calccoulomb_ij_host__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void MR3calcvdw_ij_host(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void mr3calcvdw_ij_host_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void mr3calcvdw_ij_host__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void MR3calccoulomb_nlist_ij_host_notwork(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[], double factorall);
void MR3calccoulomb_nlist_ij_host(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calccoulomb_nlist_host(double xd[], int n, double qd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calcvdw_nlist_ij_host_notwork(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[], double factor);
void MR3calcvdw_nlist_ij_host(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_host2(double x[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[], double factor, double force[]);
void MR3calccoulomb_ij_exlist_host(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void MR3calcvdw_ij_exlist_host(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void MR3calcewald_dft_host(int k[], int knum, double x[], int n, double chg[], double cellsize[3], double bs[], double bc[]);
void MR3calcewald_idft_eng_host(int k[], double bs[], double bc[], int knum, double x[], int n, double cellsize[3], double force[]);
void MR3calcewald_idft_force_host(int k[], double bs[], double bc[], int knum, double x[], int n, double cellsize[3], double force[]);
void MR3calcewald_host(int *k, int knum_org, double *x, int n, double *chg, double alpha, double epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_host__(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_host_(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void MR3SetTable(char *filename, int tblno, int flag);
void mr3settable_nf_(char *fname, int *tblno, int *flag, int *n);
void mr3settable_nf__(char *fname, int *tblno, int *flag, int *n);
void MR3_setup_exlist(int n, int *bckptr);
void mr3_setup_exlist_(int *n, int *bckptr);
void MR3_make_natex2_from_natex(int n, int natex[], int numex[], int **natex_offset, int **natex2, int **numex2, int **natex2_offset, int flag);
void calccoulomb_vdw_ij_exlist_host_sub(int i, int j, double xi[], double xj[], double qj, double gsf, double gsp, double rs, double rscale, double cutoff, double *fc, double *fv, double *pc, double *pv, int tblno, double size[3], int potflag);
void MR3calccoulomb_vdw_ij_exlist_cutoff_host(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double cutoff, double size[3], double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_host(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_host2(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_host_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_host__(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void MR3_get_board_version(int *version, int *freq);
void MR3_rscale_and_pack(int n, double (*x)[3], int *atype, longlong (*rj)[2]);
void MR3_rscale_and_pack_old(int n, double (*x)[3], int *atype, longlong (*rj)[2]);
void MR3SetTable_emu(char *filename, int tblno, int flag);
int MR3_get_total_num_chips(void);
void MR3print_chip_temperature(int flag);
int MR3_get_retry_count(void);
void m3_free_unit(VG_UNIT *unit);
VG_UNIT *m3_allocate_periodic_unit(const char *fname, int mode, double size, int dum);
void m3_set_positions(VG_UNIT *unit, double (*pos)[3], int n);
void m3_set_charges(VG_UNIT *unit, const double *q, int n);
void m3_set_cells(VG_UNIT *unit, M3_CELL *cell, int ncell);
void m3_calculate_forces(VG_UNIT *unit, double (*xi)[3], int ni, double (*force)[3]);
void m3_calculate_potentials(VG_UNIT *unit, double (*xi)[3], int ni, double *eng);
void m3_set_types(VG_UNIT *unit, const int *atype, int n);
void m3_set_pipeline_types(VG_UNIT *unit, const int *atype, int n);
void m3_set_charge_matrix(VG_UNIT *unit, const double *gscale, int nati, int natj);
void m3_set_rscale_matrix(VG_UNIT *unit, const double *rscale, int nati, int natj);
int MR3_close_ch(int s_sock);
int mr3_close_ch_(int *s_sock);
int MR3_open_port(int port_number);
int MR3_sock_read(int sockfd, char *buf, size_t count);
int mr3_sock_read_(int *sockfd, char *buf, int *count);
int mr3_sock_read__(int *sockfd, char *buf, int *count);
int mr3_sock_read_i_(int *sockfd, int *buf);
int mr3_sock_read_i__(int *sockfd, int *buf);
int MR3_sock_read_iv(int sockfd, int *buf, int count);
int mr3_sock_read_iv_(int *sockfd, int *buf, int *count);
int mr3_sock_read_iv__(int *sockfd, int *buf, int *count);
int MR3_sock_read_d(int sockfd, double *buf);
int mr3_sock_read_d__(int *sockfd, double *buf);
int mr3_sock_read_d_(int *sockfd, double *buf);
int MR3_sock_read_dv(int sockfd, double *buf, int count);
int mr3_sock_read_dv__(int *sockfd, double *buf, int *count);
int mr3_sock_read_dv_(int *sockfd, double *buf, int *count);
int MR3_sock_write(int sockfd, char *buf, size_t count);
int MR3_sock_write_c(int sockfd, char *buf);
int mr3_sock_write_c_(int *sockfd, char *buf);
int mr3_sock_write_c__(int *sockfd, char *buf);
int MR3_sock_write_i(int sockfd, int buf);
int mr3_sock_write_i_(int *sockfd, int *buf);
int mr3_sock_write_i__(int *sockfd, int *buf);
int MR3_sock_write_iv(int sockfd, int *buf, int count);
int mr3_sock_write_iv_(int *sockfd, int *buf, int *count);
int mr3_sock_write_iv__(int *sockfd, int *buf, int *count);
int MR3_sock_write_dv(int sockfd, double *buf, int count);
int mr3_sock_write_dv__(int *sockfd, double *buf, int *count);
int mr3_sock_write_dv_(int *sockfd, double *buf, int *count);
int MR3_sock_gets(int sockfd, char *str, size_t count);
int MR3_sock_puts(int sockfd, char *str);
void MR3_sock_init(int *s_sock_org, int port_num, double x[], int igraph[], int natom, int str_len, int lbres[], int ipres[], int nres);
void mr3_sock_init_(int *s_sock, int *port_num, double x[], int igraph[], int *natom, int *str_len, int lbres[], int ipres[], int *nres);
void mr3_sock_init__(int *s_sock, int *port_num, double x[], int igraph[], int *natom, int *str_len, int lbres[], int ipres[], int *nres);
void MR3_sock_1step(int s_sock, double t1, double time, double t2, int recv_buf[], int natom, double x[], double f[], double f_temp[]);
void mr3_sock_1step_(int *s_sock, double *t1, double *time, double *t2, int recv_buf[], int *natom, double x[], double f[], double f_tmp[]);
void mr3_sock_1step__(int *s_sock, double *t1, double *time, double *t2, int recv_buf[], int *natom, double x[], double f[], double f_tmp[]);
void MR3calc_ij_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, char method);
void MR3calc_ij_exlist_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], char method);
void MR3calc_ij_nlist_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], char method);
/* vtgrape.c */
void *MR3_my_malloc2(size_t n, char *s);
void MR3_my_free2(void **p, char *s);
VG_UNIT *m3_get_unit(void);
void vg_exit(int ret);
VG_UNIT *vg_allocate_unit(void (*function)(void *));
void vg_free_unit(VG_UNIT *unit);
void vg_set_function(VG_UNIT *unit, int function_index, void (*function)(void *));
void vg_set_vectors(VG_UNIT *unit, int nj, void *jvectors);
void vg_set_matrices(VG_UNIT *unit, int nati, int natj, void *matrices);
void vg_set_scalers(VG_UNIT *unit, void *scalers);
void vg_set_pipeline_vectors(VG_UNIT *unit, int ni, void *ivectors);
void vg_calculate(VG_UNIT *unit, int function_index, int nf, void *fvectors, void *pscalers);
void vg_set_vectors_pos_charge_atype(VG_UNIT *unit, int nj, double pos[][3], double charge[], int atype[]);
void vg_set_vectors_pos_charge(VG_UNIT *unit, int nj, double pos[][3], double charge[]);
void vg_set_vectors_pos_atype(VG_UNIT *unit, int nj, double pos[][3], int atype[]);
void vg_set_matrices_gscales_rscales(VG_UNIT *unit, int nati_org, int natj_org, double gscales[], double rscales[]);
void vg_set_pol_sigm_ipotro_pc_pd_zz(VG_UNIT *unit, int nati, int natj, double pol[], double sigm[], double ipotro[], double pc[], double pd[], double zz[]);
void vg_set_scalers_volume_alpha(VG_UNIT *unit, double volume[3], double alpha);
void vg_set_pipeline_vectors_pos_charge_atype(VG_UNIT *unit, int ni, double pos[][3], double charge[], int atype[]);
void vg_set_pipeline_vectors_pos_charge(VG_UNIT *unit, int ni, double pos[][3], double charge[]);
void vg_set_pipeline_vectors_pos_atype(VG_UNIT *unit, int ni, double pos[][3], int atype[]);
void vg_convert_forces(VG_UNIT *unit, int nf, int function_index, double fi[][3]);
void vg_calculate_forces_potentials(VG_UNIT *unit, int function_index, int nf, double fi[][3], double *potc, double *potv);
void vg_get_r1result(int n_org, float r[], float r1[]);
void vg_get_rsqrtresult(int n_org, float r[], float r1[]);
void vg_get_mulresult(int n_org, float r[], float q[], float rq[]);
int vg_write_emufile(int flag);
void vg_initialize_emu(void);
float vg_r1emu(float x);
float vg_rsqrtemu(float x);
void vg_set_scaleq(int n, double q[], double *scaleq, float *scaleq_1);
void m3_set_softening(VG_UNIT *unit, double eps);
void MR3_exit(int ret);
void MR3init(void);
void mr3init_(void);
void mr3init__(void);
void MR3free(void);
void mr3free_(void);
void mr3free__(void);
void MR3calccoulomb(double x[], int n, double q[], double rscale, int tblno, double xmax, int periodicflag, int natchangeflag, double force[]);
void mr3calccoulomb_(double x[], int *n, double q[], double *rscale, int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void mr3calccoulomb__(double x[], int *n, double q[], double *rscale, int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void MR3calccoulomb_ij(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag);
void mr3calccoulomb_ij_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void mr3calccoulomb_ij__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void MR3_sort_with_index_int(int data[], int index[], int left, int right);
void MR3calcvdw_ij_core(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void MR3calcvdw_ij(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void mr3calcvdw_ij_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void mr3calcvdw_ij__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void MR3calcvdw(double x[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int natchangeflag, double force[]);
void mr3calcvdw_(double x[], int *n, int atype[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void mr3calcvdw__(double x[], int *n, int atype[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void MR3calcewald(int *k, int knum_org, double *x, int n, double *chg, double alpha, double epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald__(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void MR3calcnacl(double x[], int n, int atype[], int nat, double pol[], double sigm[], double ipotro[], double pc[], double pd[], double zz[], int tblno, double xmax, int periodicflag, double force[]);
void vtgrape_force(double xj[][3], double mj[], double xi[][3], double eps2, double a[][3], int ni, int nj);
void vg_set_rcut2(VG_UNIT *unit, double rcut2);
void mr3_set_rcut2_(double *rcut2);
int md5sum(unsigned char *buffer, int totallen, unsigned char sum[16]);
int md5sum_file(char *filename, unsigned char sum[16]);
void MR3_get_cputime(double *laptime, double *sprittime);
void MR3_set_ldim(int ldim[3]);
void mr3_set_ldim_(int ldim[3]);
void mr3_set_ldim__(int ldim[3]);
void MR3_set_coulomb_vdw_factor(double cgf);
void mr3_set_coulomb_vdw_factor_(double *cgf);
void mr3_set_coulomb_vdw_factor__(double *cgf);
void MR3calccoulomb_ij_emu(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag);
void MR3calccoulomb_nlist_ij_emu(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calccoulomb_nlist_emu(double xd[], int n, double qd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calcvdw_ij_emu(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void MR3calccoulomb_vdw_nlist_ij_emu(int ni, double xid[], double qid[], int atypei[], double force[], int nj, double xjd[], double qjd[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblno, double volume[], int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_ij_emu(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_emu2(double xd[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calccoulomb_ij_exlist(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void mr3calccoulomb_ij_exlist_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag, int numexorg[], int natexorg[]);
void mr3calccoulomb_ij_exlist__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag, int numexorg[], int natexorg[]);
void MR3calcvdw_ij_exlist(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void mr3calcvdw_ij_exlist_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int numex[], int natex[]);
void mr3calcvdw_ij_exlist__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_core_old(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_core(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_virial_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_exlist(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double volume1, double *potc, double *potv, int *convert_index, int potflag, int flag);
void MR3calccoulomb_vdw_exlist_from_cell(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double volume1, double *potc, double *potv, int *convert_index, int potflag, int flag);
void mr3calccoulomb_vdw_exlist_(int *n, double x[], double q[], int atype[], int *nat, double force[], double *rscale, double gscalesf[], double gscalesp[], double rscales[], int *tblno, int numex[], int natex[], double *volume1, double *potc, double *potv, int *convert_index, int *potflag, int *flag);
void MR3_get_forces_overlap(double force[]);
void mr3_get_forces_overlap_(double force[]);
void MR3_get_potc_and_potv_overlap(double *potc, double *potv);
void mr3_get_potc_and_potv_overlap_(double *potc, double *potv);
void mr3_get_potc_and_potv_overlap__(double *potc, double *potv);
void MR3_get_forces_and_virial_overlap(double force[], double virial[3][3]);
void mr3_get_forces_and_virial_overlap_(double force[], double virial[3][3]);
void MR3calccoulomb_ci_exlist(int n, double x[], double q[], double force[], double rscale, int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], int *convert_index, int flag);
void mr3calccoulomb_ci_exlist_(int *n, double x[], double q[], double force[], double *rscale, int *tblno, int numex[], int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], int *convert_index, int *flag);
void MR3calcvdw_ci(int n, double x[], int atype[], int nat, double force[], double gscales[], double rscales[], int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calcvdw_ci_(int *n, double x[], int atype[], int *nat, double force[], double gscales[], double rscales[], int *tblno, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calcvdw_ci_exlist(int n, double x[], int atype[], int nat, double force[], double gscales[], double rscales[], int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], int *convert_index, int flag);
void mr3calcvdw_ci_exlist_(int *n, double x[], int atype[], int *nat, double force[], double gscales[], double rscales[], int *tblno, int numex[], int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], int *convert_index, int *flag);
void MR3calccoulomb_vdw_ci_exlist(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], double *potc, double *potv, int *convert_index, int potflag, int flag);
void mr3calccoulomb_vdw_ci_exlist_(int *n, double x[], double q[], int atype[], int *nat, double force[], double *rscale, double gscalesf[], double gscalesp[], double rscales[], int *tblno, int *numex, int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], double *potc, double *potv, int *convert_index, int *potflag, int *flag);
void MR3calccoulomb_ci(int n, double x[], double q[], double force[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calccoulomb_ci_(int *n, double x[], double q[], double force[], double *rscale, int *tblno, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_ij_ci(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_ij_ci_old(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calcvdw_ij_ci(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_virial(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut_org, double skinnb, double volume[3], int ldim[3], double virial[3][3], int flag);
void MR3calccoulomb_vdw_ij_ci(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calccoulomb_vdw_ij_ci_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscales[], double rscales[], double *rscale, int *tblnoc, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_old_09(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_old_090121(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_exlist(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3], int numex[], int natex[], int flag);
void mr3calccoulomb_vdw_ij_ci_exlist_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscales[], double rscales[], double *rscale, int *tblnoc, double *rcut, double *skinnb, double volume[3], int ldim[3], int numex[], int natex[], int *flag);
void MR3calccoulomb_ij_host(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag);
void mr3calccoulomb_ij_host_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void mr3calccoulomb_ij_host__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void MR3calcvdw_ij_host(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void mr3calcvdw_ij_host_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void mr3calcvdw_ij_host__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void MR3calccoulomb_nlist_ij_host_notwork(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[], double factorall);
void MR3calccoulomb_nlist_ij_host(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calccoulomb_nlist_host(double xd[], int n, double qd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calcvdw_nlist_ij_host_notwork(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[], double factor);
void MR3calcvdw_nlist_ij_host(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_host2(double x[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[], double factor, double force[]);
void MR3calccoulomb_ij_exlist_host(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void MR3calcvdw_ij_exlist_host(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void MR3calcewald_dft_host(int k[], int knum, double x[], int n, double chg[], double cellsize[3], double bs[], double bc[]);
void MR3calcewald_idft_eng_host(int k[], double bs[], double bc[], int knum, double x[], int n, double cellsize[3], double force[]);
void MR3calcewald_idft_force_host(int k[], double bs[], double bc[], int knum, double x[], int n, double cellsize[3], double force[]);
void MR3calcewald_host(int *k, int knum_org, double *x, int n, double *chg, double alpha, double epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_host__(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_host_(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void MR3SetTable(char *filename, int tblno, int flag);
void mr3settable_nf_(char *fname, int *tblno, int *flag, int *n);
void mr3settable_nf__(char *fname, int *tblno, int *flag, int *n);
void MR3_setup_exlist(int n, int *bckptr);
void mr3_setup_exlist_(int *n, int *bckptr);
void MR3_make_natex2_from_natex(int n, int natex[], int numex[], int **natex_offset, int **natex2, int **numex2, int **natex2_offset, int flag);
void calccoulomb_vdw_ij_exlist_host_sub(int i, int j, double xi[], double xj[], double qj, double gsf, double gsp, double rs, double rscale, double cutoff, double *fc, double *fv, double *pc, double *pv, int tblno, double size[3], int potflag);
void MR3calccoulomb_vdw_ij_exlist_cutoff_host(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double cutoff, double size[3], double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_host(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_host2(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_host_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_host__(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void MR3_get_board_version(int *version, int *freq);
void MR3_rscale_and_pack(int n, double (*x)[3], int *atype, longlong (*rj)[2]);
void MR3_rscale_and_pack_old(int n, double (*x)[3], int *atype, longlong (*rj)[2]);
void MR3SetTable_emu(char *filename, int tblno, int flag);
int MR3_get_total_num_chips(void);
void MR3print_chip_temperature(int flag);
int MR3_get_retry_count(void);
void m3_free_unit(VG_UNIT *unit);
VG_UNIT *m3_allocate_periodic_unit(const char *fname, int mode, double size, int dum);
void m3_set_positions(VG_UNIT *unit, double (*pos)[3], int n);
void m3_set_charges(VG_UNIT *unit, const double *q, int n);
void m3_set_cells(VG_UNIT *unit, M3_CELL *cell, int ncell);
void m3_calculate_forces(VG_UNIT *unit, double (*xi)[3], int ni, double (*force)[3]);
void m3_calculate_potentials(VG_UNIT *unit, double (*xi)[3], int ni, double *eng);
void m3_set_types(VG_UNIT *unit, const int *atype, int n);
void m3_set_pipeline_types(VG_UNIT *unit, const int *atype, int n);
void m3_set_charge_matrix(VG_UNIT *unit, const double *gscale, int nati, int natj);
void m3_set_rscale_matrix(VG_UNIT *unit, const double *rscale, int nati, int natj);
int MR3_close_ch(int s_sock);
int mr3_close_ch_(int *s_sock);
int MR3_open_port(int port_number);
int MR3_sock_read(int sockfd, char *buf, size_t count);
int mr3_sock_read_(int *sockfd, char *buf, int *count);
int mr3_sock_read__(int *sockfd, char *buf, int *count);
int mr3_sock_read_i_(int *sockfd, int *buf);
int mr3_sock_read_i__(int *sockfd, int *buf);
int MR3_sock_read_iv(int sockfd, int *buf, int count);
int mr3_sock_read_iv_(int *sockfd, int *buf, int *count);
int mr3_sock_read_iv__(int *sockfd, int *buf, int *count);
int MR3_sock_read_d(int sockfd, double *buf);
int mr3_sock_read_d__(int *sockfd, double *buf);
int mr3_sock_read_d_(int *sockfd, double *buf);
int MR3_sock_read_dv(int sockfd, double *buf, int count);
int mr3_sock_read_dv__(int *sockfd, double *buf, int *count);
int mr3_sock_read_dv_(int *sockfd, double *buf, int *count);
int MR3_sock_write(int sockfd, char *buf, size_t count);
int MR3_sock_write_c(int sockfd, char *buf);
int mr3_sock_write_c_(int *sockfd, char *buf);
int mr3_sock_write_c__(int *sockfd, char *buf);
int MR3_sock_write_i(int sockfd, int buf);
int mr3_sock_write_i_(int *sockfd, int *buf);
int mr3_sock_write_i__(int *sockfd, int *buf);
int MR3_sock_write_iv(int sockfd, int *buf, int count);
int mr3_sock_write_iv_(int *sockfd, int *buf, int *count);
int mr3_sock_write_iv__(int *sockfd, int *buf, int *count);
int MR3_sock_write_dv(int sockfd, double *buf, int count);
int mr3_sock_write_dv__(int *sockfd, double *buf, int *count);
int mr3_sock_write_dv_(int *sockfd, double *buf, int *count);
int MR3_sock_gets(int sockfd, char *str, size_t count);
int MR3_sock_puts(int sockfd, char *str);
void MR3_sock_init(int *s_sock_org, int port_num, double x[], int igraph[], int natom, int str_len, int lbres[], int ipres[], int nres);
void mr3_sock_init_(int *s_sock, int *port_num, double x[], int igraph[], int *natom, int *str_len, int lbres[], int ipres[], int *nres);
void mr3_sock_init__(int *s_sock, int *port_num, double x[], int igraph[], int *natom, int *str_len, int lbres[], int ipres[], int *nres);
void MR3_sock_1step(int s_sock, double t1, double time, double t2, int recv_buf[], int natom, double x[], double f[], double f_temp[]);
void mr3_sock_1step_(int *s_sock, double *t1, double *time, double *t2, int recv_buf[], int *natom, double x[], double f[], double f_tmp[]);
void mr3_sock_1step__(int *s_sock, double *t1, double *time, double *t2, int recv_buf[], int *natom, double x[], double f[], double f_tmp[]);
void MR3calc_ij_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, char method);
void MR3calc_ij_exlist_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], char method);
void MR3calc_ij_nlist_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], char method);
/* vtgrape.c */
void *MR3_my_malloc2(size_t n, char *s);
void MR3_my_free2(void **p, char *s);
VG_UNIT *m3_get_unit(void);
void vg_exit(int ret);
VG_UNIT *vg_allocate_unit(void (*function)(void *));
void vg_free_unit(VG_UNIT *unit);
void vg_set_function(VG_UNIT *unit, int function_index, void (*function)(void *));
void vg_set_vectors(VG_UNIT *unit, int nj, void *jvectors);
void vg_set_matrices(VG_UNIT *unit, int nati, int natj, void *matrices);
void vg_set_scalers(VG_UNIT *unit, void *scalers);
void vg_set_pipeline_vectors(VG_UNIT *unit, int ni, void *ivectors);
void vg_calculate(VG_UNIT *unit, int function_index, int nf, void *fvectors, void *pscalers);
void vg_set_vectors_pos_charge_atype(VG_UNIT *unit, int nj, double pos[][3], double charge[], int atype[]);
void vg_set_vectors_pos_charge(VG_UNIT *unit, int nj, double pos[][3], double charge[]);
void vg_set_vectors_pos_atype(VG_UNIT *unit, int nj, double pos[][3], int atype[]);
void vg_set_matrices_gscales_rscales(VG_UNIT *unit, int nati_org, int natj_org, double gscales[], double rscales[]);
void vg_set_pol_sigm_ipotro_pc_pd_zz(VG_UNIT *unit, int nati, int natj, double pol[], double sigm[], double ipotro[], double pc[], double pd[], double zz[]);
void vg_set_scalers_volume_alpha(VG_UNIT *unit, double volume[3], double alpha);
void vg_set_pipeline_vectors_pos_charge_atype(VG_UNIT *unit, int ni, double pos[][3], double charge[], int atype[]);
void vg_set_pipeline_vectors_pos_charge(VG_UNIT *unit, int ni, double pos[][3], double charge[]);
void vg_set_pipeline_vectors_pos_atype(VG_UNIT *unit, int ni, double pos[][3], int atype[]);
void vg_convert_forces(VG_UNIT *unit, int nf, int function_index, double fi[][3]);
void vg_calculate_forces_potentials(VG_UNIT *unit, int function_index, int nf, double fi[][3], double *potc, double *potv);
void vg_get_r1result(int n_org, float r[], float r1[]);
void vg_get_rsqrtresult(int n_org, float r[], float r1[]);
void vg_get_mulresult(int n_org, float r[], float q[], float rq[]);
int vg_write_emufile(int flag);
void vg_initialize_emu(void);
float vg_r1emu(float x);
float vg_rsqrtemu(float x);
void vg_set_scaleq(int n, double q[], double *scaleq, float *scaleq_1);
void m3_set_softening(VG_UNIT *unit, double eps);
void MR3_exit(int ret);
void MR3init(void);
void mr3init_(void);
void mr3init__(void);
void MR3free(void);
void mr3free_(void);
void mr3free__(void);
void MR3calccoulomb(double x[], int n, double q[], double rscale, int tblno, double xmax, int periodicflag, int natchangeflag, double force[]);
void mr3calccoulomb_(double x[], int *n, double q[], double *rscale, int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void mr3calccoulomb__(double x[], int *n, double q[], double *rscale, int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void MR3calccoulomb_ij(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag);
void mr3calccoulomb_ij_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void mr3calccoulomb_ij__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void MR3_sort_with_index_int(int data[], int index[], int left, int right);
void MR3calcvdw_ij_core(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void MR3calcvdw_ij(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void mr3calcvdw_ij_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void mr3calcvdw_ij__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void MR3calcvdw(double x[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int natchangeflag, double force[]);
void mr3calcvdw_(double x[], int *n, int atype[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void mr3calcvdw__(double x[], int *n, int atype[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int *natchangeflag, double force[]);
void MR3calcewald(int *k, int knum_org, double *x, int n, double *chg, double alpha, double epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald__(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void MR3calcnacl(double x[], int n, int atype[], int nat, double pol[], double sigm[], double ipotro[], double pc[], double pd[], double zz[], int tblno, double xmax, int periodicflag, double force[]);
void vtgrape_force(double xj[][3], double mj[], double xi[][3], double eps2, double a[][3], int ni, int nj);
void vg_set_rcut2(VG_UNIT *unit, double rcut2);
void mr3_set_rcut2_(double *rcut2);
void vg_set_cuton(VG_UNIT *unit, double cuton);
void mr3_set_cuton_(double *cuton);
int md5sum(unsigned char *buffer, int totallen, unsigned char sum[16]);
int md5sum_file(char *filename, unsigned char sum[16]);
void MR3_get_cputime(double *laptime, double *sprittime);
void MR3_set_ldim(int ldim[3]);
void mr3_set_ldim_(int ldim[3]);
void mr3_set_ldim__(int ldim[3]);
void MR3_set_coulomb_vdw_factor(double cgf);
void mr3_set_coulomb_vdw_factor_(double *cgf);
void mr3_set_coulomb_vdw_factor__(double *cgf);
void MR3calccoulomb_ij_emu(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag);
void MR3calccoulomb_nlist_ij_emu(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calccoulomb_nlist_emu(double xd[], int n, double qd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calcvdw_ij_emu(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void MR3calccoulomb_vdw_nlist_ij_emu(int ni, double xid[], double qid[], int atypei[], double force[], int nj, double xjd[], double qjd[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblno, double volume[], int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_ij_emu(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_emu2(double xd[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calccoulomb_ij_exlist(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void mr3calccoulomb_ij_exlist_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag, int numexorg[], int natexorg[]);
void mr3calccoulomb_ij_exlist__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag, int numexorg[], int natexorg[]);
void MR3calcvdw_ij_exlist(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void mr3calcvdw_ij_exlist_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int numex[], int natex[]);
void mr3calcvdw_ij_exlist__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_core_old(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_core(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_virial_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_exlist(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double volume1, double *potc, double *potv, int *convert_index, int potflag, int flag);
void MR3calccoulomb_vdw_exlist_from_cell(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double volume1, double *potc, double *potv, int *convert_index, int potflag, int flag);
void mr3calccoulomb_vdw_exlist_(int *n, double x[], double q[], int atype[], int *nat, double force[], double *rscale, double gscalesf[], double gscalesp[], double rscales[], int *tblno, int numex[], int natex[], double *volume1, double *potc, double *potv, int *convert_index, int *potflag, int *flag);
void MR3_get_forces_overlap(double force[]);
void mr3_get_forces_overlap_(double force[]);
void MR3_get_potc_and_potv_overlap(double *potc, double *potv);
void mr3_get_potc_and_potv_overlap_(double *potc, double *potv);
void mr3_get_potc_and_potv_overlap__(double *potc, double *potv);
void MR3_get_forces_and_virial_overlap(double force[], double virial[3][3]);
void mr3_get_forces_and_virial_overlap_(double force[], double virial[3][3]);
void MR3calccoulomb_ci_exlist(int n, double x[], double q[], double force[], double rscale, int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], int *convert_index, int flag);
void mr3calccoulomb_ci_exlist_(int *n, double x[], double q[], double force[], double *rscale, int *tblno, int numex[], int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], int *convert_index, int *flag);
void MR3calcvdw_ci(int n, double x[], int atype[], int nat, double force[], double gscales[], double rscales[], int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calcvdw_ci_(int *n, double x[], int atype[], int *nat, double force[], double gscales[], double rscales[], int *tblno, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calcvdw_ci_exlist(int n, double x[], int atype[], int nat, double force[], double gscales[], double rscales[], int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], int *convert_index, int flag);
void mr3calcvdw_ci_exlist_(int *n, double x[], int atype[], int *nat, double force[], double gscales[], double rscales[], int *tblno, int numex[], int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], int *convert_index, int *flag);
void MR3calccoulomb_vdw_ci_exlist(int n, double x[], double q[], int atype[], int nat, double force[], double rscale, double gscalesf[], double gscalesp[], double rscales[], int tblno, int numex[], int natex[], double rcut, double skinnb, double volume[3], int ldim[3], double *potc, double *potv, int *convert_index, int potflag, int flag);
void mr3calccoulomb_vdw_ci_exlist_(int *n, double x[], double q[], int atype[], int *nat, double force[], double *rscale, double gscalesf[], double gscalesp[], double rscales[], int *tblno, int *numex, int natex[], double *rcut, double *skinnb, double volume[3], int ldim[3], double *potc, double *potv, int *convert_index, int *potflag, int *flag);
void MR3calccoulomb_ci(int n, double x[], double q[], double force[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calccoulomb_ci_(int *n, double x[], double q[], double force[], double *rscale, int *tblno, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_ij_ci(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_ij_ci_old(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calcvdw_ij_ci(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_virial(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut_org, double skinnb, double volume[3], int ldim[3], double virial[3][3], int flag);
void MR3calccoulomb_vdw_ij_ci(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void mr3calccoulomb_vdw_ij_ci_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscales[], double rscales[], double *rscale, int *tblnoc, double *rcut, double *skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_old_09(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_old_090121(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblnoc, double rcut, double skinnb, double volume[3], int ldim[3]);
void MR3calccoulomb_vdw_ij_ci_exlist(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscales[], double rscales[], double rscale, int tblno, double rcut, double skinnb, double volume[3], int ldim[3], int numex[], int natex[], int flag);
void mr3calccoulomb_vdw_ij_ci_exlist_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscales[], double rscales[], double *rscale, int *tblnoc, double *rcut, double *skinnb, double volume[3], int ldim[3], int numex[], int natex[], int *flag);
void MR3calccoulomb_ij_host(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag);
void mr3calccoulomb_ij_host_(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void mr3calccoulomb_ij_host__(int *ni, double xi[], double qi[], double force[], int *nj, double xj[], double qj[], double *rscale, int *tblno, double *xmax, int *periodicflag);
void MR3calcvdw_ij_host(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag);
void mr3calcvdw_ij_host_(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void mr3calcvdw_ij_host__(int *ni, double xi[], int atypei[], double force[], int *nj, double xj[], int atypej[], int *nat, double gscale[], double rscale[], int *tblno, double *xmax, int *periodicflag);
void MR3calccoulomb_nlist_ij_host_notwork(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[], double factorall);
void MR3calccoulomb_nlist_ij_host(int ni, double xid[], double qid[], double force[], int nj, double xjd[], double qjd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calccoulomb_nlist_host(double xd[], int n, double qd[], double rscale, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord, double force[]);
void MR3calcvdw_nlist_ij_host_notwork(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[], double factor);
void MR3calcvdw_nlist_ij_host(int ni, double xid[], int atypei[], double force[], int nj, double xjd[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmaxd, int periodicflag, int numex[], int natex[], double factord);
void MR3calcvdw_nlist_host2(double x[], int n, int atype[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[], double factor, double force[]);
void MR3calccoulomb_ij_exlist_host(int ni, double xi[], double qi[], double force[], int nj, double xj[], double qj[], double rscale, int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void MR3calcvdw_ij_exlist_host(int ni, double xi[], int atypei[], double force[], int nj, double xj[], int atypej[], int nat, double gscale[], double rscale[], int tblno, double xmax, int periodicflag, int numex[], int natex[]);
void MR3calcewald_dft_host(int k[], int knum, double x[], int n, double chg[], double cellsize[3], double bs[], double bc[]);
void MR3calcewald_idft_eng_host(int k[], double bs[], double bc[], int knum, double x[], int n, double cellsize[3], double force[]);
void MR3calcewald_idft_force_host(int k[], double bs[], double bc[], int knum, double x[], int n, double cellsize[3], double force[]);
void MR3calcewald_host(int *k, int knum_org, double *x, int n, double *chg, double alpha, double epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_host__(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void mr3calcewald_host_(int *k, int *knum, double *x, int *n, double *chg, double *alpha, double *epsilon, double cell[3][3], double *force, double *tpot, double stress[3][3]);
void MR3SetTable(char *filename, int tblno, int flag);
void mr3settable_nf_(char *fname, int *tblno, int *flag, int *n);
void mr3settable_nf__(char *fname, int *tblno, int *flag, int *n);
void MR3_setup_exlist(int n, int *bckptr);
void mr3_setup_exlist_(int *n, int *bckptr);
void MR3_make_natex2_from_natex(int n, int natex[], int numex[], int **natex_offset, int **natex2, int **numex2, int **natex2_offset, int flag);
void calccoulomb_vdw_ij_exlist_host_sub(int i, int j, double xi[], double xj[], double qj, double gsf, double gsp, double rs, double rscale, double cutoff, double *fc, double *fv, double *pc, double *pv, int tblno, double size[3], int potflag);
void MR3calccoulomb_vdw_ij_exlist_cutoff_host(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double cutoff, double size[3], double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_host(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void MR3calccoulomb_vdw_ij_exlist_host2(int ni, double xi[], double qi[], int atypei[], double force[], int nj, double xj[], double qj[], int atypej[], int nat, double gscalesf[], double gscalesp[], double rscales[], double rscale, int tblno, double xmax, double *potc, double *potv, int periodicflag, int potflag, int changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_host_(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void mr3calccoulomb_vdw_ij_exlist_host__(int *ni, double xi[], double qi[], int atypei[], double force[], int *nj, double xj[], double qj[], int atypej[], int *nat, double gscalesf[], double gscalesp[], double rscales[], double *rscale, int *tblno, double *xmax, double *potc, double *potv, int *periodicflag, int *potflag, int *changeflag, int numex[], int natex[]);
void MR3_get_board_version(int *version, int *freq);
void MR3_rscale_and_pack(int n, double (*x)[3], int *atype, longlong (*rj)[2]);
void MR3_rscale_and_pack_old(int n, double (*x)[3], int *atype, longlong (*rj)[2]);
void MR3SetTable_emu(char *filename, int tblno, int flag);
int MR3_get_total_num_chips(void);
void MR3print_chip_temperature(int flag);
int MR3_get_retry_count(void);
void m3_free_unit(VG_UNIT *unit);
VG_UNIT *m3_allocate_periodic_unit(const char *fname, int mode, double size, int dum);
void m3_set_positions(VG_UNIT *unit, double (*pos)[3], int n);
void m3_set_charges(VG_UNIT *unit, const double *q, int n);
void m3_set_cells(VG_UNIT *unit, M3_CELL *cell, int ncell);
void m3_calculate_forces(VG_UNIT *unit, double (*xi)[3], int ni, double (*force)[3]);
void m3_calculate_potentials(VG_UNIT *unit, double (*xi)[3], int ni, double *eng);
void m3_set_types(VG_UNIT *unit, const int *atype, int n);
void m3_set_pipeline_types(VG_UNIT *unit, const int *atype, int n);
void m3_set_charge_matrix(VG_UNIT *unit, const double *gscale, int nati, int natj);
void m3_set_rscale_matrix(VG_UNIT *unit, const double *rscale, int nati, int natj);
int MR3_close_ch(int s_sock);
int mr3_close_ch_(int *s_sock);
int MR3_open_port(int port_number);
int MR3_sock_read(int sockfd, char *buf, size_t count);
int mr3_sock_read_(int *sockfd, char *buf, int *count);
int mr3_sock_read__(int *sockfd, char *buf, int *count);
int mr3_sock_read_i_(int *sockfd, int *buf);
int mr3_sock_read_i__(int *sockfd, int *buf);
int MR3_sock_read_iv(int sockfd, int *buf, int count);
int mr3_sock_read_iv_(int *sockfd, int *buf, int *count);
int mr3_sock_read_iv__(int *sockfd, int *buf, int *count);
int MR3_sock_read_d(int sockfd, double *buf);
int mr3_sock_read_d__(int *sockfd, double *buf);
int mr3_sock_read_d_(int *sockfd, double *buf);
int MR3_sock_read_dv(int sockfd, double *buf, int count);
int mr3_sock_read_dv__(int *sockfd, double *buf, int *count);
int mr3_sock_read_dv_(int *sockfd, double *buf, int *count);
int MR3_sock_write(int sockfd, char *buf, size_t count);
int MR3_sock_write_c(int sockfd, char *buf);
int mr3_sock_write_c_(int *sockfd, char *buf);
int mr3_sock_write_c__(int *sockfd, char *buf);
int MR3_sock_write_i(int sockfd, int buf);
int mr3_sock_write_i_(int *sockfd, int *buf);
int mr3_sock_write_i__(int *sockfd, int *buf);
int MR3_sock_write_iv(int sockfd, int *buf, int count);
int mr3_sock_write_iv_(int *sockfd, int *buf, int *count);
int mr3_sock_write_iv__(int *sockfd, int *buf, int *count);
int MR3_sock_write_dv(int sockfd, double *buf, int count);
int mr3_sock_write_dv__(int *sockfd, double *buf, int *count);
int mr3_sock_write_dv_(int *sockfd, double *buf, int *count);
int MR3_sock_gets(int sockfd, char *str, size_t count);
int MR3_sock_puts(int sockfd, char *str);
void MR3_sock_init(int *s_sock_org, int port_num, double x[], int igraph[], int natom, int str_len, int lbres[], int ipres[], int nres);
void mr3_sock_init_(int *s_sock, int *port_num, double x[], int igraph[], int *natom, int *str_len, int lbres[], int ipres[], int *nres);
void mr3_sock_init__(int *s_sock, int *port_num, double x[], int igraph[], int *natom, int *str_len, int lbres[], int ipres[], int *nres);
void MR3_sock_1step(int s_sock, double t1, double time, double t2, int recv_buf[], int natom, double x[], double f[], double f_temp[]);
void mr3_sock_1step_(int *s_sock, double *t1, double *time, double *t2, int recv_buf[], int *natom, double x[], double f[], double f_tmp[]);
void mr3_sock_1step__(int *s_sock, double *t1, double *time, double *t2, int recv_buf[], int *natom, double x[], double f[], double f_tmp[]);
void MR3calc_ij_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, char method);
void MR3calc_ij_exlist_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], char method);
void MR3calc_ij_nlist_host_mixedaccuracy(int ni, double xid[], double *qid, int *atypei, double forced[], int nj, double xjd[], double *qjd, int *atypej, int nat, double *gscaled, double *rscaled, int tblno, double xmaxd, int periodicflag, int numex[], int natex[], char method);
